var Gt=Object.defineProperty;var Ht=(t,e,n)=>e in t?Gt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var O=(t,e,n)=>(Ht(t,typeof e!="symbol"?e+"":e,n),n);import{c as Xt,Q as Zt,P as Yt,D as en,N as tn,a as nn,i as an,u as Oe,b as Ve,d as N,o as g,e as C,w as c,f as u,g as x,h as l,j as ut,k as m,l as sn,r as V,m as y,n as L,p as fe,q as on,s as ln,S as rn,t as P,v as B,x as wt,y as I,z as Y,A as W,B as Ae,C as cn,E as G,F as H,G as un,H as se,I as j,J as xt,W as Ct,K as ge,L as be,M as dn,O as Ke,R as mn,T as hn,U as pe,V as ae,X as Pe,Y as ke,Z as pn,_ as Fe,$ as $t,a0 as gt,a1 as fn,a2 as gn,a3 as bn,a4 as Et,a5 as qe,a6 as _n,a7 as he,a8 as ot,a9 as Me,aa as De,ab as yn,ac as Dt,ad as vn,ae as wn,af as h,ag as te,ah as Pt,ai as ce,aj as ue,ak as Ie,al as Kt,am as Se,an as Cn,ao as je,ap as It,aq as dt,ar as Mn,as as An,at as kn,au as Sn,av as xn,aw as oe,ax as ie,ay as Mt,az as re,aA as $n,aB as Ue,aC as Qe,aD as bt,aE as ne,aF as _t,aG as En,aH as Je,aI as Ee,aJ as Dn,aK as Pn,aL as Kn,aM as In,aN as zn,aO as Bn,aP as Tn,aQ as Ln,aR as Nn,aS as Wn,aT as Vn,aU as Rn,aV as On,aW as Fn,aX as qn,aY as jn,aZ as Un,a_ as Qn,a$ as Jn,b0 as Gn,b1 as Hn,b2 as Xn,b3 as Zn,b4 as Yn,b5 as ea,b6 as ta,b7 as na,b8 as aa,b9 as sa,ba as ia,bb as oa,bc as la,bd as ra,be as ca,bf as ua,bg as da,bh as ma,bi as ha,bj as pa,bk as fa,bl as ga,bm as ba,bn as _a}from"./vendor.a23ef5e2.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function n(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerpolicy&&(a.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?a.credentials="include":o.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(o){if(o.ep)return;o.ep=!0;const a=n(o);fetch(o.href,a)}})();const ya=({app:t})=>{const e=Xt();t.use(e)},va=Object.freeze(Object.defineProperty({__proto__:null,install:ya},Symbol.toStringTag,{value:"Module"})),wa=({app:t})=>{t.use(Zt,{plugins:{Dark:Yt,Dialog:en,Notify:tn,LocalStorage:nn},iconSet:an})},Ca=Object.freeze(Object.defineProperty({__proto__:null,install:wa},Symbol.toStringTag,{value:"Module"}));function Ma(){const{dark:t}=Oe(),e=Ve("theme-mode",t.isActive);return t.set(e.value),{isActive:e,set(n){t.set(n),e.value=t.isActive},toggle(){t.toggle(),e.value=t.isActive}}}const Aa={class:"container"},ka={class:"row"},Sa=u("div",{class:"col-12 col-md-6"},[u("div",{class:"footer-links"},[u("ul",null,[u("li",null,[u("a",{target:"_blank",href:"https://jpool.one"},"JPOOL")]),u("li",null,[u("a",{target:"_blank",href:"https://heartandsol.one"},"GAME")]),u("li",null,[u("a",{href:"https://magiceden.io/marketplace/heartandsol"},"NFT Marketplace")])])]),u("div",{class:"copyright"},[u("span",null,"\xA9 Copyright 2022 jpool.one. All rights reserved. Powered by mFactory GmbH")])],-1),xa={class:"col-12 col-md-6 social-col"},$a={class:"social"},Ea={class:"theme"},Da=u("div",{class:"social-link social-link-text"},[u("span",null,[x("official"),u("br"),x("channel")])],-1),Pa=u("div",{class:"social-link telegram"},null,-1),Ka=u("div",{class:"social-link twitter"},null,-1),Ia=u("div",{class:"social-link discord"},null,-1),za=N({__name:"AppFooter",setup(t){const e=Ma();return(n,i)=>(g(),C(sn,null,{default:c(()=>[u("div",Aa,[u("div",ka,[Sa,u("div",xa,[u("div",$a,[u("div",Ea,[x(" Dark theme "),l(ut,{"model-value":m(e).isActive.value,onClick:m(e).toggle},null,8,["model-value","onClick"])]),Da,Pa,Ka,Ia])])])])]),_:1}))}});function Ba(){const t=V(Ta());return{userAgent:t,isMobileOs:y(()=>La(t.value)),isWebView:y(()=>Na(t.value))}}let lt;function Ta(){var t,e;return lt===void 0&&(lt=(e=(t=globalThis.navigator)==null?void 0:t.userAgent)!=null?e:null),lt}function La(t){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)}function Na(t){return/(WebView|(Phantom|Solflare)|Version\/.+(Chrome)\/(\d+)\.(\d+)\.(\d+)\.(\d+)|; wv\).+(Chrome)\/(\d+)\.(\d+)\.(\d+)\.(\d+))/i.test(t)}function Ge(t,e=4){return t instanceof L&&(t=t.toBase58()),`${t.slice(0,e)}...${t.slice(-e)}`}function zt(t){return(t==null?void 0:t.name)&&t.name!==""?t.name:Ge(t.authority)}const Bt=t=>{if(!t)return{background:"#000"};let e=0;for(let i=0;i<t.length;i++)e=t.charCodeAt(i)+((e<<5)-e),e=e&e;let n="#";for(let i=0;i<3;i++)n+=`00${(e>>i*8&255).toString(16)}`.substr(-2);return{background:n}},Wa="/sol-messenger/assets/clover.968404b0.svg",Va="/sol-messenger/assets/ledger.40cf6861.svg",Ra="/sol-messenger/assets/mathwallet.1d763e81.svg",Tt=t=>(ge("data-v-46d95635"),t=t(),be(),t),Oa=Tt(()=>u("div",{class:"text-h6 text-center"}," Your wallet ",-1)),Fa={class:"q-gutter-md row justify-between"},qa=Tt(()=>u("div",{class:"text-h6"}," Connect to a wallet ",-1)),ja={class:"text-light-gray text-caption full-width text-no-wrap",style:{"text-overflow":"ellipsis",overflow:"hidden"}},Ua=["src","alt"],Qa=N({__name:"ConnectWallet",setup(t){const e={priority:{solflare:10,phantom:20,sollet:5,nufi:5,blocto:1},icons:{clover:Wa},darkIcons:{ledger:Va,mathwallet:Ra},deepLinks:{phantom:"https://phantom.app/ul/browse/{uri}?ref={ref}",solflare:"https://solflare.com/ul/browse/{uri}?ref={ref}"}},{userAgent:n,isWebView:i,isMobileOs:o}=Ba(),a={close:xt},s=$=>[Ct.Installed,Ct.Loadable].includes($.readyState);Oe();const r=fe(),{connected:d,connecting:p}=r;on();const v=y(()=>o.value&&!i.value);if(i.value){const $=String(n.value).toLowerCase();$.includes("phantom")?(r.select(ln),r.connect()):$.includes("solflare")&&(r.select(rn),r.connect())}const w=y(()=>{var $,R;return(R=($=r.publicKey.value)==null?void 0:$.toBase58())!=null?R:""}),k=y(()=>Ge(w.value)),f=y(()=>[...r.wallets.value].map($=>{var A,T;const R=$.adapter.name.toLowerCase();return $.adapter.icon=(T=(A=e.darkIcons[R])!=null?A:e.icons[R])!=null?T:$.adapter.icon,v.value&&e.deepLinks[R]&&($.deepLink=e.deepLinks[R].replace("{uri}",location.href).replace("{ref}",location.origin)),$}).sort(($,R)=>{var M,de;const A=(M=e.priority[$.adapter.name.toLowerCase()])!=null?M:1;return((de=e.priority[R.adapter.name.toLowerCase()])!=null?de:1)-A+((s(R)?1:0)-(s($)?1:0))})),b=y(()=>v.value?f.value.filter($=>!!$.deepLink):f.value),S=V(!1);async function U($){await r.select($.adapter.name),S.value=!1,await r.connect()}function K(){S.value=!1,r.disconnect()}function X(){S.value=!0}function Q(){S.value=!1}return($,R)=>(g(),P(j,null,[m(d)?(g(),C(I,wt({key:0},$.$attrs,{class:$.$style.btn,ripple:!1,color:"primary-gray","text-color":"white",rounded:"",unelevated:"",onClick:X}),{default:c(()=>[x(B(m(k)),1)]),_:1},16,["class"])):(g(),C(I,wt({key:1},$.$attrs,{color:"primary-gray","text-color":"white",rounded:"",unelevated:"",ripple:!1,loading:m(p),onClick:X}),{default:c(()=>[x(" CONNECT WALLET ")]),_:1},16,["loading"])),l(se,{modelValue:S.value,"onUpdate:modelValue":R[0]||(R[0]=A=>S.value=A),"transition-duration":"150","transition-show":"fade","transition-hide":"fade"},{default:c(()=>[m(d)?(g(),C(Y,{key:0},{default:c(()=>[l(W,{class:"relative-position"},{default:c(()=>[Oa,l(I,{padding:"md",color:"transparent","text-color":"primary-gray",unelevated:"",class:"absolute-right",icon:a.close,size:"md",onClick:Q},null,8,["icon"])]),_:1}),l(Ae),l(W,null,{default:c(()=>[x(B(m(w)),1)]),_:1}),l(Ae),l(W,null,{default:c(()=>[u("div",Fa,[l(I,{class:"disconnect-btn","text-color":"white",rounded:"",onClick:K},{default:c(()=>[x(" Disconnect ")]),_:1}),l(I,{class:"disconnect-btn","text-color":"white",rounded:"",onClick:Q},{default:c(()=>[x(" Ok ")]),_:1})])]),_:1})]),_:1})):(g(),C(Y,{key:1,class:"wallet-connect-card"},{default:c(()=>[l(W,null,{default:c(()=>[qa,l(I,{padding:"md",color:"transparent","text-color":"primary-gray",unelevated:"",class:"absolute-right",icon:a.close,size:"md",onClick:Q},null,8,["icon"])]),_:1}),l(Ae),l(W,{style:{"max-height":"80vh"},class:"scroll"},{default:c(()=>[l(cn,{grid:"",rows:m(b),"row-key":"name","hide-pagination":"","hide-header":"","rows-per-page-options":[100]},{item:c(({row:A})=>[(g(),P("div",{key:`wallet-${A.adapter.name}`,class:"col-12 col-md-6"},[l(G,{clickable:"",href:A.deepLink,onClick:T=>A.deepLink?!0:U(A)},{default:c(()=>[l(H,null,{default:c(()=>[u("b",null,B(A.adapter.name),1),u("div",ja,B(A.adapter.url),1)]),_:2},1024),l(H,{avatar:""},{default:c(()=>[l(un,{square:""},{default:c(()=>[u("img",{src:A.adapter.icon,alt:A.adapter.name},null,8,Ua)]),_:2},1024)]),_:2},1024)]),_:2},1032,["href","onClick"])]))]),_:1},8,["rows"])]),_:1})]),_:1}))]),_:1},8,["modelValue"])],64))}});const Ja="_btn_6n1iw_1",Ga={btn:Ja},F=(t,e)=>{const n=t.__vccOpts||t;for(const[i,o]of e)n[i]=o;return n},Ha={$style:Ga},Xa=F(Qa,[["__cssModules",Ha],["__scopeId","data-v-46d95635"]]),xe=[{id:"serum-mainnet",name:"Serum RPC",cluster:"mainnet-beta",url:"https://solana-api.projectserum.com/"},{id:"rpcpool-mainnet",name:"RPCPool RPC",cluster:"mainnet-beta",url:"https://mainnet.rpcpool.com/"},{id:"mainnet",name:"Solana RPC",cluster:"mainnet-beta",url:dn("mainnet-beta")}],Lt={id:"devnet",name:"DevNet",cluster:"devnet",url:"https://devnet.rpcpool.com/"};xe.push(Lt);const Za={id:"testnet",name:"TestNet",cluster:"testnet",url:"https://testnet.rpcpool.com/"};xe.push(Za);var St;const Ya=(St=xe.find(t=>t.id==={VITE_BASE_PATH:"/sol-messenger/",VITE_USER_NODE_ENV:"production",BASE_URL:"/sol-messenger/",MODE:"staging",DEV:!1,PROD:!0}.VITE_CONNECTION_ENDPOINT))!=null?St:Lt,es="confirmed",ts=12e4,At=[`<span>Public channels</span> are non-encrypted and available to anyone, both for reading and writing.</br></br>
    <span>Public channels</span> are encrypted, and new users need to request approval to join them.</br>
    Depending on the \u2018Members can approve\u2019 setting, such requests can be approved either by channel\u2019s 
    owner/admin only, or by any authorized member of the channel.
    `,"Any authorized channel member can approve new requests to join"],yt=Ke({id:"connection",state:()=>({commitment:es,confirmTransactionInitialTimeout:ts,rpc:mn("rpc","")}),getters:{endpoint(t){var e;return(e=xe.find(n=>n.id===t.rpc))!=null?e:Ya},connection(t){return console.log("[connection]",this.endpoint.url),new hn(this.endpoint.url,{confirmTransactionInitialTimeout:t.confirmTransactionInitialTimeout,commitment:t.commitment})},cluster(){return this.endpoint.cluster}},actions:{setRpc(t){this.rpc=t},setCommitment(t){this.commitment=t}}}),ns=N({__name:"ClusterSelector",setup(t){const e=yt(),{connected:n,connect:i,disconnect:o,autoConnect:a}=fe(),s=[xe.filter(p=>p.cluster==="mainnet-beta"),xe.filter(p=>p.cluster!=="mainnet-beta")],r=y(()=>e.endpoint),d=p=>{n&&e.cluster!==p.cluster&&(o(),a.value&&i()),e.setRpc(p.id)};return(p,v)=>(g(),C(pn,{label:m(r).name,"model-value":!1,"auto-close":"",color:"secondary","text-color":"#000",rounded:"",unelevated:"",ripple:!1},{default:c(()=>[l(pe,null,{default:c(()=>[(g(),P(j,null,ae(s,(w,k)=>(g(),P(j,{key:`${k}-cluster-group`},[(g(!0),P(j,null,ae(w,f=>(g(),C(G,{key:f.id,clickable:"",onClick:b=>d(f)},{default:c(()=>[(g(),C(H,{key:`${f.id}-item`},{default:c(()=>[l(Pe,null,{default:c(()=>[u("b",null,B(f.name),1)]),_:2},1024),x(" "+B(f.url),1)]),_:2},1024))]),_:2},1032,["onClick"]))),128)),k!==s.length-1?(g(),C(Ae,{key:0})):ke("",!0)],64))),64))]),_:1})]),_:1},8,["label"]))}});const as={},ss={class:"container"},is={class:"app-header__info"},os={class:"app-header__logo"},ls={class:"logo-wrapper"},rs=u("div",{class:"app-header__title"},[u("h1",null,[x("BLOCKCHAIN messenger "),u("span",{class:"marked"},"SOLANA")])],-1),cs={class:"app-header__right"},us={class:"app-header__buttons"};function ds(t,e){const n=Fe("router-link"),i=ns,o=Xa;return g(),C(fn,{class:"app-header"},{default:c(()=>[u("div",ss,[l($t,null,{default:c(()=>[u("div",is,[u("div",os,[u("div",ls,[l(n,{to:"/"})])]),rs]),l(gt),u("div",cs,[u("div",us,[l(i,{class:"app-header__cluster-btn header-btn"}),l(o,{class:"app-header__wallet-btn header-btn"})])])]),_:1})])]),_:1})}const ms=F(as,[["render",ds]]),hs={};function ps(t,e){const n=ms,i=Fe("router-view"),o=za;return g(),C(gn,{view:"lfh Lpr lff"},{default:c(()=>[l(n),l(bn,null,{default:c(()=>[l(i)]),_:1}),l(o)]),_:1})}const fs=F(hs,[["render",ps]]),gs={default:fs,empty:()=>Et(()=>import("./empty.b640d38d.js"),["assets/empty.b640d38d.js","assets/vendor.a23ef5e2.js"])};function bs(t){return t.map(e=>{var n;return{path:e.path,component:gs[((n=e.meta)==null?void 0:n.layout)||"default"],children:[{...e,path:""}]}})}const _s="/sol-messenger/assets/solana-logo.3caace62.svg";const ys={},He=t=>(ge("data-v-5ffd3a8e"),t=t(),be(),t),vs={class:"row info-row"},ws=He(()=>u("div",{class:"offset-0 offset-md-3"},null,-1)),Cs=He(()=>u("div",{class:"col-6 col-md-3 flex-center info-col"},[u("div",{class:"info-title"}," How IT WORKS "),u("div",{class:"info-text"},[u("ul",null,[u("li",null,"Connect your wallet"),u("li",null,"Enter the amount of JPLT you want to swap or enter the amount of JPLU you want to get"),u("li",null,"Click SWAP button"),u("li",null,"Confirm the transaction in your wallet"),u("li",null,"Done")])])],-1)),Ms={class:"col-6 col-md-5 logo-wrap"},As=He(()=>u("img",{src:_s,alt:"solana logo"},null,-1)),ks=He(()=>u("div",{class:"offset-0 offset-md-1"},null,-1));function Ss(t,e){const n=Fe("router-link");return g(),P("div",vs,[ws,Cs,u("div",Ms,[l(n,{to:"/"},{default:c(()=>[As]),_:1})]),ks])}const xs=F(ys,[["render",Ss],["__scopeId","data-v-5ffd3a8e"]]),Nt=Ke("user",()=>{const t=qe(),e=V();_n(()=>{var s;const a=(s=t.value)==null?void 0:s.publicKey;if(a){const r=Ve(a.toString(),()=>ot.encode(he.generate().secretKey));n(r.value)}else e.value=void 0});function n(a){e.value=he.fromSecretKey(ot.decode(a))}function i(){var r;const a=(r=t.value)==null?void 0:r.publicKey;if(!a)return;const s=Ve(a.toString(),"");n(s.value=ot.encode(he.generate().secretKey))}function o(a){var d;const s=(d=t.value)==null?void 0:d.publicKey;if(!s)return;const r=Ve(s.toString(),"");n(r.value=a)}return{keypair:e,generateKey:i,importKey:o}}),$s=t=>(ge("data-v-3fee7fbe"),t=t(),be(),t),Es=$s(()=>u("div",{class:"text-h6 text-center"}," Device Key ",-1)),Ds={class:"q-gutter-md row justify-between"},Ps=N({__name:"UserInfoDialog",emits:["regenerate"],setup(t){const e=Nt(),n=()=>{var i,o;wn(((o=(i=e.keypair)==null?void 0:i.publicKey)!=null?o:"").toString())};return(i,o)=>(g(),C(se,{class:"dialog-wrapper","transition-duration":"150","transition-show":"fade","transition-hide":"fade"},{default:c(()=>[l(Y,{square:"",flat:""},{default:c(()=>[l(W,{class:"row items-center"},{default:c(()=>[Es,l(gt),Me(l(I,{flat:"",round:"",dense:"",icon:m(xt)},null,8,["icon"]),[[De]])]),_:1}),l(Ae),l(W,null,{default:c(()=>{var a;return[l(I,{flat:"",round:"",dense:"",icon:m(yn),onClick:n},{default:c(()=>[l(Dt,{delay:0,anchor:"bottom middle",self:"top middle","transition-duration":"0"},{default:c(()=>[x(" Copy to clipboard ")]),_:1})]),_:1},8,["icon"]),u("span",null,B((a=m(e).keypair)==null?void 0:a.publicKey),1)]}),_:1}),l(Ae),l(vn,{align:"right"},{default:c(()=>[u("div",Ds,[l(I,{class:"dialog-submit-btn","text-color":"white",rounded:"",onClick:m(e).generateKey},{default:c(()=>[x(" Regenerate ")]),_:1},8,["onClick"])])]),_:1})]),_:1})]),_:1}))}});const Ks=F(Ps,[["__scopeId","data-v-3fee7fbe"]]),Is="0.0.8",zs="messenger",Bs=[{name:"initChannel",accounts:[{name:"channel",isMut:!0,isSigner:!0},{name:"membership",isMut:!0,isSigner:!1},{name:"authority",isMut:!0,isSigner:!0},{name:"key",isMut:!1,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"data",type:{defined:"InitChannelData"}}]},{name:"deleteChannel",accounts:[{name:"channel",isMut:!0,isSigner:!1},{name:"authorityMembership",isMut:!0,isSigner:!1},{name:"authority",isMut:!0,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"joinChannel",accounts:[{name:"channel",isMut:!0,isSigner:!1},{name:"membership",isMut:!0,isSigner:!1},{name:"authority",isMut:!0,isSigner:!0},{name:"key",isMut:!1,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"data",type:{defined:"JoinChannelData"}}]},{name:"leaveChannel",accounts:[{name:"channel",isMut:!0,isSigner:!1},{name:"membership",isMut:!0,isSigner:!1},{name:"authority",isMut:!0,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"grantAccessMember",accounts:[{name:"channel",isMut:!1,isSigner:!1},{name:"membership",isMut:!0,isSigner:!1},{name:"authorityMembership",isMut:!1,isSigner:!1},{name:"authority",isMut:!0,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"data",type:{defined:"GrantAccessMemberData"}}]},{name:"addMember",accounts:[{name:"channel",isMut:!0,isSigner:!1},{name:"invitee",isMut:!1,isSigner:!1},{name:"inviteeMembership",isMut:!0,isSigner:!1},{name:"authorityMembership",isMut:!0,isSigner:!1},{name:"authority",isMut:!0,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"data",type:{defined:"AddMemberData"}}]},{name:"authorizeMember",accounts:[{name:"channel",isMut:!1,isSigner:!1},{name:"membership",isMut:!0,isSigner:!1},{name:"authority",isMut:!1,isSigner:!0},{name:"authorityMembership",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"data",type:{defined:"AuthorizeMemberData"}}]},{name:"deleteMember",accounts:[{name:"channel",isMut:!0,isSigner:!1},{name:"membership",isMut:!0,isSigner:!1},{name:"authorityMembership",isMut:!1,isSigner:!1},{name:"authority",isMut:!0,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"postMessage",accounts:[{name:"channel",isMut:!0,isSigner:!1},{name:"membership",isMut:!1,isSigner:!1},{name:"authority",isMut:!1,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"message",type:"string"}]}],Ts=[{name:"Channel",type:{kind:"struct",fields:[{name:"name",docs:["Name of the channel"],type:"string"},{name:"creator",docs:["Channel creator"],type:"publicKey"},{name:"createdAt",docs:["Creation date"],type:"i64"},{name:"flags",docs:["Channel flags"],type:"u8"},{name:"memberCount",docs:["Number of members"],type:"u16"},{name:"messageCount",docs:["Message counter"],type:"u32"},{name:"maxMessages",docs:["The maximum number of messages that are stored in [messages]"],type:"u16"},{name:"messages",docs:["List of messages"],type:{vec:{defined:"Message"}}}]}},{name:"ChannelMembership",type:{kind:"struct",fields:[{name:"channel",docs:["Associated [Channel] address"],type:"publicKey"},{name:"authority",docs:["Authority of membership"],type:"publicKey"},{name:"key",docs:["The device key used to encrypt the `CEK`"],type:"publicKey"},{name:"cek",docs:["The content encryption key (CEK) of the channel"],type:{defined:"CEKData"}},{name:"status",docs:["Status of membership"],type:{defined:"ChannelMembershipStatus"}},{name:"name",docs:["Name of the channel member"],type:"string"},{name:"invitedBy",docs:["Inviter address"],type:{option:"publicKey"}},{name:"createdAt",docs:["Creation date"],type:"i64"},{name:"flags",docs:["Membership flags"],type:"u8"},{name:"bump",docs:["Bump seed for deriving PDA seeds"],type:"u8"}]}}],Ls=[{name:"AddMemberData",type:{kind:"struct",fields:[{name:"name",docs:["Member name"],type:"string"},{name:"flags",docs:["Membership flags, only `admin` and `owner` can set membership flags"],type:"u8"},{name:"cek",docs:["Content Encryption Key"],type:{defined:"CEKData"}},{name:"key",docs:["Device key"],type:{option:"publicKey"}}]}},{name:"AuthorizeMemberData",type:{kind:"struct",fields:[{name:"cek",type:{defined:"CEKData"}}]}},{name:"GrantAccessMemberData",type:{kind:"struct",fields:[{name:"flags",type:"u8"}]}},{name:"InitChannelData",type:{kind:"struct",fields:[{name:"name",type:"string"},{name:"maxMessages",type:"u16"},{name:"memberName",type:"string"},{name:"cek",type:{defined:"CEKData"}},{name:"public",type:"bool"},{name:"permissionless",type:"bool"}]}},{name:"JoinChannelData",type:{kind:"struct",fields:[{name:"name",type:"string"},{name:"authority",type:{option:"publicKey"}}]}},{name:"CEKData",type:{kind:"struct",fields:[{name:"header",docs:["The header information for the CEK"],type:"string"},{name:"encryptedKey",docs:["The CEK itself"],type:"string"}]}},{name:"Message",type:{kind:"struct",fields:[{name:"id",docs:["Uniq message id"],type:"u32"},{name:"sender",docs:["The message sender id"],type:"publicKey"},{name:"createdAt",docs:["The unix timestamp at which the message was received"],type:"i64"},{name:"flags",docs:["Message flags"],type:"u8"},{name:"content",docs:["The (typically encrypted) message content"],type:"string"}]}},{name:"ChannelMembershipStatus",type:{kind:"enum",variants:[{name:"Authorized",fields:[{name:"by",type:{option:"publicKey"}}]},{name:"Pending",fields:[{name:"authority",type:{option:"publicKey"}}]}]}}],Ns=[{name:"NewChannelEvent",fields:[{name:"channel",type:"publicKey",index:!0},{name:"creator",type:"publicKey",index:!1},{name:"name",type:"string",index:!1},{name:"timestamp",type:"i64",index:!1}]},{name:"DeleteChannelEvent",fields:[{name:"channel",type:"publicKey",index:!0},{name:"creator",type:"publicKey",index:!1},{name:"timestamp",type:"i64",index:!1}]},{name:"NewMessageEvent",fields:[{name:"channel",type:"publicKey",index:!0},{name:"message",type:{defined:"Message"},index:!1}]},{name:"JoinChannelEvent",fields:[{name:"channel",type:"publicKey",index:!0},{name:"membership",type:"publicKey",index:!0},{name:"timestamp",type:"i64",index:!1}]},{name:"LeaveChannelEvent",fields:[{name:"channel",type:"publicKey",index:!0},{name:"authority",type:"publicKey",index:!0},{name:"timestamp",type:"i64",index:!1}]},{name:"AddMemberEvent",fields:[{name:"channel",type:"publicKey",index:!0},{name:"membership",type:"publicKey",index:!0},{name:"by",type:"publicKey",index:!1},{name:"timestamp",type:"i64",index:!1}]},{name:"AuthorizeMemberEvent",fields:[{name:"channel",type:"publicKey",index:!0},{name:"membership",type:"publicKey",index:!0},{name:"by",type:"publicKey",index:!1},{name:"timestamp",type:"i64",index:!1}]},{name:"DeleteMemberEvent",fields:[{name:"channel",type:"publicKey",index:!0},{name:"membership",type:"publicKey",index:!0},{name:"by",type:"publicKey",index:!1},{name:"timestamp",type:"i64",index:!1}]}],Ws=[{code:6e3,name:"Unauthorized",msg:"Unauthorized"},{code:6001,name:"InvalidChannel",msg:"Invalid channel"},{code:6002,name:"InvalidMembership",msg:"Invalid membership"},{code:6003,name:"InvalidMessage",msg:"Invalid message"},{code:6004,name:"NameTooLong",msg:"Name too long"},{code:6005,name:"MessageTooLong",msg:"Message too long"}],Vs={address:"6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm",origin:"anchor",binaryVersion:"0.25.0",libVersion:"0.25.0"},Rs={version:Is,name:zs,instructions:Bs,accounts:Ts,types:Ls,events:Ns,errors:Ws,metadata:Vs},Os=new h.FixableBeetArgsStruct([["id",h.u32],["sender",te],["createdAt",h.i64],["flags",h.u8],["content",h.utf8String]],"Message"),mt=[49,159,99,106,220,87,219,88];class ee{constructor(e,n,i,o,a,s,r,d){this.name=e,this.creator=n,this.createdAt=i,this.flags=o,this.memberCount=a,this.messageCount=s,this.maxMessages=r,this.messages=d}static fromArgs(e){return new ee(e.name,e.creator,e.createdAt,e.flags,e.memberCount,e.messageCount,e.maxMessages,e.messages)}static fromAccountInfo(e,n=0){return ee.deserialize(e.data,n)}static async fromAccountAddress(e,n,i){const o=await e.getAccountInfo(n,i);if(o==null)throw new Error(`Unable to find Channel account at ${n}`);return ee.fromAccountInfo(o,0)[0]}static gpaBuilder(e=new L("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){return Pt.fromStruct(e,Ne)}static deserialize(e,n=0){return Ne.deserialize(e,n)}serialize(){return Ne.serialize({accountDiscriminator:mt,...this})}static byteSize(e){const n=ee.fromArgs(e);return Ne.toFixedFromValue({accountDiscriminator:mt,...n}).byteSize}static async getMinimumBalanceForRentExemption(e,n,i){return n.getMinimumBalanceForRentExemption(ee.byteSize(e),i)}pretty(){return{name:this.name,creator:this.creator.toBase58(),createdAt:(()=>{const e=this.createdAt;if(typeof e.toNumber=="function")try{return e.toNumber()}catch{return e}return e})(),flags:this.flags,memberCount:this.memberCount,messageCount:this.messageCount,maxMessages:this.maxMessages,messages:this.messages}}}const Ne=new h.FixableBeetStruct([["accountDiscriminator",h.uniformFixedSizeArray(h.u8,8)],["name",h.utf8String],["creator",te],["createdAt",h.i64],["flags",h.u8],["memberCount",h.u16],["messageCount",h.u32],["maxMessages",h.u16],["messages",h.array(Os)]],ee.fromArgs,"Channel"),Xe=new h.FixableBeetArgsStruct([["header",h.utf8String],["encryptedKey",h.utf8String]],"CEKData"),Fs=h.dataEnum([["Authorized",new h.FixableBeetArgsStruct([["by",h.coption(te)]],'ChannelMembershipStatusRecord["Authorized"]')],["Pending",new h.FixableBeetArgsStruct([["authority",h.coption(te)]],'ChannelMembershipStatusRecord["Pending"]')]]),Re=[238,149,255,251,116,131,86,170];class Z{constructor(e,n,i,o,a,s,r,d,p,v){this.channel=e,this.authority=n,this.key=i,this.cek=o,this.status=a,this.name=s,this.invitedBy=r,this.createdAt=d,this.flags=p,this.bump=v}static fromArgs(e){return new Z(e.channel,e.authority,e.key,e.cek,e.status,e.name,e.invitedBy,e.createdAt,e.flags,e.bump)}static fromAccountInfo(e,n=0){return Z.deserialize(e.data,n)}static async fromAccountAddress(e,n,i){const o=await e.getAccountInfo(n,i);if(o==null)throw new Error(`Unable to find ChannelMembership account at ${n}`);return Z.fromAccountInfo(o,0)[0]}static gpaBuilder(e=new L("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){return Pt.fromStruct(e,We)}static deserialize(e,n=0){return We.deserialize(e,n)}serialize(){return We.serialize({accountDiscriminator:Re,...this})}static byteSize(e){const n=Z.fromArgs(e);return We.toFixedFromValue({accountDiscriminator:Re,...n}).byteSize}static async getMinimumBalanceForRentExemption(e,n,i){return n.getMinimumBalanceForRentExemption(Z.byteSize(e),i)}pretty(){return{channel:this.channel.toBase58(),authority:this.authority.toBase58(),key:this.key.toBase58(),cek:this.cek,status:this.status.__kind,name:this.name,invitedBy:this.invitedBy,createdAt:(()=>{const e=this.createdAt;if(typeof e.toNumber=="function")try{return e.toNumber()}catch{return e}return e})(),flags:this.flags,bump:this.bump}}}const We=new h.FixableBeetStruct([["accountDiscriminator",h.uniformFixedSizeArray(h.u8,8)],["channel",te],["authority",te],["key",te],["cek",Xe],["status",Fs],["name",h.utf8String],["invitedBy",h.coption(te)],["createdAt",h.i64],["flags",h.u8],["bump",h.u8]],Z.fromArgs,"ChannelMembership"),_e=new Map,ye=new Map;class Ze extends Error{constructor(){super("Unauthorized");O(this,"code",6e3);O(this,"name","Unauthorized");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Ze)}}_e.set(6e3,()=>new Ze);ye.set("Unauthorized",()=>new Ze);class Ye extends Error{constructor(){super("Invalid channel");O(this,"code",6001);O(this,"name","InvalidChannel");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Ye)}}_e.set(6001,()=>new Ye);ye.set("InvalidChannel",()=>new Ye);class et extends Error{constructor(){super("Invalid membership");O(this,"code",6002);O(this,"name","InvalidMembership");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,et)}}_e.set(6002,()=>new et);ye.set("InvalidMembership",()=>new et);class tt extends Error{constructor(){super("Invalid message");O(this,"code",6003);O(this,"name","InvalidMessage");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,tt)}}_e.set(6003,()=>new tt);ye.set("InvalidMessage",()=>new tt);class nt extends Error{constructor(){super("Name too long");O(this,"code",6004);O(this,"name","NameTooLong");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,nt)}}_e.set(6004,()=>new nt);ye.set("NameTooLong",()=>new nt);class at extends Error{constructor(){super("Message too long");O(this,"code",6005);O(this,"name","MessageTooLong");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,at)}}_e.set(6005,()=>new at);ye.set("MessageTooLong",()=>new at);function le(t){const e=_e.get(t);return e!=null?e():null}function Ce(t){const e=ye.get(t);return e!=null?e():null}const qs=new h.FixableBeetArgsStruct([["name",h.utf8String],["flags",h.u8],["cek",Xe],["key",h.coption(te)]],"AddMemberData"),js=new h.FixableBeetArgsStruct([["instructionDiscriminator",h.uniformFixedSizeArray(h.u8,8)],["data",qs]],"AddMemberInstructionArgs"),Us=[13,116,123,130,126,198,57,34];function Qs(t,e,n=new L("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){var s;const[i]=js.serialize({instructionDiscriminator:Us,...e}),o=[{pubkey:t.channel,isWritable:!0,isSigner:!1},{pubkey:t.invitee,isWritable:!1,isSigner:!1},{pubkey:t.inviteeMembership,isWritable:!0,isSigner:!1},{pubkey:t.authorityMembership,isWritable:!0,isSigner:!1},{pubkey:t.authority,isWritable:!0,isSigner:!0},{pubkey:(s=t.systemProgram)!=null?s:ce.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const r of t.anchorRemainingAccounts)o.push(r);return new ue({programId:n,keys:o,data:i})}const Js=new h.FixableBeetArgsStruct([["cek",Xe]],"AuthorizeMemberData"),Gs=new h.FixableBeetArgsStruct([["instructionDiscriminator",h.uniformFixedSizeArray(h.u8,8)],["data",Js]],"AuthorizeMemberInstructionArgs"),Hs=[194,123,189,175,86,225,93,128];function Xs(t,e,n=new L("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){var s;const[i]=Gs.serialize({instructionDiscriminator:Hs,...e}),o=[{pubkey:t.channel,isWritable:!1,isSigner:!1},{pubkey:t.membership,isWritable:!0,isSigner:!1},{pubkey:t.authority,isWritable:!1,isSigner:!0},{pubkey:t.authorityMembership,isWritable:!0,isSigner:!1},{pubkey:(s=t.systemProgram)!=null?s:ce.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const r of t.anchorRemainingAccounts)o.push(r);return new ue({programId:n,keys:o,data:i})}const Zs=new h.BeetArgsStruct([["instructionDiscriminator",h.uniformFixedSizeArray(h.u8,8)]],"DeleteChannelInstructionArgs"),Ys=[145,225,187,221,157,142,114,133];function ei(t,e=new L("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){var a;const[n]=Zs.serialize({instructionDiscriminator:Ys}),i=[{pubkey:t.channel,isWritable:!0,isSigner:!1},{pubkey:t.authorityMembership,isWritable:!0,isSigner:!1},{pubkey:t.authority,isWritable:!0,isSigner:!0},{pubkey:(a=t.systemProgram)!=null?a:ce.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const s of t.anchorRemainingAccounts)i.push(s);return new ue({programId:e,keys:i,data:n})}const ti=new h.BeetArgsStruct([["instructionDiscriminator",h.uniformFixedSizeArray(h.u8,8)]],"DeleteMemberInstructionArgs"),ni=[95,14,98,112,252,218,205,173];function ai(t,e=new L("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){var a;const[n]=ti.serialize({instructionDiscriminator:ni}),i=[{pubkey:t.channel,isWritable:!0,isSigner:!1},{pubkey:t.membership,isWritable:!0,isSigner:!1},{pubkey:t.authorityMembership,isWritable:!1,isSigner:!1},{pubkey:t.authority,isWritable:!0,isSigner:!0},{pubkey:(a=t.systemProgram)!=null?a:ce.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const s of t.anchorRemainingAccounts)i.push(s);return new ue({programId:e,keys:i,data:n})}const si=new h.BeetArgsStruct([["flags",h.u8]],"GrantAccessMemberData");new h.BeetArgsStruct([["instructionDiscriminator",h.uniformFixedSizeArray(h.u8,8)],["data",si]],"GrantAccessMemberInstructionArgs");const ii=new h.FixableBeetArgsStruct([["name",h.utf8String],["maxMessages",h.u16],["memberName",h.utf8String],["cek",Xe],["public",h.bool],["permissionless",h.bool]],"InitChannelData"),oi=new h.FixableBeetArgsStruct([["instructionDiscriminator",h.uniformFixedSizeArray(h.u8,8)],["data",ii]],"InitChannelInstructionArgs"),li=[21,200,152,39,19,178,76,47];function ri(t,e,n=new L("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){var s;const[i]=oi.serialize({instructionDiscriminator:li,...e}),o=[{pubkey:t.channel,isWritable:!0,isSigner:!0},{pubkey:t.membership,isWritable:!0,isSigner:!1},{pubkey:t.authority,isWritable:!0,isSigner:!0},{pubkey:t.key,isWritable:!1,isSigner:!0},{pubkey:(s=t.systemProgram)!=null?s:ce.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const r of t.anchorRemainingAccounts)o.push(r);return new ue({programId:n,keys:o,data:i})}const ci=new h.FixableBeetArgsStruct([["name",h.utf8String],["authority",h.coption(te)]],"JoinChannelData"),ui=new h.FixableBeetArgsStruct([["instructionDiscriminator",h.uniformFixedSizeArray(h.u8,8)],["data",ci]],"JoinChannelInstructionArgs"),di=[124,39,115,89,217,26,38,29];function mi(t,e,n=new L("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){var s;const[i]=ui.serialize({instructionDiscriminator:di,...e}),o=[{pubkey:t.channel,isWritable:!0,isSigner:!1},{pubkey:t.membership,isWritable:!0,isSigner:!1},{pubkey:t.authority,isWritable:!0,isSigner:!0},{pubkey:t.key,isWritable:!1,isSigner:!0},{pubkey:(s=t.systemProgram)!=null?s:ce.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const r of t.anchorRemainingAccounts)o.push(r);return new ue({programId:n,keys:o,data:i})}const hi=new h.BeetArgsStruct([["instructionDiscriminator",h.uniformFixedSizeArray(h.u8,8)]],"LeaveChannelInstructionArgs"),pi=[104,0,75,134,95,80,68,186];function fi(t,e=new L("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){var a;const[n]=hi.serialize({instructionDiscriminator:pi}),i=[{pubkey:t.channel,isWritable:!0,isSigner:!1},{pubkey:t.membership,isWritable:!0,isSigner:!1},{pubkey:t.authority,isWritable:!0,isSigner:!0},{pubkey:(a=t.systemProgram)!=null?a:ce.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const s of t.anchorRemainingAccounts)i.push(s);return new ue({programId:e,keys:i,data:n})}const gi=new h.FixableBeetArgsStruct([["instructionDiscriminator",h.uniformFixedSizeArray(h.u8,8)],["message",h.utf8String]],"PostMessageInstructionArgs"),bi=[214,50,100,209,38,34,7,76];function _i(t,e,n=new L("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){var s;const[i]=gi.serialize({instructionDiscriminator:bi,...e}),o=[{pubkey:t.channel,isWritable:!0,isSigner:!1},{pubkey:t.membership,isWritable:!1,isSigner:!1},{pubkey:t.authority,isWritable:!1,isSigner:!0},{pubkey:(s=t.systemProgram)!=null?s:ce.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const r of t.anchorRemainingAccounts)o.push(r);return new ue({programId:n,keys:o,data:i})}const yi="6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm",vi=new L(yi);function ht(t,e=new Uint8Array(4)){const n=Ie(t.toString(),"base10");return e.set(n,4-n.length),e}const rt=t=>Se([ht(t.length),t]);function Wt(t,e,n){if(e!==256)throw new Error(`Unsupported key length: ${e}`);const i=Se([rt(Ie(n)),rt(new Uint8Array(0)),rt(new Uint8Array(0)),ht(e)]),o=1;return Cn.hash(Se([ht(o),t,i]))}const pt=t=>Ie(t,"base64pad"),ft=t=>Kt(t,"base64pad"),wi=t=>Ie(t),Ci=t=>Kt(t),Mi=t=>Ie(t,"base58btc"),me=je.NONCE_LENGTH,$e=je.TAG_LENGTH,Vt=t=>{const e=new je.XChaCha20Poly1305(t);return(n,i)=>{const o=It.randomBytes(me),a=e.seal(o,n,i);return{ciphertext:a.subarray(0,a.length-$e),tag:a.subarray(a.length-$e),iv:o}}},Rt=t=>{const e=new je.XChaCha20Poly1305(t);return(n,i,o,a)=>e.open(o,Se([n,i]),a)},Ot="ECDH-ES+XC20PKW",Ft=256,Ai=t=>e=>{const n=dt.generateKeyPair(),i=dt.sharedKey(n.secretKey,t),o=Wt(i,Ft,Ot),a=Vt(o)(e);return{encryptedKey:a.ciphertext,tag:a.tag,iv:a.iv,epPubKey:n.publicKey}},ki=t=>(e,n,i,o)=>{const a=dt.sharedKey(t,o),s=Wt(a,Ft,Ot);return Rt(s)(e,n,i)},Si=t=>Array.isArray(t)?he.fromSecretKey(kn.Buffer.from(t)):typeof t=="string"?he.fromSecretKey(Mi(t)):he.fromSecretKey(t),xi=async(t=32)=>{const e=It.randomBytes(t);return Promise.resolve(e)},$i=async(t,e)=>{const n=await Ai(Mn(e.toBytes()))(t);return{header:ft(Se([n.iv,n.tag,n.epPubKey])),encryptedKey:ft(n.encryptedKey)}},Ei=async(t,e)=>{const n=pt(t.header),i=n.subarray(0,me),o=n.subarray(me,me+$e),a=n.subarray(me+$e),s=pt(t.encryptedKey),r=Si(e).secretKey,d=An(r),p=await ki(d)(s,o,i,a);if(p===null)throw new Error("There was a problem decrypting the CEK");return p},Di=async(t,e)=>{const n=await Vt(e)(wi(t));return ft(Se([n.iv,n.ciphertext,n.tag]))},Pi=async(t,e)=>{const n=pt(t),i=n.subarray(0,me),o=n.subarray(me,-$e),a=n.subarray(-$e),s=await Rt(e)(o,a,i);if(s===null)throw new Error("There was an error decoding the message!");return Ci(s)};class Ki{constructor(e,n){O(this,"programId",vi);O(this,"_coder");O(this,"_events");O(this,"utils",{channel:{isPublic:e=>(e.flags&1)>0,isPermissionless:e=>(e.flags&2)>0},member:{isOwner:e=>e.flags>=255,isAdmin:e=>(e.flags&7)===7,canAddMember:e=>(e.flags&1)>0,canDeleteMember:e=>(e.flags&2)>0,canAuthorizeMember:e=>(e.flags&4)>0},message:{isEncrypted:e=>(e.flags&1)>0}});this.provider=e,this.keypair=n,this._coder=new Sn(Rs),this._events=new xn(this.programId,e,this._coder)}get connection(){return this.provider.connection}addEventListener(e,n){return this._events.addEventListener(e,n)}async removeEventListener(e){return await this._events.removeEventListener(e)}setKeypair(e){this.keypair=e}async loadAllChannels(){return(await ee.gpaBuilder().addFilter("accountDiscriminator",mt).run(this.provider.connection)).map(n=>({pubkey:n.pubkey,data:ee.fromAccountInfo(n.account)[0]}))}async loadChannel(e,n){return ee.fromAccountAddress(this.provider.connection,e,n)}async loadMyChannels(){return await this.loadMemberships()}async loadChannelMembers(e){return(await Z.gpaBuilder().addFilter("accountDiscriminator",Re).addFilter("channel",e).run(this.provider.connection)).map(i=>({pubkey:i.pubkey,data:Z.fromAccountInfo(i.account)[0]}))}async loadMemberships(e){const n=Z.gpaBuilder().addFilter("accountDiscriminator",Re).addFilter("authority",this.provider.publicKey);return e&&n.addFilter("key",e),(await n.run(this.provider.connection)).map(o=>({pubkey:o.pubkey,data:Z.fromAccountInfo(o.account)}))}async loadMembership(e,n){return Z.fromAccountAddress(this.provider.connection,e,n)}async getMembershipPDA(e,n){return n=n!=null?n:this.keypair.publicKey,await L.findProgramAddress([e.toBuffer(),n.toBuffer()],this.programId)}async encryptCEK(e,n){return $i(e,n!=null?n:this.keypair.publicKey)}async decryptCEK(e,n){return Ei(e,n!=null?n:this.keypair.secretKey)}async encryptMessage(e,n){return Di(e,n)}async decryptMessage(e,n){return Pi(e,n)}async initChannel(e){var p,v,w,k,f;const n=(p=e.channel)!=null?p:he.generate(),i=await xi(),o=await this.encryptCEK(i),[a]=await this.getMembershipPDA(n.publicKey),s=this.provider.publicKey,r=new oe;r.add(ri({key:this.keypair.publicKey,channel:n.publicKey,membership:a,authority:s},{data:{name:e.name,public:(v=e.public)!=null?v:!1,permissionless:(w=e.permissionless)!=null?w:!1,memberName:(k=e.memberName)!=null?k:"",maxMessages:e.maxMessages,cek:o}}));let d;try{d=await this.provider.sendAndConfirm(r,[n,this.keypair],e.opts)}catch(b){throw(f=le(b.code))!=null?f:b}return{signature:d,channel:n,cek:i,cekEncrypted:o}}async deleteChannel({channel:e,opts:n}){var r;const i=this.provider.publicKey,[o]=await this.getMembershipPDA(e),a=new oe;a.add(ei({channel:e,authority:i,authorityMembership:o}));let s;try{s=await this.provider.sendAndConfirm(a,void 0,n)}catch(d){throw(r=le(d.code))!=null?r:Ce("Unauthorized")}return{signature:s}}async joinChannel(e){var s,r;const[n]=await this.getMembershipPDA(e.channel),i=this.provider.publicKey,o=new oe;o.add(mi({channel:e.channel,key:this.keypair.publicKey,membership:n,authority:i},{data:{name:e.name,authority:(s=e.authority)!=null?s:null}}));let a;try{a=await this.provider.sendAndConfirm(o,[this.keypair],e.opts)}catch(d){throw(r=le(d.code))!=null?r:d}return{signature:a}}async leaveChannel(e){var s;const[n]=await this.getMembershipPDA(e.channel),i=this.provider.publicKey,o=new oe;o.add(fi({channel:e.channel,membership:n,authority:i}));let a;try{a=await this.provider.sendAndConfirm(o)}catch(r){throw(s=le(r.code))!=null?s:r}return{signature:a}}async addMember(e){var v,w,k,f;const n=(v=e.key)!=null?v:e.invitee,[i]=await this.getMembershipPDA(e.channel),[o]=await this.getMembershipPDA(e.channel,n),a=await this.loadMembership(i);if(!a.cek.encryptedKey)throw Ce("Unauthorized");const s=await this.decryptCEK(a.cek),r=await this.encryptCEK(s,n),d=new oe;d.add(Qs({channel:e.channel,authority:this.provider.publicKey,invitee:e.invitee,authorityMembership:i,inviteeMembership:o},{data:{name:(w=e.name)!=null?w:"",flags:(k=e.flags)!=null?k:0,cek:r,key:n}}));let p;try{p=await this.provider.sendAndConfirm(d)}catch(b){throw(f=le(b.code))!=null?f:Ce("Unauthorized")}return{signature:p}}async deleteMember(e){var r;const[n]=e.membership?[e.membership]:await this.getMembershipPDA(e.channel,e.key),[i]=await this.getMembershipPDA(e.channel),o=this.provider.publicKey,a=new oe;a.add(ai({channel:e.channel,membership:n,authority:o,authorityMembership:i}));let s;try{s=await this.provider.sendAndConfirm(a)}catch(d){throw(r=le(d.code))!=null?r:d}return{signature:s}}async authorizeMember(e){var p;const[n]=await this.getMembershipPDA(e.channel),[i]=await this.getMembershipPDA(e.channel,e.key),o=await this.loadMembership(n);if(!o.cek.encryptedKey)throw Ce("Unauthorized");const a=await this.decryptCEK(o.cek),s=await this.encryptCEK(a,e.key),r=new oe;r.add(Xs({channel:e.channel,membership:i,authority:this.provider.publicKey,authorityMembership:n},{data:{cek:s}}));let d;try{d=await this.provider.sendAndConfirm(r)}catch(v){throw(p=le(v.code))!=null?p:Ce("Unauthorized")}return{signature:d}}async postMessage(e){var r;const[n]=await this.getMembershipPDA(e.channel);let i,o=0;if(e.encrypt){const d=await this.loadMembership(n);if(!d.cek.header)throw Ce("Unauthorized");const p=await this.decryptCEK(d.cek);i=await this.encryptMessage(e.message,p),o|=1}else i=e.message;const a=new oe;a.add(_i({channel:e.channel,membership:n,authority:this.provider.publicKey},{message:String.fromCharCode(o)+i}));let s;try{s=await this.provider.sendAndConfirm(a)}catch(d){throw(r=le(d.code))!=null?r:d}return{signature:s}}}const kt="***** *** *** *** *******",q=Ke("messenger",()=>{const t=yt(),e=Nt(),n=qe(),i=y(()=>e.keypair),o={allChannels:[],ownChannels:[],channel:void 0,channelAddr:void 0,channelMembershipAddr:void 0,channelMembership:void 0,channelMembers:[],channelMessages:[],channelLoading:!1,loading:!1,creating:!1,sending:!1},a=ie({...o}),s=y(()=>{var _;return new Ki(new Mt(t.connection,(_=n.value)!=null?_:{publicKey:L.default},Mt.defaultOptions()),e.keypair)});let r=[];re(n,_=>{_?v().then():w()},{immediate:!0}),re([i,()=>a.allChannels],()=>{d().then()},{immediate:!0});async function d(){var D;const E=(await s.value.loadMemberships((D=e.keypair)==null?void 0:D.publicKey)).map(J=>({pubkey:J.data[0].channel.toBase58(),status:J.data[0].status.__kind}));a.ownChannels=E,console.log("myChannels ====== ",a.ownChannels)}async function p(){console.log("Register events...");for(const _ of r)await s.value.removeEventListener(_);r.push(s.value.addEventListener("NewMessageEvent",async _=>{if(console.log("[Event] NewMessageEvent",_),`${_.channel}`!=`${a.channelAddr}`)return;let E=_.message.content;if(s.value.utils.message.isEncrypted(_.message)){const J=await U();J?E=await s.value.decryptMessage(_.message.content,J):E=kt}a.channelMessages.push({..._.message,content:E})})),r.push(s.value.addEventListener("AuthorizeMemberEvent",async _=>{console.log("[Event] AuthorizeMemberEvent",_),!(a.channelAddr&&`${_.channel}`!=`${a.channelAddr}`)&&(`${_.membership}`==`${a.channelMembershipAddr}`?S(a.channelAddr).then():X().then())})),r.push(s.value.addEventListener("JoinChannelEvent",async _=>{console.log("[Event] JoinChannelEvent",_),`${_.channel}`==`${a.channelAddr}`&&X().then()})),r.push(s.value.addEventListener("LeaveChannelEvent",async _=>{console.log("[Event] LeaveChannelEvent",_),`${_.channel}`==`${a.channelAddr}`&&X().then()}))}async function v(){w(),r=[],a.loading=!0;const _=await s.value.loadAllChannels();await p(),a.allChannels=_,a.loading=!1,console.log(a)}function w(){Object.assign(a,o)}async function k(_,E){var D,J;try{a.creating=!0,await s.value.initChannel({name:_,maxMessages:(D=E.maxMessages)!=null?D:15,public:E.public,permissionless:E.permissionless,opts:{commitment:(J=E.commitment)!=null?J:"confirmed"}}),await v()}finally{a.creating=!1}}async function f(_){const E=new L(_);await s.value.deleteChannel({channel:E,opts:{commitment:"confirmed"}}),await v()}async function b(_,E){const D=new L(_);await s.value.joinChannel({channel:D,name:E,opts:{commitment:"confirmed"}}),await S(_),await M()}async function S(_){var E;a.channelLoading=!0,a.channelMessages=[],a.channelMembers=[],a.channelMembershipAddr=void 0,a.channelMembership=void 0,a.channelAddr=new L(_);try{if((E=n.value)!=null&&E.publicKey)try{const[D]=await s.value.getMembershipPDA(a.channelAddr);a.channelMembershipAddr=D,a.channelMembership=await s.value.loadMembership(D)}catch(D){console.log(D),a.channelMembershipAddr=void 0,a.channelMembership=void 0}await X(),await K()}catch(D){console.log("Error",D)}finally{a.channelLoading=!1}}async function U(){if(!!a.channelMembership)try{return await s.value.decryptCEK(a.channelMembership.cek)}catch(_){console.log(_)}}async function K(){if(!a.channelAddr){console.log("Invalid channel");return}a.channel=await s.value.loadChannel(a.channelAddr);const E=s.value.utils.channel.isPublic(a.channel)?null:await U();a.channelMessages=await Promise.all(a.channel.messages.map(async D=>{var Te;let ze=s.value.utils.message.isEncrypted(D)?kt:D.content,Be=Ge(D.sender);if((Te=n.value)!=null&&Te.publicKey){const z=a.channelMembers.find(({data:Le})=>Le.name!==""&&(`${Le.authority}`==`${D.sender}`||`${Le.key}`==`${D.sender}`));z&&z.data.name!==""&&(Be=z.data.name)}if(E)try{ze=await s.value.decryptMessage(D.content,E)}catch{console.log(`Failed to decrypt message #${D.id}`)}return{...D,senderDisplayName:Be,content:ze}}))}async function X(){if(!a.channelAddr){console.error("Invalid channel");return}a.channelMembers=await Q()}async function Q(_=a.channelAddr){return await s.value.loadChannelMembers(_)}async function $(_){if(!a.channelAddr){console.log("Please select a channel");return}try{a.sending=!0;let E;a.channel&&(E=s.value.utils.channel.isPublic(a.channel)),await s.value.postMessage({channel:a.channelAddr,message:_,encrypt:!E}),await K()}finally{a.sending=!1}}async function R(_,E,D,J){if(!a.channelAddr){console.log("Invalid channel");return}await s.value.addMember({channel:a.channelAddr,invitee:new L(_),key:E?new L(E):void 0,name:D,flags:J,opts:{commitment:"confirmed"}})}async function A(_){if(!a.channelAddr){console.log("Invalid channel");return}await s.value.deleteMember({channel:a.channelAddr,key:new L(_),opts:{commitment:"finalized"}}),await de()}async function T(_){if(!a.channelAddr){console.log("Invalid channel");return}await s.value.authorizeMember({channel:a.channelAddr,key:new L(_)}),await de()}async function M(){await v()}async function de(){a.channelMembers=await Q()}async function it(_){a.channelAddr=_}return{state:a,client:s.value,loadChannel:S,joinChannel:b,createChannel:k,deleteChannel:f,postMessage:$,addMember:R,deleteMember:A,authorizeMember:T,refreshList:M,loadMembers:Q,selectChannel:it}}),ve=Ke("channel",()=>{const t=qe(),{state:e,client:n}=q(),i=y(()=>e.channelLoading),o=y(()=>e.sending),a=y(()=>{var A;return!!((A=t.value)!=null&&A.publicKey)}),s=y(()=>!!e.channel&&n.utils.channel.isPublic(e.channel)),r=y(()=>!!e.channel&&n.utils.channel.isPermissionless(e.channel)),d=y(()=>{var A;return((A=e.channelMembership)==null?void 0:A.status.__kind)==="Authorized"}),p=y(()=>{var A;return((A=e.channelMembership)==null?void 0:A.status.__kind)==="Pending"}),v=y(()=>{var A,T,M;return String((A=e.channel)==null?void 0:A.creator)===String((M=(T=t.value)==null?void 0:T.publicKey)!=null?M:"-")}),w=y(()=>!!e.channelMembership&&n.utils.member.canAddMember(e.channelMembership)),k=y(()=>!!e.channelMembership&&n.utils.member.canAuthorizeMember(e.channelMembership)),f=y(()=>!!e.channelMembership&&n.utils.member.canDeleteMember(e.channelMembership)),b=y(()=>!!e.channelMembership&&n.utils.member.isAdmin(e.channelMembership)),S=y(()=>!!e.channelMembership&&n.utils.member.isOwner(e.channelMembership)),U=y(()=>a.value&&!!e.channel&&!e.loading&&!d.value),K=y(()=>a.value),X=y(()=>S.value),Q=y(()=>S.value),$=y(()=>!e.sending&&(s.value||d.value));return{ownChannels:y(()=>e.allChannels.filter(A=>{var T;return!!e.ownChannels.find(M=>M.pubkey===A.pubkey.toBase58())||A.data.flags===1||A.data.creator.toBase58()===String((T=t.value)==null?void 0:T.publicKey)})),isChannelLoading:i,isSendMessage:o,isPublicChannel:s,isWalletConnected:a,isPermissionlessChannel:r,isAuthorizedMember:d,isPendingMember:p,isChannelCreator:v,isAdmin:b,isOwner:S,canJoinChannel:U,canAddMember:w,canAuthorizeMember:k,canDeleteMember:f,canCreateChannel:K,canDeleteChannel:X,canGrantAccess:Q,canPostMessage:$}}),Ii={class:"text-weight-medium"},zi={class:"memberlist-info__details"},Bi=u("span",null,"Authority:",-1),Ti={class:"memberlist-info__details"},Li=u("span",null,"Key:",-1),Ni={class:"memberlist-btns"},Wi=N({__name:"MemberListDialog",props:{membersDialog:{type:Boolean,default:!1},authorizeMemberState:{type:Object},deleteMemberState:{type:Object},wallet:{type:Object}},emits:["submit","deleteMember"],setup(t,{emit:e}){const{state:n}=q(),i=ve(),o=s=>s==="Pending"&&i.canAuthorizeMember;function a(s){return String(s).toLowerCase()}return(s,r)=>(g(),C(se,{class:"memberlist"},{default:c(()=>[l(Y,{square:"",flat:"",horizontal:""},{default:c(()=>[l(W,{class:"q-px-lg"},{default:c(()=>[x(" MEMBERS ")]),_:1}),l(W,{class:"memberlist-card"},{default:c(()=>[l(pe,{separator:""},{default:c(()=>[(g(!0),P(j,null,ae(m(n).channelMembers,d=>(g(),C(G,{key:d.pubkey.toString(),"active-class":"bg-teal-1",active:`${d.pubkey}`==`${m(n).channelMembershipAddr}`,class:"memberlist-item"},{default:c(()=>[l(H,{class:"memberlist-info"},{default:c(()=>[l(Pe,{class:"row justify-between"},{default:c(()=>[u("span",Ii,B(m(zt)(d.data)),1),l($n,{class:Ue([a(d.data.status.__kind),"memberlist-status q-pa-xs"])},{default:c(()=>[x(B(d.data.status.__kind),1)]),_:2},1032,["class"])]),_:2},1024),l(Pe,{caption:"",lines:"2"},{default:c(()=>[u("div",zi,[Bi,u("span",null,B(d.data.authority),1)]),u("div",Ti,[Li,u("span",null,B(d.data.key),1)])]),_:2},1024)]),_:2},1024),u("div",Ni,[o(d.data.status.__kind)?(g(),C(I,{key:0,color:"positive",size:"sm",unelevated:"",class:"full-width",loading:t.authorizeMemberState.loading,disabled:t.authorizeMemberState.loading,onClick:p=>s.$emit("submit",d.data.key)},{default:c(()=>[x(" Authorize ")]),_:2},1032,["loading","disabled","onClick"])):ke("",!0),m(i).canDeleteMember?(g(),C(I,{key:1,color:"negative",size:"sm",unelevated:"",class:"full-width",loading:t.deleteMemberState.loading,disabled:t.deleteMemberState.loading,onClick:p=>s.$emit("deleteMember",d.data.key)},{default:c(()=>[x(" Delete ")]),_:2},1032,["loading","disabled","onClick"])):ke("",!0)])]),_:2},1032,["active"]))),128))]),_:1})]),_:1})]),_:1})]),_:1}))}}),Vi=t=>(ge("data-v-734c01bd"),t=t(),be(),t),Ri=Vi(()=>u("br",null,null,-1)),Oi=N({__name:"JoinChennalModal",emits:["join"],setup(t,{emit:e}){const n=V("");return(i,o)=>(g(),C(se,null,{default:c(()=>[l(Y,{square:"",flat:""},{default:c(()=>[l(W,{class:"text-body1"},{default:c(()=>[x(" Join Channel ")]),_:1}),l(W,{class:"text-body1 text-blue-grey-8"},{default:c(()=>[l(Qe,{class:"join-channel-form",onSubmit:o[1]||(o[1]=bt(a=>i.$emit("join",n.value),["prevent"]))},{default:c(()=>[l(ne,{modelValue:n.value,"onUpdate:modelValue":o[0]||(o[0]=a=>n.value=a),label:"Member name *","lazy-rules":"",rules:[a=>a&&a.length>2||"Please type something"]},null,8,["modelValue","rules"]),Ri,l(I,{type:"submit",class:"dialog-submit-btn","text-color":"white",ripple:!1,rounded:""},{default:c(()=>[x(" Join Channel ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}});const Fi=F(Oi,[["__scopeId","data-v-734c01bd"]]),qi=N({props:{text:{type:String,default:""}}});const ji=["innerHTML"];function Ui(t,e,n,i,o,a){return g(),C(Dt,{class:"bg-white text-primary shadow-1 custom-tooltip",style:{"border-radius":"0"},anchor:"top middle",self:"bottom middle"},{default:c(()=>[u("div",{innerHTML:t.text},null,8,ji)]),_:1})}const st=F(qi,[["render",Ui]]),Qi="/sol-messenger/assets/join.627c8616.svg",qt=t=>(ge("data-v-dd7a35d7"),t=t(),be(),t),Ji=qt(()=>u("span",{class:"text-blue-grey-8 q-pb-sm"},"Search by name or address",-1)),Gi={class:"search-block"},Hi={class:"channel-info"},Xi={class:"channel-info"},Zi=qt(()=>u("img",{src:Qi,alt:"join"},null,-1)),Yi=N({__name:"JoinChannelDialog",props:{loading:{type:Boolean},defaultState:Object},emits:["submit","reset"],setup(t,{emit:e}){const n=t;V(n.defaultState);const{state:i,selectChannel:o}=q(),a=V(!1),s=V(""),r=V([]),d=y(()=>i.allChannels.filter(f=>f.data.flags===0||f.data.flags===2)),p=f=>f.name.slice(0,2),v=()=>{if(s.value===""){r.value=[],s.value="";return}r.value=d.value.filter(f=>f.data.name.toLocaleLowerCase().includes(s.value.toLocaleLowerCase())||f.pubkey.toBase58().toLocaleLowerCase().includes(s.value.toLocaleLowerCase()))},w=y(()=>{var f;return((f=s.value)==null?void 0:f.length)>0?r.value:d.value}),k=f=>{e("submit",f)};return re(s,()=>{v()}),re(()=>n.loading,f=>{f&&(a.value=!1)}),(f,b)=>{const S=st,U=Fi;return g(),C(se,{class:"join-channel-dialog",onHide:b[3]||(b[3]=K=>f.$emit("reset"))},{default:c(()=>[l(Y,{square:"",flat:""},{default:c(()=>[l(W,{class:"text-body1 text-blue-grey-8"},{default:c(()=>[x(" Join channel ")]),_:1}),l(W,null,{default:c(()=>[Ji,u("div",Gi,[l(ne,{modelValue:s.value,"onUpdate:modelValue":b[0]||(b[0]=K=>s.value=K),class:"input no-margin q-pa-none",placeholder:"Search ...",borderless:"",dense:"",debounce:"300"},null,8,["modelValue"])])]),_:1}),l(W,null,{default:c(()=>[m(w).length?(g(),C(pe,{key:0,bordered:"",separator:"",class:"privat-channels"},{default:c(()=>[(g(!0),P(j,null,ae(m(w),K=>Me((g(),C(G,{key:K,"active-class":"bg-blue-grey-8 text-white",class:"privat-channels-item",active:`${m(i).channelAddr}`==`${K.pubkey}`,clickable:"",onClick:X=>m(o)(K.pubkey)},{default:c(()=>[u("div",{class:"chat-avatar",style:_t(m(Bt)(`${K.pubkey}`))},[u("span",null,B(p(K.data)),1)],4),l(H,null,{default:c(()=>[u("span",Hi,B(K.data.name),1),u("span",Xi,B(K.pubkey),1)]),_:2},1024)]),_:2},1032,["active","onClick"])),[[En]])),128))]),_:1})):(g(),C(G,{key:1,class:"privat-channels justify-center items-center text-blue-grey-5"},{default:c(()=>[x(" Channels not found ")]),_:1}))]),_:1}),l(G,null,{default:c(()=>[l(I,{class:"control-button",square:"",flat:"",disable:!m(i).channelAddr,onClick:b[1]||(b[1]=K=>a.value=!0)},{default:c(()=>[Zi,l(S,{text:"Join the channel"})]),_:1},8,["disable"]),l(U,{modelValue:a.value,"onUpdate:modelValue":b[2]||(b[2]=K=>a.value=K),onJoin:k},null,8,["modelValue"])]),_:1}),l(Je,{showing:t.loading},null,8,["showing"])]),_:1})]),_:1})}}});const eo=F(Yi,[["__scopeId","data-v-dd7a35d7"]]),to=t=>(ge("data-v-bd4b9454"),t=t(),be(),t),no=to(()=>u("br",null,null,-1)),ao=N({__name:"AddMemberDialog",props:{loading:{type:Boolean,default:!1},defaultState:Object},emits:["submit","reset"],setup(t,{emit:e}){const i=V(t.defaultState),o=()=>e("submit",i.value);return(a,s)=>(g(),C(se,{class:"add-member-dialog",onHide:s[3]||(s[3]=r=>a.$emit("reset"))},{default:c(()=>[l(Y,{square:"",flat:""},{default:c(()=>[l(W,null,{default:c(()=>[l(Qe,{class:"add-member-form",onSubmit:bt(o,["prevent"])},{default:c(()=>[l(ne,{modelValue:i.value.name,"onUpdate:modelValue":s[0]||(s[0]=r=>i.value.name=r),label:"Member name *",hint:"Min length 3 chars","lazy-rules":"",rules:[r=>r&&r.length>2||"Please type something"]},null,8,["modelValue","rules"]),l(ne,{modelValue:i.value.wallet,"onUpdate:modelValue":s[1]||(s[1]=r=>i.value.wallet=r),label:"Member Wallet *","lazy-rules":"",rules:[r=>r&&r.length>32||"Invalid public key"]},null,8,["modelValue","rules"]),l(ne,{modelValue:i.value.key,"onUpdate:modelValue":s[2]||(s[2]=r=>i.value.key=r),label:"Member Device Key",hint:"Default: The same as member wallet","lazy-rules":"",rules:[r=>!r||r.length>32||"Invalid public key"]},null,8,["modelValue","rules"]),no,l(I,{type:"submit",class:"dialog-submit-btn","text-color":"white",ripple:!1,rounded:""},{default:c(()=>[x(" Add Member ")]),_:1})]),_:1},8,["onSubmit"]),l(Je,{showing:t.loading},null,8,["showing"])]),_:1})]),_:1})]),_:1}))}});const so=F(ao,[["__scopeId","data-v-bd4b9454"]]),jt="/sol-messenger/assets/info.bfade5eb.svg",io={class:"row q-mt-md relative-position",style:{height:"42px"}},oo={class:"toggle-info"},lo=u("img",{src:jt,alt:"info"},null,-1),ro={key:0,class:"row text-primary toggle-approve"},co={class:"toggle-info"},uo=u("img",{src:jt,alt:"info"},null,-1),mo=N({__name:"NewChannelDialog",props:{loading:{type:Boolean,default:!1},defaultState:Object},emits:["submit","reset"],setup(t,{emit:e}){const i=V(t.defaultState),o=()=>e("submit",i);return(a,s)=>{const r=st;return g(),C(se,{class:"new-channel-dialog",onHide:s[4]||(s[4]=d=>a.$emit("reset"))},{default:c(()=>[l(Y,{square:"",flat:""},{default:c(()=>[l(W,null,{default:c(()=>[l(Qe,{class:"messenger-new-channel-form",onSubmit:o},{default:c(()=>[l(ne,{modelValue:i.value.name,"onUpdate:modelValue":s[0]||(s[0]=d=>i.value.name=d),label:"Channel name *","lazy-rules":"",maxlength:"32",rules:[d=>d&&d.length>2||"Please type something"]},null,8,["modelValue","rules"]),l(ne,{modelValue:i.value.maxMessages,"onUpdate:modelValue":s[1]||(s[1]=d=>i.value.maxMessages=d),label:"Max messages","lazy-rules":"",rules:[d=>+d>0||"Invalid value"]},null,8,["modelValue","rules"]),u("div",io,[u("div",oo,[l(r,{text:m(At)[0]},null,8,["text"]),lo]),u("div",{class:Ue(["col text-primary",{"toggle-border":!i.value.public}])},[x(" Private"),l(ut,{modelValue:i.value.public,"onUpdate:modelValue":s[2]||(s[2]=d=>i.value.public=d),label:"Public"},null,8,["modelValue"])],2),i.value.public?ke("",!0):(g(),P("div",ro,[l(ut,{modelValue:i.value.permissionless,"onUpdate:modelValue":s[3]||(s[3]=d=>i.value.permissionless=d)},null,8,["modelValue"]),u("span",null,[u("div",co,[l(r,{text:m(At)[1]},null,8,["text"]),uo]),x(" Members can approve")])]))]),l(I,{type:"submit",class:"dialog-submit-btn q-mt-md","text-color":"black",ripple:!1,square:"",flat:""},{default:c(()=>[x(" Create the Channel ")]),_:1})]),_:1}),l(Je,{showing:t.loading},null,8,["showing"])]),_:1})]),_:1})]),_:1})}}});const ho=N({__name:"ChannelForm",props:{message:{type:String,default:""},disabled:{type:Boolean,default:!1},sending:{type:Boolean,default:!1}},emits:["submit"],setup(t,{emit:e}){const i=V(t.message),o=()=>{e("submit",i),i.value=""};return(a,s)=>(g(),C(Qe,{class:"channel-form",onSubmit:bt(o,["prevent"])},{default:c(()=>[l($t,{class:"row message-control"},{default:c(()=>[l(ne,{ref:"inputFocus",modelValue:i.value,"onUpdate:modelValue":s[0]||(s[0]=r=>i.value=r),class:"col-grow message-input","bg-color":"white",placeholder:"Type a message",dense:"",borderless:"",autofocus:"",disable:t.disabled},null,8,["modelValue","disable"]),l(I,{class:"send-btn",square:"",flat:"",type:"submit",disable:t.disabled,loading:t.sending},{default:c(()=>[x(" Send ")]),_:1},8,["disable","loading"])]),_:1})]),_:1},8,["onSubmit"]))}});const po=F(ho,[["__scopeId","data-v-23f62c62"]]),fo={},go={class:"column q-ma-md"},bo={class:"column items-end q-ma-md"};function _o(t,e){return g(),P(j,null,[u("div",go,[l(Ee,{class:"q-my-xs",width:"250px",height:"47px"}),l(Ee,{class:"q-my-xs",width:"250px",height:"47px"})]),u("div",bo,[l(Ee,{class:"q-my-xs",width:"250px",height:"47px"}),l(Ee,{class:"q-my-xs",width:"250px",height:"47px"}),l(Ee,{class:"q-my-xs",width:"250px",height:"47px"})])],64)}const yo=F(fo,[["render",_o]]),vo={key:1,class:"row justify-center channel-wrapper"},wo={key:1,class:"messenger-empty"},Co={key:2,class:"messenger-empty"},Mo=N({__name:"ChannelWrapper",props:{postMessageState:{type:Object}},emits:["sendMessage"],setup(t,{emit:e}){const n=fe(),{state:i}=q(),o=ve();function a(w){const k=n.publicKey.value;return k?String(k)!==String(w):!0}const s=y(()=>{const w=[];let k=0,f;for(const b of i.channelMessages)f&&`${b.sender}`==`${f}`?w[k-1].text.push(b.content):(f=b.sender,w.push({id:b.id,sender:b.sender,senderDisplayName:b.senderDisplayName,text:[b.content],date:b.createdAt}),k++);return w}),r=y(()=>o.canPostMessage),d=w=>e("sendMessage",w),p=V(),v=V();return re(v,w=>{w&&(p.value.scrollTop=w.scrollHeight)}),(w,k)=>{const f=yo,b=po;return g(),C(Y,{class:"messenger-card",square:"",flat:""},{default:c(()=>[u("div",{ref_key:"chat",ref:p,class:"messenger-content"},[m(o).isChannelLoading?(g(),C(f,{key:0})):m(i).channel?(g(),P("div",vo,[m(s).length>0?(g(),P("div",{key:0,ref_key:"mes",ref:v,class:"messenger-messages"},[(g(!0),P(j,null,ae(m(s),S=>(g(),C(Dn,{key:S.id,name:S.senderDisplayName,text:S.text,sent:a(S.sender)},null,8,["name","text","sent"]))),128))],512)):(g(),P("div",wo," No messages "))])):(g(),P("div",Co," Please connect a wallet "))],512),l(b,{message:t.postMessageState.message,sending:m(o).isSendMessage,disabled:!m(r),onSubmit:d},null,8,["message","sending","disabled"])]),_:1})}}});const Ao=F(Mo,[["__scopeId","data-v-7bffac36"]]),ko=15;function So(){const{createChannel:t}=q(),{isWalletConnected:e,ok:n,error:i}=we(),o=ie({dialog:!1,name:"",maxMessages:ko,public:!1,permissionless:!1,loading:!1});async function a(){if(e())try{await t(o.name,{maxMessages:o.maxMessages,public:o.public,permissionless:o.permissionless}),s(),n("Channel was created!")}catch(r){i("Something went wrong"),console.log(r)}}function s(){o.dialog=!1,o.public=!1,o.loading=!1,o.name="",o.maxMessages=15}return{state:o,submit:a,reset:s}}function xo(){const t=q(),{info:e,ok:n,error:i}=we(),o=ie({loading:!1});async function a(){if(!t.state.channelAddr){e("Please select a channel");return}try{o.loading=!0,await t.deleteChannel(t.state.channelAddr),n("Channel was deleted!")}catch(s){console.log("Error",s),i("Something went wrong")}finally{o.loading=!1}}return{state:o,submit:a}}function Ut(){const{authorizeMember:t}=q(),{ok:e,error:n}=we(),i=ie({loading:!1,dialog:!1});async function o(a){try{i.loading=!0,await t(a),e("Member was authorized")}catch(s){n("Something went wrong"),console.log(s)}finally{i.loading=!1}}return{state:i,submit:o}}function $o(){const{state:t,addMember:e}=q(),{ok:n,info:i,error:o}=we(),a=ie({dialog:!1,loading:!1});async function s(d){if(console.log(d),a.loading=!0,!t.channelAddr){i("Please select a channel");return}try{return await e(d.wallet,d.key,d.name),n("Member was added"),!0}catch(p){o("Something went wrong"),console.log(p)}finally{a.loading=!1,a.dialog=!1}return!1}function r(){a.loading=!1,a.dialog=!1}return{state:a,submit:s,reset:r}}function Qt(){const{deleteMember:t}=q(),{ok:e,error:n}=we(),i=ie({loading:!1});async function o(a){try{i.loading=!0,await t(a),e("Member was deleted")}catch(s){n("Something went wrong"),console.log(s)}finally{i.loading=!1}}return{state:i,submit:o}}function Eo(){const{state:t,joinChannel:e}=q(),{ok:n,info:i,error:o}=we(),a=ie({dialog:!1,loading:!1,name:""});async function s(){if(!t.channelAddr){i("Please select a channel");return}a.loading=!0;try{await e(t.channelAddr,a.name),r(),n("Request was sent")}catch(d){console.log("Error",d),o("Something went wrong")}finally{a.loading=!1}}function r(){a.loading=!1,a.dialog=!1,a.name=""}return{state:a,submit:s,reset:r}}function we(){const t=fe(),{notify:e}=Oe(),n=s=>e({type:"positive",message:s,timeout:2e3}),i=s=>e({type:"info",message:s,timeout:2e3}),o=s=>e({type:"negative",message:s,timeout:2e3});function a(){return t.publicKey.value?!0:(i("Please connect wallet"),!1)}return{ok:n,info:i,error:o,isWalletConnected:a}}const Do="/sol-messenger/assets/refresh.e0cf4262.svg",Po="/sol-messenger/assets/add.1481b8ed.svg",Ko="/sol-messenger/assets/search.6c5d7d6e.svg",vt=t=>(ge("data-v-38fb5666"),t=t(),be(),t),Io=vt(()=>u("img",{src:Do,alt:"refresh"},null,-1)),zo=vt(()=>u("img",{src:Po,alt:"create"},null,-1)),Bo=vt(()=>u("img",{src:Ko,alt:"join"},null,-1)),To=N({__name:"ChannelControl",props:{isLoading:{type:Boolean}},emits:["createChannel","joinChannel","refreshList"],setup(t,{emit:e}){const n=ve(),{isWalletConnected:i}=we();y(()=>n.isPendingMember),y(()=>n.canCreateChannel);const o=a=>{if(!n.isWalletConnected){i();return}e(a)};return(a,s)=>{const r=st;return g(),C(G,null,{default:c(()=>[l(H,{class:"button-wrapper"},{default:c(()=>[l(I,{class:Ue(["control-button",{"refresh-btn":t.isLoading}]),square:"",flat:"",onClick:s[0]||(s[0]=d=>o("refreshList"))},{default:c(()=>[Io,l(r,{text:"Refresh list"})]),_:1},8,["class"]),l(I,{class:"control-button",square:"",flat:"",onClick:s[1]||(s[1]=d=>o("createChannel"))},{default:c(()=>[zo,l(r,{text:"Create a channel"})]),_:1}),l(I,{class:"control-button",square:"",flat:"",onClick:s[2]||(s[2]=d=>o("joinChannel"))},{default:c(()=>[Bo,l(r,{text:"Browse channels"})]),_:1})]),_:1})]),_:1})}}});const Lo=F(To,[["__scopeId","data-v-38fb5666"]]),No={class:"chat-name"},Wo={key:0,class:"message-public"},Vo=N({__name:"MessengerChannel",props:{pubkey:{type:Object,required:!0},channel:{type:Object,required:!0},isActive:Boolean},emits:["select"],setup(t){const e=t,n=y(()=>e.channel.name.slice(0,2)),i=y(()=>e.channel.flags===1);return(o,a)=>{const s=st;return g(),C(G,{"active-class":"bg-blue-grey-8 text-white",active:t.isActive},{default:c(()=>[l(H,{class:"chat-item cursor-pointer",onClick:a[0]||(a[0]=r=>o.$emit("select"))},{default:c(()=>[u("div",{class:"chat-badge",style:_t(m(Bt)(`${t.pubkey}`))},[u("span",null,B(m(n)),1)],4),u("div",No,B(t.channel.name),1),m(i)?(g(),P("div",Wo,[l(s,{text:"Public channel"}),x(" P ")])):ke("",!0)]),_:1})]),_:1},8,["active"])}}});const Ro=F(Vo,[["__scopeId","data-v-13e9ec19"]]),Oo=u("div",{class:"text-h5"}," Channels ",-1),Fo={class:"text-weight-medium"},qo={class:"memberlist-info__details"},jo=u("span",null,"Authority:",-1),Uo={class:"memberlist-info__details"},Qo=u("span",null,"Key:",-1),Jo=N({__name:"PendingUsersDialog",props:{pendingChannels:Object},setup(t){V(!1);const{state:e,refreshList:n}=q(),i=Ut(),o=Qt(),a=async(p,v)=>{e.channelAddr=v,await i.submit(p),await n()},s=async(p,v)=>{e.channelAddr=v,await o.submit(p),await n()},r=y(()=>i.state.loading),d=y(()=>o.state.loading);return(p,v)=>(g(),C(se,null,{default:c(()=>[l(Y,{class:"pending-channels",square:"",flat:"",horizontal:""},{default:c(()=>[l(W,null,{default:c(()=>[Oo]),_:1}),l(W,null,{default:c(()=>[l(pe,{bordered:""},{default:c(()=>[(g(!0),P(j,null,ae(t.pendingChannels,(w,k)=>(g(),C(Pn,{key:w.name,"expand-separator":"",label:w.channel.data.name,caption:"channel","default-opened":k===0,"header-class":"bg-blue-grey-1"},{default:c(()=>[l(pe,{separator:""},{default:c(()=>[(g(!0),P(j,null,ae(w.pendingMembers,f=>(g(),C(G,{key:f,class:"row justify-between pending-item"},{default:c(()=>[l(H,{class:"memberlist-info"},{default:c(()=>[l(Pe,{class:"row justify-between"},{default:c(()=>[u("span",Fo,B(m(zt)(f.data)),1)]),_:2},1024),l(Pe,{caption:"",lines:"2"},{default:c(()=>[u("div",qo,[jo,u("span",null,B(f.data.authority),1)]),u("div",Uo,[Qo,u("span",null,B(f.data.key),1)])]),_:2},1024)]),_:2},1024),l(H,{side:"",class:"memberlist-btns"},{default:c(()=>[l(I,{color:"teal",size:"xs",unelevated:"",class:"full-width",loading:m(r),disabled:m(r),onClick:b=>a(f.data.key,w.channel.pubkey)},{default:c(()=>[x(" Authorize ")]),_:2},1032,["loading","disabled","onClick"]),l(I,{color:"negative",size:"xs",unelevated:"",class:"full-width",loading:m(d),disabled:m(d),onClick:b=>s(f.data.key,w.channel.pubkey)},{default:c(()=>[x(" Delete ")]),_:2},1032,["loading","disabled","onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1032,["label","default-opened"]))),128))]),_:1})]),_:1})]),_:1})]),_:1}))}});const Go={class:"bell",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",fill:"none","xmlns:v":"https://vecta.io/nano"},Ho=["fill"],Xo=N({__name:"iconBell",props:{color:{type:String,default:"AABEC8"}},setup(t){return(e,n)=>(g(),P("svg",Go,[u("path",{d:"M5.352 14.359h3.294c0 .821-.59 1.641-1.647 1.641s-1.647-.82-1.647-1.641zm8.434-3.467l-.911-1.515a3.68 3.68 0 0 1-.527-1.897V5.325C12.348 2.389 9.949 0 7 0S1.651 2.389 1.651 5.325v2.155a3.68 3.68 0 0 1-.527 1.897l-.911 1.515c-.278.461-.285 1.018-.018 1.487s.749.749 1.29.749h11.03a1.47 1.47 0 0 0 1.291-.749 1.46 1.46 0 0 0-.021-1.487z",fill:`#${t.color}`},null,8,Ho)]))}}),Jt=Ke("notifications",()=>{const t=qe(),{loadMembers:e}=q(),n=ve(),i=ie({showInfo:!1,showDialog:!1,pendingChannels:[]});re(()=>n.ownChannels,async(a,s)=>{s.length>0&&await o(s)});async function o(a){try{const s=await Promise.all(a.map(async r=>{var v;const{pubkey:d,data:p}=r;if(p.creator.toBase58()===((v=t.value)==null?void 0:v.publicKey.toBase58())){const w=await e(d);if(w.length===0)return;const k=w.filter(f=>f.data.status.__kind==="Pending");return k.length?{channel:r,pendingMembers:k}:void 0}}));i.pendingChannels=s.filter(r=>r),i.pendingChannels.length>0?(setTimeout(()=>i.showInfo=!0,2e3),setTimeout(()=>i.showInfo=!1,7e3)):i.showDialog=!1}catch(s){console.log(s)}}return{state:i}});function Zo(){const{state:t}=Jt();return{showDialog:y(()=>t.showDialog),showInfo:y(()=>t.showInfo),pendingChannels:y(()=>t.pendingChannels)}}const Yo={class:"panel-notifications__info"},el=N({__name:"MessengerNotification",setup(t){const{pendingChannels:e,showInfo:n,showDialog:i}=Zo(),{state:o}=Jt(),a=y(()=>{var p,v;return(v=(p=e.value)==null?void 0:p.length)!=null?v:0}),s=y(()=>a.value>0),r=y(()=>n.value?"width: 100%; padding-right: 14px":"width: 0; padding-right: 0;"),d=()=>{!s.value||(o.showDialog=!o.showDialog)};return(p,v)=>{const w=Xo,k=Jo;return g(),P("div",{class:Ue(["panel-notifications",{"has-notifications":m(s)}]),onClick:d},[u("div",Yo,[l(w,{class:"ring",color:m(s)?"FF5C5C":"AABEC8"},null,8,["color"]),u("span",null,B(a.value),1)]),u("div",{ref:"notificationsInfo",class:"panel-notifications__details",style:_t(m(r))}," channels are awaiting user confirmation ",4),l(k,{modelValue:m(o).showDialog,"onUpdate:modelValue":v[0]||(v[0]=f=>m(o).showDialog=f),"pending-channels":m(e),onCloseDialog:v[1]||(v[1]=f=>p.isShow.value=!1)},null,8,["modelValue","pending-channels"])],2)}}});const tl={class:"panel-toolbar"},nl={class:"panel-search"},al={class:"search-wrapper"},sl={class:"panel-info"},il={class:"chat-info"},ol={class:"chat-members"},ll={class:"chat-messages"},rl={class:"chat-name"},cl=N({__name:"MessengerToolbar",emits:["search","showMembers","deleteChannel","addMember","showDeviceKey"],setup(t,{emit:e}){const n=fe(),{state:i}=q(),o=ve(),a=y(()=>!!n.publicKey.value),s=V(""),r=y(()=>i.channel),d=y(()=>{var f,b,S;return((f=r.value)==null?void 0:f.memberCount)===null||((b=r.value)==null?void 0:b.memberCount)===void 0?"":`${(S=r.value)==null?void 0:S.memberCount}\xA0members`}),p=y(()=>{var f,b,S;return((f=r.value)==null?void 0:f.messageCount)===null||((b=r.value)==null?void 0:b.messageCount)===void 0?"":`${(S=r.value)==null?void 0:S.messageCount}\xA0messages`}),v=f=>e("search",f),w=()=>e("showMembers"),k=()=>e("addMember");return re(s,f=>{v(String(f))}),(f,b)=>{var U;const S=el;return g(),P("div",tl,[l(S),u("div",nl,[u("div",al,[l(ne,{modelValue:s.value,"onUpdate:modelValue":b[0]||(b[0]=K=>s.value=K),class:"search-input no-margin q-pa-none",placeholder:"Search ...",clearable:"",debounce:"300",borderless:"",onClear:b[1]||(b[1]=K=>s.value="")},null,8,["modelValue"])])]),u("div",sl,[u("div",il,[u("div",ol,B(m(d)),1),u("div",ll,B(m(p)),1)]),l(gt,{class:""}),u("div",rl,B((U=m(r))==null?void 0:U.name),1),u("div",null,[l(I,{class:"chat-menu",flat:"",square:"",disable:!m(a)},{default:c(()=>[l(Kn,{name:m(In)},null,8,["name"]),l(zn,{anchor:"bottom middle",self:"top middle"},{default:c(()=>[l(pe,{style:{"min-width":"150px"},bordered:""},{default:c(()=>[Me((g(),C(G,{clickable:"",onClick:b[2]||(b[2]=K=>f.$emit("showDeviceKey"))},{default:c(()=>[l(H,null,{default:c(()=>[l(I,{flat:"",square:"",class:"bg-blue-grey-7 text-white"},{default:c(()=>[x(" Device key ")]),_:1})]),_:1})]),_:1})),[[De]]),Me((g(),C(G,{clickable:"",disable:!m(r),onClick:w},{default:c(()=>[l(H,null,{default:c(()=>[l(I,{flat:"",square:"",class:"bg-cyan-9 text-white"},{default:c(()=>[x(" Members ")]),_:1})]),_:1})]),_:1},8,["disable"])),[[De]]),Me((g(),C(G,{clickable:"",disable:!m(o).canAddMember,onClick:k},{default:c(()=>[l(H,null,{default:c(()=>[l(I,{flat:"",square:"",class:"bg-amber-7 text-white"},{default:c(()=>[x(" Add member ")]),_:1})]),_:1})]),_:1},8,["disable"])),[[De]]),Me((g(),C(G,{clickable:"",disable:!m(o).isChannelCreator,onClick:b[3]||(b[3]=K=>f.$emit("deleteChannel"))},{default:c(()=>[l(H,null,{default:c(()=>[l(I,{flat:"",square:"",class:"bg-negative text-white"},{default:c(()=>[x(" Delete ")]),_:1})]),_:1})]),_:1},8,["disable"])),[[De]])]),_:1})]),_:1})]),_:1},8,["disable"])])])])}}});const ul={class:"col col-4"},dl={class:"col"},ml={class:"no-margin"},hl=N({__name:"DebugBtn",setup(t){const{state:e}=q(),{isAuthorizedMember:n,isPendingMember:i,isChannelCreator:o}=ve(),a=V(!1),s=Bn(a);return(r,d)=>(g(),P(j,null,[l(I,{flat:"",class:"text-blue-2",onClick:d[0]||(d[0]=p=>m(s)())},{default:c(()=>[x(" Debug info ")]),_:1}),l(se,{modelValue:a.value,"onUpdate:modelValue":d[1]||(d[1]=p=>a.value=p)},{default:c(()=>[l(Y,null,{default:c(()=>[l(W,null,{default:c(()=>[(g(!0),P(j,null,ae([["Authorized",m(n)],["Pending Access",m(i)],["Channel Creator",m(o)],["Channel",m(e).channel],["Membership",m(e).channelMembership],["Members",m(e).channelMembers]],p=>(g(),P("div",{key:p[0],class:"row q-mt-md"},[u("div",ul,B(p[0]),1),u("div",dl,[u("pre",ml,B(p[1]),1)])]))),128))]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}}),pl={class:"messenger-wrapper"},fl={class:"messenger-main"},gl={key:1,class:"messenger-channels-empty"},bl={key:0,class:"q-my-md q-px-lg"},_l=N({__name:"Messenger",setup(t){const e=fe(),{state:n,postMessage:i,loadChannel:o,refreshList:a}=q(),s=ve(),r=So(),d=Eo(),p=$o(),v=Ut(),w=Qt(),k=xo(),f=ie({message:""});y(()=>n.allChannels);const b=V([]),S=V("");async function U(T){await i(T.value),f.message=""}const K=T=>{if(T===""){b.value=[],S.value="";return}b.value=s.ownChannels.filter(M=>M.data.name.toLocaleLowerCase().includes(T.toLocaleLowerCase())||M.pubkey.toBase58().toLocaleLowerCase().includes(T.toLocaleLowerCase())),S.value=T},X=y(()=>n.loading),Q=V(!1),$=y(()=>b.value.length>0||S.value.length>0?b.value:s.ownChannels),R=T=>p.submit(T),A=T=>{d.state.name=T,d.submit()};return(T,M)=>{const de=cl,it=Ro,_=Lo,E=Ao,D=mo,J=so,ze=eo,Be=Wi,Te=Ks;return g(),P(j,null,[u("div",pl,[l(de,{onSearch:K,onShowMembers:M[0]||(M[0]=z=>m(v).state.dialog=!0),onDeleteChannel:M[1]||(M[1]=z=>m(k).submit(m(n).channelAddr)),onAddMember:M[2]||(M[2]=z=>m(p).state.dialog=!0),onShowDeviceKey:M[3]||(M[3]=z=>Q.value=!0)}),u("div",fl,[l(Y,{class:"messenger-channels",square:"",flat:""},{default:c(()=>[m($).length>0?(g(),C(pe,{key:0,separator:"",class:"channels-list"},{default:c(()=>[(g(!0),P(j,null,ae(m($),z=>(g(),C(it,{key:z.name,pubkey:z.pubkey,channel:z.data,"is-active":`${m(n).channelAddr}`==`${z.pubkey}`,onSelect:Le=>m(o)(z.pubkey)},null,8,["pubkey","channel","is-active","onSelect"]))),128))]),_:1})):(g(),P("div",gl," No channels ")),l(_,{"is-joining":m(d).state.loading,"is-loading":m(X),onCreateChannel:M[4]||(M[4]=z=>m(r).state.dialog=!0),onJoinChannel:M[5]||(M[5]=z=>m(d).state.dialog=!0),onRefreshList:m(a)},null,8,["is-joining","is-loading","onRefreshList"])]),_:1}),l(E,{"post-message-state":f,onSendMessage:U},null,8,["post-message-state"]),l(Je,{showing:m(n).loading,color:"primary"},null,8,["showing"])])]),l(D,{modelValue:m(r).state.dialog,"onUpdate:modelValue":M[6]||(M[6]=z=>m(r).state.dialog=z),loading:m(r).state.loading,"default-state":m(r).state,onSubmit:m(r).submit,onReset:m(r).reset},null,8,["modelValue","loading","default-state","onSubmit","onReset"]),l(J,{modelValue:m(p).state.dialog,"onUpdate:modelValue":M[7]||(M[7]=z=>m(p).state.dialog=z),loading:m(p).state.loading,"default-state":m(p).state,onSubmit:R,onReset:m(p).reset},null,8,["modelValue","loading","default-state","onReset"]),l(ze,{modelValue:m(d).state.dialog,"onUpdate:modelValue":M[8]||(M[8]=z=>m(d).state.dialog=z),loading:m(d).state.loading,"default-state":m(d).state,onSubmit:A,onReset:m(d).reset},null,8,["modelValue","loading","default-state","onReset"]),l(Be,{modelValue:m(v).state.dialog,"onUpdate:modelValue":M[9]||(M[9]=z=>m(v).state.dialog=z),wallet:m(e),"authorize-member-state":m(v).state,"delete-member-state":m(w).state,onSubmit:m(v).submit,onDeleteMember:m(w).submit},null,8,["modelValue","wallet","authorize-member-state","delete-member-state","onSubmit","onDeleteMember"]),l(Te,{modelValue:Q.value,"onUpdate:modelValue":M[10]||(M[10]=z=>Q.value=z)},null,8,["modelValue"]),m(n).channel?(g(),P("div",bl,[l(hl)])):ke("",!0)],64)}}});const yl={},vl={class:"container"},wl={class:"messenger-container"},Cl={class:"container"};function Ml(t,e){const n=_l,i=xs;return g(),C(Tn,{class:"page-wrapper"},{default:c(()=>[u("div",vl,[u("div",wl,[l(n)])]),u("div",Cl,[l(i)])]),_:1})}const Al=F(yl,[["render",Ml],["__scopeId","data-v-8f1b09e0"]]),kl=()=>Et(()=>import("./_...all_.83a1db46.js"),["assets/_...all_.83a1db46.js","assets/vendor.a23ef5e2.js","assets/_...all_.73169310.css"]),Sl=[{name:"index",path:"/",component:Al,props:!0},{name:"all",path:"/:all(.*)*",component:kl,props:!0,meta:{layout:"empty"}}],xl=bs(Sl),$l="/sol-messenger/",El=Ln({history:Nn($l),scrollBehavior:()=>({left:0,top:0}),strict:!0,routes:xl}),Dl=({app:t})=>{t.use(El)},Pl=Object.freeze(Object.defineProperty({__proto__:null,install:Dl},Symbol.toStringTag,{value:"Module"})),Kl=({app:t})=>{t.use(Wn,{wallets:[new Vn,new Rn,new On,new Fn,new qn,new jn,new Un,new Qn,new Jn,new Gn,new Hn,new Xn,new Zn,new Yn,new ea,new ta,new na,new aa,new sa,new ia,new oa,new la,new ra,new ca,new ua,new da,new ma,new ha,new pa,new fa],autoConnect:!1})},Il=Object.freeze(Object.defineProperty({__proto__:null,install:Kl},Symbol.toStringTag,{value:"Module"})),zl=ga();function Bl(){return zl}const Tl=Symbol("WALLET_CONNECT_EVENT"),Ll=Symbol("WALLET_DISCONNECT_EVENT"),Nl=Symbol("ACCOUNT_CHANGE_EVENT"),ct=5e3;function Wl(){const{connection:t}=yt(),{emit:e}=Bl(),{notify:n}=Oe(),{wallet:i}=fe();re(i,o=>{if(!o)return;const a=()=>{const d=o.adapter.publicKey;t.onAccountChange(d,p=>{e(Nl,p)}),t.onLogs(d,p=>{console.log(p)}),n({message:"Wallet update",caption:`Connected to wallet ${Ge(d.toBase58(),7)}`,timeout:ct}),e(Tl,o)},s=()=>{n({message:"Wallet update",caption:"Disconnected from wallet",timeout:ct}),e(Ll,o)},r=d=>{!(d!=null&&d.message)||n({type:"negative",message:"Wallet update",caption:d.message,timeout:ct})};o.adapter.once("connect",a),o.adapter.once("disconnect",s),o.adapter.removeAllListeners("error"),o.adapter.on("error",r)},{immediate:!0})}const Vl=N({__name:"App",setup(t){return ba(()=>{Wl()}),(e,n)=>{const i=Fe("router-view");return g(),C(i)}}});async function Rl(){const t=_a(Vl);Object.values(Object.assign({"./plugins/pinia.ts":va,"./plugins/quasar.ts":Ca,"./plugins/router.ts":Pl,"./plugins/wallet.ts":Il})).forEach(e=>{var n;return(n=e.install)==null?void 0:n.call(e,{app:t})}),t.mount("#app")}Rl().then();export{F as _};
