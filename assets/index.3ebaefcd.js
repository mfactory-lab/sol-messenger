var Qt=Object.defineProperty;var Jt=(t,e,n)=>e in t?Qt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var j=(t,e,n)=>(Jt(t,typeof e!="symbol"?e+"":e,n),n);import{c as Gt,Q as Ht,P as Xt,D as Yt,N as Zt,a as en,i as tn,u as Pe,b as Ve,d as W,o as f,e as A,f as m,g as $,w as fe,v as nn,h as d,F as Q,r as Y,t as T,j as O,k as b,l as R,m as _e,n as an,p as sn,S as on,q as M,s as u,x as wt,y as K,z as r,A as Z,B as q,C as ke,E as ln,G as X,H as G,I as rn,J as oe,K as $t,W as Ct,L as Ie,M as Ke,O as Le,R as cn,T as un,U as ye,V as Ee,X as ie,Y as dn,Z as gt,_ as bt,$ as mn,a0 as hn,a1 as Et,a2 as Oe,a3 as pn,a4 as fn,a5 as be,a6 as lt,a7 as $e,a8 as gn,a9 as Dt,aa as bn,ab as yn,ac as p,ad as ae,ae as Pt,af as de,ag as me,ah as Te,ai as It,aj as Se,ak as _n,al as Ue,am as Kt,an as dt,ao as vn,ap as wn,aq as Cn,ar as Mn,as as An,at as re,au as le,av as Mt,aw as ue,ax as kn,ay as ze,az as Fe,aA as yt,aB as se,aC as je,aD as Sn,aE as xn,aF as Lt,aG as $n,aH as Qe,aI as At,aJ as En,aK as Dn,aL as Pn,aM as In,aN as Kn,aO as Ln,aP as Tn,aQ as zn,aR as Nn,aS as Bn,aT as Wn,aU as Rn,aV as Vn,aW as qn,aX as On,aY as Un,aZ as Fn,a_ as jn,a$ as Qn,b0 as Jn,b1 as Gn,b2 as Hn,b3 as Xn,b4 as Yn,b5 as Zn,b6 as ea,b7 as ta,b8 as na,b9 as aa,ba as sa,bb as ia,bc as oa,bd as la,be as ra,bf as ca,bg as ua,bh as da,bi as ma,bj as ha,bk as pa,bl as fa,bm as ga,bn as ba,bo as ya,bp as _a,bq as va,br as wa}from"./vendor.b54ab2b2.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerpolicy&&(a.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?a.credentials="include":s.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(s){if(s.ep)return;s.ep=!0;const a=n(s);fetch(s.href,a)}})();const Ca=({app:t})=>{const e=Gt();t.use(e)},Ma=Object.freeze(Object.defineProperty({__proto__:null,install:Ca},Symbol.toStringTag,{value:"Module"})),Aa=({app:t})=>{t.use(Ht,{plugins:{Dark:Xt,Dialog:Yt,Notify:Zt,LocalStorage:en},iconSet:tn})},ka=Object.freeze(Object.defineProperty({__proto__:null,install:Aa},Symbol.toStringTag,{value:"Module"}));function Sa(){const{dark:t}=Pe(),e=Ve("theme-mode",t.isActive);return t.set(e.value),{isActive:e,set(n){t.set(n),e.value=t.isActive},toggle(){t.toggle(),e.value=t.isActive}}}const De=[],Tt={id:"devnet",name:"DevNet",cluster:"devnet",url:"https://devnet.rpcpool.com/"};De.push(Tt);var xt;const xa=(xt=De.find(t=>t.id==={VITE_USER_NODE_ENV:"production",BASE_URL:"/",MODE:"staging",DEV:!1,PROD:!0}.VITE_CONNECTION_ENDPOINT))!=null?xt:Tt,$a="confirmed",Ea=12e4,kt=[`<span>Public channels</span> are non-encrypted and available to anyone, both for reading and writing.</br></br>
    <span>Public channels</span> are encrypted, and new users need to request approval to join them.</br>
    Depending on the \u2018Members can approve\u2019 setting, such requests can be approved either by channel\u2019s 
    owner/admin only, or by any authorized member of the channel.
    `,"Any authorized channel member can approve new requests to join"],Da="https://twitter.com/JPoolSolana",Pa="https://t.me/jpool_solana",Ia="https://t.me/jpoolsolana",Ka="https://discord.gg/qR4BA9QXVR",La="https://jfactory.ch",Ta="https://jpool.one",za="https://svt.one",Na="https://staking.kiwi/",Ba={class:"container"},Wa={class:"footer-section"},Ra={class:"footer-info"},Va={class:"theme"},qa={class:"switch"},Oa=m("span",{class:"slider round"},null,-1),Ua=m("div",{class:"copyright"},[$(" \xA9 Copyright 2022 cgram.one. All rights reserved."),m("br"),$("Powered by jFactory ")],-1),Fa={class:"footer-links"},ja={class:"social"},Qa=["href"],Ja=m("span",null,[$("official"),m("br"),$("channel")],-1),Ga=[Ja],Ha=["href"],Xa=["href"],Ya=["href"],Za=["href"],es=W({__name:"AppFooter",setup(t){const e=Sa(),n=[{name:"JFACTORY",link:La},{name:"JPOOL",link:Ta},{name:"STAKING KIWI",link:Na},{name:"SOLANA VALIDATOR TOOLKIT",link:za}];return(i,s)=>(f(),A("footer",null,[m("div",Ba,[m("div",Wa,[m("div",Ra,[m("div",Va,[$(" Dark mode "),m("label",qa,[fe(m("input",{"onUpdate:modelValue":s[0]||(s[0]=a=>d(e).isActive.value=a),type:"checkbox",onClick:s[1]||(s[1]=(...a)=>d(e).toggle&&d(e).toggle(...a))},null,512),[[nn,d(e).isActive.value]]),Oa])]),Ua]),m("div",Fa,[m("div",ja,[m("a",{href:d(Pa),target:"_blank",class:"social-link social-link-text"},Ga,8,Qa),m("a",{href:d(Ia),target:"_blank",class:"social-link telegram"},null,8,Ha),m("a",{href:d(Da),target:"_blank",class:"social-link twitter"},null,8,Xa),m("a",{href:d(Ka),target:"_blank",class:"social-link discord"},null,8,Ya)]),m("nav",null,[m("ul",null,[(f(),A(Q,null,Y(n,({name:a,link:o})=>m("li",{key:a},[m("a",{target:"_blank",href:o},T(a),9,Za)])),64))])])])])])]))}});function ts(){const t=O(ns());return{userAgent:t,isMobileOs:b(()=>as(t.value)),isWebView:b(()=>ss(t.value))}}let rt;function ns(){var t,e;return rt===void 0&&(rt=(e=(t=globalThis.navigator)==null?void 0:t.userAgent)!=null?e:null),rt}function as(t){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)}function ss(t){return/(WebView|(Phantom|Solflare)|Version\/.+(Chrome)\/(\d+)\.(\d+)\.(\d+)\.(\d+)|; wv\).+(Chrome)\/(\d+)\.(\d+)\.(\d+)\.(\d+))/i.test(t)}function Je(t,e=4){return t instanceof R&&(t=t.toBase58()),`${t.slice(0,e)}...${t.slice(-e)}`}function zt(t){return(t==null?void 0:t.name)&&t.name!==""?t.name:Je(t.authority)}const Nt=t=>{if(!t)return{background:"#000"};let e=0;for(let i=0;i<t.length;i++)e=t.charCodeAt(i)+((e<<5)-e),e=e&e;let n="#";for(let i=0;i<3;i++)n+=`00${(e>>i*8&255).toString(16)}`.substr(-2);return{background:n}},is="/assets/clover.968404b0.svg",os="/assets/ledger.40cf6861.svg",ls="/assets/mathwallet.1d763e81.svg",Ge=t=>(Ie("data-v-269ee747"),t=t(),Ke(),t),rs=Ge(()=>m("div",{class:"text-h6 text-center"}," Your wallet ",-1)),cs={class:"q-gutter-md row justify-between"},us=Ge(()=>m("span",{name:"wallet"},"Disconnect",-1)),ds=Ge(()=>m("span",{name:"wallet"},"Ok",-1)),ms=Ge(()=>m("div",{class:"text-h6"}," Connect to a wallet ",-1)),hs={class:"text-light-gray text-caption full-width text-no-wrap",style:{"text-overflow":"ellipsis",overflow:"hidden"}},ps=["src","alt"],fs=W({__name:"ConnectWallet",setup(t){const e={priority:{solflare:10,phantom:20,sollet:5,nufi:5,blocto:1},icons:{clover:is},darkIcons:{ledger:os,mathwallet:ls},deepLinks:{phantom:"https://phantom.app/ul/browse/{uri}?ref={ref}",solflare:"https://solflare.com/ul/browse/{uri}?ref={ref}"}},{userAgent:n,isWebView:i,isMobileOs:s}=ts(),a={close:$t},o=D=>[Ct.Installed,Ct.Loadable].includes(D.readyState);Pe();const l=_e(),{connected:c,connecting:h}=l;an();const g=b(()=>s.value&&!i.value);if(i.value){const D=String(n.value).toLowerCase();D.includes("phantom")?(l.select(sn),l.connect()):D.includes("solflare")&&(l.select(on),l.connect())}const v=b(()=>{var D,E;return(E=(D=l.publicKey.value)==null?void 0:D.toBase58())!=null?E:""}),C=b(()=>Je(v.value)),w=b(()=>[...l.wallets.value].map(D=>{var k,B;const E=D.adapter.name.toLowerCase();return D.adapter.icon=(B=(k=e.darkIcons[E])!=null?k:e.icons[E])!=null?B:D.adapter.icon,g.value&&e.deepLinks[E]&&(D.deepLink=e.deepLinks[E].replace("{uri}",location.href).replace("{ref}",location.origin)),D}).sort((D,E)=>{var x,Me;const k=(x=e.priority[D.adapter.name.toLowerCase()])!=null?x:1;return((Me=e.priority[E.adapter.name.toLowerCase()])!=null?Me:1)-k+((o(E)?1:0)-(o(D)?1:0))})),_=b(()=>g.value?w.value.filter(D=>!!D.deepLink):w.value),S=O(!1);async function U(D){await l.select(D.adapter.name),S.value=!1,await l.connect()}function P(){S.value=!1,l.disconnect()}function L(){S.value=!0}function F(){S.value=!1}return(D,E)=>(f(),A(Q,null,[d(c)?(f(),M(K,wt({key:0},D.$attrs,{ripple:!1,color:"primary-gray","text-color":"white",square:"",unelevated:"",onClick:L}),{default:u(()=>[$(T(d(C)),1)]),_:1},16)):(f(),M(K,wt({key:1},D.$attrs,{color:"primary-gray",class:"q-pa-none btn","text-color":"white",square:"",flat:"",ripple:!1,loading:d(h),onClick:L}),{default:u(()=>[$(" CONNECT WALLET ")]),_:1},16,["loading"])),r(oe,{modelValue:S.value,"onUpdate:modelValue":E[0]||(E[0]=k=>S.value=k),"transition-duration":"150","transition-show":"fade","transition-hide":"fade"},{default:u(()=>[d(c)?(f(),M(Z,{key:0},{default:u(()=>[r(q,{class:"relative-position"},{default:u(()=>[rs,r(K,{padding:"md",color:"transparent","text-color":"primary-gray",unelevated:"",class:"absolute-right",icon:a.close,size:"md",onClick:F},null,8,["icon"])]),_:1}),r(ke),r(q,null,{default:u(()=>[$(T(d(v)),1)]),_:1}),r(ke),r(q,null,{default:u(()=>[m("div",cs,[r(K,{class:"disconnect-btn","text-color":"black",square:"",flat:"",onClick:P},{default:u(()=>[us]),_:1}),r(K,{class:"disconnect-btn","text-color":"black",square:"",flat:"",onClick:F},{default:u(()=>[ds]),_:1})])]),_:1})]),_:1})):(f(),M(Z,{key:1,class:"wallet-connect-card"},{default:u(()=>[r(q,null,{default:u(()=>[ms,r(K,{padding:"md",color:"transparent","text-color":"primary-gray",unelevated:"",class:"absolute-right",icon:a.close,size:"md",onClick:F},null,8,["icon"])]),_:1}),r(ke),r(q,{style:{"max-height":"80vh"},class:"scroll"},{default:u(()=>[r(ln,{grid:"",rows:d(_),"row-key":"name","hide-pagination":"","hide-header":"","rows-per-page-options":[100]},{item:u(({row:k})=>[(f(),A("div",{key:`wallet-${k.adapter.name}`,class:"col-12 col-md-6"},[r(X,{clickable:"",href:k.deepLink,onClick:B=>k.deepLink?!0:U(k)},{default:u(()=>[r(G,null,{default:u(()=>[m("b",null,T(k.adapter.name),1),m("div",hs,T(k.adapter.url),1)]),_:2},1024),r(G,{avatar:""},{default:u(()=>[r(rn,{square:""},{default:u(()=>[m("img",{src:k.adapter.icon,alt:k.adapter.name},null,8,ps)]),_:2},1024)]),_:2},1024)]),_:2},1032,["href","onClick"])]))]),_:1},8,["rows"])]),_:1})]),_:1}))]),_:1},8,["modelValue"])],64))}});const ee=(t,e)=>{const n=t.__vccOpts||t;for(const[i,s]of e)n[i]=s;return n},gs=ee(fs,[["__scopeId","data-v-269ee747"]]),He=Le({id:"connection",state:()=>({commitment:$a,confirmTransactionInitialTimeout:Ea,rpc:cn("rpc","")}),getters:{endpoint(t){var e;return(e=De.find(n=>n.id===t.rpc))!=null?e:xa},connection(t){return console.log("[connection]",this.endpoint.url),new un(this.endpoint.url,{confirmTransactionInitialTimeout:t.confirmTransactionInitialTimeout,commitment:t.commitment})},cluster(){return this.endpoint.cluster}},actions:{setRpc(t){this.rpc=t},setCommitment(t){this.commitment=t}}}),bs=W({__name:"ClusterSelector",setup(t){const e=He(),{connected:n,connect:i,disconnect:s,autoConnect:a}=_e(),o=[De.filter(h=>h.cluster==="mainnet-beta"),De.filter(h=>h.cluster!=="mainnet-beta")],l=b(()=>e.endpoint),c=h=>{n&&e.cluster!==h.cluster&&(s(),a.value&&i()),e.setRpc(h.id)};return(h,g)=>(f(),M(dn,{label:d(l).name,"model-value":!1,"auto-close":"",color:"secondary","text-color":"#000",square:"",unelevated:"",ripple:!1},{default:u(()=>[r(ye,null,{default:u(()=>[(f(),A(Q,null,Y(o,(v,C)=>(f(),A(Q,{key:`${C}-cluster-group`},[(f(!0),A(Q,null,Y(v,w=>(f(),M(X,{key:w.id,clickable:"",onClick:_=>c(w)},{default:u(()=>[(f(),M(G,{key:`${w.id}-item`},{default:u(()=>[r(Ee,null,{default:u(()=>[m("b",null,T(w.name),1)]),_:2},1024),$(" "+T(w.url),1)]),_:2},1024))]),_:2},1032,["onClick"]))),128)),C!==o.length-1?(f(),M(ke,{key:0})):ie("",!0)],64))),64))]),_:1})]),_:1},8,["label"]))}});const ys={},_s={class:"app-header"},vs={class:"container"},ws={class:"app-header__info"},Cs={class:"app-header__logo"},Ms={class:"logo-wrapper"},As=m("div",{class:"app-header__title"},[m("h1",null,[$("BLOCKCHAIN "),m("br"),$(" messenger "),m("span",{class:"marked"},"SOLANA")])],-1),ks={class:"app-header__right"},Ss={class:"app-header__buttons"};function xs(t,e){const n=gt("router-link"),i=bs,s=gs;return f(),A("header",_s,[m("div",vs,[m("div",ws,[m("div",Cs,[m("div",Ms,[r(n,{to:"/"})])]),As]),r(bt),m("div",ks,[m("div",Ss,[r(i,{class:"app-header__cluster-btn header-btn"}),r(s,{class:"app-header__wallet-btn header-btn"})])])])])}const $s=ee(ys,[["render",xs]]),Es={};function Ds(t,e){const n=$s,i=gt("router-view"),s=es;return f(),M(mn,{view:"lfh Lpr lff"},{default:u(()=>[r(n),r(hn,null,{default:u(()=>[r(i)]),_:1}),r(s)]),_:1})}const Ps=ee(Es,[["render",Ds]]),Is={default:Ps,empty:()=>Et(()=>import("./empty.31acf6db.js"),["assets/empty.31acf6db.js","assets/vendor.b54ab2b2.js"])};function Ks(t){return t.map(e=>{var n;return{path:e.path,component:Is[((n=e.meta)==null?void 0:n.layout)||"default"],children:[{...e,path:""}]}})}const Ls="/assets/search.b4fadb1c.svg",Ts="/assets/transfer.796e9da5.svg",zs="/assets/plus.ee413328.svg",Ns={class:"how-it-works"},Bs={class:"app-info"},Ws=m("div",{class:"app-info__title"}," JOIN A CHANNEL ",-1),Rs={class:"app-info__list"},Vs=["innerHTML"],qs={class:"app-info"},Os=m("div",{class:"app-info__title"}," CREATE YOUR OWN CHANNEL ",-1),Us={class:"app-info__list"},Fs=["innerHTML"],js=W({__name:"HowItWorks",setup(t){const e=["For <span>public channels</span>, you can read or send messages without limitations.",`In order to join one of the existing private channels, click
        <img src="${Ls}" class="icon" alt="search">
        (BROWSE CHANNELS) at the bottom of the left-side panel.`,`Find a channel you are interested in and click
        <img src="${Ts}" class="icon" alt="transfer">
        (REQUEST TO JOIN). Your status for that channel will be set to Pending
        Approval until your request has been accepted. While awaiting approval,
        all messages in the channel will appear scrambled.`,`After the private channel's owner or admin approves your membership,your
        status will change to Authorized. You will be able to read the channel
        and send messages.`],n=["You can create a channel of your own as well.",`Click <img src="${zs}" class="icon" alt="search"> (CREATE A CHANNEL) 
  at the bottom of the left-side panel, then choose between Private and Public options.`,"A public channel is open to anyone for reading and writing, and no encryption is used.",`If you create a private channel, joining it will require your approval. You will see a red 
  notification badge above the channel list if there are approval requests pending.`];return(i,s)=>(f(),A("div",Ns,[m("div",Bs,[Ws,m("ul",Rs,[(f(),A(Q,null,Y(e,a=>m("li",{key:a},[m("p",{innerHTML:a},null,8,Vs)])),64))])]),m("div",qs,[Os,m("ul",Us,[(f(),A(Q,null,Y(n,a=>m("li",{key:a},[m("p",{innerHTML:a},null,8,Fs)])),64))])])]))}});const _t=Le("user",()=>{const t=He(),e=Oe(),n=O();pn(()=>{var c;const l=(c=e.value)==null?void 0:c.publicKey;if(l){const h=Ve(l.toString(),()=>lt.encode(be.generate().secretKey));i(h.value)}else n.value=void 0});function i(l){n.value=be.fromSecretKey(lt.decode(l))}function s(){var h;const l=(h=e.value)==null?void 0:h.publicKey;if(!l)return;const c=Ve(l.toString(),"");i(c.value=lt.encode(be.generate().secretKey))}function a(l){var g;const c=(g=e.value)==null?void 0:g.publicKey;if(!c)return;const h=Ve(c.toString(),"");i(h.value=l)}const o=b(async()=>{var c;const l=(c=e.value)==null?void 0:c.publicKey;return l?await t.connection.getBalance(l)/fn:0});return{keypair:n,balance:o,generateKey:s,importKey:a}}),Qs=t=>(Ie("data-v-b77c7ee6"),t=t(),Ke(),t),Js=Qs(()=>m("div",{class:"text-h6 text-center"}," Device Key ",-1)),Gs={class:"q-gutter-md row justify-between"},Hs=W({__name:"UserInfoDialog",emits:["regenerate"],setup(t){const e=_t(),n=()=>{var i,s;return yn(String((s=(i=e.keypair)==null?void 0:i.publicKey)!=null?s:""))};return(i,s)=>(f(),M(oe,{class:"dialog-wrapper","transition-duration":"150","transition-show":"fade","transition-hide":"fade"},{default:u(()=>[r(Z,{square:"",flat:""},{default:u(()=>[r(q,{class:"row items-center"},{default:u(()=>[Js,r(bt),fe(r(K,{flat:"",round:"",dense:"",icon:d($t)},null,8,["icon"]),[[$e]])]),_:1}),r(ke),r(q,null,{default:u(()=>{var a;return[r(K,{flat:"",round:"",dense:"",icon:d(gn),onClick:n},{default:u(()=>[r(Dt,{delay:0,anchor:"bottom middle",self:"top middle","transition-duration":"0"},{default:u(()=>[$(" Copy to clipboard ")]),_:1})]),_:1},8,["icon"]),m("span",null,T((a=d(e).keypair)==null?void 0:a.publicKey),1)]}),_:1}),r(ke),r(bn,{align:"right"},{default:u(()=>[m("div",Gs,[r(K,{class:"disconnect-btn","text-color":"black",square:"",flat:"",onClick:d(e).generateKey},{default:u(()=>[$(" Regenerate ")]),_:1},8,["onClick"])])]),_:1})]),_:1})]),_:1}))}});const Xs=ee(Hs,[["__scopeId","data-v-b77c7ee6"]]),Ys="0.0.8",Zs="messenger",ei=[{name:"initChannel",accounts:[{name:"channel",isMut:!0,isSigner:!0},{name:"membership",isMut:!0,isSigner:!1},{name:"authority",isMut:!0,isSigner:!0},{name:"key",isMut:!1,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"data",type:{defined:"InitChannelData"}}]},{name:"deleteChannel",accounts:[{name:"channel",isMut:!0,isSigner:!1},{name:"authorityMembership",isMut:!0,isSigner:!1},{name:"authority",isMut:!0,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"joinChannel",accounts:[{name:"channel",isMut:!0,isSigner:!1},{name:"membership",isMut:!0,isSigner:!1},{name:"authority",isMut:!0,isSigner:!0},{name:"key",isMut:!1,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"data",type:{defined:"JoinChannelData"}}]},{name:"leaveChannel",accounts:[{name:"channel",isMut:!0,isSigner:!1},{name:"membership",isMut:!0,isSigner:!1},{name:"authority",isMut:!0,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"grantAccessMember",accounts:[{name:"channel",isMut:!1,isSigner:!1},{name:"membership",isMut:!0,isSigner:!1},{name:"authorityMembership",isMut:!1,isSigner:!1},{name:"authority",isMut:!0,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"data",type:{defined:"GrantAccessMemberData"}}]},{name:"addMember",accounts:[{name:"channel",isMut:!0,isSigner:!1},{name:"invitee",isMut:!1,isSigner:!1},{name:"inviteeMembership",isMut:!0,isSigner:!1},{name:"authorityMembership",isMut:!0,isSigner:!1},{name:"authority",isMut:!0,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"data",type:{defined:"AddMemberData"}}]},{name:"authorizeMember",accounts:[{name:"channel",isMut:!1,isSigner:!1},{name:"membership",isMut:!0,isSigner:!1},{name:"authority",isMut:!1,isSigner:!0},{name:"authorityMembership",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"data",type:{defined:"AuthorizeMemberData"}}]},{name:"deleteMember",accounts:[{name:"channel",isMut:!0,isSigner:!1},{name:"membership",isMut:!0,isSigner:!1},{name:"authorityMembership",isMut:!1,isSigner:!1},{name:"authority",isMut:!0,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"postMessage",accounts:[{name:"channel",isMut:!0,isSigner:!1},{name:"membership",isMut:!1,isSigner:!1},{name:"authority",isMut:!1,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"message",type:"string"}]}],ti=[{name:"Channel",type:{kind:"struct",fields:[{name:"name",docs:["Name of the channel"],type:"string"},{name:"creator",docs:["Channel creator"],type:"publicKey"},{name:"createdAt",docs:["Creation date"],type:"i64"},{name:"flags",docs:["Channel flags"],type:"u8"},{name:"memberCount",docs:["Number of members"],type:"u16"},{name:"messageCount",docs:["Message counter"],type:"u32"},{name:"maxMessages",docs:["The maximum number of messages that are stored in [messages]"],type:"u16"},{name:"messages",docs:["List of messages"],type:{vec:{defined:"Message"}}}]}},{name:"ChannelMembership",type:{kind:"struct",fields:[{name:"channel",docs:["Associated [Channel] address"],type:"publicKey"},{name:"authority",docs:["Authority of membership"],type:"publicKey"},{name:"key",docs:["The device key used to encrypt the `CEK`"],type:"publicKey"},{name:"cek",docs:["The content encryption key (CEK) of the channel"],type:{defined:"CEKData"}},{name:"status",docs:["Status of membership"],type:{defined:"ChannelMembershipStatus"}},{name:"name",docs:["Name of the channel member"],type:"string"},{name:"invitedBy",docs:["Inviter address"],type:{option:"publicKey"}},{name:"createdAt",docs:["Creation date"],type:"i64"},{name:"flags",docs:["Membership flags"],type:"u8"},{name:"bump",docs:["Bump seed for deriving PDA seeds"],type:"u8"}]}}],ni=[{name:"AddMemberData",type:{kind:"struct",fields:[{name:"name",docs:["Member name"],type:"string"},{name:"flags",docs:["Membership flags, only `admin` and `owner` can set membership flags"],type:"u8"},{name:"cek",docs:["Content Encryption Key"],type:{defined:"CEKData"}},{name:"key",docs:["Device key"],type:{option:"publicKey"}}]}},{name:"AuthorizeMemberData",type:{kind:"struct",fields:[{name:"cek",type:{defined:"CEKData"}}]}},{name:"GrantAccessMemberData",type:{kind:"struct",fields:[{name:"flags",type:"u8"}]}},{name:"InitChannelData",type:{kind:"struct",fields:[{name:"name",type:"string"},{name:"maxMessages",type:"u16"},{name:"memberName",type:"string"},{name:"cek",type:{defined:"CEKData"}},{name:"public",type:"bool"},{name:"permissionless",type:"bool"}]}},{name:"JoinChannelData",type:{kind:"struct",fields:[{name:"name",type:"string"},{name:"authority",type:{option:"publicKey"}}]}},{name:"CEKData",type:{kind:"struct",fields:[{name:"header",docs:["The header information for the CEK"],type:"string"},{name:"encryptedKey",docs:["The CEK itself"],type:"string"}]}},{name:"Message",type:{kind:"struct",fields:[{name:"id",docs:["Uniq message id"],type:"u32"},{name:"sender",docs:["The message sender id"],type:"publicKey"},{name:"createdAt",docs:["The unix timestamp at which the message was received"],type:"i64"},{name:"flags",docs:["Message flags"],type:"u8"},{name:"content",docs:["The (typically encrypted) message content"],type:"string"}]}},{name:"ChannelMembershipStatus",type:{kind:"enum",variants:[{name:"Authorized",fields:[{name:"by",type:{option:"publicKey"}}]},{name:"Pending",fields:[{name:"authority",type:{option:"publicKey"}}]}]}}],ai=[{name:"NewChannelEvent",fields:[{name:"channel",type:"publicKey",index:!0},{name:"creator",type:"publicKey",index:!1},{name:"name",type:"string",index:!1},{name:"timestamp",type:"i64",index:!1}]},{name:"DeleteChannelEvent",fields:[{name:"channel",type:"publicKey",index:!0},{name:"creator",type:"publicKey",index:!1},{name:"timestamp",type:"i64",index:!1}]},{name:"NewMessageEvent",fields:[{name:"channel",type:"publicKey",index:!0},{name:"message",type:{defined:"Message"},index:!1}]},{name:"JoinChannelEvent",fields:[{name:"channel",type:"publicKey",index:!0},{name:"membership",type:"publicKey",index:!0},{name:"timestamp",type:"i64",index:!1}]},{name:"LeaveChannelEvent",fields:[{name:"channel",type:"publicKey",index:!0},{name:"authority",type:"publicKey",index:!0},{name:"timestamp",type:"i64",index:!1}]},{name:"AddMemberEvent",fields:[{name:"channel",type:"publicKey",index:!0},{name:"membership",type:"publicKey",index:!0},{name:"by",type:"publicKey",index:!1},{name:"timestamp",type:"i64",index:!1}]},{name:"AuthorizeMemberEvent",fields:[{name:"channel",type:"publicKey",index:!0},{name:"membership",type:"publicKey",index:!0},{name:"by",type:"publicKey",index:!1},{name:"timestamp",type:"i64",index:!1}]},{name:"DeleteMemberEvent",fields:[{name:"channel",type:"publicKey",index:!0},{name:"membership",type:"publicKey",index:!0},{name:"by",type:"publicKey",index:!1},{name:"timestamp",type:"i64",index:!1}]}],si=[{code:6e3,name:"Unauthorized",msg:"Unauthorized"},{code:6001,name:"InvalidChannel",msg:"Invalid channel"},{code:6002,name:"InvalidMembership",msg:"Invalid membership"},{code:6003,name:"InvalidMessage",msg:"Invalid message"},{code:6004,name:"NameTooLong",msg:"Name too long"},{code:6005,name:"MessageTooLong",msg:"Message too long"}],ii={address:"6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm",origin:"anchor",binaryVersion:"0.25.0",libVersion:"0.25.0"},oi={version:Ys,name:Zs,instructions:ei,accounts:ti,types:ni,events:ai,errors:si,metadata:ii},li=new p.FixableBeetArgsStruct([["id",p.u32],["sender",ae],["createdAt",p.i64],["flags",p.u8],["content",p.utf8String]],"Message"),mt=[49,159,99,106,220,87,219,88];class ne{constructor(e,n,i,s,a,o,l,c){this.name=e,this.creator=n,this.createdAt=i,this.flags=s,this.memberCount=a,this.messageCount=o,this.maxMessages=l,this.messages=c}static fromArgs(e){return new ne(e.name,e.creator,e.createdAt,e.flags,e.memberCount,e.messageCount,e.maxMessages,e.messages)}static fromAccountInfo(e,n=0){return ne.deserialize(e.data,n)}static async fromAccountAddress(e,n,i){const s=await e.getAccountInfo(n,i);if(s==null)throw new Error(`Unable to find Channel account at ${n}`);return ne.fromAccountInfo(s,0)[0]}static gpaBuilder(e=new R("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){return Pt.fromStruct(e,We)}static deserialize(e,n=0){return We.deserialize(e,n)}serialize(){return We.serialize({accountDiscriminator:mt,...this})}static byteSize(e){const n=ne.fromArgs(e);return We.toFixedFromValue({accountDiscriminator:mt,...n}).byteSize}static async getMinimumBalanceForRentExemption(e,n,i){return n.getMinimumBalanceForRentExemption(ne.byteSize(e),i)}pretty(){return{name:this.name,creator:this.creator.toBase58(),createdAt:(()=>{const e=this.createdAt;if(typeof e.toNumber=="function")try{return e.toNumber()}catch{return e}return e})(),flags:this.flags,memberCount:this.memberCount,messageCount:this.messageCount,maxMessages:this.maxMessages,messages:this.messages}}}const We=new p.FixableBeetStruct([["accountDiscriminator",p.uniformFixedSizeArray(p.u8,8)],["name",p.utf8String],["creator",ae],["createdAt",p.i64],["flags",p.u8],["memberCount",p.u16],["messageCount",p.u32],["maxMessages",p.u16],["messages",p.array(li)]],ne.fromArgs,"Channel"),Xe=new p.FixableBeetArgsStruct([["header",p.utf8String],["encryptedKey",p.utf8String]],"CEKData"),ri=p.dataEnum([["Authorized",new p.FixableBeetArgsStruct([["by",p.coption(ae)]],'ChannelMembershipStatusRecord["Authorized"]')],["Pending",new p.FixableBeetArgsStruct([["authority",p.coption(ae)]],'ChannelMembershipStatusRecord["Pending"]')]]),qe=[238,149,255,251,116,131,86,170];class H{constructor(e,n,i,s,a,o,l,c,h,g){this.channel=e,this.authority=n,this.key=i,this.cek=s,this.status=a,this.name=o,this.invitedBy=l,this.createdAt=c,this.flags=h,this.bump=g}static fromArgs(e){return new H(e.channel,e.authority,e.key,e.cek,e.status,e.name,e.invitedBy,e.createdAt,e.flags,e.bump)}static fromAccountInfo(e,n=0){return H.deserialize(e.data,n)}static async fromAccountAddress(e,n,i){const s=await e.getAccountInfo(n,i);if(s==null)throw new Error(`Unable to find ChannelMembership account at ${n}`);return H.fromAccountInfo(s,0)[0]}static gpaBuilder(e=new R("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){return Pt.fromStruct(e,Re)}static deserialize(e,n=0){return Re.deserialize(e,n)}serialize(){return Re.serialize({accountDiscriminator:qe,...this})}static byteSize(e){const n=H.fromArgs(e);return Re.toFixedFromValue({accountDiscriminator:qe,...n}).byteSize}static async getMinimumBalanceForRentExemption(e,n,i){return n.getMinimumBalanceForRentExemption(H.byteSize(e),i)}pretty(){return{channel:this.channel.toBase58(),authority:this.authority.toBase58(),key:this.key.toBase58(),cek:this.cek,status:this.status.__kind,name:this.name,invitedBy:this.invitedBy,createdAt:(()=>{const e=this.createdAt;if(typeof e.toNumber=="function")try{return e.toNumber()}catch{return e}return e})(),flags:this.flags,bump:this.bump}}}const Re=new p.FixableBeetStruct([["accountDiscriminator",p.uniformFixedSizeArray(p.u8,8)],["channel",ae],["authority",ae],["key",ae],["cek",Xe],["status",ri],["name",p.utf8String],["invitedBy",p.coption(ae)],["createdAt",p.i64],["flags",p.u8],["bump",p.u8]],H.fromArgs,"ChannelMembership"),ve=new Map,we=new Map;class Ye extends Error{constructor(){super("Unauthorized");j(this,"code",6e3);j(this,"name","Unauthorized");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Ye)}}ve.set(6e3,()=>new Ye);we.set("Unauthorized",()=>new Ye);class Ze extends Error{constructor(){super("Invalid channel");j(this,"code",6001);j(this,"name","InvalidChannel");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Ze)}}ve.set(6001,()=>new Ze);we.set("InvalidChannel",()=>new Ze);class et extends Error{constructor(){super("Invalid membership");j(this,"code",6002);j(this,"name","InvalidMembership");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,et)}}ve.set(6002,()=>new et);we.set("InvalidMembership",()=>new et);class tt extends Error{constructor(){super("Invalid message");j(this,"code",6003);j(this,"name","InvalidMessage");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,tt)}}ve.set(6003,()=>new tt);we.set("InvalidMessage",()=>new tt);class nt extends Error{constructor(){super("Name too long");j(this,"code",6004);j(this,"name","NameTooLong");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,nt)}}ve.set(6004,()=>new nt);we.set("NameTooLong",()=>new nt);class at extends Error{constructor(){super("Message too long");j(this,"code",6005);j(this,"name","MessageTooLong");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,at)}}ve.set(6005,()=>new at);we.set("MessageTooLong",()=>new at);function ce(t){const e=ve.get(t);return e!=null?e():null}function Ae(t){const e=we.get(t);return e!=null?e():null}const ci=new p.FixableBeetArgsStruct([["name",p.utf8String],["flags",p.u8],["cek",Xe],["key",p.coption(ae)]],"AddMemberData"),ui=new p.FixableBeetArgsStruct([["instructionDiscriminator",p.uniformFixedSizeArray(p.u8,8)],["data",ci]],"AddMemberInstructionArgs"),di=[13,116,123,130,126,198,57,34];function mi(t,e,n=new R("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){var o;const[i]=ui.serialize({instructionDiscriminator:di,...e}),s=[{pubkey:t.channel,isWritable:!0,isSigner:!1},{pubkey:t.invitee,isWritable:!1,isSigner:!1},{pubkey:t.inviteeMembership,isWritable:!0,isSigner:!1},{pubkey:t.authorityMembership,isWritable:!0,isSigner:!1},{pubkey:t.authority,isWritable:!0,isSigner:!0},{pubkey:(o=t.systemProgram)!=null?o:de.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const l of t.anchorRemainingAccounts)s.push(l);return new me({programId:n,keys:s,data:i})}const hi=new p.FixableBeetArgsStruct([["cek",Xe]],"AuthorizeMemberData"),pi=new p.FixableBeetArgsStruct([["instructionDiscriminator",p.uniformFixedSizeArray(p.u8,8)],["data",hi]],"AuthorizeMemberInstructionArgs"),fi=[194,123,189,175,86,225,93,128];function gi(t,e,n=new R("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){var o;const[i]=pi.serialize({instructionDiscriminator:fi,...e}),s=[{pubkey:t.channel,isWritable:!1,isSigner:!1},{pubkey:t.membership,isWritable:!0,isSigner:!1},{pubkey:t.authority,isWritable:!1,isSigner:!0},{pubkey:t.authorityMembership,isWritable:!0,isSigner:!1},{pubkey:(o=t.systemProgram)!=null?o:de.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const l of t.anchorRemainingAccounts)s.push(l);return new me({programId:n,keys:s,data:i})}const bi=new p.BeetArgsStruct([["instructionDiscriminator",p.uniformFixedSizeArray(p.u8,8)]],"DeleteChannelInstructionArgs"),yi=[145,225,187,221,157,142,114,133];function _i(t,e=new R("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){var a;const[n]=bi.serialize({instructionDiscriminator:yi}),i=[{pubkey:t.channel,isWritable:!0,isSigner:!1},{pubkey:t.authorityMembership,isWritable:!0,isSigner:!1},{pubkey:t.authority,isWritable:!0,isSigner:!0},{pubkey:(a=t.systemProgram)!=null?a:de.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const o of t.anchorRemainingAccounts)i.push(o);return new me({programId:e,keys:i,data:n})}const vi=new p.BeetArgsStruct([["instructionDiscriminator",p.uniformFixedSizeArray(p.u8,8)]],"DeleteMemberInstructionArgs"),wi=[95,14,98,112,252,218,205,173];function Ci(t,e=new R("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){var a;const[n]=vi.serialize({instructionDiscriminator:wi}),i=[{pubkey:t.channel,isWritable:!0,isSigner:!1},{pubkey:t.membership,isWritable:!0,isSigner:!1},{pubkey:t.authorityMembership,isWritable:!1,isSigner:!1},{pubkey:t.authority,isWritable:!0,isSigner:!0},{pubkey:(a=t.systemProgram)!=null?a:de.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const o of t.anchorRemainingAccounts)i.push(o);return new me({programId:e,keys:i,data:n})}const Mi=new p.BeetArgsStruct([["flags",p.u8]],"GrantAccessMemberData");new p.BeetArgsStruct([["instructionDiscriminator",p.uniformFixedSizeArray(p.u8,8)],["data",Mi]],"GrantAccessMemberInstructionArgs");const Ai=new p.FixableBeetArgsStruct([["name",p.utf8String],["maxMessages",p.u16],["memberName",p.utf8String],["cek",Xe],["public",p.bool],["permissionless",p.bool]],"InitChannelData"),ki=new p.FixableBeetArgsStruct([["instructionDiscriminator",p.uniformFixedSizeArray(p.u8,8)],["data",Ai]],"InitChannelInstructionArgs"),Si=[21,200,152,39,19,178,76,47];function xi(t,e,n=new R("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){var o;const[i]=ki.serialize({instructionDiscriminator:Si,...e}),s=[{pubkey:t.channel,isWritable:!0,isSigner:!0},{pubkey:t.membership,isWritable:!0,isSigner:!1},{pubkey:t.authority,isWritable:!0,isSigner:!0},{pubkey:t.key,isWritable:!1,isSigner:!0},{pubkey:(o=t.systemProgram)!=null?o:de.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const l of t.anchorRemainingAccounts)s.push(l);return new me({programId:n,keys:s,data:i})}const $i=new p.FixableBeetArgsStruct([["name",p.utf8String],["authority",p.coption(ae)]],"JoinChannelData"),Ei=new p.FixableBeetArgsStruct([["instructionDiscriminator",p.uniformFixedSizeArray(p.u8,8)],["data",$i]],"JoinChannelInstructionArgs"),Di=[124,39,115,89,217,26,38,29];function Pi(t,e,n=new R("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){var o;const[i]=Ei.serialize({instructionDiscriminator:Di,...e}),s=[{pubkey:t.channel,isWritable:!0,isSigner:!1},{pubkey:t.membership,isWritable:!0,isSigner:!1},{pubkey:t.authority,isWritable:!0,isSigner:!0},{pubkey:t.key,isWritable:!1,isSigner:!0},{pubkey:(o=t.systemProgram)!=null?o:de.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const l of t.anchorRemainingAccounts)s.push(l);return new me({programId:n,keys:s,data:i})}const Ii=new p.BeetArgsStruct([["instructionDiscriminator",p.uniformFixedSizeArray(p.u8,8)]],"LeaveChannelInstructionArgs"),Ki=[104,0,75,134,95,80,68,186];function Li(t,e=new R("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){var a;const[n]=Ii.serialize({instructionDiscriminator:Ki}),i=[{pubkey:t.channel,isWritable:!0,isSigner:!1},{pubkey:t.membership,isWritable:!0,isSigner:!1},{pubkey:t.authority,isWritable:!0,isSigner:!0},{pubkey:(a=t.systemProgram)!=null?a:de.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const o of t.anchorRemainingAccounts)i.push(o);return new me({programId:e,keys:i,data:n})}const Ti=new p.FixableBeetArgsStruct([["instructionDiscriminator",p.uniformFixedSizeArray(p.u8,8)],["message",p.utf8String]],"PostMessageInstructionArgs"),zi=[214,50,100,209,38,34,7,76];function Ni(t,e,n=new R("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){var o;const[i]=Ti.serialize({instructionDiscriminator:zi,...e}),s=[{pubkey:t.channel,isWritable:!0,isSigner:!1},{pubkey:t.membership,isWritable:!1,isSigner:!1},{pubkey:t.authority,isWritable:!1,isSigner:!0},{pubkey:(o=t.systemProgram)!=null?o:de.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const l of t.anchorRemainingAccounts)s.push(l);return new me({programId:n,keys:s,data:i})}const Bi="6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm",Wi=new R(Bi);function ht(t,e=new Uint8Array(4)){const n=Te(t.toString(),"base10");return e.set(n,4-n.length),e}const ct=t=>Se([ht(t.length),t]);function Bt(t,e,n){if(e!==256)throw new Error(`Unsupported key length: ${e}`);const i=Se([ct(Te(n)),ct(new Uint8Array(0)),ct(new Uint8Array(0)),ht(e)]),s=1;return _n.hash(Se([ht(s),t,i]))}const pt=t=>Te(t,"base64pad"),ft=t=>It(t,"base64pad"),Ri=t=>Te(t),Vi=t=>It(t),qi=t=>Te(t,"base58btc"),ge=Ue.NONCE_LENGTH,xe=Ue.TAG_LENGTH,Wt=t=>{const e=new Ue.XChaCha20Poly1305(t);return(n,i)=>{const s=Kt.randomBytes(ge),a=e.seal(s,n,i);return{ciphertext:a.subarray(0,a.length-xe),tag:a.subarray(a.length-xe),iv:s}}},Rt=t=>{const e=new Ue.XChaCha20Poly1305(t);return(n,i,s,a)=>e.open(s,Se([n,i]),a)},Vt="ECDH-ES+XC20PKW",qt=256,Oi=t=>e=>{const n=dt.generateKeyPair(),i=dt.sharedKey(n.secretKey,t),s=Bt(i,qt,Vt),a=Wt(s)(e);return{encryptedKey:a.ciphertext,tag:a.tag,iv:a.iv,epPubKey:n.publicKey}},Ui=t=>(e,n,i,s)=>{const a=dt.sharedKey(t,s),o=Bt(a,qt,Vt);return Rt(o)(e,n,i)},Fi=t=>Array.isArray(t)?be.fromSecretKey(Cn.Buffer.from(t)):typeof t=="string"?be.fromSecretKey(qi(t)):be.fromSecretKey(t),ji=async(t=32)=>{const e=Kt.randomBytes(t);return Promise.resolve(e)},Qi=async(t,e)=>{const n=await Oi(vn(e.toBytes()))(t);return{header:ft(Se([n.iv,n.tag,n.epPubKey])),encryptedKey:ft(n.encryptedKey)}},Ji=async(t,e)=>{const n=pt(t.header),i=n.subarray(0,ge),s=n.subarray(ge,ge+xe),a=n.subarray(ge+xe),o=pt(t.encryptedKey),l=Fi(e).secretKey,c=wn(l),h=await Ui(c)(o,s,i,a);if(h===null)throw new Error("There was a problem decrypting the CEK");return h},Gi=async(t,e)=>{const n=await Wt(e)(Ri(t));return ft(Se([n.iv,n.ciphertext,n.tag]))},Hi=async(t,e)=>{const n=pt(t),i=n.subarray(0,ge),s=n.subarray(ge,-xe),a=n.subarray(-xe),o=await Rt(e)(s,a,i);if(o===null)throw new Error("There was an error decoding the message!");return Vi(o)};class Xi{constructor(e,n){j(this,"programId",Wi);j(this,"_coder");j(this,"_events");j(this,"utils",{channel:{isPublic:e=>(e.flags&1)>0,isPermissionless:e=>(e.flags&2)>0},member:{isOwner:e=>e.flags>=255,isAdmin:e=>(e.flags&7)===7,canAddMember:e=>(e.flags&1)>0,canDeleteMember:e=>(e.flags&2)>0,canAuthorizeMember:e=>(e.flags&4)>0},message:{isEncrypted:e=>(e.flags&1)>0}});this.provider=e,this.keypair=n,this._coder=new Mn(oi),this._events=new An(this.programId,e,this._coder)}get connection(){return this.provider.connection}addEventListener(e,n){return this._events.addEventListener(e,n)}async removeEventListener(e){return await this._events.removeEventListener(e)}setKeypair(e){this.keypair=e}async loadAllChannels(){return(await ne.gpaBuilder().addFilter("accountDiscriminator",mt).run(this.provider.connection)).map(n=>({pubkey:n.pubkey,data:ne.fromAccountInfo(n.account)[0]}))}async loadChannel(e,n){return ne.fromAccountAddress(this.provider.connection,e,n)}async loadMyChannels(){return await this.loadMemberships()}async loadChannelMembers(e){return(await H.gpaBuilder().addFilter("accountDiscriminator",qe).addFilter("channel",e).run(this.provider.connection)).map(i=>({pubkey:i.pubkey,data:H.fromAccountInfo(i.account)[0]}))}async loadMemberships(e){const n=H.gpaBuilder().addFilter("accountDiscriminator",qe).addFilter("authority",this.provider.publicKey);return e&&n.addFilter("key",e),(await n.run(this.provider.connection)).map(s=>({pubkey:s.pubkey,data:H.fromAccountInfo(s.account)}))}async loadMembership(e,n){return H.fromAccountAddress(this.provider.connection,e,n)}async getMembershipPDA(e,n){return n=n!=null?n:this.keypair.publicKey,await R.findProgramAddress([e.toBuffer(),n.toBuffer()],this.programId)}async encryptCEK(e,n){return Qi(e,n!=null?n:this.keypair.publicKey)}async decryptCEK(e,n){return Ji(e,n!=null?n:this.keypair.secretKey)}async encryptMessage(e,n){return Gi(e,n)}async decryptMessage(e,n){return Hi(e,n)}async initChannel(e){var h,g,v,C,w;const n=(h=e.channel)!=null?h:be.generate(),i=await ji(),s=await this.encryptCEK(i),[a]=await this.getMembershipPDA(n.publicKey),o=this.provider.publicKey,l=new re;l.add(xi({key:this.keypair.publicKey,channel:n.publicKey,membership:a,authority:o},{data:{name:e.name,public:(g=e.public)!=null?g:!1,permissionless:(v=e.permissionless)!=null?v:!1,memberName:(C=e.memberName)!=null?C:"",maxMessages:e.maxMessages,cek:s}}));let c;try{c=await this.provider.sendAndConfirm(l,[n,this.keypair],e.opts)}catch(_){throw(w=ce(_.code))!=null?w:_}return{signature:c,channel:n,cek:i,cekEncrypted:s}}async deleteChannel({channel:e,opts:n}){var l;const i=this.provider.publicKey,[s]=await this.getMembershipPDA(e),a=new re;a.add(_i({channel:e,authority:i,authorityMembership:s}));let o;try{o=await this.provider.sendAndConfirm(a,void 0,n)}catch(c){throw(l=ce(c.code))!=null?l:Ae("Unauthorized")}return{signature:o}}async joinChannel(e){var o,l;const[n]=await this.getMembershipPDA(e.channel),i=this.provider.publicKey,s=new re;s.add(Pi({channel:e.channel,key:this.keypair.publicKey,membership:n,authority:i},{data:{name:e.name,authority:(o=e.authority)!=null?o:null}}));let a;try{a=await this.provider.sendAndConfirm(s,[this.keypair],e.opts)}catch(c){throw(l=ce(c.code))!=null?l:c}return{signature:a}}async leaveChannel(e){var o;const[n]=await this.getMembershipPDA(e.channel),i=this.provider.publicKey,s=new re;s.add(Li({channel:e.channel,membership:n,authority:i}));let a;try{a=await this.provider.sendAndConfirm(s)}catch(l){throw(o=ce(l.code))!=null?o:l}return{signature:a}}async addMember(e){var g,v,C,w;const n=(g=e.key)!=null?g:e.invitee,[i]=await this.getMembershipPDA(e.channel),[s]=await this.getMembershipPDA(e.channel,n),a=await this.loadMembership(i);if(!a.cek.encryptedKey)throw Ae("Unauthorized");const o=await this.decryptCEK(a.cek),l=await this.encryptCEK(o,n),c=new re;c.add(mi({channel:e.channel,authority:this.provider.publicKey,invitee:e.invitee,authorityMembership:i,inviteeMembership:s},{data:{name:(v=e.name)!=null?v:"",flags:(C=e.flags)!=null?C:0,cek:l,key:n}}));let h;try{h=await this.provider.sendAndConfirm(c)}catch(_){throw(w=ce(_.code))!=null?w:Ae("Unauthorized")}return{signature:h}}async deleteMember(e){var l;const[n]=e.membership?[e.membership]:await this.getMembershipPDA(e.channel,e.key),[i]=await this.getMembershipPDA(e.channel),s=this.provider.publicKey,a=new re;a.add(Ci({channel:e.channel,membership:n,authority:s,authorityMembership:i}));let o;try{o=await this.provider.sendAndConfirm(a)}catch(c){throw(l=ce(c.code))!=null?l:c}return{signature:o}}async authorizeMember(e){var h;const[n]=await this.getMembershipPDA(e.channel),[i]=await this.getMembershipPDA(e.channel,e.key),s=await this.loadMembership(n);if(!s.cek.encryptedKey)throw Ae("Unauthorized");const a=await this.decryptCEK(s.cek),o=await this.encryptCEK(a,e.key),l=new re;l.add(gi({channel:e.channel,membership:i,authority:this.provider.publicKey,authorityMembership:n},{data:{cek:o}}));let c;try{c=await this.provider.sendAndConfirm(l)}catch(g){throw(h=ce(g.code))!=null?h:Ae("Unauthorized")}return{signature:c}}async postMessage(e){var l;const[n]=await this.getMembershipPDA(e.channel);let i,s=0;if(e.encrypt){const c=await this.loadMembership(n);if(!c.cek.header)throw Ae("Unauthorized");const h=await this.decryptCEK(c.cek);i=await this.encryptMessage(e.message,h),s|=1}else i=e.message;const a=new re;a.add(Ni({channel:e.channel,membership:n,authority:this.provider.publicKey},{message:String.fromCharCode(s)+i}));let o;try{o=await this.provider.sendAndConfirm(a)}catch(c){throw(l=ce(c.code))!=null?l:c}return{signature:o}}}const St=t=>"***** *** *** *** *******",J=Le("messenger",()=>{const t=He(),e=_t(),n=Oe(),i=b(()=>e.keypair),s={allChannels:[],ownChannels:[],channel:void 0,channelAddr:void 0,channelMembershipAddr:void 0,channelMembership:void 0,channelMembers:[],channelMessages:[],channelLoading:!1,loading:!1,creating:!1,sending:!1},a=le({...s}),o=b(()=>{var y;return new Xi(new Mt(t.connection,(y=n.value)!=null?y:{publicKey:R.default},Mt.defaultOptions()),e.keypair)});let l=[];ue(n,y=>{y?g().then():v()},{immediate:!0}),ue([i,()=>a.allChannels],()=>{c().then()},{immediate:!0});async function c(){var N;const I=(await o.value.loadMemberships((N=e.keypair)==null?void 0:N.publicKey)).map(V=>({pubkey:V.data[0].channel.toBase58(),status:V.data[0].status.__kind}));a.ownChannels=I,console.log("myChannels ====== ",a.ownChannels)}async function h(){console.log("Register events...");for(const y of l)await o.value.removeEventListener(y);l.push(o.value.addEventListener("NewMessageEvent",async y=>{if(console.log("[Event] NewMessageEvent",y),`${y.channel}`!=`${a.channelAddr}`)return;let I=y.message.content;if(o.value.utils.message.isEncrypted(y.message)){const V=await U();V?I=await o.value.decryptMessage(y.message.content,V):I=St(y.message.content)}a.channelMessages.push({...y.message,content:I})})),l.push(o.value.addEventListener("AuthorizeMemberEvent",async y=>{console.log("[Event] AuthorizeMemberEvent",y),!(a.channelAddr&&`${y.channel}`!=`${a.channelAddr}`)&&(`${y.membership}`==`${a.channelMembershipAddr}`?S(a.channelAddr).then():L().then())})),l.push(o.value.addEventListener("JoinChannelEvent",async y=>{console.log("[Event] JoinChannelEvent",y),`${y.channel}`==`${a.channelAddr}`&&L().then()})),l.push(o.value.addEventListener("LeaveChannelEvent",async y=>{console.log("[Event] LeaveChannelEvent",y),`${y.channel}`==`${a.channelAddr}`&&L().then()}))}async function g(){v(),l=[],a.loading=!0;const y=await o.value.loadAllChannels();await h(),a.allChannels=y,a.loading=!1,console.log(a)}function v(){Object.assign(a,s)}async function C(y,I){var N,V;try{a.creating=!0,await o.value.initChannel({name:y,maxMessages:(N=I.maxMessages)!=null?N:15,public:I.public,permissionless:I.permissionless,opts:{commitment:(V=I.commitment)!=null?V:"confirmed"}}),await g()}finally{a.creating=!1}}async function w(y){const I=new R(y);await o.value.deleteChannel({channel:I,opts:{commitment:"confirmed"}}),await g()}async function _(y,I){const N=new R(y);try{await o.value.joinChannel({channel:N,name:I,opts:{commitment:"confirmed"}}),await S(y);const V={pubkey:y.toString(),status:"Pending"};a.ownChannels.push(V)}catch(V){console.log(V)}}async function S(y){var I,N,V,pe;a.channelLoading=!0,a.channelMessages=(I=a.channelMessages)!=null?I:[],a.channelMembers=(N=a.channelMembers)!=null?N:[],a.channelMembershipAddr=void 0,a.channelMembership=(V=a.channelMembership)!=null?V:void 0,a.channelAddr=new R(y);try{if((pe=n.value)!=null&&pe.publicKey)try{const[te]=await o.value.getMembershipPDA(a.channelAddr);a.channelMembershipAddr=te,a.channelMembership=await o.value.loadMembership(te)}catch(te){console.log(te),a.channelMembershipAddr=void 0,a.channelMembership=void 0}await L(),await P()}catch(te){console.log("Error",te)}finally{a.channelLoading=!1}}async function U(){if(!!a.channelMembership)try{return await o.value.decryptCEK(a.channelMembership.cek)}catch(y){console.log(y)}}async function P(){if(!a.channelAddr){console.log("Invalid channel");return}a.channel=await o.value.loadChannel(a.channelAddr);const I=o.value.utils.channel.isPublic(a.channel)?null:await U();a.channelMessages=await Promise.all(a.channel.messages.map(async N=>{var Ne;let pe=o.value.utils.message.isEncrypted(N)?St(N.content):N.content,te=Je(N.sender);if((Ne=n.value)!=null&&Ne.publicKey){const z=a.channelMembers.find(({data:Be})=>Be.name!==""&&(`${Be.authority}`==`${N.sender}`||`${Be.key}`==`${N.sender}`));z&&z.data.name!==""&&(te=z.data.name)}if(I)try{pe=await o.value.decryptMessage(N.content,I)}catch{console.log(`Failed to decrypt message #${N.id}`)}return{...N,senderDisplayName:te,content:pe}}))}async function L(){if(!a.channelAddr){console.error("Invalid channel");return}a.channelMembers=await F()}async function F(y=a.channelAddr){return await o.value.loadChannelMembers(y)}async function D(y){if(!a.channelAddr){console.log("Please select a channel");return}try{a.sending=!0;let I;a.channel&&(I=o.value.utils.channel.isPublic(a.channel)),await o.value.postMessage({channel:a.channelAddr,message:y,encrypt:!I}),await P()}finally{a.sending=!1}}async function E(y,I,N,V){if(!a.channelAddr){console.log("Invalid channel");return}await o.value.addMember({channel:a.channelAddr,invitee:new R(y),key:I?new R(I):void 0,name:N,flags:V,opts:{commitment:"confirmed"}})}async function k(y){if(!a.channelAddr){console.log("Invalid channel");return}await o.value.deleteMember({channel:a.channelAddr,key:new R(y),opts:{commitment:"finalized"}})}async function B(y){if(!a.channelAddr){console.log("Invalid channel");return}await o.value.authorizeMember({channel:a.channelAddr,key:new R(y)}),await Me()}async function x(){await g()}async function Me(){a.channelMembers=await F()}async function ot(y){a.channelAddr=y}return{state:a,client:o.value,loadChannel:S,joinChannel:_,createChannel:C,deleteChannel:w,postMessage:D,addMember:E,deleteMember:k,authorizeMember:B,refreshList:x,loadMembers:F,selectChannel:ot}}),he=Le("channel",()=>{const t=Oe(),{state:e,client:n}=J(),i=b(()=>e.channelLoading),s=b(()=>e.sending),a=b(()=>{var k;return!!((k=t.value)!=null&&k.publicKey)}),o=b(()=>!!e.channel&&n.utils.channel.isPublic(e.channel)),l=b(()=>!!e.channel&&n.utils.channel.isPermissionless(e.channel)),c=b(()=>{var k;return((k=e.channelMembership)==null?void 0:k.status.__kind)==="Authorized"}),h=b(()=>{var k;return((k=e.channelMembership)==null?void 0:k.status.__kind)==="Pending"}),g=b(()=>{var k,B,x;return String((k=e.channel)==null?void 0:k.creator)===String((x=(B=t.value)==null?void 0:B.publicKey)!=null?x:"-")}),v=b(()=>!!e.channelMembership&&n.utils.member.canAddMember(e.channelMembership)),C=b(()=>!!e.channelMembership&&n.utils.member.canAuthorizeMember(e.channelMembership)),w=b(()=>!!e.channelMembership&&n.utils.member.canDeleteMember(e.channelMembership)),_=b(()=>!!e.channelMembership&&n.utils.member.isAdmin(e.channelMembership)),S=b(()=>!!e.channelMembership&&n.utils.member.isOwner(e.channelMembership)),U=b(()=>a.value&&!!e.channel&&!e.loading&&!c.value),P=b(()=>a.value),L=b(()=>S.value),F=b(()=>S.value),D=b(()=>!e.sending&&(o.value||c.value));return{ownChannels:b(()=>e.allChannels.filter(k=>{var B;return!!e.ownChannels.find(x=>x.pubkey===k.pubkey.toBase58())||k.data.flags===1||k.data.creator.toBase58()===String((B=t.value)==null?void 0:B.publicKey)})),isChannelLoading:i,isSendMessage:s,isPublicChannel:o,isWalletConnected:a,isPermissionlessChannel:l,isAuthorizedMember:c,isPendingMember:h,isChannelCreator:g,isAdmin:_,isOwner:S,canJoinChannel:U,canAddMember:v,canAuthorizeMember:C,canDeleteMember:w,canCreateChannel:P,canDeleteChannel:L,canGrantAccess:F,canPostMessage:D}}),Yi={class:"text-weight-medium wallet"},Zi={class:"memberlist-info__details"},eo=m("span",null,"Authority:",-1),to={class:"memberlist-info__details"},no=m("span",null,"Key:",-1),ao={class:"memberlist-btns"},so=W({__name:"MemberListDialog",props:{membersDialog:{type:Boolean,default:!1},authorizeMemberState:{type:Object},deleteMemberState:{type:Object},wallet:{type:Object}},emits:["submit","deleteMember"],setup(t,{emit:e}){const{state:n}=J(),i=he(),s=l=>l==="Pending"&&i.canAuthorizeMember;function a(l){return String(l).toLowerCase()}const o=l=>{var c;return((c=n.channel)==null?void 0:c.creator.toBase58())===l};return(l,c)=>(f(),M(oe,{class:"memberlist"},{default:u(()=>[r(Z,{square:"",flat:"",horizontal:""},{default:u(()=>[r(q,{class:"q-px-lg"},{default:u(()=>[$(" MEMBERS ")]),_:1}),r(q,{class:"memberlist-card"},{default:u(()=>[r(ye,{separator:""},{default:u(()=>[(f(!0),A(Q,null,Y(d(n).channelMembers,h=>(f(),M(X,{key:h.pubkey.toString(),"active-class":"owner",active:`${h.pubkey}`==`${d(n).channelMembershipAddr}`,class:"memberlist-item"},{default:u(()=>[r(G,{class:"memberlist-info"},{default:u(()=>[r(Ee,{class:"row"},{default:u(()=>[m("span",Yi,T(d(zt)(h.data)),1),r(kn,{class:ze([a(h.data.status.__kind),"memberlist-status q-pa-xs q-ml-lg"])},{default:u(()=>[$(T(h.data.status.__kind),1)]),_:2},1032,["class"])]),_:2},1024),r(Ee,{caption:"",lines:"2"},{default:u(()=>[m("div",Zi,[eo,m("span",null,T(h.data.authority),1)]),m("div",to,[no,m("span",null,T(h.data.key),1)])]),_:2},1024)]),_:2},1024),m("div",ao,[s(h.data.status.__kind)?(f(),M(K,{key:0,color:"positive",size:"sm",unelevated:"",class:"full-width",loading:t.authorizeMemberState.loading,disabled:t.authorizeMemberState.loading,onClick:g=>l.$emit("submit",h.data.key)},{default:u(()=>[$(" Authorize ")]),_:2},1032,["loading","disabled","onClick"])):ie("",!0),d(i).canDeleteMember&&!o(h.data.authority.toBase58())?(f(),M(K,{key:1,color:"negative",size:"sm",unelevated:"",class:"full-width",loading:t.deleteMemberState.loading,disabled:t.deleteMemberState.loading,onClick:g=>l.$emit("deleteMember",h.data.key)},{default:u(()=>[$(" Delete ")]),_:2},1032,["loading","disabled","onClick"])):ie("",!0)])]),_:2},1032,["active"]))),128))]),_:1})]),_:1})]),_:1})]),_:1}))}}),io=m("br",null,null,-1),oo=W({__name:"JoinChennalModal",emits:["join"],setup(t,{emit:e}){const n=O("");return(i,s)=>(f(),M(oe,null,{default:u(()=>[r(Z,{square:"",flat:""},{default:u(()=>[r(q,{class:"text-body1"},{default:u(()=>[$(" Join Channel ")]),_:1}),r(q,{class:"text-body1 text-blue-grey-8"},{default:u(()=>[r(Fe,{class:"join-channel-form",onSubmit:s[1]||(s[1]=yt(a=>i.$emit("join",n.value),["prevent"]))},{default:u(()=>[r(se,{modelValue:n.value,"onUpdate:modelValue":s[0]||(s[0]=a=>n.value=a),label:"Member name *","lazy-rules":"",rules:[a=>a&&a.length>2||"Please type something"]},null,8,["modelValue","rules"]),io,r(K,{type:"submit",class:"dialog-submit-btn","text-color":"black",ripple:!1,square:""},{default:u(()=>[$(" Join Channel ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}});const lo=W({props:{text:{type:String,default:""},padding:{type:String,default:"0"}}});const ro=["innerHTML"];function co(t,e,n,i,s,a){return f(),M(Dt,{class:"bg-white text-primary shadow-1 custom-tooltip",style:{"border-radius":"0"},anchor:"top middle",self:"bottom middle"},{default:u(()=>[m("div",{style:je({fontSize:"11px",padding:`${t.padding}`}),innerHTML:t.text},null,12,ro)]),_:1})}const st=ee(lo,[["render",co]]),uo=t=>(Ie("data-v-157586e8"),t=t(),Ke(),t),mo=uo(()=>m("span",{class:"text-blue-grey-8 q-pb-xs"},"Search by name or address",-1)),ho={class:"search-block"},po={class:"channel-info text-weight-medium"},fo={class:"channel-info"},go={key:0,class:"already-in-chat"},bo={class:"control-btns"},yo=W({__name:"JoinChannelDialog",props:{loading:{type:Boolean},defaultState:Object},emits:["submit","reset"],setup(t,{emit:e}){const n=t;O(n.defaultState);const{state:i,selectChannel:s,refreshList:a}=J(),o=he(),l=O(!1),c=O(""),h=O([]),g=b(()=>i.allChannels.filter(P=>P.data.flags===0||P.data.flags===2)),v=b(()=>i.loading),C=P=>P.name.slice(0,2),w=()=>{if(c.value===""){h.value=[],c.value="";return}h.value=g.value.filter(P=>P.data.name.toLocaleLowerCase().includes(c.value.toLocaleLowerCase())||P.pubkey.toBase58().toLocaleLowerCase().includes(c.value.toLocaleLowerCase()))},_=b(()=>{var P;return((P=c.value)==null?void 0:P.length)>0?h.value:g.value}),S=P=>{e("submit",P)};ue(c,()=>{w()}),ue(()=>n.loading,P=>{P&&(l.value=!1)});const U=P=>o.ownChannels.find(L=>String(L.pubkey)===String(P.pubkey));return(P,L)=>{const F=st,D=oo;return f(),M(oe,{class:"join-channel-dialog",onHide:L[3]||(L[3]=E=>P.$emit("reset"))},{default:u(()=>[r(Z,{square:"",flat:""},{default:u(()=>[r(q,{class:"text-body1 text-blue-grey-8"},{default:u(()=>[$(" Join channel ")]),_:1}),r(q,{class:"q-py-none"},{default:u(()=>[mo,m("div",ho,[r(se,{modelValue:c.value,"onUpdate:modelValue":L[0]||(L[0]=E=>c.value=E),class:"input no-margin q-pa-none",placeholder:"Search ...",borderless:"",dense:"",debounce:"300"},null,8,["modelValue"])])]),_:1}),r(q,null,{default:u(()=>[d(_).length?(f(),M(ye,{key:0,bordered:"",separator:"",class:"privat-channels"},{default:u(()=>[(f(!0),A(Q,null,Y(d(_),E=>fe((f(),M(X,{key:E,"active-class":"bg-blue-grey-8 text-white",class:"privat-channels-item",active:`${d(i).channelAddr}`==`${E.pubkey}`,clickable:"",onClick:k=>d(s)(E.pubkey)},{default:u(()=>[m("div",{class:"chat-avatar",style:je(d(Nt)(`${E.pubkey}`))},[m("span",null,T(C(E.data)),1)],4),r(G,null,{default:u(()=>[m("span",po,T(E.data.name),1),m("span",fo,T(E.pubkey),1)]),_:2},1024),U(E)?(f(),A("div",go,[r(F,{text:"already in channel"}),r(d(Sn),{size:"18"})])):ie("",!0)]),_:2},1032,["active","onClick"])),[[xn]])),128))]),_:1})):(f(),M(X,{key:1,class:"privat-channels justify-center items-center text-blue-grey-5"},{default:u(()=>[$(" Channels not found ")]),_:1}))]),_:1}),m("div",bo,[r(K,{class:ze(["control-button",{"refresh-btn":d(v)}]),square:"",flat:"",disable:!d(i).channelAddr,onClick:d(a)},{default:u(()=>[r(d(Lt),{style:{color:"#fff"}}),r(F,{text:"Refresh channels"})]),_:1},8,["disable","class","onClick"]),r(K,{class:"control-button",square:"",flat:"",disable:!d(i).channelAddr,onClick:L[1]||(L[1]=E=>l.value=!0)},{default:u(()=>[r(d($n),{style:{color:"#fff"}}),r(F,{text:"Request to join"})]),_:1},8,["disable"]),r(D,{modelValue:l.value,"onUpdate:modelValue":L[2]||(L[2]=E=>l.value=E),onJoin:S},null,8,["modelValue"])]),r(Qe,{showing:t.loading},null,8,["showing"])]),_:1})]),_:1})}}});const _o=ee(yo,[["__scopeId","data-v-157586e8"]]),vo=t=>(Ie("data-v-e91edd23"),t=t(),Ke(),t),wo=vo(()=>m("br",null,null,-1)),Co=W({__name:"AddMemberDialog",props:{loading:{type:Boolean,default:!1},defaultState:Object},emits:["submit","reset"],setup(t,{emit:e}){const i=O(t.defaultState),s=()=>e("submit",i.value);return(a,o)=>(f(),M(oe,{class:"add-member-dialog",onHide:o[3]||(o[3]=l=>a.$emit("reset"))},{default:u(()=>[r(Z,{square:"",flat:""},{default:u(()=>[r(q,null,{default:u(()=>[r(Fe,{class:"add-member-form",onSubmit:yt(s,["prevent"])},{default:u(()=>[r(se,{modelValue:i.value.name,"onUpdate:modelValue":o[0]||(o[0]=l=>i.value.name=l),label:"Member name *",hint:"Min length 3 chars","lazy-rules":"",rules:[l=>l&&l.length>2||"Please type something"]},null,8,["modelValue","rules"]),r(se,{modelValue:i.value.wallet,"onUpdate:modelValue":o[1]||(o[1]=l=>i.value.wallet=l),label:"Member Wallet *","lazy-rules":"",rules:[l=>l&&l.length>32||"Invalid public key"]},null,8,["modelValue","rules"]),r(se,{modelValue:i.value.key,"onUpdate:modelValue":o[2]||(o[2]=l=>i.value.key=l),label:"Member Device Key",hint:"Default: The same as member wallet","lazy-rules":"",rules:[l=>!l||l.length>32||"Invalid public key"]},null,8,["modelValue","rules"]),wo,r(K,{type:"submit",class:"dialog-submit-btn","text-color":"black",ripple:!1,square:"",flat:""},{default:u(()=>[$(" Add Member ")]),_:1})]),_:1},8,["onSubmit"]),r(Qe,{showing:t.loading},null,8,["showing"])]),_:1})]),_:1})]),_:1}))}});const Mo=ee(Co,[["__scopeId","data-v-e91edd23"]]),Ot="/assets/info.bfade5eb.svg",Ao={class:"row q-mt-md relative-position",style:{height:"42px"}},ko={class:"toggle-info"},So=m("img",{src:Ot,alt:"info"},null,-1),xo={key:0,class:"row text-primary toggle-approve"},$o={class:"toggle-info"},Eo=m("img",{src:Ot,alt:"info"},null,-1),Do=W({__name:"NewChannelDialog",props:{loading:{type:Boolean,default:!1},defaultState:Object},emits:["submit","reset"],setup(t,{emit:e}){const i=O(t.defaultState),s=()=>e("submit",i);return(a,o)=>{const l=st;return f(),M(oe,{class:"new-channel-dialog",onHide:o[4]||(o[4]=c=>a.$emit("reset"))},{default:u(()=>[r(Z,{square:"",flat:""},{default:u(()=>[r(q,null,{default:u(()=>[r(Fe,{class:"messenger-new-channel-form",onSubmit:s},{default:u(()=>[r(se,{modelValue:i.value.name,"onUpdate:modelValue":o[0]||(o[0]=c=>i.value.name=c),label:"Channel name *","lazy-rules":"",maxlength:"32",rules:[c=>c&&c.length>2||"Please type something"]},null,8,["modelValue","rules"]),r(se,{modelValue:i.value.maxMessages,"onUpdate:modelValue":o[1]||(o[1]=c=>i.value.maxMessages=c),label:"Max messages","lazy-rules":"",rules:[c=>+c>0||"Invalid value"]},null,8,["modelValue","rules"]),m("div",Ao,[m("div",ko,[r(l,{text:d(kt)[0],padding:"8px"},null,8,["text"]),So]),m("div",{class:ze(["col text-primary",{"toggle-border":!i.value.public}])},[$(" Private"),r(At,{modelValue:i.value.public,"onUpdate:modelValue":o[2]||(o[2]=c=>i.value.public=c),label:"Public"},null,8,["modelValue"])],2),i.value.public?ie("",!0):(f(),A("div",xo,[r(At,{modelValue:i.value.permissionless,"onUpdate:modelValue":o[3]||(o[3]=c=>i.value.permissionless=c)},null,8,["modelValue"]),m("span",null,[m("div",$o,[r(l,{text:d(kt)[1],padding:"8px"},null,8,["text"]),Eo]),$(" Members can approve")])]))]),r(K,{type:"submit",class:"dialog-submit-btn q-mt-md","text-color":"black",ripple:!1,square:"",flat:""},{default:u(()=>[$(" Create the Channel ")]),_:1})]),_:1}),r(Qe,{showing:t.loading},null,8,["showing"])]),_:1})]),_:1})]),_:1})}}});const Po=W({__name:"ChannelForm",props:{message:{type:String,default:""},disabled:{type:Boolean,default:!1},sending:{type:Boolean,default:!1}},emits:["submit"],setup(t,{emit:e}){const i=O(t.message),s=()=>{e("submit",i),i.value=""};return(a,o)=>(f(),M(Fe,{class:"channel-form",onSubmit:yt(s,["prevent"])},{default:u(()=>[r(En,{class:"row message-control"},{default:u(()=>[r(se,{ref:"inputFocus",modelValue:i.value,"onUpdate:modelValue":o[0]||(o[0]=l=>i.value=l),class:"col-grow message-input",placeholder:"Type a message",dense:"",borderless:"",autofocus:"",disable:t.disabled},null,8,["modelValue","disable"]),r(K,{class:"send-btn",square:"",flat:"",type:"submit",disable:t.disabled,loading:t.sending},{default:u(()=>[$(" Send ")]),_:1},8,["disable","loading"])]),_:1})]),_:1},8,["onSubmit"]))}});const Io=ee(Po,[["__scopeId","data-v-bb5ae488"]]),Ko="/assets/solana-logo.3caace62.svg",vt=t=>(Ie("data-v-a765a3c1"),t=t(),Ke(),t),Lo={class:"messenger-content"},To={key:0,class:"preloader"},zo={key:1,class:"messenger-empty"},No={key:2,class:"messenger-empty"},Bo=vt(()=>m("img",{src:Ko,alt:"logo"},null,-1)),Wo=vt(()=>m("span",{name:"connect"},"Please connect a wallet",-1)),Ro=[Bo,Wo],Vo={key:3,class:"messenger-empty"},qo=vt(()=>m("span",{name:"select"},"Please select a channel",-1)),Oo=[qo],Uo=W({__name:"ChannelWrapper",props:{postMessageState:{type:Object}},emits:["sendMessage"],setup(t,{emit:e}){const n=_e(),{state:i}=J(),s=he();function a(v){const C=n.publicKey.value;return C?String(C)!==String(v):!0}const o=b(()=>{const v=[];let C=0,w;for(const _ of i.channelMessages)w&&`${_.sender}`==`${w}`?v[C-1].text.push(_.content):(w=_.sender,v.push({id:_.id,sender:_.sender,senderDisplayName:_.senderDisplayName,text:[_.content],date:_.createdAt}),C++);return v}),l=b(()=>s.canPostMessage),c=v=>e("sendMessage",v),h=O(),g=O();return ue(g,v=>{v&&(h.value.scrollTop=v.scrollHeight)}),(v,C)=>{const w=Io;return f(),M(Z,{class:"messenger-card",square:"",flat:""},{default:u(()=>[m("div",Lo,[d(s).isChannelLoading?(f(),A("div",To,[r(Dn,{color:"primary",size:"2em"})])):d(i).channel?(f(),A("div",{key:1,ref_key:"chat",ref:h,class:"row justify-center channel-wrapper"},[d(o).length>0?(f(),A("div",{key:0,ref_key:"mes",ref:g,class:"messenger-messages"},[(f(!0),A(Q,null,Y(d(o),_=>(f(),M(Pn,{key:_.id,name:_.senderDisplayName,text:_.text,sent:a(_.sender)},null,8,["name","text","sent"]))),128))],512)):(f(),A("div",zo," No messages "))],512)):d(s).isWalletConnected?(f(),A("div",Vo,Oo)):(f(),A("div",No,Ro))]),r(w,{message:t.postMessageState.message,sending:d(s).isSendMessage,disabled:!d(l),onSubmit:c},null,8,["message","sending","disabled"])]),_:1})}}});const Fo=ee(Uo,[["__scopeId","data-v-a765a3c1"]]),jo=15;async function it(){const{balance:t}=_t();return await t>0}function Qo(){const{createChannel:t}=J(),{isWalletConnected:e,ok:n,error:i,custom:s}=Ce(),a=le({dialog:!1,name:"",maxMessages:jo,public:!1,permissionless:!1,loading:!1});async function o(){if(e())try{if(!await it()){s("You don't have enough SOL on your balance");return}await t(a.name,{maxMessages:a.maxMessages,public:a.public,permissionless:a.permissionless}),l(),n("Channel was created!")}catch(c){i("Something went wrong"),console.log(c)}}function l(){a.dialog=!1,a.public=!1,a.loading=!1,a.name="",a.maxMessages=15}return{state:a,submit:o,reset:l}}function Jo(){const t=J(),{info:e,ok:n,error:i}=Ce(),s=le({loading:!1});async function a(){if(!t.state.channelAddr){e("Please select a channel");return}try{console.log(await it()),s.loading=!0,await t.deleteChannel(t.state.channelAddr),n("Channel was deleted!")}catch(o){console.log("Error",o),i("Something went wrong")}finally{s.loading=!1}}return{state:s,submit:a}}function Ut(){const{authorizeMember:t,loadChannel:e,state:n}=J(),{ok:i,error:s}=Ce(),a=le({loading:!1,dialog:!1});async function o(l){var c;try{a.loading=!0,await t(l),await e((c=n.channelAddr)!=null?c:""),i("Member was authorized")}catch(h){s("Something went wrong"),console.log(h)}finally{a.loading=!1}}return{state:a,submit:o}}function Go(){const{state:t,addMember:e}=J(),{ok:n,info:i,error:s,custom:a}=Ce(),o=le({dialog:!1,loading:!1});async function l(h){if(o.loading=!0,!t.channelAddr){i("Please select a channel");return}try{if(!await it()){a("You don't have enough SOL on your balance");return}return await e(h.wallet,h.key,h.name),n("Member was added"),!0}catch(g){s("Something went wrong"),console.log(g)}finally{o.loading=!1,o.dialog=!1}return!1}function c(){o.loading=!1,o.dialog=!1}return{state:o,submit:l,reset:c}}function Ft(){const{deleteMember:t,loadChannel:e,state:n}=J(),{ok:i,error:s}=Ce(),a=le({loading:!1});async function o(l){var c;try{a.loading=!0,await t(l),await e((c=n.channelAddr)!=null?c:""),i("Member was deleted")}catch(h){s("Something went wrong"),console.log(h)}finally{a.loading=!1}}return{state:a,submit:o}}function Ho(){const{state:t,joinChannel:e}=J(),{ok:n,info:i,error:s,custom:a}=Ce(),o=le({dialog:!1,loading:!1,name:""});async function l(){if(!t.channelAddr){i("Please select a channel");return}o.loading=!0;try{if(!await it()){a("You don't have enough SOL on your balance");return}await e(t.channelAddr,o.name),c(),n("Request was sent")}catch(h){console.log("Error",h),s("Something went wrong")}finally{o.loading=!1}}function c(){o.loading=!1,o.dialog=!1,o.name=""}return{state:o,submit:l,reset:c}}function Ce(){const t=_e(),{notify:e}=Pe(),n=l=>e({type:"positive",message:l,timeout:2e3}),i=l=>e({type:"info",message:l,timeout:2e3}),s=l=>e({type:"negative",message:l,timeout:2e3}),a=l=>e({type:"warning",message:l,position:"top"});function o(){return t.publicKey.value?!0:(i("Please connect wallet"),!1)}return{ok:n,info:i,error:s,custom:a,isWalletConnected:o}}const Xo=W({__name:"ChannelControl",props:{isLoading:{type:Boolean}},emits:["createChannel","joinChannel","refreshList"],setup(t,{emit:e}){const n=he();Ce();const{notify:i}=Pe();b(()=>n.isPendingMember),b(()=>n.canCreateChannel);const s=a=>{if(!n.isWalletConnected){i({message:"Please connect wallet",color:"negative",position:"top"});return}e(a)};return(a,o)=>{const l=st;return f(),M(X,null,{default:u(()=>[r(G,{class:"button-wrapper"},{default:u(()=>[r(K,{class:ze(["control-button",{"refresh-btn":t.isLoading}]),square:"",flat:"",onClick:o[0]||(o[0]=c=>s("refreshList"))},{default:u(()=>[r(d(Lt),{style:{color:"#fff"}}),r(l,{text:"Refresh channels"})]),_:1},8,["class"]),r(K,{class:"control-button",square:"",flat:"",onClick:o[1]||(o[1]=c=>s("createChannel"))},{default:u(()=>[r(d(In),{style:{color:"#fff"}}),r(l,{text:"Create a channel"})]),_:1}),r(K,{class:"control-button",square:"",flat:"",onClick:o[2]||(o[2]=c=>s("joinChannel"))},{default:u(()=>[r(d(Kn),{style:{color:"#fff"}}),r(l,{text:"Browse channels"})]),_:1})]),_:1})]),_:1})}}});const Yo=ee(Xo,[["__scopeId","data-v-03d9bcd0"]]),Zo={class:"chat-name"},el={key:0,class:"message-public"},tl={key:1,class:"pending-icon"},nl=W({__name:"MessengerChannel",props:{pubkey:{type:Object,required:!0},channel:{type:Object,required:!0},isActive:Boolean},emits:["select"],setup(t){const e=t,{state:n}=J(),i=b(()=>{var l;return(l=n.ownChannels.find(c=>c.pubkey===e.pubkey.toString()))==null?void 0:l.status}),s=b(()=>i.value==="Pending"),a=b(()=>e.channel.name.slice(0,2)),o=b(()=>e.channel.flags===1);return(l,c)=>{const h=st;return f(),M(X,{"active-class":"bg-blue-grey-8 text-white",style:{"min-height":"42px"},active:t.isActive},{default:u(()=>[r(G,{class:"chat-item cursor-pointer",onClick:c[0]||(c[0]=g=>l.$emit("select"))},{default:u(()=>[m("div",{class:"chat-badge",style:je(d(Nt)(`${t.pubkey}`))},[m("span",null,T(d(a)),1)],4),m("div",Zo,T(t.channel.name),1),d(o)?(f(),A("div",el,[r(h,{text:"Public channel"}),$(" P ")])):ie("",!0),d(s)?(f(),A("div",tl,[r(h,{text:"waiting for confirmation"}),r(Ln,{color:"primary",size:"16px"})])):ie("",!0)]),_:1})]),_:1},8,["active"])}}});const al=ee(nl,[["__scopeId","data-v-d398a652"]]),sl=m("div",{class:"text-h5"}," Channels ",-1),il={class:"text-weight-medium"},ol={class:"memberlist-info__details"},ll=m("span",null,"Authority:",-1),rl={class:"memberlist-info__details"},cl=m("span",null,"Key:",-1),ul=W({__name:"PendingUsersDialog",props:{pendingChannels:Object},setup(t){O(!1);const{state:e}=J(),n=Ut(),i=Ft(),s=async(c,h)=>{e.channelAddr=h,await n.submit(c)},a=async(c,h)=>{e.channelAddr=h,await i.submit(c)},o=b(()=>n.state.loading),l=b(()=>i.state.loading);return(c,h)=>(f(),M(oe,null,{default:u(()=>[r(Z,{class:"pending-channels",square:"",flat:"",horizontal:""},{default:u(()=>[r(q,null,{default:u(()=>[sl]),_:1}),r(q,null,{default:u(()=>[r(ye,{bordered:""},{default:u(()=>[(f(!0),A(Q,null,Y(t.pendingChannels,(g,v)=>(f(),M(Tn,{key:g.name,"expand-separator":"",label:g.channel.data.name,caption:"channel","default-opened":v===0,"header-class":"owner"},{default:u(()=>[r(ye,{separator:""},{default:u(()=>[(f(!0),A(Q,null,Y(g.pendingMembers,C=>(f(),M(X,{key:C,class:"row justify-between pending-item"},{default:u(()=>[r(G,{class:"memberlist-info"},{default:u(()=>[r(Ee,{class:"row justify-between"},{default:u(()=>[m("span",il,T(d(zt)(C.data)),1)]),_:2},1024),r(Ee,{caption:"",lines:"2"},{default:u(()=>[m("div",ol,[ll,m("span",null,T(C.data.authority),1)]),m("div",rl,[cl,m("span",null,T(C.data.key),1)])]),_:2},1024)]),_:2},1024),r(G,{side:"",class:"memberlist-btns"},{default:u(()=>[r(K,{color:"teal",size:"xs",unelevated:"",class:"full-width",loading:d(o),disabled:d(o),onClick:w=>s(C.data.key,g.channel.pubkey)},{default:u(()=>[$(" Authorize ")]),_:2},1032,["loading","disabled","onClick"]),r(K,{color:"negative",size:"xs",unelevated:"",class:"full-width",loading:d(l),disabled:d(l),onClick:w=>a(C.data.key,g.channel.pubkey)},{default:u(()=>[$(" Delete ")]),_:2},1032,["loading","disabled","onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1032,["label","default-opened"]))),128))]),_:1})]),_:1})]),_:1})]),_:1}))}});const dl={class:"bell",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",fill:"none","xmlns:v":"https://vecta.io/nano"},ml=["fill"],hl=W({__name:"iconBell",props:{color:{type:String,default:"AABEC8"}},setup(t){return(e,n)=>(f(),A("svg",dl,[m("path",{d:"M5.352 14.359h3.294c0 .821-.59 1.641-1.647 1.641s-1.647-.82-1.647-1.641zm8.434-3.467l-.911-1.515a3.68 3.68 0 0 1-.527-1.897V5.325C12.348 2.389 9.949 0 7 0S1.651 2.389 1.651 5.325v2.155a3.68 3.68 0 0 1-.527 1.897l-.911 1.515c-.278.461-.285 1.018-.018 1.487s.749.749 1.29.749h11.03a1.47 1.47 0 0 0 1.291-.749 1.46 1.46 0 0 0-.021-1.487z",fill:`#${t.color}`},null,8,ml)]))}}),jt=Le("notifications",()=>{const t=Oe(),{loadMembers:e,state:n}=J(),i=he(),s=le({showInfo:!1,showDialog:!1,pendingChannels:[]});ue([()=>i.ownChannels,()=>n.channelMembers],async(o,l)=>{l.length>0&&await a(l[0])});async function a(o){try{const l=await Promise.all(o.map(async c=>{var v;const{pubkey:h,data:g}=c;if(g.creator.toBase58()===((v=t.value)==null?void 0:v.publicKey.toBase58())){const C=await e(h);if(C.length===0)return;const w=C.filter(_=>_.data.status.__kind==="Pending");return w.length?{channel:c,pendingMembers:w}:void 0}}));s.pendingChannels=l.filter(c=>c),s.pendingChannels.length>0?(setTimeout(()=>s.showInfo=!0,2e3),setTimeout(()=>s.showInfo=!1,7e3)):s.showDialog=!1}catch(l){console.log(l)}}return{state:s}});function pl(){const{state:t}=jt();return{showDialog:b(()=>t.showDialog),showInfo:b(()=>t.showInfo),pendingChannels:b(()=>t.pendingChannels)}}const fl={class:"panel-notifications__info"},gl=W({__name:"MessengerNotification",setup(t){const{pendingChannels:e,showInfo:n,showDialog:i}=pl(),{state:s}=jt(),a=b(()=>{var h,g;return(g=(h=e.value)==null?void 0:h.length)!=null?g:0}),o=b(()=>a.value>0),l=b(()=>n.value?"width: 100%; padding-right: 14px":"width: 0; padding-right: 0;"),c=()=>{!o.value||(s.showDialog=!s.showDialog)};return(h,g)=>{const v=hl,C=ul;return f(),A("div",{class:ze(["panel-notifications",{"has-notifications":d(o)}]),onClick:c},[m("div",fl,[r(v,{class:"ring",color:d(o)?"FF5C5C":"AABEC8"},null,8,["color"]),m("span",null,T(a.value),1)]),m("div",{ref:"notificationsInfo",class:"panel-notifications__details",style:je(d(l))}," channels are awaiting user confirmation ",4),r(C,{modelValue:d(s).showDialog,"onUpdate:modelValue":g[0]||(g[0]=w=>d(s).showDialog=w),"pending-channels":d(e),onCloseDialog:g[1]||(g[1]=w=>h.isShow.value=!1)},null,8,["modelValue","pending-channels"])],2)}}});const bl={class:"panel-toolbar"},yl={class:"panel-search"},_l={class:"search-wrapper"},vl={class:"panel-info"},wl={class:"chat-info"},Cl={class:"chat-members"},Ml={class:"chat-messages"},Al={class:"chat-name"},kl={key:0,class:"members-count bg-cyan-9"},Sl=W({__name:"MessengerToolbar",emits:["search","showMembers","deleteChannel","addMember","showDeviceKey"],setup(t,{emit:e}){const n=_e(),{state:i}=J(),s=he(),a=b(()=>!!n.publicKey.value),o=O(""),l=b(()=>i.channel),c=b(()=>{var _,S,U;return((_=l.value)==null?void 0:_.memberCount)===null||((S=l.value)==null?void 0:S.memberCount)===void 0?"":`${(U=l.value)==null?void 0:U.memberCount}\xA0members`}),h=b(()=>{var _,S,U;return((_=l.value)==null?void 0:_.messageCount)===null||((S=l.value)==null?void 0:S.messageCount)===void 0?"":`${(U=l.value)==null?void 0:U.messageCount}\xA0messages`}),g=_=>e("search",_),v=()=>e("showMembers"),C=()=>e("addMember"),w=b(()=>{if(!(!s.isOwner||!s.isAdmin))return i.channelMembers.filter(_=>_.data.status.__kind==="Pending").length});return ue(o,_=>{g(String(_))}),(_,S)=>{var P;const U=gl;return f(),A("div",bl,[r(U),m("div",yl,[m("div",_l,[r(se,{modelValue:o.value,"onUpdate:modelValue":S[0]||(S[0]=L=>o.value=L),class:"search-input no-margin q-pa-none",placeholder:"Search ...",clearable:"",debounce:"300",borderless:"",onClear:S[1]||(S[1]=L=>o.value="")},null,8,["modelValue"])])]),m("div",vl,[m("div",wl,[m("div",Cl,T(d(c)),1),m("div",Ml,T(d(h)),1)]),r(bt,{class:""}),m("div",Al,T((P=d(l))==null?void 0:P.name),1),m("div",null,[r(K,{class:"chat-menu",flat:"",square:"",disable:!d(a)},{default:u(()=>[r(d(zn),{size:"18"}),r(Nn,{anchor:"bottom middle",self:"top middle"},{default:u(()=>[r(ye,{style:{"min-width":"120px"},bordered:""},{default:u(()=>[fe((f(),M(X,{class:"q-my-sm q-mx-sm q-pa-none chat-menu__item",clickable:"",onClick:S[2]||(S[2]=L=>_.$emit("showDeviceKey"))},{default:u(()=>[r(G,{class:"q-pa-none"},{default:u(()=>[r(K,{flat:"",square:"",size:"sm",class:"bg-blue-grey-7 text-white q-px-xs"},{default:u(()=>[$(" Device key ")]),_:1})]),_:1})]),_:1})),[[$e]]),fe((f(),M(X,{class:"q-my-sm q-mx-sm q-pa-none chat-menu__item relative-position",clickable:"",disable:!d(l),onClick:v},{default:u(()=>[r(G,null,{default:u(()=>[d(w)>0?(f(),A("div",kl,T(d(w)),1)):ie("",!0),r(K,{flat:"",square:"",size:"sm",class:"bg-cyan-9 text-white q-px-xs"},{default:u(()=>[$(" Members ")]),_:1})]),_:1})]),_:1},8,["disable"])),[[$e]]),fe((f(),M(X,{class:"q-my-sm q-mx-sm q-pa-none chat-menu__item",clickable:"",disable:!d(s).canAddMember,onClick:C},{default:u(()=>[r(G,null,{default:u(()=>[r(K,{flat:"",square:"",size:"sm",class:"bg-amber-7 text-white q-px-xs"},{default:u(()=>[$(" Add member ")]),_:1})]),_:1})]),_:1},8,["disable"])),[[$e]]),fe((f(),M(X,{class:"q-my-sm q-mx-sm q-pa-none chat-menu__item",clickable:"",disable:!d(s).isChannelCreator,onClick:S[3]||(S[3]=L=>_.$emit("deleteChannel"))},{default:u(()=>[r(G,null,{default:u(()=>[r(K,{flat:"",square:"",size:"sm",class:"bg-negative text-white q-px-xs"},{default:u(()=>[$(" Delete ")]),_:1})]),_:1})]),_:1},8,["disable"])),[[$e]])]),_:1})]),_:1})]),_:1},8,["disable"])])])])}}});const xl={class:"col col-4"},$l={class:"col"},El={class:"no-margin"},Dl=W({__name:"DebugBtn",setup(t){const{state:e}=J(),{isAuthorizedMember:n,isPendingMember:i,isChannelCreator:s}=he(),a=O(!1),o=Bn(a);return(l,c)=>(f(),A(Q,null,[r(K,{flat:"",class:"text-blue-2",onClick:c[0]||(c[0]=h=>d(o)())},{default:u(()=>[$(" Debug info ")]),_:1}),r(oe,{modelValue:a.value,"onUpdate:modelValue":c[1]||(c[1]=h=>a.value=h)},{default:u(()=>[r(Z,null,{default:u(()=>[r(q,null,{default:u(()=>[(f(!0),A(Q,null,Y([["Authorized",d(n)],["Pending Access",d(i)],["Channel Creator",d(s)],["Channel",d(e).channel],["Membership",d(e).channelMembership],["Members",d(e).channelMembers]],h=>(f(),A("div",{key:h[0],class:"row q-mt-md"},[m("div",xl,T(h[0]),1),m("div",$l,[m("pre",El,T(h[1]),1)])]))),128))]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}}),Pl={class:"messenger-wrapper"},Il={class:"messenger-main"},Kl={key:1,class:"messenger-channels-empty"},Ll={key:0,class:"q-my-md q-px-lg"},Tl=W({__name:"Messenger",setup(t){const e=_e(),{state:n,postMessage:i,loadChannel:s,refreshList:a}=J(),o=he(),l=Qo(),c=Ho(),h=Go(),g=Ut(),v=Ft(),C=Jo(),w=le({message:""});b(()=>n.allChannels);const _=O([]),S=O("");async function U(B){await i(B.value),w.message=""}const P=B=>{if(B===""){_.value=[],S.value="";return}_.value=o.ownChannels.filter(x=>x.data.name.toLocaleLowerCase().includes(B.toLocaleLowerCase())||x.pubkey.toBase58().toLocaleLowerCase().includes(B.toLocaleLowerCase())),S.value=B},L=b(()=>n.loading),F=O(!1),D=b(()=>_.value.length>0||S.value.length>0?_.value:o.ownChannels),E=B=>h.submit(B),k=B=>{c.state.name=B,c.submit()};return(B,x)=>{const Me=Sl,ot=al,y=Yo,I=Fo,N=Do,V=Mo,pe=_o,te=so,Ne=Xs;return f(),A(Q,null,[m("div",Pl,[r(Me,{onSearch:P,onShowMembers:x[0]||(x[0]=z=>d(g).state.dialog=!0),onDeleteChannel:x[1]||(x[1]=z=>d(C).submit(d(n).channelAddr)),onAddMember:x[2]||(x[2]=z=>d(h).state.dialog=!0),onShowDeviceKey:x[3]||(x[3]=z=>F.value=!0)}),m("div",Il,[r(Z,{class:"messenger-channels",square:"",flat:""},{default:u(()=>[d(D).length>0?(f(),M(ye,{key:0,separator:"",class:"channels-list"},{default:u(()=>[(f(!0),A(Q,null,Y(d(D),z=>(f(),M(ot,{key:z.name,pubkey:z.pubkey,channel:z.data,"active-class":"select-channel","is-active":`${d(n).channelAddr}`==`${z.pubkey}`,onSelect:Be=>d(s)(z.pubkey)},null,8,["pubkey","channel","is-active","onSelect"]))),128))]),_:1})):(f(),A("div",Kl," No channels ")),r(y,{"is-joining":d(c).state.loading,"is-loading":d(L),onCreateChannel:x[4]||(x[4]=z=>d(l).state.dialog=!0),onJoinChannel:x[5]||(x[5]=z=>d(c).state.dialog=!0),onRefreshList:d(a)},null,8,["is-joining","is-loading","onRefreshList"])]),_:1}),r(I,{"post-message-state":w,onSendMessage:U},null,8,["post-message-state"]),r(Qe,{showing:d(n).loading,color:"primary"},null,8,["showing"])])]),r(N,{modelValue:d(l).state.dialog,"onUpdate:modelValue":x[6]||(x[6]=z=>d(l).state.dialog=z),loading:d(l).state.loading,"default-state":d(l).state,onSubmit:d(l).submit,onReset:d(l).reset},null,8,["modelValue","loading","default-state","onSubmit","onReset"]),r(V,{modelValue:d(h).state.dialog,"onUpdate:modelValue":x[7]||(x[7]=z=>d(h).state.dialog=z),loading:d(h).state.loading,"default-state":d(h).state,onSubmit:E,onReset:d(h).reset},null,8,["modelValue","loading","default-state","onReset"]),r(pe,{modelValue:d(c).state.dialog,"onUpdate:modelValue":x[8]||(x[8]=z=>d(c).state.dialog=z),loading:d(c).state.loading,"default-state":d(c).state,onSubmit:k,onReset:d(c).reset},null,8,["modelValue","loading","default-state","onReset"]),r(te,{modelValue:d(g).state.dialog,"onUpdate:modelValue":x[9]||(x[9]=z=>d(g).state.dialog=z),wallet:d(e),"authorize-member-state":d(g).state,"delete-member-state":d(v).state,onSubmit:d(g).submit,onDeleteMember:d(v).submit},null,8,["modelValue","wallet","authorize-member-state","delete-member-state","onSubmit","onDeleteMember"]),r(Ne,{modelValue:F.value,"onUpdate:modelValue":x[10]||(x[10]=z=>F.value=z)},null,8,["modelValue"]),d(n).channel?(f(),A("div",Ll,[r(Dl)])):ie("",!0)],64)}}});const zl={},Nl={class:"container"},Bl={class:"messenger-container"},Wl={class:"container"};function Rl(t,e){const n=Tl,i=js;return f(),M(Wn,{class:"page-wrapper"},{default:u(()=>[m("div",Nl,[m("div",Bl,[r(n)])]),m("div",Wl,[r(i)])]),_:1})}const Vl=ee(zl,[["render",Rl],["__scopeId","data-v-d4ef5e8f"]]),ql=()=>Et(()=>import("./_...all_.8c2995af.js"),["assets/_...all_.8c2995af.js","assets/vendor.b54ab2b2.js","assets/_...all_.73169310.css"]),Ol=[{name:"index",path:"/",component:Vl,props:!0},{name:"all",path:"/:all(.*)*",component:ql,props:!0,meta:{layout:"empty"}}],Ul=Ks(Ol),Fl="/",jl=Rn({history:Vn(Fl),scrollBehavior:()=>({left:0,top:0}),strict:!0,routes:Ul}),Ql=({app:t})=>{t.use(jl)},Jl=Object.freeze(Object.defineProperty({__proto__:null,install:Ql},Symbol.toStringTag,{value:"Module"})),Gl=({app:t})=>{t.use(qn,{wallets:[new On,new Un,new Fn,new jn,new Qn,new Jn,new Gn,new Hn,new Xn,new Yn,new Zn,new ea,new ta,new na,new aa,new sa,new ia,new oa,new la,new ra,new ca,new ua,new da,new ma,new ha,new pa,new fa,new ga,new ba,new ya],autoConnect:!1})},Hl=Object.freeze(Object.defineProperty({__proto__:null,install:Gl},Symbol.toStringTag,{value:"Module"})),Xl=_a();function Yl(){return Xl}const Zl=Symbol("WALLET_CONNECT_EVENT"),er=Symbol("WALLET_DISCONNECT_EVENT"),tr=Symbol("ACCOUNT_CHANGE_EVENT"),ut=5e3;function nr(){const{connection:t}=He(),{emit:e}=Yl(),{notify:n}=Pe(),{wallet:i}=_e();ue(i,s=>{if(!s)return;const a=()=>{const c=s.adapter.publicKey;t.onAccountChange(c,h=>{e(tr,h)}),t.onLogs(c,h=>{console.log(h)}),n({message:"Wallet update",caption:`Connected to wallet ${Je(c.toBase58(),7)}`,timeout:ut}),e(Zl,s)},o=()=>{n({message:"Wallet update",caption:"Disconnected from wallet",timeout:ut}),e(er,s)},l=c=>{!(c!=null&&c.message)||n({type:"negative",message:"Wallet update",caption:c.message,timeout:ut})};s.adapter.once("connect",a),s.adapter.once("disconnect",o),s.adapter.removeAllListeners("error"),s.adapter.on("error",l)},{immediate:!0})}const ar=W({__name:"App",setup(t){return va(()=>{nr()}),(e,n)=>{const i=gt("router-view");return f(),M(i)}}});async function sr(){const t=wa(ar);Object.values(Object.assign({"./plugins/pinia.ts":Ma,"./plugins/quasar.ts":ka,"./plugins/router.ts":Jl,"./plugins/wallet.ts":Hl})).forEach(e=>{var n;return(n=e.install)==null?void 0:n.call(e,{app:t})}),t.mount("#app")}sr().then();export{ee as _};
