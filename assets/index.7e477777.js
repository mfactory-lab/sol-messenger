var un=Object.defineProperty;var dn=(t,e,n)=>e in t?un(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var O=(t,e,n)=>(dn(t,typeof e!="symbol"?e+"":e,n),n);import{c as mn,a as hn,Q as pn,P as gn,D as fn,N as yn,b as bn,i as _n,u as ke,d as Fe,e as R,o as y,f as C,g as p,h as I,w as ve,v as vn,j as d,F as U,r as ne,t as N,k as F,l as _,m as T,n as ye,p as wn,q as kn,S as An,s as M,x as m,y as Lt,z as K,A as l,B as ee,C as H,E as Te,G as Sn,H as j,I as Z,J as Mn,K as ge,L as $t,W as zt,M as xe,O as De,R as We,T as Cn,U as Ot,V as we,X as Re,Y,Z as xn,_ as It,$ as et,a0 as Dn,a1 as $n,a2 as Vt,a3 as tt,a4 as In,a5 as Ce,a6 as bt,a7 as En,a8 as Et,a9 as f,aa as he,ab as Pt,ac as se,ad as le,ae as Ve,af as qt,ag as Le,ah as Pn,ai as nt,aj as Ht,ak as At,al as Bn,am as Tn,an as Kn,ao as Ln,ap as zn,aq as oe,ar as ie,as as Wt,at as ae,au as pe,av as qe,aw as Ne,ax as He,ay as Ut,az as jt,aA as Wn,aB as Nn,aC as $e,aD as Fn,aE as Rn,aF as Be,aG as On,aH as Vn,aI as qn,aJ as Hn,aK as Bt,aL as Un,aM as jn,aN as Qt,aO as Qn,aP as Gn,aQ as Nt,aR as Jn,aS as Yn,aT as Xn,aU as Zn,aV as ea,aW as ta,aX as na,aY as aa,aZ as sa,a_ as ia,a$ as oa,b0 as ra,b1 as la,b2 as ca,b3 as ua,b4 as da,b5 as ma,b6 as ha,b7 as pa,b8 as ga,b9 as fa,ba as ya,bb as ba,bc as _a,bd as va,be as wa,bf as ka,bg as Aa,bh as Sa,bi as Ma,bj as Ca,bk as xa,bl as Da,bm as $a,bn as Ia,bo as Ea,bp as Pa,bq as Ba,br as Ta,bs as Ka,bt as La,bu as za,bv as Wa,bw as Na,bx as Fa,by as Ra,bz as Oa,bA as Va}from"./vendor.e16d9468.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerpolicy&&(a.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?a.credentials="include":s.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(s){if(s.ep)return;s.ep=!0;const a=n(s);fetch(s.href,a)}})();const qa=({app:t})=>{t.use(mn())},Ha=Object.freeze(Object.defineProperty({__proto__:null,install:qa},Symbol.toStringTag,{value:"Module"})),Ua=({app:t})=>{const e=hn();t.use(e)},ja=Object.freeze(Object.defineProperty({__proto__:null,install:Ua},Symbol.toStringTag,{value:"Module"})),Qa=({app:t})=>{t.use(pn,{plugins:{Dark:gn,Dialog:fn,Notify:yn,LocalStorage:bn},iconSet:_n})},Ga=Object.freeze(Object.defineProperty({__proto__:null,install:Qa},Symbol.toStringTag,{value:"Module"}));function Ja(){const{dark:t}=ke(),e=Fe("theme-mode",t.isActive);return t.set(e.value),{isActive:e,set(n){t.set(n),e.value=t.isActive},toggle(){t.toggle(),e.value=t.isActive}}}const Oe=[],Gt={id:"devnet",name:"DevNet",cluster:"devnet",url:"https://devnet.rpcpool.com/"};Oe.push(Gt);var Rt;const Ya=(Rt=Oe.find(t=>t.id==={VITE_USER_NODE_ENV:"production",BASE_URL:"/",MODE:"staging",DEV:!1,PROD:!0}.VITE_CONNECTION_ENDPOINT))!=null?Rt:Gt,Xa="confirmed",Za=12e4,_t=[`<span>Public channels</span> are non-encrypted and available to anyone, both for reading and writing.</br></br>
    <span>Public channels</span> are encrypted, and new users need to request approval to join them.</br>
    Depending on the \u2018Members can approve\u2019 setting, such requests can be approved either by channel\u2019s 
    owner/admin only, or by any authorized member of the channel.
    `,"Any authorized channel member can approve new requests to join","This setting determines how many messages will be available in chat until they are updated with new messages"],es="https://twitter.com/JPoolSolana",ts="https://t.me/jpool_solana",ns="https://t.me/jpoolsolana",as="https://discord.gg/qR4BA9QXVR",ss="https://jfactory.ch",is="https://jpool.one",os="https://svt.one",rs="https://staking.kiwi/",ls={class:"container"},cs={class:"footer-section"},us={class:"footer-info"},ds={class:"theme"},ms={class:"switch"},hs=p("span",{class:"slider round"},null,-1),ps=p("div",{class:"copyright"},[I(" \xA9 Copyright 2022 cgram.one. All rights reserved."),p("br"),I("Powered by jFactory ")],-1),gs={class:"footer-links"},fs={class:"social"},ys=["href"],bs=p("span",null,[I("official"),p("br"),I("channel")],-1),_s=[bs],vs=["href"],ws=["href"],ks=["href"],As=["href"],Ss=R({__name:"AppFooter",setup(t){const e=Ja(),n=[{name:"JFACTORY",link:ss},{name:"JPOOL",link:is},{name:"STAKING KIWI",link:rs},{name:"SOLANA VALIDATOR TOOLKIT",link:os}];return(i,s)=>(y(),C("footer",null,[p("div",ls,[p("div",cs,[p("div",us,[p("div",ds,[I(" Dark mode "),p("label",ms,[ve(p("input",{"onUpdate:modelValue":s[0]||(s[0]=a=>d(e).isActive.value=a),type:"checkbox",onClick:s[1]||(s[1]=(...a)=>d(e).toggle&&d(e).toggle(...a))},null,512),[[vn,d(e).isActive.value]]),hs])]),ps]),p("div",gs,[p("div",fs,[p("a",{href:d(ts),target:"_blank",class:"social-link social-link-text"},_s,8,ys),p("a",{href:d(ns),target:"_blank",class:"social-link telegram"},null,8,vs),p("a",{href:d(es),target:"_blank",class:"social-link twitter"},null,8,ws),p("a",{href:d(as),target:"_blank",class:"social-link discord"},null,8,ks)]),p("nav",null,[p("ul",null,[(y(),C(U,null,ne(n,({name:a,link:o})=>p("li",{key:a},[p("a",{target:"_blank",href:o},N(a),9,As)])),64))])])])])])]))}});function Ms(){const t=F(Cs());return{userAgent:t,isMobileOs:_(()=>xs(t.value)),isWebView:_(()=>Ds(t.value))}}let vt;function Cs(){var t,e;return vt===void 0&&(vt=(e=(t=globalThis.navigator)==null?void 0:t.userAgent)!=null?e:null),vt}function xs(t){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)}function Ds(t){return/(WebView|(Phantom|Solflare)|Version\/.+(Chrome)\/(\d+)\.(\d+)\.(\d+)\.(\d+)|; wv\).+(Chrome)\/(\d+)\.(\d+)\.(\d+)\.(\d+))/i.test(t)}function Ue(t,e=4){return t instanceof T&&(t=t.toBase58()),`${t.slice(0,e)}...${t.slice(-e)}`}function Jt(t){return(t==null?void 0:t.name)&&t.name!==""?t.name:Ue(t.authority)}const Yt=t=>{if(!t)return{background:"#000"};let e=0;for(let i=0;i<t.length;i++)e=t.charCodeAt(i)+((e<<5)-e),e=e&e;let n="#";for(let i=0;i<3;i++)n+=`00${(e>>i*8&255).toString(16)}`.substr(-2);return{background:n}},$s="/assets/clover.968404b0.svg",Is="/assets/ledger.40cf6861.svg",Es="/assets/mathwallet.1d763e81.svg",at=t=>(xe("data-v-269ee747"),t=t(),De(),t),Ps=at(()=>p("div",{class:"text-h6 text-center"}," Your wallet ",-1)),Bs={class:"q-gutter-md row justify-between"},Ts=at(()=>p("span",{name:"wallet"},"Disconnect",-1)),Ks=at(()=>p("span",{name:"wallet"},"Ok",-1)),Ls=at(()=>p("div",{class:"text-h6"}," Connect to a wallet ",-1)),zs={class:"text-light-gray text-caption full-width text-no-wrap",style:{"text-overflow":"ellipsis",overflow:"hidden"}},Ws=["src","alt"],Ns=R({__name:"ConnectWallet",setup(t){const e={priority:{solflare:10,phantom:20,sollet:5,nufi:5,blocto:1},icons:{clover:$s},darkIcons:{ledger:Is,mathwallet:Es},deepLinks:{phantom:"https://phantom.app/ul/browse/{uri}?ref={ref}",solflare:"https://solflare.com/ul/browse/{uri}?ref={ref}"}},{userAgent:n,isWebView:i,isMobileOs:s}=Ms(),a={close:$t},o=x=>[zt.Installed,zt.Loadable].includes(x.readyState);ke();const r=ye(),{connected:c,connecting:u}=r;wn();const h=_(()=>s.value&&!i.value);if(i.value){const x=String(n.value).toLowerCase();x.includes("phantom")?(r.select(kn),r.connect()):x.includes("solflare")&&(r.select(An),r.connect())}const g=_(()=>{var x,P;return(P=(x=r.publicKey.value)==null?void 0:x.toBase58())!=null?P:""}),v=_(()=>Ue(g.value)),k=_(()=>[...r.wallets.value].map(x=>{var E,G;const P=x.adapter.name.toLowerCase();return x.adapter.icon=(G=(E=e.darkIcons[P])!=null?E:e.icons[P])!=null?G:x.adapter.icon,h.value&&e.deepLinks[P]&&(x.deepLink=e.deepLinks[P].replace("{uri}",location.href).replace("{ref}",location.origin)),x}).sort((x,P)=>{var ue,Ee;const E=(ue=e.priority[x.adapter.name.toLowerCase()])!=null?ue:1;return((Ee=e.priority[P.adapter.name.toLowerCase()])!=null?Ee:1)-E+((o(P)?1:0)-(o(x)?1:0))})),A=_(()=>h.value?k.value.filter(x=>!!x.deepLink):k.value),S=F(!1);async function D(x){await r.select(x.adapter.name),S.value=!1,await r.connect()}function w(){S.value=!1,r.disconnect()}function B(){S.value=!0}function V(){S.value=!1}return(x,P)=>(y(),C(U,null,[d(c)?(y(),M(K,Lt({key:0},x.$attrs,{ripple:!1,color:"primary-gray","text-color":"white",square:"",unelevated:"",onClick:B}),{default:m(()=>[I(N(d(v)),1)]),_:1},16)):(y(),M(K,Lt({key:1},x.$attrs,{color:"primary-gray",class:"q-pa-none btn","text-color":"white",square:"",flat:"",ripple:!1,loading:d(u),onClick:B}),{default:m(()=>[I(" CONNECT WALLET ")]),_:1},16,["loading"])),l(ge,{modelValue:S.value,"onUpdate:modelValue":P[0]||(P[0]=E=>S.value=E),"transition-duration":"150","transition-show":"fade","transition-hide":"fade"},{default:m(()=>[d(c)?(y(),M(ee,{key:0},{default:m(()=>[l(H,{class:"relative-position"},{default:m(()=>[Ps,l(K,{padding:"md",color:"transparent","text-color":"primary-gray",unelevated:"",class:"absolute-right",icon:a.close,size:"md",onClick:V},null,8,["icon"])]),_:1}),l(Te),l(H,null,{default:m(()=>[I(N(d(g)),1)]),_:1}),l(Te),l(H,null,{default:m(()=>[p("div",Bs,[l(K,{class:"disconnect-btn","text-color":"black",square:"",flat:"",onClick:w},{default:m(()=>[Ts]),_:1}),l(K,{class:"disconnect-btn","text-color":"black",square:"",flat:"",onClick:V},{default:m(()=>[Ks]),_:1})])]),_:1})]),_:1})):(y(),M(ee,{key:1,class:"wallet-connect-card"},{default:m(()=>[l(H,null,{default:m(()=>[Ls,l(K,{padding:"md",color:"transparent","text-color":"primary-gray",unelevated:"",class:"absolute-right",icon:a.close,size:"md",onClick:V},null,8,["icon"])]),_:1}),l(Te),l(H,{style:{"max-height":"80vh"},class:"scroll"},{default:m(()=>[l(Sn,{grid:"",rows:d(A),"row-key":"name","hide-pagination":"","hide-header":"","rows-per-page-options":[100]},{item:m(({row:E})=>[(y(),C("div",{key:`wallet-${E.adapter.name}`,class:"col-12 col-md-6"},[l(j,{clickable:"",href:E.deepLink,onClick:G=>E.deepLink?!0:D(E)},{default:m(()=>[l(Z,null,{default:m(()=>[p("b",null,N(E.adapter.name),1),p("div",zs,N(E.adapter.url),1)]),_:2},1024),l(Z,{avatar:""},{default:m(()=>[l(Mn,{square:""},{default:m(()=>[p("img",{src:E.adapter.icon,alt:E.adapter.name},null,8,Ws)]),_:2},1024)]),_:2},1024)]),_:2},1032,["href","onClick"])]))]),_:1},8,["rows"])]),_:1})]),_:1}))]),_:1},8,["modelValue"])],64))}});const X=(t,e)=>{const n=t.__vccOpts||t;for(const[i,s]of e)n[i]=s;return n},Fs=X(Ns,[["__scopeId","data-v-269ee747"]]),st=We({id:"connection",state:()=>({commitment:Xa,confirmTransactionInitialTimeout:Za,rpc:Cn("rpc","")}),getters:{endpoint(t){var e;return(e=Oe.find(n=>n.id===t.rpc))!=null?e:Ya},connection(t){return console.log("[connection]",this.endpoint.url),new Ot(this.endpoint.url,{confirmTransactionInitialTimeout:t.confirmTransactionInitialTimeout,commitment:t.commitment})},cluster(){return this.endpoint.cluster}},actions:{setRpc(t){this.rpc=t},setCommitment(t){this.commitment=t}}}),Rs=R({__name:"ClusterSelector",setup(t){const e=st(),{connected:n,connect:i,disconnect:s,autoConnect:a}=ye(),o=[Oe.filter(u=>u.cluster==="mainnet-beta"),Oe.filter(u=>u.cluster!=="mainnet-beta")],r=_(()=>e.endpoint),c=u=>{n&&e.cluster!==u.cluster&&(s(),a.value&&i()),e.setRpc(u.id)};return(u,h)=>(y(),M(xn,{label:d(r).name,"model-value":!1,"auto-close":"",color:"secondary","text-color":"#000",square:"",unelevated:"",ripple:!1},{default:m(()=>[l(we,null,{default:m(()=>[(y(),C(U,null,ne(o,(g,v)=>(y(),C(U,{key:`${v}-cluster-group`},[(y(!0),C(U,null,ne(g,k=>(y(),M(j,{key:k.id,clickable:"",onClick:A=>c(k)},{default:m(()=>[(y(),M(Z,{key:`${k.id}-item`},{default:m(()=>[l(Re,null,{default:m(()=>[p("b",null,N(k.name),1)]),_:2},1024),I(" "+N(k.url),1)]),_:2},1024))]),_:2},1032,["onClick"]))),128)),v!==o.length-1?(y(),M(Te,{key:0})):Y("",!0)],64))),64))]),_:1})]),_:1},8,["label"]))}});const Os={},Vs={class:"app-header"},qs={class:"container"},Hs={class:"app-header__info"},Us={class:"app-header__logo"},js={class:"logo-wrapper"},Qs=p("div",{class:"app-header__title"},[p("h1",null,[I("BLOCKCHAIN "),p("br"),I(" messenger "),p("span",{class:"marked"},"SOLANA")])],-1),Gs={class:"app-header__right"},Js={class:"app-header__buttons"};function Ys(t,e){const n=It("router-link"),i=Rs,s=Fs;return y(),C("header",Vs,[p("div",qs,[p("div",Hs,[p("div",Us,[p("div",js,[l(n,{to:"/"})])]),Qs]),l(et),p("div",Gs,[p("div",Js,[l(i,{class:"app-header__cluster-btn header-btn"}),l(s,{class:"app-header__wallet-btn header-btn"})])])])])}const Xs=X(Os,[["render",Ys]]),Zs={};function ei(t,e){const n=Xs,i=It("router-view"),s=Ss;return y(),M(Dn,{view:"lfh Lpr lff"},{default:m(()=>[l(n),l($n,null,{default:m(()=>[l(i)]),_:1}),l(s)]),_:1})}const ti=X(Zs,[["render",ei]]),ni={default:ti,empty:()=>Vt(()=>import("./empty.33ed7e65.js"),["assets/empty.33ed7e65.js","assets/vendor.e16d9468.js"])};function ai(t){return t.map(e=>{var n;return{path:e.path,component:ni[((n=e.meta)==null?void 0:n.layout)||"default"],children:[{...e,path:""}]}})}const si="/assets/search.b4fadb1c.svg",ii="/assets/transfer.796e9da5.svg",oi="/assets/plus.ee413328.svg",ri={class:"how-it-works"},li={class:"app-info"},ci=p("div",{class:"app-info__title"}," JOIN A CHANNEL ",-1),ui={class:"app-info__list"},di=["innerHTML"],mi={class:"app-info"},hi=p("div",{class:"app-info__title"}," CREATE YOUR OWN CHANNEL ",-1),pi={class:"app-info__list"},gi=["innerHTML"],fi=R({__name:"HowItWorks",setup(t){const e=["For <span>public channels</span>, you can read or send messages without limitations.",`In order to join one of the existing private channels, click
        <img src="${si}" class="icon" alt="search">
        (BROWSE CHANNELS) at the bottom of the left-side panel.`,`Find a channel you are interested in and click
        <img src="${ii}" class="icon" alt="transfer">
        (REQUEST TO JOIN). Your status for that channel will be set to Pending
        Approval until your request has been accepted. While awaiting approval,
        all messages in the channel will appear scrambled.`,`After the private channel's owner or admin approves your membership,your
        status will change to Authorized. You will be able to read the channel
        and send messages.`],n=["You can create a channel of your own as well.",`Click <img src="${oi}" class="icon" alt="search"> (CREATE A CHANNEL) 
  at the bottom of the left-side panel, then choose between Private and Public options.`,"A public channel is open to anyone for reading and writing, and no encryption is used.",`If you create a private channel, joining it will require your approval. You will see a red 
  notification badge above the channel list if there are approval requests pending.`];return(i,s)=>(y(),C("div",ri,[p("div",li,[ci,p("ul",ui,[(y(),C(U,null,ne(e,a=>p("li",{key:a},[p("p",{innerHTML:a},null,8,di)])),64))])]),p("div",mi,[hi,p("ul",pi,[(y(),C(U,null,ne(n,a=>p("li",{key:a},[p("p",{innerHTML:a},null,8,gi)])),64))])])]))}});const je=We("user",()=>{const t=tt(),e=F();In(()=>{var c;const r=(c=t.value)==null?void 0:c.publicKey;if(r){const u=Fe(r.toString(),()=>bt.encode(Ce.generate().secretKey));n(u.value)}else e.value=void 0});function n(r){e.value=Ce.fromSecretKey(bt.decode(r))}function i(){var u;const r=(u=t.value)==null?void 0:u.publicKey;if(!r)return;const c=Fe(r.toString(),"");n(c.value=bt.encode(Ce.generate().secretKey))}function s(r){var h;const c=(h=t.value)==null?void 0:h.publicKey;if(!c)return;const u=Fe(c.toString(),"");n(u.value=r)}function a(){var v;const r=(v=t.value)==null?void 0:v.publicKey;if(!r)return;const u={backupKey:Fe(r.toString(),"").value},h=`data:text/json;charset=utf-8,${encodeURIComponent(JSON.stringify(u))}`,g=document.createElement("a");g.setAttribute("href",h),g.setAttribute("download","backup_key.json"),g.click()}async function o(){var g;const r=(g=t.value)==null?void 0:g.publicKey;return await await new Ot(En("devnet"),"confirmed").getBalance(r)/Et>.1}return{keypair:e,generateKey:i,importKey:s,exportKey:a,userBalance:o}}),yi="0.0.11",bi="messenger",_i=[{name:"initChannel",accounts:[{name:"channel",isMut:!0,isSigner:!1},{name:"membership",isMut:!0,isSigner:!1},{name:"device",isMut:!0,isSigner:!1},{name:"authority",isMut:!0,isSigner:!0},{name:"key",isMut:!1,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"data",type:{defined:"InitChannelData"}}]},{name:"deleteChannel",accounts:[{name:"channel",isMut:!0,isSigner:!1},{name:"authorityMembership",isMut:!0,isSigner:!1},{name:"authority",isMut:!0,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"joinChannel",accounts:[{name:"channel",isMut:!0,isSigner:!1},{name:"membership",isMut:!0,isSigner:!1},{name:"device",isMut:!0,isSigner:!1},{name:"authority",isMut:!0,isSigner:!0},{name:"key",isMut:!1,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"data",type:{defined:"JoinChannelData"}}]},{name:"leaveChannel",accounts:[{name:"channel",isMut:!0,isSigner:!1},{name:"membership",isMut:!0,isSigner:!1},{name:"authority",isMut:!0,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"grantAccessMember",accounts:[{name:"channel",isMut:!1,isSigner:!1},{name:"membership",isMut:!0,isSigner:!1},{name:"authorityMembership",isMut:!1,isSigner:!1},{name:"authority",isMut:!0,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"data",type:{defined:"GrantAccessMemberData"}}]},{name:"addMember",accounts:[{name:"channel",isMut:!0,isSigner:!1},{name:"invitee",isMut:!1,isSigner:!1},{name:"inviteeMembership",isMut:!0,isSigner:!1},{name:"inviteeDevice",isMut:!0,isSigner:!1},{name:"authorityMembership",isMut:!0,isSigner:!1},{name:"authority",isMut:!0,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"data",type:{defined:"AddMemberData"}}]},{name:"authorizeMember",accounts:[{name:"channel",isMut:!1,isSigner:!1},{name:"membership",isMut:!0,isSigner:!1},{name:"device",isMut:!0,isSigner:!1},{name:"authority",isMut:!1,isSigner:!0},{name:"authorityMembership",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"data",type:{defined:"AuthorizeMemberData"}}]},{name:"deleteMember",accounts:[{name:"channel",isMut:!0,isSigner:!1},{name:"membership",isMut:!0,isSigner:!1},{name:"membershipAuthority",isMut:!0,isSigner:!1},{name:"authorityMembership",isMut:!1,isSigner:!1},{name:"authority",isMut:!1,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"addDevice",accounts:[{name:"channel",isMut:!0,isSigner:!1},{name:"membership",isMut:!0,isSigner:!1},{name:"device",isMut:!0,isSigner:!1},{name:"authority",isMut:!0,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"data",type:{defined:"AddDeviceData"}}]},{name:"deleteDevice",accounts:[{name:"channel",isMut:!0,isSigner:!1},{name:"device",isMut:!0,isSigner:!1},{name:"deviceAuthority",isMut:!0,isSigner:!1},{name:"authority",isMut:!1,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"postMessage",accounts:[{name:"channel",isMut:!0,isSigner:!1},{name:"membership",isMut:!1,isSigner:!1},{name:"authority",isMut:!1,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"message",type:"string"}]},{name:"readMessage",accounts:[{name:"channel",isMut:!0,isSigner:!1},{name:"membership",isMut:!0,isSigner:!1},{name:"authority",isMut:!1,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"messageId",type:"u64"}]}],vi=[{name:"Channel",type:{kind:"struct",fields:[{name:"workspace",docs:["Workspace used to group channels"],type:"string"},{name:"name",docs:["Name of the channel"],type:"string"},{name:"creator",docs:["Channel creator"],type:"publicKey"},{name:"createdAt",docs:["Creation date"],type:"i64"},{name:"lastMessageAt",docs:["Last message date"],type:"i64"},{name:"flags",docs:["Channel flags"],type:"u8"},{name:"memberCount",docs:["Number of members"],type:"u16"},{name:"messageCount",docs:["Message counter"],type:"u64"},{name:"maxMessages",docs:["The maximum number of messages that are stored in [messages]"],type:"u16"},{name:"messages",docs:["List of latest messages"],type:{vec:{defined:"Message"}}}]}},{name:"ChannelDevice",type:{kind:"struct",fields:[{name:"channel",docs:["Associated [Channel] address"],type:"publicKey"},{name:"authority",docs:["Authority of the [ChannelKey]"],type:"publicKey"},{name:"key",docs:["The device key used to encrypt the `cek`"],type:"publicKey"},{name:"cek",docs:["The content encryption key (CEK)"],type:{defined:"CEKData"}},{name:"bump",docs:["Bump seed for deriving PDA seeds"],type:"u8"}]}},{name:"ChannelMembership",type:{kind:"struct",fields:[{name:"channel",docs:["Associated [Channel] address"],type:"publicKey"},{name:"authority",docs:["Authority of membership"],type:"publicKey"},{name:"status",docs:["Status of membership"],type:{defined:"ChannelMembershipStatus"}},{name:"statusTarget",docs:["Status target key"],type:{option:"publicKey"}},{name:"name",docs:["Name of the channel member"],type:"string"},{name:"lastReadMessageId",docs:["The last read message id"],type:"u64"},{name:"createdAt",docs:["Creation date"],type:"i64"},{name:"flags",docs:["Membership flags"],type:"u8"},{name:"bump",docs:["Bump seed for deriving PDA seeds"],type:"u8"}]}}],wi=[{name:"AddDeviceData",type:{kind:"struct",fields:[{name:"key",type:"publicKey"},{name:"cek",type:{defined:"CEKData"}}]}},{name:"AddMemberData",type:{kind:"struct",fields:[{name:"name",docs:["Member name"],type:"string"},{name:"flags",docs:["Membership flags, only `admin` and `owner` can set membership flags"],type:"u8"},{name:"cek",docs:["Content Encryption Key"],type:{defined:"CEKData"}},{name:"key",docs:["Device key"],type:"publicKey"}]}},{name:"AuthorizeMemberData",type:{kind:"struct",fields:[{name:"cek",type:{defined:"CEKData"}}]}},{name:"GrantAccessMemberData",type:{kind:"struct",fields:[{name:"flags",type:"u8"}]}},{name:"InitChannelData",type:{kind:"struct",fields:[{name:"workspace",type:"string"},{name:"name",type:"string"},{name:"maxMessages",type:"u16"},{name:"memberName",type:"string"},{name:"cek",type:{defined:"CEKData"}},{name:"public",type:"bool"},{name:"permissionless",type:"bool"}]}},{name:"JoinChannelData",type:{kind:"struct",fields:[{name:"name",type:"string"},{name:"authority",type:{option:"publicKey"}}]}},{name:"CEKData",type:{kind:"struct",fields:[{name:"header",docs:["The header information for the CEK"],type:"string"},{name:"encryptedKey",docs:["The CEK itself"],type:"string"}]}},{name:"Message",type:{kind:"struct",fields:[{name:"id",docs:["Uniq message id"],type:"u64"},{name:"sender",docs:["The message sender id"],type:"publicKey"},{name:"createdAt",docs:["The unix timestamp at which the message was received"],type:"i64"},{name:"flags",docs:["Message flags"],type:"u8"},{name:"content",docs:["The (typically encrypted) message content"],type:"string"}]}},{name:"ChannelMembershipStatus",type:{kind:"enum",variants:[{name:"Authorized"},{name:"Pending"}]}}],ki=[{name:"NewChannelEvent",fields:[{name:"channel",type:"publicKey",index:!0},{name:"creator",type:"publicKey",index:!1},{name:"name",type:"string",index:!1},{name:"timestamp",type:"i64",index:!1}]},{name:"DeleteChannelEvent",fields:[{name:"channel",type:"publicKey",index:!0},{name:"creator",type:"publicKey",index:!1},{name:"timestamp",type:"i64",index:!1}]},{name:"NewMessageEvent",fields:[{name:"channel",type:"publicKey",index:!0},{name:"message",type:{defined:"Message"},index:!1}]},{name:"JoinChannelEvent",fields:[{name:"channel",type:"publicKey",index:!0},{name:"membership",type:"publicKey",index:!0},{name:"device",type:"publicKey",index:!1},{name:"timestamp",type:"i64",index:!1}]},{name:"LeaveChannelEvent",fields:[{name:"channel",type:"publicKey",index:!0},{name:"authority",type:"publicKey",index:!0},{name:"timestamp",type:"i64",index:!1}]},{name:"AddMemberEvent",fields:[{name:"channel",type:"publicKey",index:!0},{name:"membership",type:"publicKey",index:!0},{name:"by",type:"publicKey",index:!1},{name:"timestamp",type:"i64",index:!1}]},{name:"AuthorizeMemberEvent",fields:[{name:"channel",type:"publicKey",index:!0},{name:"membership",type:"publicKey",index:!0},{name:"by",type:"publicKey",index:!1},{name:"timestamp",type:"i64",index:!1}]},{name:"DeleteMemberEvent",fields:[{name:"channel",type:"publicKey",index:!0},{name:"membership",type:"publicKey",index:!0},{name:"by",type:"publicKey",index:!1},{name:"timestamp",type:"i64",index:!1}]},{name:"AddDeviceEvent",fields:[{name:"channel",type:"publicKey",index:!0},{name:"device",type:"publicKey",index:!0},{name:"authority",type:"publicKey",index:!1},{name:"timestamp",type:"i64",index:!1}]},{name:"DeleteDeviceEvent",fields:[{name:"channel",type:"publicKey",index:!0},{name:"device",type:"publicKey",index:!0},{name:"authority",type:"publicKey",index:!1},{name:"timestamp",type:"i64",index:!1}]}],Ai=[{code:6e3,name:"Unauthorized",msg:"Unauthorized"},{code:6001,name:"InvalidChannel",msg:"Invalid channel"},{code:6002,name:"InvalidMembership",msg:"Invalid membership"},{code:6003,name:"InvalidDevice",msg:"Invalid device"},{code:6004,name:"InvalidMessage",msg:"Invalid message"},{code:6005,name:"NameTooLong",msg:"Name too long"},{code:6006,name:"WorkspaceTooLong",msg:"Workspace too long"},{code:6007,name:"MessageTooLong",msg:"Message too long"}],Si={address:"4AnSBTc21f4wTBHmnFyarbosr28Qk4CgGFBHcRh4kYPw",origin:"anchor",binaryVersion:"0.25.0",libVersion:"0.25.0"},Mi={version:yi,name:bi,instructions:_i,accounts:vi,types:wi,events:ki,errors:Ai,metadata:Si},Ci=new f.FixableBeetArgsStruct([["id",f.u64],["sender",he],["createdAt",f.i64],["flags",f.u8],["content",f.utf8String]],"Message"),St=[49,159,99,106,220,87,219,88];class de{constructor(e,n,i,s,a,o,r,c,u,h){this.workspace=e,this.name=n,this.creator=i,this.createdAt=s,this.lastMessageAt=a,this.flags=o,this.memberCount=r,this.messageCount=c,this.maxMessages=u,this.messages=h}static fromArgs(e){return new de(e.workspace,e.name,e.creator,e.createdAt,e.lastMessageAt,e.flags,e.memberCount,e.messageCount,e.maxMessages,e.messages)}static fromAccountInfo(e,n=0){return de.deserialize(e.data,n)}static async fromAccountAddress(e,n,i){const s=await e.getAccountInfo(n,i);if(s==null)throw new Error(`Unable to find Channel account at ${n}`);return de.fromAccountInfo(s,0)[0]}static gpaBuilder(e=new T("4AnSBTc21f4wTBHmnFyarbosr28Qk4CgGFBHcRh4kYPw")){return Pt.fromStruct(e,Je)}static deserialize(e,n=0){return Je.deserialize(e,n)}serialize(){return Je.serialize({accountDiscriminator:St,...this})}static byteSize(e){const n=de.fromArgs(e);return Je.toFixedFromValue({accountDiscriminator:St,...n}).byteSize}static async getMinimumBalanceForRentExemption(e,n,i){return n.getMinimumBalanceForRentExemption(de.byteSize(e),i)}pretty(){return{workspace:this.workspace,name:this.name,creator:this.creator.toBase58(),createdAt:(()=>{const e=this.createdAt;if(typeof e.toNumber=="function")try{return e.toNumber()}catch{return e}return e})(),lastMessageAt:(()=>{const e=this.lastMessageAt;if(typeof e.toNumber=="function")try{return e.toNumber()}catch{return e}return e})(),flags:this.flags,memberCount:this.memberCount,messageCount:(()=>{const e=this.messageCount;if(typeof e.toNumber=="function")try{return e.toNumber()}catch{return e}return e})(),maxMessages:this.maxMessages,messages:this.messages}}}const Je=new f.FixableBeetStruct([["accountDiscriminator",f.uniformFixedSizeArray(f.u8,8)],["workspace",f.utf8String],["name",f.utf8String],["creator",he],["createdAt",f.i64],["lastMessageAt",f.i64],["flags",f.u8],["memberCount",f.u16],["messageCount",f.u64],["maxMessages",f.u16],["messages",f.array(Ci)]],de.fromArgs,"Channel"),Qe=new f.FixableBeetArgsStruct([["header",f.utf8String],["encryptedKey",f.utf8String]],"CEKData"),Mt=[163,153,9,169,176,51,204,146];class me{constructor(e,n,i,s,a){this.channel=e,this.authority=n,this.key=i,this.cek=s,this.bump=a}static fromArgs(e){return new me(e.channel,e.authority,e.key,e.cek,e.bump)}static fromAccountInfo(e,n=0){return me.deserialize(e.data,n)}static async fromAccountAddress(e,n,i){const s=await e.getAccountInfo(n,i);if(s==null)throw new Error(`Unable to find ChannelDevice account at ${n}`);return me.fromAccountInfo(s,0)[0]}static gpaBuilder(e=new T("4AnSBTc21f4wTBHmnFyarbosr28Qk4CgGFBHcRh4kYPw")){return Pt.fromStruct(e,Ye)}static deserialize(e,n=0){return Ye.deserialize(e,n)}serialize(){return Ye.serialize({accountDiscriminator:Mt,...this})}static byteSize(e){const n=me.fromArgs(e);return Ye.toFixedFromValue({accountDiscriminator:Mt,...n}).byteSize}static async getMinimumBalanceForRentExemption(e,n,i){return n.getMinimumBalanceForRentExemption(me.byteSize(e),i)}pretty(){return{channel:this.channel.toBase58(),authority:this.authority.toBase58(),key:this.key.toBase58(),cek:this.cek,bump:this.bump}}}const Ye=new f.FixableBeetStruct([["accountDiscriminator",f.uniformFixedSizeArray(f.u8,8)],["channel",he],["authority",he],["key",he],["cek",Qe],["bump",f.u8]],me.fromArgs,"ChannelDevice");var Ke=(t=>(t[t.Authorized=0]="Authorized",t[t.Pending=1]="Pending",t))(Ke||{});const xi=f.fixedScalarEnum(Ke),Ze=[238,149,255,251,116,131,86,170];class te{constructor(e,n,i,s,a,o,r,c,u){this.channel=e,this.authority=n,this.status=i,this.statusTarget=s,this.name=a,this.lastReadMessageId=o,this.createdAt=r,this.flags=c,this.bump=u}static fromArgs(e){return new te(e.channel,e.authority,e.status,e.statusTarget,e.name,e.lastReadMessageId,e.createdAt,e.flags,e.bump)}static fromAccountInfo(e,n=0){return te.deserialize(e.data,n)}static async fromAccountAddress(e,n,i){const s=await e.getAccountInfo(n,i);if(s==null)throw new Error(`Unable to find ChannelMembership account at ${n}`);return te.fromAccountInfo(s,0)[0]}static gpaBuilder(e=new T("4AnSBTc21f4wTBHmnFyarbosr28Qk4CgGFBHcRh4kYPw")){return Pt.fromStruct(e,Xe)}static deserialize(e,n=0){return Xe.deserialize(e,n)}serialize(){return Xe.serialize({accountDiscriminator:Ze,...this})}static byteSize(e){const n=te.fromArgs(e);return Xe.toFixedFromValue({accountDiscriminator:Ze,...n}).byteSize}static async getMinimumBalanceForRentExemption(e,n,i){return n.getMinimumBalanceForRentExemption(te.byteSize(e),i)}pretty(){return{channel:this.channel.toBase58(),authority:this.authority.toBase58(),status:`ChannelMembershipStatus.${Ke[this.status]}`,statusTarget:this.statusTarget,name:this.name,lastReadMessageId:(()=>{const e=this.lastReadMessageId;if(typeof e.toNumber=="function")try{return e.toNumber()}catch{return e}return e})(),createdAt:(()=>{const e=this.createdAt;if(typeof e.toNumber=="function")try{return e.toNumber()}catch{return e}return e})(),flags:this.flags,bump:this.bump}}}const Xe=new f.FixableBeetStruct([["accountDiscriminator",f.uniformFixedSizeArray(f.u8,8)],["channel",he],["authority",he],["status",xi],["statusTarget",f.coption(he)],["name",f.utf8String],["lastReadMessageId",f.u64],["createdAt",f.i64],["flags",f.u8],["bump",f.u8]],te.fromArgs,"ChannelMembership"),be=new Map,_e=new Map;class it extends Error{constructor(){super("Unauthorized");O(this,"code",6e3);O(this,"name","Unauthorized");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,it)}}be.set(6e3,()=>new it);_e.set("Unauthorized",()=>new it);class ot extends Error{constructor(){super("Invalid channel");O(this,"code",6001);O(this,"name","InvalidChannel");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,ot)}}be.set(6001,()=>new ot);_e.set("InvalidChannel",()=>new ot);class rt extends Error{constructor(){super("Invalid membership");O(this,"code",6002);O(this,"name","InvalidMembership");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,rt)}}be.set(6002,()=>new rt);_e.set("InvalidMembership",()=>new rt);class lt extends Error{constructor(){super("Invalid device");O(this,"code",6003);O(this,"name","InvalidDevice");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,lt)}}be.set(6003,()=>new lt);_e.set("InvalidDevice",()=>new lt);class ct extends Error{constructor(){super("Invalid message");O(this,"code",6004);O(this,"name","InvalidMessage");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,ct)}}be.set(6004,()=>new ct);_e.set("InvalidMessage",()=>new ct);class ut extends Error{constructor(){super("Name too long");O(this,"code",6005);O(this,"name","NameTooLong");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,ut)}}be.set(6005,()=>new ut);_e.set("NameTooLong",()=>new ut);class dt extends Error{constructor(){super("Workspace too long");O(this,"code",6006);O(this,"name","WorkspaceTooLong");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,dt)}}be.set(6006,()=>new dt);_e.set("WorkspaceTooLong",()=>new dt);class mt extends Error{constructor(){super("Message too long");O(this,"code",6007);O(this,"name","MessageTooLong");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,mt)}}be.set(6007,()=>new mt);_e.set("MessageTooLong",()=>new mt);function re(t){const e=be.get(t);return e!=null?e():null}function Se(t){const e=_e.get(t);return e!=null?e():null}const Di=new f.FixableBeetArgsStruct([["key",he],["cek",Qe]],"AddDeviceData"),$i=new f.FixableBeetArgsStruct([["instructionDiscriminator",f.uniformFixedSizeArray(f.u8,8)],["data",Di]],"AddDeviceInstructionArgs"),Ii=[21,27,66,42,18,30,14,18];function Ei(t,e,n=new T("4AnSBTc21f4wTBHmnFyarbosr28Qk4CgGFBHcRh4kYPw")){var o;const[i]=$i.serialize({instructionDiscriminator:Ii,...e}),s=[{pubkey:t.channel,isWritable:!0,isSigner:!1},{pubkey:t.membership,isWritable:!0,isSigner:!1},{pubkey:t.device,isWritable:!0,isSigner:!1},{pubkey:t.authority,isWritable:!0,isSigner:!0},{pubkey:(o=t.systemProgram)!=null?o:se.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const r of t.anchorRemainingAccounts)s.push(r);return new le({programId:n,keys:s,data:i})}const Pi=new f.FixableBeetArgsStruct([["name",f.utf8String],["flags",f.u8],["cek",Qe],["key",he]],"AddMemberData"),Bi=new f.FixableBeetArgsStruct([["instructionDiscriminator",f.uniformFixedSizeArray(f.u8,8)],["data",Pi]],"AddMemberInstructionArgs"),Ti=[13,116,123,130,126,198,57,34];function Ki(t,e,n=new T("4AnSBTc21f4wTBHmnFyarbosr28Qk4CgGFBHcRh4kYPw")){var o;const[i]=Bi.serialize({instructionDiscriminator:Ti,...e}),s=[{pubkey:t.channel,isWritable:!0,isSigner:!1},{pubkey:t.invitee,isWritable:!1,isSigner:!1},{pubkey:t.inviteeMembership,isWritable:!0,isSigner:!1},{pubkey:t.inviteeDevice,isWritable:!0,isSigner:!1},{pubkey:t.authorityMembership,isWritable:!0,isSigner:!1},{pubkey:t.authority,isWritable:!0,isSigner:!0},{pubkey:(o=t.systemProgram)!=null?o:se.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const r of t.anchorRemainingAccounts)s.push(r);return new le({programId:n,keys:s,data:i})}const Li=new f.FixableBeetArgsStruct([["cek",Qe]],"AuthorizeMemberData"),zi=new f.FixableBeetArgsStruct([["instructionDiscriminator",f.uniformFixedSizeArray(f.u8,8)],["data",Li]],"AuthorizeMemberInstructionArgs"),Wi=[194,123,189,175,86,225,93,128];function Ni(t,e,n=new T("4AnSBTc21f4wTBHmnFyarbosr28Qk4CgGFBHcRh4kYPw")){var o;const[i]=zi.serialize({instructionDiscriminator:Wi,...e}),s=[{pubkey:t.channel,isWritable:!1,isSigner:!1},{pubkey:t.membership,isWritable:!0,isSigner:!1},{pubkey:t.device,isWritable:!0,isSigner:!1},{pubkey:t.authority,isWritable:!1,isSigner:!0},{pubkey:t.authorityMembership,isWritable:!0,isSigner:!1},{pubkey:(o=t.systemProgram)!=null?o:se.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const r of t.anchorRemainingAccounts)s.push(r);return new le({programId:n,keys:s,data:i})}const Fi=new f.BeetArgsStruct([["instructionDiscriminator",f.uniformFixedSizeArray(f.u8,8)]],"DeleteChannelInstructionArgs"),Ri=[145,225,187,221,157,142,114,133];function Oi(t,e=new T("4AnSBTc21f4wTBHmnFyarbosr28Qk4CgGFBHcRh4kYPw")){var a;const[n]=Fi.serialize({instructionDiscriminator:Ri}),i=[{pubkey:t.channel,isWritable:!0,isSigner:!1},{pubkey:t.authorityMembership,isWritable:!0,isSigner:!1},{pubkey:t.authority,isWritable:!0,isSigner:!0},{pubkey:(a=t.systemProgram)!=null?a:se.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const o of t.anchorRemainingAccounts)i.push(o);return new le({programId:e,keys:i,data:n})}const Vi=new f.BeetArgsStruct([["instructionDiscriminator",f.uniformFixedSizeArray(f.u8,8)]],"DeleteDeviceInstructionArgs"),qi=[168,96,86,82,105,2,215,144];function Hi(t,e=new T("4AnSBTc21f4wTBHmnFyarbosr28Qk4CgGFBHcRh4kYPw")){var a;const[n]=Vi.serialize({instructionDiscriminator:qi}),i=[{pubkey:t.channel,isWritable:!0,isSigner:!1},{pubkey:t.device,isWritable:!0,isSigner:!1},{pubkey:t.deviceAuthority,isWritable:!0,isSigner:!1},{pubkey:t.authority,isWritable:!1,isSigner:!0},{pubkey:(a=t.systemProgram)!=null?a:se.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const o of t.anchorRemainingAccounts)i.push(o);return new le({programId:e,keys:i,data:n})}const Ui=new f.BeetArgsStruct([["instructionDiscriminator",f.uniformFixedSizeArray(f.u8,8)]],"DeleteMemberInstructionArgs"),ji=[95,14,98,112,252,218,205,173];function Qi(t,e=new T("4AnSBTc21f4wTBHmnFyarbosr28Qk4CgGFBHcRh4kYPw")){var a;const[n]=Ui.serialize({instructionDiscriminator:ji}),i=[{pubkey:t.channel,isWritable:!0,isSigner:!1},{pubkey:t.membership,isWritable:!0,isSigner:!1},{pubkey:t.membershipAuthority,isWritable:!0,isSigner:!1},{pubkey:t.authorityMembership,isWritable:!1,isSigner:!1},{pubkey:t.authority,isWritable:!1,isSigner:!0},{pubkey:(a=t.systemProgram)!=null?a:se.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const o of t.anchorRemainingAccounts)i.push(o);return new le({programId:e,keys:i,data:n})}const Gi=new f.BeetArgsStruct([["flags",f.u8]],"GrantAccessMemberData"),Ji=new f.BeetArgsStruct([["instructionDiscriminator",f.uniformFixedSizeArray(f.u8,8)],["data",Gi]],"GrantAccessMemberInstructionArgs"),Yi=[236,46,184,64,57,158,80,142];function Xi(t,e,n=new T("4AnSBTc21f4wTBHmnFyarbosr28Qk4CgGFBHcRh4kYPw")){var o;const[i]=Ji.serialize({instructionDiscriminator:Yi,...e}),s=[{pubkey:t.channel,isWritable:!1,isSigner:!1},{pubkey:t.membership,isWritable:!0,isSigner:!1},{pubkey:t.authorityMembership,isWritable:!1,isSigner:!1},{pubkey:t.authority,isWritable:!0,isSigner:!0},{pubkey:(o=t.systemProgram)!=null?o:se.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const r of t.anchorRemainingAccounts)s.push(r);return new le({programId:n,keys:s,data:i})}const Zi=new f.FixableBeetArgsStruct([["workspace",f.utf8String],["name",f.utf8String],["maxMessages",f.u16],["memberName",f.utf8String],["cek",Qe],["public",f.bool],["permissionless",f.bool]],"InitChannelData"),eo=new f.FixableBeetArgsStruct([["instructionDiscriminator",f.uniformFixedSizeArray(f.u8,8)],["data",Zi]],"InitChannelInstructionArgs"),to=[21,200,152,39,19,178,76,47];function no(t,e,n=new T("4AnSBTc21f4wTBHmnFyarbosr28Qk4CgGFBHcRh4kYPw")){var o;const[i]=eo.serialize({instructionDiscriminator:to,...e}),s=[{pubkey:t.channel,isWritable:!0,isSigner:!1},{pubkey:t.membership,isWritable:!0,isSigner:!1},{pubkey:t.device,isWritable:!0,isSigner:!1},{pubkey:t.authority,isWritable:!0,isSigner:!0},{pubkey:t.key,isWritable:!1,isSigner:!0},{pubkey:(o=t.systemProgram)!=null?o:se.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const r of t.anchorRemainingAccounts)s.push(r);return new le({programId:n,keys:s,data:i})}const ao=new f.FixableBeetArgsStruct([["name",f.utf8String],["authority",f.coption(he)]],"JoinChannelData"),so=new f.FixableBeetArgsStruct([["instructionDiscriminator",f.uniformFixedSizeArray(f.u8,8)],["data",ao]],"JoinChannelInstructionArgs"),io=[124,39,115,89,217,26,38,29];function oo(t,e,n=new T("4AnSBTc21f4wTBHmnFyarbosr28Qk4CgGFBHcRh4kYPw")){var o;const[i]=so.serialize({instructionDiscriminator:io,...e}),s=[{pubkey:t.channel,isWritable:!0,isSigner:!1},{pubkey:t.membership,isWritable:!0,isSigner:!1},{pubkey:t.device,isWritable:!0,isSigner:!1},{pubkey:t.authority,isWritable:!0,isSigner:!0},{pubkey:t.key,isWritable:!1,isSigner:!0},{pubkey:(o=t.systemProgram)!=null?o:se.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const r of t.anchorRemainingAccounts)s.push(r);return new le({programId:n,keys:s,data:i})}const ro=new f.BeetArgsStruct([["instructionDiscriminator",f.uniformFixedSizeArray(f.u8,8)]],"LeaveChannelInstructionArgs"),lo=[104,0,75,134,95,80,68,186];function co(t,e=new T("4AnSBTc21f4wTBHmnFyarbosr28Qk4CgGFBHcRh4kYPw")){var a;const[n]=ro.serialize({instructionDiscriminator:lo}),i=[{pubkey:t.channel,isWritable:!0,isSigner:!1},{pubkey:t.membership,isWritable:!0,isSigner:!1},{pubkey:t.authority,isWritable:!0,isSigner:!0},{pubkey:(a=t.systemProgram)!=null?a:se.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const o of t.anchorRemainingAccounts)i.push(o);return new le({programId:e,keys:i,data:n})}const uo=new f.FixableBeetArgsStruct([["instructionDiscriminator",f.uniformFixedSizeArray(f.u8,8)],["message",f.utf8String]],"PostMessageInstructionArgs"),mo=[214,50,100,209,38,34,7,76];function ho(t,e,n=new T("4AnSBTc21f4wTBHmnFyarbosr28Qk4CgGFBHcRh4kYPw")){var o;const[i]=uo.serialize({instructionDiscriminator:mo,...e}),s=[{pubkey:t.channel,isWritable:!0,isSigner:!1},{pubkey:t.membership,isWritable:!1,isSigner:!1},{pubkey:t.authority,isWritable:!1,isSigner:!0},{pubkey:(o=t.systemProgram)!=null?o:se.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const r of t.anchorRemainingAccounts)s.push(r);return new le({programId:n,keys:s,data:i})}const po=new f.BeetArgsStruct([["instructionDiscriminator",f.uniformFixedSizeArray(f.u8,8)],["messageId",f.u64]],"ReadMessageInstructionArgs"),go=[54,166,48,51,234,46,110,163];function fo(t,e,n=new T("4AnSBTc21f4wTBHmnFyarbosr28Qk4CgGFBHcRh4kYPw")){var o;const[i]=po.serialize({instructionDiscriminator:go,...e}),s=[{pubkey:t.channel,isWritable:!0,isSigner:!1},{pubkey:t.membership,isWritable:!0,isSigner:!1},{pubkey:t.authority,isWritable:!1,isSigner:!0},{pubkey:(o=t.systemProgram)!=null?o:se.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const r of t.anchorRemainingAccounts)s.push(r);return new le({programId:n,keys:s,data:i})}const yo="4AnSBTc21f4wTBHmnFyarbosr28Qk4CgGFBHcRh4kYPw",bo=new T(yo);function Ct(t,e=new Uint8Array(4)){const n=Ve(t.toString(),"base10");return e.set(n,4-n.length),e}const wt=t=>Le([Ct(t.length),t]);function Xt(t,e,n){if(e!==256)throw new Error(`Unsupported key length: ${e}`);const i=Le([wt(Ve(n)),wt(new Uint8Array(0)),wt(new Uint8Array(0)),Ct(e)]),s=1;return Pn.hash(Le([Ct(s),t,i]))}const xt=t=>Ve(t,"base64pad"),Dt=t=>qt(t,"base64pad"),_o=t=>Ve(t),vo=t=>qt(t),wo=t=>Ve(t,"base58btc"),Me=nt.NONCE_LENGTH,ze=nt.TAG_LENGTH,Zt=t=>{const e=new nt.XChaCha20Poly1305(t);return(n,i)=>{const s=Ht.randomBytes(Me),a=e.seal(s,n,i);return{ciphertext:a.subarray(0,a.length-ze),tag:a.subarray(a.length-ze),iv:s}}},en=t=>{const e=new nt.XChaCha20Poly1305(t);return(n,i,s,a)=>e.open(s,Le([n,i]),a)},tn="ECDH-ES+XC20PKW",nn=256,ko=t=>e=>{const n=At.generateKeyPair(),i=At.sharedKey(n.secretKey,t),s=Xt(i,nn,tn),a=Zt(s)(e);return{encryptedKey:a.ciphertext,tag:a.tag,iv:a.iv,epPubKey:n.publicKey}},Ao=t=>(e,n,i,s)=>{const a=At.sharedKey(t,s),o=Xt(a,nn,tn);return en(o)(e,n,i)},So=t=>Array.isArray(t)?Ce.fromSecretKey(Kn.Buffer.from(t)):typeof t=="string"?Ce.fromSecretKey(wo(t)):Ce.fromSecretKey(t),Mo=async(t=32)=>{const e=Ht.randomBytes(t);return Promise.resolve(e)},Co=async(t,e)=>{const n=await ko(Bn(e.toBytes()))(t);return{header:Dt(Le([n.iv,n.tag,n.epPubKey])),encryptedKey:Dt(n.encryptedKey)}},xo=async(t,e)=>{const n=xt(t.header),i=n.subarray(0,Me),s=n.subarray(Me,Me+ze),a=n.subarray(Me+ze),o=xt(t.encryptedKey),r=So(e).secretKey,c=Tn(r),u=await Ao(c)(o,s,i,a);if(u===null)throw new Error("There was a problem decrypting the CEK");return u},Do=async(t,e)=>{const n=await Zt(e)(_o(t));return Dt(Le([n.iv,n.ciphertext,n.tag]))},$o=async(t,e)=>{const n=xt(t),i=n.subarray(0,Me),s=n.subarray(Me,-ze),a=n.subarray(-ze),o=await en(e)(s,a,i);if(o===null)throw new Error("There was an error decoding the message!");return vo(o)},Io={maxWorkspaceLength:32,maxChannelNameLength:32,maxMemberNameLength:32,maxMessageLength:400,maxCEKLength:100};class Eo{constructor(e,n){O(this,"programId",bo);O(this,"constants",Io);O(this,"workspace");O(this,"_coder");O(this,"_events");O(this,"utils",{channel:{isPublic:e=>(e.flags&1)>0,isPermissionless:e=>(e.flags&2)>0},member:{isAuthorized:e=>e.status===Ke.Authorized,isPending:e=>e.status===Ke.Pending,isOwner:e=>e.flags>=255,isAdmin:e=>(e.flags&7)===7,canAddMember:e=>(e.flags&1)>0,canDeleteMember:e=>(e.flags&2)>0,canAuthorizeMember:e=>(e.flags&4)>0},message:{isEncrypted:e=>(e.flags&1)>0}});this.provider=e,this.keypair=n,this._coder=new Ln(Mi),this._events=new zn(this.programId,e,this._coder)}get connection(){return this.provider.connection}addEventListener(e,n){return this._events.addEventListener(e,n)}async removeEventListener(e){return await this._events.removeEventListener(e)}setKeypair(e){this.keypair=e}async loadAllChannels(e={}){const n=de.gpaBuilder().addFilter("accountDiscriminator",St);return this.workspace!==void 0&&n.addFilter("workspace",this.workspace),e.name&&n.addFilter("name",e.name),e.creator&&n.addFilter("creator",e.creator),(await n.run(this.provider.connection)).map(i=>({pubkey:i.pubkey,data:de.fromAccountInfo(i.account)[0]}))}async loadChannel(e,n){return de.fromAccountAddress(this.provider.connection,e,n)}async loadChannelMembers(e){return(await te.gpaBuilder().addFilter("accountDiscriminator",Ze).addFilter("channel",e).run(this.provider.connection)).map(i=>({pubkey:i.pubkey,data:te.fromAccountInfo(i.account)[0]}))}async loadMemberships(){return(await te.gpaBuilder().addFilter("accountDiscriminator",Ze).addFilter("authority",this.provider.publicKey).run(this.provider.connection)).map(i=>({pubkey:i.pubkey,data:te.fromAccountInfo(i.account)[0]}))}async loadMembership(e,n){return te.fromAccountAddress(this.provider.connection,e,n)}async getMembershipPDA(e,n){return n=n!=null?n:this.provider.publicKey,await T.findProgramAddress([e.toBuffer(),n.toBuffer()],this.programId)}async loadDevices(e,n){return(await me.gpaBuilder().addFilter("accountDiscriminator",Mt).addFilter("authority",n!=null?n:this.provider.publicKey).addFilter("channel",e).run(this.provider.connection)).map(a=>({pubkey:a.pubkey,data:me.fromAccountInfo(a.account)[0]}))}async loadDevice(e,n){return me.fromAccountAddress(this.provider.connection,e,n)}async getDevicePDA(e,n){return n=n!=null?n:this.keypair.publicKey,await T.findProgramAddress([e.toBuffer(),n.toBuffer()],this.programId)}async encryptCEK(e,n){return Co(e,n!=null?n:this.keypair.publicKey)}async decryptCEK(e,n){return xo(e,n!=null?n:this.keypair.secretKey)}async encryptMessage(e,n){return Do(e,n)}async decryptMessage(e,n){return $o(e,n)}async initChannel(e,n){var v,k,A,S,D,w;const i=(v=e.channel)!=null?v:Ce.generate(),s=await Mo(),a=await this.encryptCEK(s),[o]=await this.getMembershipPDA(i.publicKey),[r]=await this.getDevicePDA(o),c=this.provider.publicKey,u=new oe,h=this.channelSpace(e.maxMessages);u.add(se.createAccount({fromPubkey:c,newAccountPubkey:i.publicKey,lamports:await this.connection.getMinimumBalanceForRentExemption(h,n==null?void 0:n.commitment),space:h,programId:this.programId})),u.add(no({key:this.keypair.publicKey,channel:i.publicKey,membership:o,device:r,authority:c},{data:{workspace:(k=e.workspace)!=null?k:"",name:e.name,public:(A=e.public)!=null?A:!1,permissionless:(S=e.permissionless)!=null?S:!1,memberName:(D=e.memberName)!=null?D:"",maxMessages:e.maxMessages,cek:a}}));let g;try{g=await this.provider.sendAndConfirm(u,[i,this.keypair],n)}catch(B){throw(w=re(B.code))!=null?w:B}return{signature:g,channel:i,cek:s,cekEncrypted:a}}async deleteChannel({channel:e},n){var r;const i=this.provider.publicKey,[s]=await this.getMembershipPDA(e),a=new oe;a.add(Oi({channel:e,authority:i,authorityMembership:s}));let o;try{o=await this.provider.sendAndConfirm(a,void 0,n)}catch(c){throw(r=re(c.code))!=null?r:Se("Unauthorized")}return{signature:o}}async joinChannel(e,n){var u,h;const[i]=await this.getMembershipPDA(e.channel),[s]=await this.getDevicePDA(i),a=this.provider.publicKey,o=this.keypair.publicKey,r=new oe;r.add(oo({channel:e.channel,membership:i,device:s,authority:a,key:o},{data:{name:e.name,authority:(u=e.authority)!=null?u:null}}));let c;try{c=await this.provider.sendAndConfirm(r,[this.keypair],n)}catch(g){throw(h=re(g.code))!=null?h:g}return{signature:c}}async leaveChannel(e,n){var c;const[i]=await this.getMembershipPDA(e.channel),s=this.provider.publicKey,a=new oe,o=await this.loadDevices(e.channel);a.add(co({channel:e.channel,membership:i,authority:s,anchorRemainingAccounts:o.map(u=>({pubkey:u.pubkey,isSigner:!1,isWritable:!0}))}));let r;try{r=await this.provider.sendAndConfirm(a,void 0,n)}catch(u){throw(c=re(u.code))!=null?c:u}return{signature:r}}async addMember(e,n){var k,A,S,D;const i=(k=e.key)!=null?k:e.invitee,[s]=await this.getMembershipPDA(e.channel),[a]=await this.getDevicePDA(s),[o]=await this.getMembershipPDA(e.channel,e.invitee),[r]=await this.getDevicePDA(o,i),c=await this.loadDevice(a);if(!c.cek.encryptedKey)throw Se("Unauthorized");const u=await this.decryptCEK(c.cek),h=await this.encryptCEK(u,i),g=new oe;g.add(Ki({channel:e.channel,authority:this.provider.publicKey,invitee:e.invitee,authorityMembership:s,inviteeMembership:o,inviteeDevice:r},{data:{name:(A=e.name)!=null?A:"",flags:(S=e.flags)!=null?S:0,cek:h,key:i}}));let v;try{v=await this.provider.sendAndConfirm(g,void 0,n)}catch(w){throw(D=re(w.code))!=null?D:w}return{signature:v}}async deleteMember(e,n){var u;const[i]=await this.getMembershipPDA(e.channel,e.authority),[s]=await this.getMembershipPDA(e.channel),a=this.provider.publicKey,o=await this.loadDevices(e.channel,e.authority),r=new oe;r.add(Qi({channel:e.channel,membership:i,membershipAuthority:e.authority,authority:a,authorityMembership:s,anchorRemainingAccounts:o.map(h=>({pubkey:h.pubkey,isSigner:!1,isWritable:!0}))}));let c;try{c=await this.provider.sendAndConfirm(r,void 0,n)}catch(h){throw console.log(h),(u=re(h.code))!=null?u:h}return{signature:c}}async authorizeMember(e,n){var k,A;const i=(k=e.key)!=null?k:e.authority,[s]=await this.getMembershipPDA(e.channel),[a]=await this.getDevicePDA(s),[o]=await this.getMembershipPDA(e.channel,e.authority),[r]=await this.getDevicePDA(o,i),c=await this.loadDevice(a);if(!c.cek.encryptedKey)throw Se("Unauthorized");const u=await this.decryptCEK(c.cek),h=await this.encryptCEK(u,i),g=new oe;g.add(Ni({channel:e.channel,membership:o,device:r,authority:this.provider.publicKey,authorityMembership:s},{data:{cek:h}}));let v;try{v=await this.provider.sendAndConfirm(g,void 0,n)}catch(S){throw(A=re(S.code))!=null?A:Se("Unauthorized")}return{signature:v}}async grantAccessMember(e,n){var r;const[i]=await this.getMembershipPDA(e.channel),[s]=await this.getMembershipPDA(e.channel,e.authority),a=new oe;a.add(Xi({channel:e.channel,membership:s,authority:this.provider.publicKey,authorityMembership:i},{data:{flags:e.flags}}));let o;try{o=await this.provider.sendAndConfirm(a,void 0,n)}catch(c){throw(r=re(c.code))!=null?r:Se("Unauthorized")}return{signature:o}}async addDevice(e,n){var g;const[i]=await this.getMembershipPDA(e.channel),[s]=await this.getDevicePDA(i),[a]=await this.getDevicePDA(i,e.key),o=await this.loadDevice(s);if(!(o!=null&&o.cek.encryptedKey))throw Se("Unauthorized");const r=await this.decryptCEK(o.cek),c=await this.encryptCEK(r,e.key),u=new oe;u.add(Ei({channel:e.channel,authority:this.provider.publicKey,membership:i,device:a},{data:{cek:c,key:e.key}}));let h;try{h=await this.provider.sendAndConfirm(u,void 0,n)}catch(v){throw(g=re(v.code))!=null?g:v}return{signature:h}}async deleteDevice(e,n){var c,u;const i=(c=e.authority)!=null?c:this.provider.publicKey,[s]=await this.getMembershipPDA(e.channel,i),[a]=await this.getDevicePDA(s,e.key),o=new oe;o.add(Hi({channel:e.channel,authority:this.provider.publicKey,device:a,deviceAuthority:i}));let r;try{r=await this.provider.sendAndConfirm(o,void 0,n)}catch(h){throw(u=re(h.code))!=null?u:h}return{signature:r}}async postMessage(e,n){var u;const[i]=await this.getMembershipPDA(e.channel),[s]=await this.getDevicePDA(i);let a,o=0;if(e.encrypt){const h=await this.loadDevice(s);if(!h.cek.header)throw Se("Unauthorized");const g=await this.decryptCEK(h.cek);a=await this.encryptMessage(e.message,g),o|=1}else a=e.message;const r=new oe;r.add(ho({channel:e.channel,membership:i,authority:this.provider.publicKey},{message:String.fromCharCode(o)+a}));let c;try{c=await this.provider.sendAndConfirm(r,void 0,n)}catch(h){throw(u=re(h.code))!=null?u:h}return{signature:c}}async readMessage(e,n){var o;const[i]=await this.getMembershipPDA(e.channel),s=new oe;s.add(fo({channel:e.channel,membership:i,authority:this.provider.publicKey},{messageId:e.messageId}));let a;try{a=await this.provider.sendAndConfirm(s,void 0,n)}catch(r){throw(o=re(r.code))!=null?o:r}return{signature:a}}channelSpace(e=1){return de.byteSize({workspace:"x".repeat(this.constants.maxWorkspaceLength),name:"x".repeat(this.constants.maxChannelNameLength),creator:T.default,createdAt:0,lastMessageAt:0,flags:0,memberCount:0,messageCount:0,maxMessages:e,messages:Array(e).fill({id:0,sender:T.default,createdAt:0,flags:0,content:"x".repeat(this.constants.maxMessageLength)})})}channelMembershipSpace(){return te.byteSize({authority:T.default,bump:0,channel:T.default,createdAt:0,flags:0,lastReadMessageId:0,name:"x".repeat(this.constants.maxMemberNameLength),status:Ke.Authorized,statusTarget:T.default})}channelDeviceSpace(){return me.byteSize({authority:T.default,channel:T.default,key:T.default,cek:{encryptedKey:"x".repeat(this.constants.maxCEKLength),header:"x".repeat(72)},bump:0})}}const Ft=t=>"***** *** *** *** *******",q=We("messenger",()=>{const t=st(),e=je(),n=tt(),i=_(()=>e.keypair),s={allChannels:[],ownChannels:[],channel:void 0,channelAddr:void 0,channelMembershipAddr:void 0,channelMembership:void 0,channelMembers:[],channelMessages:[],channelLoading:!1,memberDevices:[],loading:!1,creating:!1,sending:!1},a=ie({...s}),o=_(()=>{var b;return new Eo(new Wt(t.connection,(b=n.value)!=null?b:{publicKey:T.default},Wt.defaultOptions()),e.keypair)});let r=[];ae(n,b=>{b?h().then():g()},{immediate:!0}),ae([i,()=>a.allChannels],()=>{c().then()},{immediate:!0});async function c(){const $=(await o.value.loadMemberships()).map(L=>({pubkey:L.data.channel.toBase58(),status:L.data.status}));a.ownChannels=$}async function u(){console.log("Register events...");for(const b of r)await o.value.removeEventListener(b);r.push(o.value.addEventListener("NewMessageEvent",async b=>{if(console.log("[Event] NewMessageEvent",b),`${b.channel}`!=`${a.channelAddr}`)return;let $=b.message.content;if(o.value.utils.message.isEncrypted(b.message)){const Q=await w();Q?$=await o.value.decryptMessage(b.message.content,Q):$=Ft(b.message.content)}a.channelMessages.push({...b.message,content:$})})),r.push(o.value.addEventListener("AuthorizeMemberEvent",async b=>{console.log("[Event] AuthorizeMemberEvent",b),!(a.channelAddr&&`${b.channel}`!=`${a.channelAddr}`)&&(`${b.membership}`==`${a.channelMembershipAddr}`?D(a.channelAddr).then():V().then())})),r.push(o.value.addEventListener("JoinChannelEvent",async b=>{console.log("[Event] JoinChannelEvent",b),`${b.channel}`==`${a.channelAddr}`&&V().then()})),r.push(o.value.addEventListener("LeaveChannelEvent",async b=>{console.log("[Event] LeaveChannelEvent",b),`${b.channel}`==`${a.channelAddr}`&&V().then()}))}async function h(){g(),r=[],a.loading=!0;const b=await o.value.loadAllChannels();await u(),a.allChannels=b,a.loading=!1,console.log(a)}function g(){Object.assign(a,s)}async function v(b,$){try{a.creating=!0;const{channel:L}=await o.value.initChannel({name:b,maxMessages:Number($.maxMessages),public:$.public,permissionless:$.permissionless});await D(L.publicKey),a.channel&&a.allChannels.push({pubkey:L.publicKey,data:a.channel})}finally{a.creating=!1}}async function k(b){const $=new T(b);await o.value.deleteChannel({channel:$}),Ge(b)}async function A(b){console.log("leaveChannel channel === ",b.toBase58()),await o.value.leaveChannel({channel:b}),Ge(b)}async function S(b,$){const L=new T(b);try{await o.value.joinChannel({channel:L,name:$}),await D(b);const Q={pubkey:b.toString(),status:1};a.ownChannels.push(Q)}catch(Q){console.log(Q)}}async function D(b){var $,L,Q,W;a.channelLoading=!0,a.channelMessages=($=a.channelMessages)!=null?$:[],a.channelMembers=(L=a.channelMembers)!=null?L:[],a.channelMembershipAddr=void 0,a.channelMembership=(Q=a.channelMembership)!=null?Q:void 0,a.channelAddr=new T(b),a.memberDevices=[];try{if((W=n.value)!=null&&W.publicKey)try{const[fe]=await o.value.getMembershipPDA(a.channelAddr);a.channelMembershipAddr=fe,a.channelMembership=await o.value.loadMembership(fe)}catch(fe){console.log(fe),a.channelMembershipAddr=void 0,a.channelMembership=void 0}await Pe(),await V(),await B()}catch(fe){console.log("Error",fe)}finally{a.channelLoading=!1}}async function w(){if(!(!a.channelMembership||!i.value))try{const[b]=await o.value.getMembershipPDA(a.channelAddr),[$]=await o.value.getDevicePDA(b,i.value.publicKey),L=await o.value.loadDevice($);return await o.value.decryptCEK(L.cek,i.value.secretKey)}catch(b){console.log(b)}}async function B(){if(!a.channelAddr){console.log("Invalid channel");return}a.channel=await o.value.loadChannel(a.channelAddr);const $=o.value.utils.channel.isPublic(a.channel)?null:await w();a.channelMessages=await Promise.all(a.channel.messages.map(async L=>{let W=o.value.utils.message.isEncrypted(L)?Ft(L.content):L.content;const fe=Ue(L.sender);if($)try{W=await o.value.decryptMessage(L.content,$)}catch{console.log(`Failed to decrypt message #${L.id}`)}return{...L,senderDisplayName:fe,content:W}}))}async function V(){if(!a.channelAddr){console.error("Invalid channel");return}a.channelMembers=await x()}async function x(b=a.channelAddr){return await o.value.loadChannelMembers(b)}async function P(b){if(!a.channelAddr){console.log("Please select a channel");return}try{a.sending=!0;let $;a.channel&&($=o.value.utils.channel.isPublic(a.channel)),await o.value.postMessage({channel:a.channelAddr,message:b,encrypt:!$}),await B()}finally{a.sending=!1}}async function E(b,$,L,Q){if(!a.channelAddr){console.log("Invalid channel");return}await o.value.addMember({channel:a.channelAddr,invitee:new T(b),key:$?new T($):void 0,name:L,flags:Q})}async function G(b){if(!a.channelAddr){console.log("Invalid channel");return}await o.value.deleteMember({channel:a.channelAddr,authority:new T(b)})}async function ue(b){if(!a.channelAddr){console.log("Invalid channel");return}await o.value.addDevice({channel:a.channelAddr,key:new T(b)}),await Pe()}async function Ee(b){if(!a.channelAddr){console.log("Invalid channel");return}await o.value.deleteDevice({channel:a.channelAddr,key:b}),await Pe()}async function ht(b){return(await o.value.loadDevices(a.channelAddr,b)).filter($=>{var L;return((L=$.data.cek)==null?void 0:L.encryptedKey)===""})[0]}async function Pe(){a.channelAddr&&a.channelMembership&&(a.memberDevices=await o.value.loadDevices(a.channelAddr,a.channelMembership.authority))}async function J(b){if(!a.channelAddr){console.log("Invalid channel");return}const $=await ht(b);await o.value.authorizeMember({channel:a.channelAddr,authority:b,key:$.data.key}),await pt()}async function z(){await h()}async function pt(){a.channelMembers=await x()}async function gt(b){a.channelAddr=b}function Ge(b){const $=a.allChannels.findIndex(L=>L.pubkey.toBase58()===b.toString());a.allChannels.splice($,1),a.channelMessages=[],a.channel=void 0}async function ft(b){const $=await o.value.channelSpace(b),L=await o.value.channelMembershipSpace(),Q=await o.value.channelDeviceSpace(),W=$+L+Q;return Number(await t.connection.getMinimumBalanceForRentExemption(W)/Et)}async function yt(){if(!a.channelAddr)return;const[b]=await o.value.getMembershipPDA(a.channelAddr),[$]=await o.value.getDevicePDA(b);return(await o.value.loadDevice($)).key.toBase58()}return{channelMessagesCost:ft,addDevice:ue,deleteDevice:Ee,channelAuthorityDevice:yt,state:a,client:o.value,leaveChannel:A,loadChannel:D,joinChannel:S,createChannel:v,deleteChannel:k,postMessage:P,addMember:E,deleteMember:G,authorizeMember:J,refreshList:z,loadMembers:x,selectChannel:gt}});function Po(){const{connection:t}=st(),e=ye(),{notify:n}=ke(),i=F(!1);return{isAirdrop:i,airdropSol:async()=>{try{const a=await t.requestAirdrop(e.publicKey.value,1*Et);await t.confirmTransaction(a),n({type:"positive",message:"you got 1 sol",timeout:2e3,position:"top"}),i.value=!0}catch(a){console.log(a)}}}}const an=15;function Bo(){const{createChannel:t}=q(),{isWalletConnected:e,ok:n,error:i,noSol:s}=ce(),{userBalance:a}=je(),o=ie({dialog:!1,name:"",maxMessages:an,public:!1,permissionless:!1,loading:!1});async function r(){if(e())try{if(!await a()){s();return}await t(o.name,{maxMessages:o.maxMessages,public:o.public,permissionless:o.permissionless}),c(),n("Channel was created!")}catch(u){i("Something went wrong"),console.log(u)}}function c(){o.dialog=!1,o.public=!1,o.loading=!1,o.name="",o.maxMessages=15}return{state:o,submit:r,reset:c}}function To(){const t=q(),{info:e,ok:n,error:i}=ce(),s=ie({loading:!1});async function a(){if(!t.state.channelAddr){e("Please select a channel");return}try{s.loading=!0,await t.deleteChannel(t.state.channelAddr),n("Channel was deleted!")}catch(o){console.log("Error",o),i("Something went wrong")}finally{s.loading=!1}}return{state:s,submit:a}}function sn(){const{authorizeMember:t,loadChannel:e,state:n}=q(),{ok:i,error:s}=ce(),a=ie({loading:!1,dialog:!1});async function o(r){var c;try{a.loading=!0,await t(r),await e((c=n.channelAddr)!=null?c:""),i("Member was authorized")}catch(u){s("Something went wrong"),console.log(u)}finally{a.loading=!1}}return{state:a,submit:o}}function Ko(){const{state:t,addMember:e,loadChannel:n}=q(),{ok:i,info:s,error:a,noSol:o}=ce(),{userBalance:r}=je(),c=ie({dialog:!1,loading:!1});async function u(g){var v;if(c.loading=!0,!t.channelAddr){s("Please select a channel");return}try{if(!await r()){o();return}return await e(g.wallet,g.key,g.name),await n((v=t.channelAddr)!=null?v:""),i("Member was added"),!0}catch(k){a("Something went wrong"),console.log(k)}finally{c.loading=!1,c.dialog=!1}return!1}function h(){c.loading=!1,c.dialog=!1}return{state:c,submit:u,reset:h}}function on(){const{deleteMember:t,loadChannel:e,state:n}=q(),{ok:i,error:s}=ce(),a=ie({loading:!1});async function o(r){var c;try{a.loading=!0,await t(r),await e((c=n.channelAddr)!=null?c:""),i("Member was deleted")}catch(u){s("Something went wrong"),console.log(u)}finally{a.loading=!1}}return{state:a,submit:o}}function Lo(){const{state:t,joinChannel:e}=q(),{ok:n,info:i,error:s,noSol:a}=ce(),{userBalance:o}=je(),r=ie({dialog:!1,loading:!1,name:""});async function c(){if(!t.channelAddr){i("Please select a channel");return}r.loading=!0;try{if(!await o()){a();return}await e(t.channelAddr,r.name),u(),n("Request was sent")}catch(h){console.log("Error",h),s("Something went wrong")}finally{r.loading=!1}}function u(){r.loading=!1,r.dialog=!1,r.name=""}return{state:r,submit:c,reset:u}}function zo(){const t=q(),{info:e,ok:n,error:i}=ce(),s=ie({loading:!1});async function a(){if(!t.state.channelAddr){e("Please select a channel");return}try{s.loading=!0,await t.leaveChannel(t.state.channelAddr),n("Channel was abandoned!")}catch(o){console.log("Error",o),i("Something went wrong")}finally{s.loading=!1}}return{state:s,submit:a}}function Wo(){const t=q(),{ok:e,error:n}=ce(),i=ie({loading:!1});async function s(a){try{i.loading=!0,await t.addDevice(a),e("device added")}catch{n("Invalid Device Key")}finally{i.loading=!1}}return{state:i,submit:s}}function No(){const t=q(),{ok:e}=ce(),n=ie({loading:!1});async function i(s){try{n.loading=!0,await t.deleteDevice(s),e("device removed")}finally{n.loading=!1}}return{state:n,submit:i}}function ce(){const t=ye(),{airdropSol:e}=Po(),{notify:n}=ke(),i=c=>n({type:"info",message:c,timeout:2e3}),s=c=>n({type:"negative",message:c,timeout:2e3}),a=(c,u="bottom")=>n({type:"positive",message:c,timeout:2e3,position:u}),o=()=>n({type:"warning",message:"You don't have enough SOL on your balance!",position:"top",timeout:0,actions:[{label:"GET SOL",class:"btn--no-hover",padding:"0 15px 0 10px",size:"14px",color:"black",handler:()=>e()}]});function r(){return t.publicKey.value?!0:(i("Please connect wallet"),!1)}return{ok:a,info:i,error:s,noSol:o,isWalletConnected:r}}const Fo=R({__name:"ImportDeviceDialog",emits:["handleImport","closeImportModal"],setup(t,{emit:e}){const{ok:n,error:i}=ce(),s=F(),a=()=>{const o=s.value[0],r=new FileReader;r.addEventListener("load",()=>{const c=JSON.parse(r.result);c.backupKey||i("Invalid Key"),e("handleImport",c.backupKey),e("closeImportModal"),n("secret key imported")},!1),o&&r.readAsText(o)};return(o,r)=>(y(),M(ge,null,{default:m(()=>[l(ee,{flat:"",square:""},{default:m(()=>[l(j,{class:"q-pa-md",style:{height:"20px"}},{default:m(()=>[l(pe,{modelValue:s.value,"onUpdate:modelValue":r[0]||(r[0]=c=>s.value=c),borderless:"",type:"file"},null,8,["modelValue"])]),_:1}),l(j,{class:"q-pa-md"},{default:m(()=>[l(K,{class:"dialog-submit-btn",disabled:!s.value,flat:"",square:"",onClick:a},{default:m(()=>[I(" import device key ")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1}))}}),Ro=R({__name:"AddDeviceDialog",props:{addLoading:Boolean},emits:["handleAddDevice"],setup(t,{emit:e}){const n=F(""),i=()=>e("handleAddDevice",n.value);return(s,a)=>(y(),M(ge,null,{default:m(()=>[l(ee,{flat:"",square:"",class:"add-device-dialog"},{default:m(()=>[l(j,{class:"q-px-md q-pt-md justify-center items-center text-body1"},{default:m(()=>[I(" Enter device key ")]),_:1}),l(j,{class:"q-pa-md justify-center"},{default:m(()=>[l(qe,{onSubmit:i},{default:m(()=>[l(pe,{modelValue:n.value,"onUpdate:modelValue":a[0]||(a[0]=o=>n.value=o),class:"input",label:"Device key",dense:"","lazy-rules":"",rules:[o=>o&&o.length>0||"Please enter device key"]},null,8,["modelValue","rules"]),l(K,{type:"submit",class:"dialog-submit-btn",flat:"",square:""},{default:m(()=>[I(" add device ")]),_:1})]),_:1})]),_:1}),l(Ne,{showing:t.addLoading},null,8,["showing"])]),_:1})]),_:1}))}});const Oo=X(Ro,[["__scopeId","data-v-fc061ba6"]]),Vo=R({props:{text:{type:String,default:""},padding:{type:String,default:"0"}}});const qo=["innerHTML"];function Ho(t,e,n,i,s,a){return y(),M(Ut,{class:"bg-white text-primary shadow-1 custom-tooltip",style:{"border-radius":"0"},anchor:"top middle",self:"bottom middle"},{default:m(()=>[p("div",{style:He({fontSize:"11px",padding:`${t.padding}`}),innerHTML:t.text},null,12,qo)]),_:1})}const Ie=X(Vo,[["render",Ho]]),Uo={class:"q-gutter-md row justify-between q-px-sm"},jo=R({__name:"DevicesControl",props:{addLoading:Boolean,isAuthorityDevice:Boolean,devices:Object},emits:["handleExport","handleAddDevice","handleImport"],setup(t,{emit:e}){const n=t,i=F(!1),s=F(!1),a=async u=>{await e("handleAddDevice",u)};ae(()=>n.addLoading,u=>{u||(i.value=!1)});const o=u=>e("handleImport",u),r=()=>s.value=!1,c=()=>{e("handleExport")};return(u,h)=>{const g=Ie,v=Oo,k=Fo;return y(),C(U,null,[p("div",Uo,[l(K,{class:"control-btn",square:"",flat:"",disabled:!t.devices.length,onClick:h[0]||(h[0]=A=>i.value=!0)},{default:m(()=>[l(g,{text:"Add new device"}),l(d(jt))]),_:1},8,["disabled"]),l(K,{class:"control-btn",square:"",flat:"",onClick:h[1]||(h[1]=A=>s.value=!0)},{default:m(()=>[l(g,{text:"Import device key"}),l(d(Wn))]),_:1}),l(K,{class:"control-btn",square:"",flat:"",disabled:!t.isAuthorityDevice&&t.devices.length,onClick:c},{default:m(()=>[l(g,{text:"Export device key"}),l(d(Nn))]),_:1},8,["disabled"])]),l(v,{modelValue:i.value,"onUpdate:modelValue":h[2]||(h[2]=A=>i.value=A),"add-loading":t.addLoading,onHandleAddDevice:a},null,8,["modelValue","add-loading"]),l(k,{modelValue:s.value,"onUpdate:modelValue":h[3]||(h[3]=A=>s.value=A),"is-import-modal":s.value,onHandleImport:o,onCloseImportModal:r},null,8,["modelValue","is-import-modal"])],64)}}});const Qo=X(jo,[["__scopeId","data-v-dcedbc7a"]]),Go=t=>(xe("data-v-08199a05"),t=t(),De(),t),Jo=Go(()=>p("div",{class:"text-body1 text-blue-grey-8 text-left"}," Devices ",-1)),Yo={class:"devices-item__key"},Xo=R({__name:"DevicesList",props:{selectDevicekey:Object,deleteLoading:Boolean,devices:Object,authorityDevice:String},emits:["handleSelect","handleDelete"],setup(t,{emit:e}){const n=t,i=o=>e("handleSelect",o),s=o=>e("handleDelete",o),a=o=>o.toBase58()===n.authorityDevice;return(o,r)=>{const c=Ie;return y(),C(U,null,[Jo,l(we,{bordered:"",separator:"",class:"devices-list"},{default:m(()=>[(y(!0),C(U,null,ne(t.devices,u=>(y(),M(j,{key:u,"active-class":"bg-blue-grey-8 text-white active",class:$e(["devices-item",{"authority-device":a(u.data.key)}]),clickable:"",active:t.selectDevicekey===u.data.key,onClick:h=>i(u.data.key)},{default:m(()=>[p("span",Yo,[a(u.data.key)?(y(),M(c,{key:0,text:"Authority device"})):Y("",!0),I(" "+N(u.data.key),1)]),l(et),a(u.data.key)?Y("",!0):(y(),M(Fn,{key:0,name:d($t),size:"18px",class:"delete-device-btn",onClick:h=>s(u.data.key)},{default:m(()=>[l(c,{text:"Delete device"})]),_:2},1032,["name","onClick"]))]),_:2},1032,["class","active","onClick"]))),128))]),_:1}),l(Ne,{showing:t.deleteLoading},null,8,["showing"])],64)}}});const Zo=X(Xo,[["__scopeId","data-v-08199a05"]]),er=t=>(xe("data-v-5faa519f"),t=t(),De(),t),tr=er(()=>p("div",{class:"text-body1 text-blue-grey-8 text-left"}," Device Key ",-1)),nr={class:"text-center"},ar=["title"],sr=R({__name:"UserInfoDialog",props:{authorityDevice:String},emits:["regenerate","channelAuthorityDevice","loadChannel"],setup(t,{emit:e}){const n=t,i=je(),{state:s}=q();ce();const a=Wo(),o=No(),r=F(),c=_(()=>{var w;return n.authorityDevice===((w=r.value)==null?void 0:w.toBase58())}),u=()=>{var w,B;return qn(String((B=(w=i.keypair)==null?void 0:w.publicKey)!=null?B:""))},h=_(()=>s.memberDevices),g=_(()=>{var w,B;return Rn.xs?Ue((w=i.keypair)==null?void 0:w.publicKey,12):(B=i.keypair)==null?void 0:B.publicKey}),v=w=>r.value=w,k=w=>{a.submit(w)},A=()=>{i.exportKey()},S=w=>{i.importKey(w),setTimeout(()=>e("loadChannel"),1e3)},D=w=>{o.submit(w)};return(w,B)=>{const V=Zo,x=Qo;return y(),M(ge,{"transition-duration":"150","transition-show":"fade","transition-hide":"fade"},{default:m(()=>[l(ee,{square:"",flat:"",class:"dialog-wrapper"},{default:m(()=>[l(H,{class:"row items-center q-pa-xs"},{default:m(()=>[l(et),ve(l(K,{flat:"",round:"",dense:"",icon:d($t)},null,8,["icon"]),[[Be]])]),_:1}),l(H,{class:"q-py-none"},{default:m(()=>{var P;return[tr,p("div",nr,[l(K,{flat:"",round:"",dense:"",icon:d(On),onClick:u},{default:m(()=>[l(Ut,{delay:0,anchor:"bottom middle",self:"top middle","transition-duration":"0"},{default:m(()=>[I(" Copy to clipboard ")]),_:1})]),_:1},8,["icon"]),p("span",{class:"text-body2",title:(P=d(i).keypair)==null?void 0:P.publicKey},N(d(g)),9,ar)])]}),_:1}),l(Te),l(H,null,{default:m(()=>[l(V,{devices:d(h),"authority-device":t.authorityDevice,"select-devicekey":r.value,"delete-loading":d(o).state.loading,onHandleSelect:v,onHandleDelete:D},null,8,["devices","authority-device","select-devicekey","delete-loading"])]),_:1}),l(Te),l(Vn,{align:"right"},{default:m(()=>[l(x,{"add-loading":d(a).state.loading,"is-authority-device":d(c),devices:d(h),onHandleExport:A,onHandleAddDevice:k,onHandleImport:S},null,8,["add-loading","is-authority-device","devices"])]),_:1})]),_:1})]),_:1})}}});const ir=X(sr,[["__scopeId","data-v-5faa519f"]]),Ae=We("channel",()=>{const t=tt(),{state:e,client:n}=q(),i=_(()=>e.channelLoading),s=_(()=>e.sending),a=_(()=>{var E;return!!((E=t.value)!=null&&E.publicKey)}),o=_(()=>!!e.channel&&n.utils.channel.isPublic(e.channel)),r=_(()=>!!e.channel&&n.utils.channel.isPermissionless(e.channel)),c=_(()=>{var E;return((E=e.channelMembership)==null?void 0:E.status)===0}),u=_(()=>{var E;return((E=e.channelMembership)==null?void 0:E.status)===1}),h=_(()=>{var E,G,ue;return String((E=e.channel)==null?void 0:E.creator)===String((ue=(G=t.value)==null?void 0:G.publicKey)!=null?ue:"-")}),g=_(()=>!!e.channelMembership&&n.utils.member.canAddMember(e.channelMembership)),v=_(()=>!!e.channelMembership&&n.utils.member.canAuthorizeMember(e.channelMembership)),k=_(()=>!!e.channelMembership&&n.utils.member.canDeleteMember(e.channelMembership)),A=_(()=>!!e.channelMembership&&n.utils.member.isAdmin(e.channelMembership)),S=_(()=>!!e.channelMembership&&n.utils.member.isOwner(e.channelMembership)),D=_(()=>a.value&&!!e.channel&&!e.loading&&!c.value),w=_(()=>a.value),B=_(()=>S.value),V=_(()=>S.value),x=_(()=>!e.sending&&(o.value||c.value));return{ownChannels:_(()=>e.allChannels.filter(E=>{var G;return!!e.ownChannels.find(ue=>ue.pubkey===E.pubkey.toBase58())||E.data.flags===1||E.data.creator.toBase58()===String((G=t.value)==null?void 0:G.publicKey)})),isChannelLoading:i,isSendMessage:s,isPublicChannel:o,isWalletConnected:a,isPermissionlessChannel:r,isAuthorizedMember:c,isPendingMember:u,isChannelCreator:h,isAdmin:A,isOwner:S,canJoinChannel:D,canAddMember:g,canAuthorizeMember:v,canDeleteMember:k,canCreateChannel:w,canDeleteChannel:B,canGrantAccess:V,canPostMessage:x}}),rn="/assets/star.073c274c.svg",or={class:"text-weight-medium row wallet"},rr={key:0,class:"channel-owner"},lr=p("img",{src:rn},null,-1),cr={class:"memberlist-info__details"},ur=p("span",null,"Authority:",-1),dr={key:0,class:"memberlist-btns"},mr=R({__name:"MemberListDialog",props:{membersDialog:{type:Boolean,default:!1},authorizeMemberState:{type:Object},deleteMemberState:{type:Object},wallet:{type:Object}},emits:["submit","deleteMember"],setup(t,{emit:e}){const{state:n}=q(),i=Ae(),s=r=>r>0?"pending":"authorized",a=r=>s(r)==="pending"&&i.canAuthorizeMember,o=r=>{var c;return((c=n.channel)==null?void 0:c.creator.toBase58())===r};return(r,c)=>{const u=Ie;return y(),M(ge,{class:"memberlist"},{default:m(()=>[l(ee,{square:"",flat:"",horizontal:""},{default:m(()=>[l(H,{class:"q-px-lg"},{default:m(()=>[I(" MEMBERS ")]),_:1}),l(H,{class:"memberlist-card"},{default:m(()=>[l(we,{separator:""},{default:m(()=>[(y(!0),C(U,null,ne(d(n).channelMembers,h=>(y(),M(j,{key:h.pubkey.toString(),"active-class":"owner",active:`${h.pubkey}`==`${d(n).channelMembershipAddr}`,class:"memberlist-item"},{default:m(()=>[l(Z,{class:"memberlist-info"},{default:m(()=>[l(Re,{class:"row justify-between memberlist-info__header"},{default:m(()=>[p("span",or,[I(N(d(Jt)(h.data))+" ",1),o(h.data.authority.toBase58())?(y(),C("div",rr,[l(u,{text:"Channel Owner"}),lr])):Y("",!0)]),l(Hn,{class:$e([s(h.data.status),"memberlist-status q-pa-xs q-ml-lg"])},{default:m(()=>[I(N(s(h.data.status)),1)]),_:2},1032,["class"])]),_:2},1024),l(Re,{caption:"",lines:"2"},{default:m(()=>[p("div",cr,[ur,p("span",null,N(h.data.authority),1)])]),_:2},1024)]),_:2},1024),d(i).canDeleteMember?(y(),C("div",dr,[a(h.data.status)?(y(),M(K,{key:0,color:"positive",size:"sm",unelevated:"",class:"full-width",loading:t.authorizeMemberState.loading,disabled:t.authorizeMemberState.loading,onClick:g=>r.$emit("submit",h.data.authority)},{default:m(()=>[I(" Authorize ")]),_:2},1032,["loading","disabled","onClick"])):Y("",!0),l(K,{color:"negative",size:"sm",unelevated:"",class:"full-width",loading:t.deleteMemberState.loading,disabled:t.deleteMemberState.loading||o(h.data.authority.toBase58()),onClick:g=>r.$emit("deleteMember",h.data.authority)},{default:m(()=>[I(" Delete ")]),_:2},1032,["loading","disabled","onClick"])])):Y("",!0)]),_:2},1032,["active"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})}}}),hr=p("br",null,null,-1),pr=R({__name:"JoinChennalModal",emits:["join"],setup(t,{emit:e}){const n=F("");return(i,s)=>(y(),M(ge,null,{default:m(()=>[l(ee,{square:"",flat:""},{default:m(()=>[l(H,{class:"text-body1"},{default:m(()=>[I(" Join Channel ")]),_:1}),l(H,{class:"text-body1 text-blue-grey-8"},{default:m(()=>[l(qe,{class:"join-channel-form",onSubmit:s[1]||(s[1]=Bt(a=>i.$emit("join",n.value),["prevent"]))},{default:m(()=>[l(pe,{modelValue:n.value,"onUpdate:modelValue":s[0]||(s[0]=a=>n.value=a),label:"Member name *","lazy-rules":"",rules:[a=>a&&a.length>2||"Please type something"]},null,8,["modelValue","rules"]),hr,l(K,{type:"submit",class:"dialog-submit-btn","text-color":"black",ripple:!1,square:""},{default:m(()=>[I(" Join Channel ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}});const gr=t=>(xe("data-v-157586e8"),t=t(),De(),t),fr=gr(()=>p("span",{class:"text-blue-grey-8 q-pb-xs"},"Search by name or address",-1)),yr={class:"search-block"},br={class:"channel-info text-weight-medium"},_r={class:"channel-info"},vr={key:0,class:"already-in-chat"},wr={class:"control-btns"},kr=R({__name:"JoinChannelDialog",props:{loading:{type:Boolean},defaultState:Object},emits:["submit","reset"],setup(t,{emit:e}){const n=t;F(n.defaultState);const{state:i,selectChannel:s,refreshList:a}=q(),o=Ae(),r=F(!1),c=F(""),u=F([]),h=_(()=>i.allChannels.filter(w=>w.data.flags===0||w.data.flags===2)),g=_(()=>i.loading),v=w=>w.name.slice(0,2),k=()=>{if(c.value===""){u.value=[],c.value="";return}u.value=h.value.filter(w=>w.data.name.toLocaleLowerCase().includes(c.value.toLocaleLowerCase())||w.pubkey.toBase58().toLocaleLowerCase().includes(c.value.toLocaleLowerCase()))},A=_(()=>{var w;return((w=c.value)==null?void 0:w.length)>0?u.value:h.value}),S=w=>{e("submit",w)};ae(c,()=>{k()}),ae(()=>n.loading,w=>{w&&(r.value=!1)});const D=w=>o.ownChannels.find(B=>String(B.pubkey)===String(w.pubkey));return(w,B)=>{const V=Ie,x=pr;return y(),M(ge,{class:"join-channel-dialog",onHide:B[3]||(B[3]=P=>w.$emit("reset"))},{default:m(()=>[l(ee,{square:"",flat:""},{default:m(()=>[l(H,{class:"text-body1 text-blue-grey-8"},{default:m(()=>[I(" Join channel ")]),_:1}),l(H,{class:"q-py-none"},{default:m(()=>[fr,p("div",yr,[l(pe,{modelValue:c.value,"onUpdate:modelValue":B[0]||(B[0]=P=>c.value=P),class:"input no-margin q-pa-none",placeholder:"Search ...",borderless:"",dense:"",debounce:"300"},null,8,["modelValue"])])]),_:1}),l(H,null,{default:m(()=>[d(A).length?(y(),M(we,{key:0,bordered:"",separator:"",class:"privat-channels"},{default:m(()=>[(y(!0),C(U,null,ne(d(A),P=>ve((y(),M(j,{key:P,"active-class":"bg-blue-grey-8 text-white",class:"privat-channels-item",active:`${d(i).channelAddr}`==`${P.pubkey}`,clickable:"",onClick:E=>d(s)(P.pubkey)},{default:m(()=>[p("div",{class:"chat-avatar",style:He(d(Yt)(`${P.pubkey}`))},[p("span",null,N(v(P.data)),1)],4),l(Z,null,{default:m(()=>[p("span",br,N(P.data.name),1),p("span",_r,N(P.pubkey),1)]),_:2},1024),D(P)?(y(),C("div",vr,[l(V,{text:"already in channel"}),l(d(Un),{size:"18"})])):Y("",!0)]),_:2},1032,["active","onClick"])),[[jn]])),128))]),_:1})):(y(),M(j,{key:1,class:"privat-channels justify-center items-center text-blue-grey-5"},{default:m(()=>[I(" Channels not found ")]),_:1}))]),_:1}),p("div",wr,[l(K,{class:$e(["control-button",{"refresh-btn":d(g)}]),square:"",flat:"",disable:!d(i).channelAddr,onClick:d(a)},{default:m(()=>[l(d(Qt),{style:{color:"#fff"}}),l(V,{text:"Refresh channels"})]),_:1},8,["disable","class","onClick"]),l(K,{class:"control-button",square:"",flat:"",disable:!d(i).channelAddr,onClick:B[1]||(B[1]=P=>r.value=!0)},{default:m(()=>[l(d(Qn),{style:{color:"#fff"}}),l(V,{text:"Request to join"})]),_:1},8,["disable"]),l(x,{modelValue:r.value,"onUpdate:modelValue":B[2]||(B[2]=P=>r.value=P),onJoin:S},null,8,["modelValue"])]),l(Ne,{showing:t.loading},null,8,["showing"])]),_:1})]),_:1})}}});const Ar=X(kr,[["__scopeId","data-v-157586e8"]]),Sr=t=>(xe("data-v-e91edd23"),t=t(),De(),t),Mr=Sr(()=>p("br",null,null,-1)),Cr=R({__name:"AddMemberDialog",props:{loading:{type:Boolean,default:!1},defaultState:Object},emits:["submit","reset"],setup(t,{emit:e}){const i=F(t.defaultState),s=()=>e("submit",i.value);return(a,o)=>(y(),M(ge,{class:"add-member-dialog",onHide:o[3]||(o[3]=r=>a.$emit("reset"))},{default:m(()=>[l(ee,{square:"",flat:""},{default:m(()=>[l(H,null,{default:m(()=>[l(qe,{class:"add-member-form",onSubmit:Bt(s,["prevent"])},{default:m(()=>[l(pe,{modelValue:i.value.name,"onUpdate:modelValue":o[0]||(o[0]=r=>i.value.name=r),label:"Member name *",hint:"Min length 3 chars","lazy-rules":"",rules:[r=>r&&r.length>2||"Please type something"]},null,8,["modelValue","rules"]),l(pe,{modelValue:i.value.wallet,"onUpdate:modelValue":o[1]||(o[1]=r=>i.value.wallet=r),label:"Member Wallet *","lazy-rules":"",rules:[r=>r&&r.length>32||"Invalid public key"]},null,8,["modelValue","rules"]),l(pe,{modelValue:i.value.key,"onUpdate:modelValue":o[2]||(o[2]=r=>i.value.key=r),label:"Member Device Key",hint:"Default: The same as member wallet","lazy-rules":"",rules:[r=>!r||r.length>32||"Invalid public key"]},null,8,["modelValue","rules"]),Mr,l(K,{type:"submit",class:"dialog-submit-btn","text-color":"black",ripple:!1,square:"",flat:""},{default:m(()=>[I(" Add Member ")]),_:1})]),_:1},8,["onSubmit"]),l(Ne,{showing:t.loading},null,8,["showing"])]),_:1})]),_:1})]),_:1}))}});const xr=X(Cr,[["__scopeId","data-v-e91edd23"]]),Tt="/assets/info.bfade5eb.svg",Dr={class:"relative-position"},$r={class:"messages-cost"},Ir={class:"toggle-info max-messages-tooltip"},Er=p("img",{src:Tt,alt:"info"},null,-1),Pr={class:"row q-mt-md relative-position",style:{height:"42px"}},Br={class:"toggle-info"},Tr=p("img",{src:Tt,alt:"info"},null,-1),Kr={key:0,class:"row text-primary toggle-approve"},Lr={class:"toggle-info"},zr=p("img",{src:Tt,alt:"info"},null,-1),Wr=R({__name:"NewChannelDialog",props:{loading:{type:Boolean,default:!1},defaultState:Object},emits:["submit","reset"],setup(t,{emit:e}){const n=t,{channelMessagesCost:i}=q(),s=F(n.defaultState),a=()=>e("submit",s),o=F(0),r=_(()=>`~${o.value.toFixed(5)} SOL`);return ae(()=>{var c;return(c=s.value)==null?void 0:c.maxMessages},async c=>{o.value=await i(Number(c))}),Gn(async()=>{const c=an;o.value=await i(Number(c))}),(c,u)=>{const h=Ie;return y(),M(ge,{class:"new-channel-dialog",onHide:u[4]||(u[4]=g=>c.$emit("reset"))},{default:m(()=>[l(ee,{square:"",flat:""},{default:m(()=>[l(H,null,{default:m(()=>[l(qe,{class:"messenger-new-channel-form",onSubmit:a},{default:m(()=>[l(pe,{modelValue:s.value.name,"onUpdate:modelValue":u[0]||(u[0]=g=>s.value.name=g),label:"Channel name *","lazy-rules":"",maxlength:"32",rules:[g=>g&&g.length>2||"Please type something"]},null,8,["modelValue","rules"]),p("div",Dr,[l(pe,{modelValue:s.value.maxMessages,"onUpdate:modelValue":u[1]||(u[1]=g=>s.value.maxMessages=g),label:"Max messages","lazy-rules":"",type:"number",debounce:"100",rules:[g=>+g>0||"Invalid value"]},null,8,["modelValue","rules"]),p("div",$r,N(d(r)),1),p("div",Ir,[l(h,{text:d(_t)[2],padding:"8px"},null,8,["text"]),Er])]),p("div",Pr,[p("div",Br,[l(h,{text:d(_t)[0],padding:"8px"},null,8,["text"]),Tr]),p("div",{class:$e(["col text-primary",{"toggle-border":!s.value.public}])},[I(" Private"),l(Nt,{modelValue:s.value.public,"onUpdate:modelValue":u[2]||(u[2]=g=>s.value.public=g),label:"Public"},null,8,["modelValue"])],2),s.value.public?Y("",!0):(y(),C("div",Kr,[l(Nt,{modelValue:s.value.permissionless,"onUpdate:modelValue":u[3]||(u[3]=g=>s.value.permissionless=g)},null,8,["modelValue"]),p("span",null,[p("div",Lr,[l(h,{text:d(_t)[1],padding:"8px"},null,8,["text"]),zr]),I(" Members can approve")])]))]),l(K,{type:"submit",class:"dialog-submit-btn q-mt-md","text-color":"black",ripple:!1,square:"",flat:""},{default:m(()=>[I(" Create the Channel ")]),_:1})]),_:1}),l(Ne,{showing:t.loading},null,8,["showing"])]),_:1})]),_:1})]),_:1})}}});const Nr=R({__name:"ChannelForm",props:{message:{type:String,default:""},disabled:{type:Boolean,default:!1},sending:{type:Boolean,default:!1}},emits:["submit"],setup(t,{emit:e}){const i=F(t.message),s=()=>{e("submit",i),i.value=""};return(a,o)=>(y(),M(qe,{class:"channel-form",onSubmit:Bt(s,["prevent"])},{default:m(()=>[l(Jn,{class:"row message-control"},{default:m(()=>[l(pe,{ref:"inputFocus",modelValue:i.value,"onUpdate:modelValue":o[0]||(o[0]=r=>i.value=r),class:"col-grow message-input",placeholder:"Type a message",dense:"",borderless:"",autofocus:"",disable:t.disabled},null,8,["modelValue","disable"]),l(K,{class:"send-btn",square:"",flat:"",type:"submit",disable:t.disabled,loading:t.sending},{default:m(()=>[I(" Send ")]),_:1},8,["disable","loading"])]),_:1})]),_:1},8,["onSubmit"]))}});const Fr=X(Nr,[["__scopeId","data-v-bb5ae488"]]),Rr="/assets/solana-logo.3caace62.svg",Kt=t=>(xe("data-v-a765a3c1"),t=t(),De(),t),Or={class:"messenger-content"},Vr={key:0,class:"preloader"},qr={key:1,class:"messenger-empty"},Hr={key:2,class:"messenger-empty"},Ur=Kt(()=>p("img",{src:Rr,alt:"logo"},null,-1)),jr=Kt(()=>p("span",{name:"connect"},"Please connect a wallet",-1)),Qr=[Ur,jr],Gr={key:3,class:"messenger-empty"},Jr=Kt(()=>p("span",{name:"select"},"Please select a channel",-1)),Yr=[Jr],Xr=R({__name:"ChannelWrapper",props:{postMessageState:{type:Object}},emits:["sendMessage"],setup(t,{emit:e}){const n=ye(),{state:i}=q(),s=Ae();function a(g){const v=n.publicKey.value;return v?String(v)!==String(g):!0}const o=_(()=>{const g=[];let v=0,k;for(const A of i.channelMessages)k&&`${A.sender}`==`${k}`?g[v-1].text.push(A.content):(k=A.sender,g.push({id:A.id,sender:A.sender,senderDisplayName:A.senderDisplayName,text:[A.content],date:A.createdAt}),v++);return g}),r=_(()=>s.canPostMessage),c=g=>e("sendMessage",g),u=F(),h=F();return ae(h,g=>{g&&(u.value.scrollTop=g.scrollHeight)}),(g,v)=>{const k=Fr;return y(),M(ee,{class:"messenger-card",square:"",flat:""},{default:m(()=>[p("div",Or,[d(s).isChannelLoading?(y(),C("div",Vr,[l(Yn,{color:"primary",size:"2em"})])):d(i).channel?(y(),C("div",{key:1,ref_key:"chat",ref:u,class:"row justify-center channel-wrapper"},[d(o).length>0?(y(),C("div",{key:0,ref_key:"mes",ref:h,class:"messenger-messages"},[(y(!0),C(U,null,ne(d(o),A=>(y(),M(Xn,{key:A.id,name:A.senderDisplayName,text:A.text,sent:a(A.sender)},null,8,["name","text","sent"]))),128))],512)):(y(),C("div",qr," No messages "))],512)):d(s).isWalletConnected?(y(),C("div",Gr,Yr)):(y(),C("div",Hr,Qr))]),l(k,{message:t.postMessageState.message,sending:d(s).isSendMessage,disabled:!d(r),onSubmit:c},null,8,["message","sending","disabled"])]),_:1})}}});const Zr=X(Xr,[["__scopeId","data-v-a765a3c1"]]),el=R({__name:"ChannelControl",props:{isLoading:{type:Boolean}},emits:["createChannel","joinChannel","refreshList"],setup(t,{emit:e}){const n=Ae();ce();const{notify:i}=ke();_(()=>n.isPendingMember),_(()=>n.canCreateChannel);const s=a=>{if(!n.isWalletConnected){i({message:"Please connect wallet",color:"negative",position:"top"});return}e(a)};return(a,o)=>{const r=Ie;return y(),M(j,null,{default:m(()=>[l(Z,{class:"button-wrapper"},{default:m(()=>[l(K,{class:$e(["control-button",{"refresh-btn":t.isLoading}]),square:"",flat:"",onClick:o[0]||(o[0]=c=>s("refreshList"))},{default:m(()=>[l(d(Qt),{style:{color:"#fff"}}),l(r,{text:"Refresh channels"})]),_:1},8,["class"]),l(K,{class:"control-button",square:"",flat:"",onClick:o[1]||(o[1]=c=>s("createChannel"))},{default:m(()=>[l(d(jt),{style:{color:"#fff"}}),l(r,{text:"Create a channel"})]),_:1}),l(K,{class:"control-button",square:"",flat:"",onClick:o[2]||(o[2]=c=>s("joinChannel"))},{default:m(()=>[l(d(Zn),{style:{color:"#fff"}}),l(r,{text:"Browse channels"})]),_:1})]),_:1})]),_:1})}}});const tl=X(el,[["__scopeId","data-v-e1ed7dfd"]]),nl=t=>(xe("data-v-ddda9a9c"),t=t(),De(),t),al={class:"chat-name"},sl={key:0,class:"message-public"},il={key:1,class:"message-owner row"},ol=nl(()=>p("img",{src:rn},null,-1)),rl={key:2,class:"pending-icon"},ll=R({__name:"MessengerChannel",props:{pubkey:{type:Object,required:!0},channel:{type:Object,required:!0},isActive:Boolean},emits:["select"],setup(t){const e=t,{state:n}=q(),i=ye(),s=_(()=>{var h;return(h=n.ownChannels.find(g=>g.pubkey===e.pubkey.toString()))==null?void 0:h.status}),a=_(()=>s.value===1),o=_(()=>e.channel.name.slice(0,2)),r=_(()=>e.channel.flags===1),c=_(()=>{var h,g;return(g=(h=i.publicKey.value)==null?void 0:h.toBase58())!=null?g:""}),u=_(()=>e.channel.creator.toBase58()===c.value);return(h,g)=>{const v=Ie;return y(),M(j,{"active-class":"bg-blue-grey-8 text-white",style:{"min-height":"42px"},active:t.isActive},{default:m(()=>[l(Z,{class:"chat-item cursor-pointer",onClick:g[0]||(g[0]=k=>h.$emit("select"))},{default:m(()=>[p("div",{class:"chat-badge",style:He(d(Yt)(`${t.pubkey}`))},[p("span",null,N(d(o)),1)],4),p("div",al,N(t.channel.name),1),d(r)?(y(),C("div",sl,[l(v,{text:"Public Channel"}),I(" P ")])):Y("",!0),d(u)?(y(),C("div",il,[l(v,{text:"Channel Owner"}),ol])):Y("",!0),d(a)?(y(),C("div",rl,[l(v,{text:"Waiting for confirmation"}),l(ea,{color:"primary",size:"16px"})])):Y("",!0)]),_:1})]),_:1},8,["active"])}}});const cl=X(ll,[["__scopeId","data-v-ddda9a9c"]]),ul=p("div",{class:"text-h5"}," Channels ",-1),dl={class:"text-weight-medium"},ml={class:"memberlist-info__details"},hl=p("span",null,"Authority:",-1),pl={class:"memberlist-info__details"},gl=p("span",null,"Key:",-1),fl=R({__name:"PendingUsersDialog",props:{pendingChannels:Object},setup(t){F(!1);const{state:e}=q(),n=sn(),i=on(),s=async(c,u)=>{e.channelAddr=u,await n.submit(c)},a=async(c,u)=>{e.channelAddr=u,await i.submit(c)},o=_(()=>n.state.loading),r=_(()=>i.state.loading);return(c,u)=>(y(),M(ge,null,{default:m(()=>[l(ee,{class:"pending-channels",square:"",flat:"",horizontal:""},{default:m(()=>[l(H,null,{default:m(()=>[ul]),_:1}),l(H,null,{default:m(()=>[l(we,{bordered:""},{default:m(()=>[(y(!0),C(U,null,ne(t.pendingChannels,(h,g)=>(y(),M(ta,{key:h.name,"expand-separator":"",label:h.channel.data.name,caption:"channel","default-opened":g===0,"header-class":"owner"},{default:m(()=>[l(we,{separator:""},{default:m(()=>[(y(!0),C(U,null,ne(h.pendingMembers,v=>(y(),M(j,{key:v,class:"row justify-between pending-item"},{default:m(()=>[l(Z,{class:"memberlist-info"},{default:m(()=>[l(Re,{class:"row justify-between"},{default:m(()=>[p("span",dl,N(d(Jt)(v.data)),1)]),_:2},1024),l(Re,{caption:"",lines:"2"},{default:m(()=>[p("div",ml,[hl,p("span",null,N(v.data.authority),1)]),p("div",pl,[gl,p("span",null,N(v.data.key),1)])]),_:2},1024)]),_:2},1024),l(Z,{side:"",class:"memberlist-btns"},{default:m(()=>[l(K,{color:"teal",size:"xs",unelevated:"",class:"full-width",loading:d(o),disabled:d(o),onClick:k=>s(v.data.authority,h.channel.pubkey)},{default:m(()=>[I(" Authorize ")]),_:2},1032,["loading","disabled","onClick"]),l(K,{color:"negative",size:"xs",unelevated:"",class:"full-width",loading:d(r),disabled:d(r),onClick:k=>a(v.data.key,h.channel.pubkey)},{default:m(()=>[I(" Delete ")]),_:2},1032,["loading","disabled","onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1032,["label","default-opened"]))),128))]),_:1})]),_:1})]),_:1})]),_:1}))}});const yl={class:"bell",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",fill:"none","xmlns:v":"https://vecta.io/nano"},bl=["fill"],_l=R({__name:"iconBell",props:{color:{type:String,default:"AABEC8"}},setup(t){return(e,n)=>(y(),C("svg",yl,[p("path",{d:"M5.352 14.359h3.294c0 .821-.59 1.641-1.647 1.641s-1.647-.82-1.647-1.641zm8.434-3.467l-.911-1.515a3.68 3.68 0 0 1-.527-1.897V5.325C12.348 2.389 9.949 0 7 0S1.651 2.389 1.651 5.325v2.155a3.68 3.68 0 0 1-.527 1.897l-.911 1.515c-.278.461-.285 1.018-.018 1.487s.749.749 1.29.749h11.03a1.47 1.47 0 0 0 1.291-.749 1.46 1.46 0 0 0-.021-1.487z",fill:`#${t.color}`},null,8,bl)]))}}),ln=We("notifications",()=>{const t=tt(),{loadMembers:e,state:n}=q(),i=Ae(),s=ie({showInfo:!1,showDialog:!1,pendingChannels:[]});ae([()=>i.ownChannels,()=>n.channelMembers],async(o,r)=>{r.length>0&&await a(r[0])});async function a(o){try{const r=await Promise.all(o.map(async c=>{var g;const{pubkey:u,data:h}=c;if(h.creator.toBase58()===((g=t.value)==null?void 0:g.publicKey.toBase58())){const v=await e(u);if(v.length===0)return;const k=v.filter(A=>A.data.status===1);return k.length?{channel:c,pendingMembers:k}:void 0}}));s.pendingChannels=r.filter(c=>c),s.pendingChannels.length>0?(setTimeout(()=>s.showInfo=!0,2e3),setTimeout(()=>s.showInfo=!1,7e3)):s.showDialog=!1}catch(r){console.log(r)}}return{state:s}});function vl(){const{state:t}=ln();return{showDialog:_(()=>t.showDialog),showInfo:_(()=>t.showInfo),pendingChannels:_(()=>t.pendingChannels)}}const wl={class:"panel-notifications__info"},kl=R({__name:"MessengerNotification",setup(t){const{pendingChannels:e,showInfo:n,showDialog:i}=vl(),{state:s}=ln(),a=_(()=>{var u,h;return(h=(u=e.value)==null?void 0:u.length)!=null?h:0}),o=_(()=>a.value>0),r=_(()=>n.value?"width: 100%; padding-right: 14px":"width: 0; padding-right: 0;"),c=()=>{!o.value||(s.showDialog=!s.showDialog)};return(u,h)=>{const g=_l,v=fl;return y(),C("div",{class:$e(["panel-notifications",{"has-notifications":d(o)}]),onClick:c},[p("div",wl,[l(g,{class:"ring",color:d(o)?"FF5C5C":"AABEC8"},null,8,["color"]),p("span",null,N(a.value),1)]),p("div",{ref:"notificationsInfo",class:"panel-notifications__details",style:He(d(r))}," channels are awaiting user confirmation ",4),l(v,{modelValue:d(s).showDialog,"onUpdate:modelValue":h[0]||(h[0]=k=>d(s).showDialog=k),"pending-channels":d(e),onCloseDialog:h[1]||(h[1]=k=>u.isShow.value=!1)},null,8,["modelValue","pending-channels"])],2)}}});const cn=We("mobile",()=>{const{screen:t}=ke(),e=ie({searchOrInfo:"search"}),n=_(()=>t.xs);return ae(n,i=>{i&&(e.searchOrInfo="search")}),{state:e,isMobile:n}}),Al={class:"panel-search"},Sl={class:"search-wrapper"},Ml={class:"panel-info"},Cl={class:"chat-info"},xl={class:"chat-members"},Dl={class:"chat-messages"},$l=["title"],Il={key:0,class:"members-count bg-cyan-9"},El=R({__name:"MessengerToolbar",emits:["search","showMembers","deleteChannel","addMember","showDeviceKey","leaveChannel"],setup(t,{emit:e}){const n=ye(),{state:i}=q(),s=Ae(),a=cn();ke(),_(()=>!!n.publicKey.value);const o=F(""),r=_(()=>i.channel),c=_(()=>{var S,D,w;return((S=r.value)==null?void 0:S.memberCount)===null||((D=r.value)==null?void 0:D.memberCount)===void 0?"":`${(w=r.value)==null?void 0:w.memberCount}\xA0members`}),u=_(()=>{var S,D,w;return((S=r.value)==null?void 0:S.messageCount)===null||((D=r.value)==null?void 0:D.messageCount)===void 0?"":`${(w=r.value)==null?void 0:w.messageCount}\xA0messages`}),h=S=>e("search",S),g=()=>e("showMembers"),v=()=>e("addMember"),k=_(()=>{if(!(!s.isOwner||!s.isAdmin))return i.channelMembers.filter(S=>S.data.status===1).length});ae(o,S=>{h(String(S))});const A=_(()=>a.isMobile&&a.state.searchOrInfo==="info");return ae(()=>i.channelAddr,S=>{S&&a.isMobile&&(a.state.searchOrInfo="info")}),(S,D)=>{var B,V;const w=kl;return y(),C("div",{class:$e(["panel-toolbar",d(a).state.searchOrInfo])},[l(w),d(A)?(y(),M(d(na),{key:0,class:"back-arrow",onClick:D[0]||(D[0]=x=>d(a).state.searchOrInfo="search")})):Y("",!0),p("div",Al,[p("div",Sl,[l(pe,{modelValue:o.value,"onUpdate:modelValue":D[1]||(D[1]=x=>o.value=x),class:"search-input no-margin q-pa-none",placeholder:"Search ...",clearable:"",debounce:"300",borderless:"",onClear:D[2]||(D[2]=x=>o.value="")},null,8,["modelValue"])])]),p("div",Ml,[p("div",Cl,[p("div",xl,N(d(c)),1),p("div",Dl,N(d(u)),1)]),l(et,{class:""}),p("div",{class:"chat-name",title:(B=d(r))==null?void 0:B.name},N((V=d(r))==null?void 0:V.name),9,$l),p("div",null,[l(K,{class:"chat-menu",flat:"",square:""},{default:m(()=>[l(d(aa),{size:"18"}),l(sa,{anchor:"bottom middle",self:"top middle"},{default:m(()=>[l(we,{style:{"min-width":"120px"},bordered:""},{default:m(()=>[ve((y(),M(j,{class:"q-my-sm q-mx-sm q-pa-none chat-menu__item",clickable:"",onClick:D[3]||(D[3]=x=>S.$emit("showDeviceKey"))},{default:m(()=>[l(Z,{class:"q-pa-none"},{default:m(()=>[l(K,{flat:"",square:"",size:"sm",class:"bg-blue-grey-7 text-white q-px-xs"},{default:m(()=>[I(" Devices ")]),_:1})]),_:1})]),_:1})),[[Be]]),ve((y(),M(j,{class:"q-my-sm q-mx-sm q-pa-none chat-menu__item relative-position",clickable:"",disable:!d(r),onClick:g},{default:m(()=>[l(Z,null,{default:m(()=>[d(k)>0?(y(),C("div",Il,N(d(k)),1)):Y("",!0),l(K,{flat:"",square:"",size:"sm",class:"bg-cyan-9 text-white q-px-xs"},{default:m(()=>[I(" Members ")]),_:1})]),_:1})]),_:1},8,["disable"])),[[Be]]),d(s).isOwner?ve((y(),M(j,{key:0,class:"q-my-sm q-mx-sm q-pa-none chat-menu__item",clickable:"",disable:!d(s).canAddMember,onClick:v},{default:m(()=>[l(Z,null,{default:m(()=>[l(K,{flat:"",square:"",size:"sm",class:"bg-amber-7 text-white q-px-xs"},{default:m(()=>[I(" Add member ")]),_:1})]),_:1})]),_:1},8,["disable"])),[[Be]]):Y("",!0),d(s).isOwner?ve((y(),M(j,{key:1,class:"q-my-sm q-mx-sm q-pa-none chat-menu__item",clickable:"",disable:!d(s).isChannelCreator,onClick:D[4]||(D[4]=x=>S.$emit("deleteChannel"))},{default:m(()=>[l(Z,null,{default:m(()=>[l(K,{flat:"",square:"",size:"sm",class:"bg-negative text-white q-px-xs"},{default:m(()=>[I(" Delete ")]),_:1})]),_:1})]),_:1},8,["disable"])),[[Be]]):ve((y(),M(j,{key:2,class:"q-my-sm q-mx-sm q-pa-none chat-menu__item",clickable:"",disable:!d(r),onClick:D[5]||(D[5]=x=>S.$emit("leaveChannel"))},{default:m(()=>[l(Z,null,{default:m(()=>[l(K,{flat:"",square:"",size:"sm",class:"bg-negative text-white q-px-xs"},{default:m(()=>[I(" Leave ")]),_:1})]),_:1})]),_:1},8,["disable"])),[[Be]])]),_:1})]),_:1})]),_:1})])])],2)}}});const Pl={class:"col col-4"},Bl={class:"col"},Tl={class:"no-margin"},Kl=R({__name:"DebugBtn",setup(t){const{state:e}=q(),{isAuthorizedMember:n,isPendingMember:i,isChannelCreator:s}=Ae(),a=F(!1),o=ia(a);return(r,c)=>(y(),C(U,null,[l(K,{flat:"",class:"text-blue-2",onClick:c[0]||(c[0]=u=>d(o)())},{default:m(()=>[I(" Debug info ")]),_:1}),l(ge,{modelValue:a.value,"onUpdate:modelValue":c[1]||(c[1]=u=>a.value=u)},{default:m(()=>[l(ee,{style:{width:"800px","max-width":"80vw"}},{default:m(()=>[l(H,null,{default:m(()=>[(y(!0),C(U,null,ne([["Authorized",d(n)],["Pending Access",d(i)],["Channel Creator",d(s)],["Channel Address",d(e).channelAddr],["Channel",d(e).channel],["Membership",d(e).channelMembership],["Members",d(e).channelMembers]],u=>(y(),C("div",{key:u[0],class:"row q-mt-md"},[p("div",Pl,N(u[0]),1),p("div",Bl,[p("pre",Tl,N(u[1]),1)])]))),128))]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}}),Ll={class:"messenger-wrapper"},zl={class:"messenger-main"},Wl={key:1,class:"messenger-channels-empty"},Nl={key:0,class:"q-my-md q-px-lg"},Fl=R({__name:"Messenger",setup(t){const e=ye(),{state:n,postMessage:i,loadChannel:s,refreshList:a,channelAuthorityDevice:o}=q(),r=Ae(),c=cn(),u=Bo(),h=Lo(),g=Ko(),v=sn(),k=on(),A=To(),S=zo(),D=ie({message:""});_(()=>n.allChannels);const w=F([]),B=F("");async function V(J){await i(J.value),D.message=""}const x=J=>{if(J===""){w.value=[],B.value="";return}w.value=r.ownChannels.filter(z=>z.data.name.toLocaleLowerCase().includes(J.toLocaleLowerCase())||z.pubkey.toBase58().toLocaleLowerCase().includes(J.toLocaleLowerCase())),B.value=J},P=_(()=>n.loading),E=F(!1),G=_(()=>w.value.length>0||B.value.length>0?w.value:r.ownChannels),ue=J=>g.submit(J),Ee=J=>{h.state.name=J,h.submit()},ht=_(()=>c.isMobile?c.state.searchOrInfo==="search"?1:2:1),Pe=F("");return ae(()=>n.memberDevices,async J=>{J.length>0&&(Pe.value=await o())}),(J,z)=>{const pt=El,gt=cl,Ge=tl,ft=Zr,yt=Wr,b=xr,$=Ar,L=mr,Q=ir;return y(),C(U,null,[p("div",Ll,[l(pt,{onSearch:x,onShowMembers:z[0]||(z[0]=W=>d(v).state.dialog=!0),onDeleteChannel:z[1]||(z[1]=W=>d(A).submit(d(n).channelAddr)),onLeaveChannel:z[2]||(z[2]=W=>d(S).submit(d(n).channelAddr)),onAddMember:z[3]||(z[3]=W=>d(g).state.dialog=!0),onShowDeviceKey:z[4]||(z[4]=W=>E.value=!0)}),p("div",zl,[l(ee,{class:"messenger-channels",square:"",flat:""},{default:m(()=>[d(G).length>0?(y(),M(we,{key:0,separator:"",class:"channels-list"},{default:m(()=>[(y(!0),C(U,null,ne(d(G),W=>(y(),M(gt,{key:W.name,pubkey:W.pubkey,channel:W.data,"active-class":"select-channel","is-active":`${d(n).channelAddr}`==`${W.pubkey}`,onSelect:fe=>d(s)(W.pubkey)},null,8,["pubkey","channel","is-active","onSelect"]))),128))]),_:1})):(y(),C("div",Wl," No channels ")),l(Ge,{"is-joining":d(h).state.loading,"is-loading":d(P),onCreateChannel:z[5]||(z[5]=W=>d(u).state.dialog=!0),onJoinChannel:z[6]||(z[6]=W=>d(h).state.dialog=!0),onRefreshList:d(a)},null,8,["is-joining","is-loading","onRefreshList"])]),_:1}),l(ft,{style:He({"z-index":d(ht)}),"post-message-state":D,onSendMessage:V},null,8,["style","post-message-state"]),l(Ne,{showing:d(n).loading,color:"primary"},null,8,["showing"])])]),l(yt,{modelValue:d(u).state.dialog,"onUpdate:modelValue":z[7]||(z[7]=W=>d(u).state.dialog=W),loading:d(u).state.loading,"default-state":d(u).state,onSubmit:d(u).submit,onReset:d(u).reset},null,8,["modelValue","loading","default-state","onSubmit","onReset"]),l(b,{modelValue:d(g).state.dialog,"onUpdate:modelValue":z[8]||(z[8]=W=>d(g).state.dialog=W),loading:d(g).state.loading,"default-state":d(g).state,onSubmit:ue,onReset:d(g).reset},null,8,["modelValue","loading","default-state","onReset"]),l($,{modelValue:d(h).state.dialog,"onUpdate:modelValue":z[9]||(z[9]=W=>d(h).state.dialog=W),loading:d(h).state.loading,"default-state":d(h).state,onSubmit:Ee,onReset:d(h).reset},null,8,["modelValue","loading","default-state","onReset"]),l(L,{modelValue:d(v).state.dialog,"onUpdate:modelValue":z[10]||(z[10]=W=>d(v).state.dialog=W),wallet:d(e),"authorize-member-state":d(v).state,"delete-member-state":d(k).state,onSubmit:d(v).submit,onDeleteMember:d(k).submit},null,8,["modelValue","wallet","authorize-member-state","delete-member-state","onSubmit","onDeleteMember"]),l(Q,{modelValue:E.value,"onUpdate:modelValue":z[11]||(z[11]=W=>E.value=W),"authority-device":Pe.value,onLoadChannel:z[12]||(z[12]=W=>d(s)(d(n).channelAddr))},null,8,["modelValue","authority-device"]),d(n).channel?(y(),C("div",Nl,[l(Kl)])):Y("",!0)],64)}}});const Rl={},Ol={class:"container"},Vl={class:"messenger-container"},ql={class:"container"};function Hl(t,e){const n=Fl,i=fi;return y(),M(oa,{class:"page-wrapper"},{default:m(()=>[p("div",Ol,[p("div",Vl,[l(n)])]),p("div",ql,[l(i)])]),_:1})}const Ul=X(Rl,[["render",Hl],["__scopeId","data-v-d4ef5e8f"]]),jl=()=>Vt(()=>import("./_...all_.96b2e448.js"),["assets/_...all_.96b2e448.js","assets/vendor.e16d9468.js","assets/_...all_.73169310.css"]),Ql=[{name:"index",path:"/",component:Ul,props:!0},{name:"all",path:"/:all(.*)*",component:jl,props:!0,meta:{layout:"empty"}}],Gl=ai(Ql),Jl="/",Yl=ra({history:la(Jl),scrollBehavior:()=>({left:0,top:0}),strict:!0,routes:Gl}),Xl=({app:t})=>{t.use(Yl)},Zl=Object.freeze(Object.defineProperty({__proto__:null,install:Xl},Symbol.toStringTag,{value:"Module"})),ec=({app:t})=>{t.use(ca,{wallets:[new ua,new da,new ma,new ha,new pa,new ga,new fa,new ya,new ba,new _a,new va,new wa,new ka,new Aa,new Sa,new Ma,new Ca,new xa,new Da,new $a,new Ia,new Ea,new Pa,new Ba,new Ta,new Ka,new La,new za,new Wa,new Na],autoConnect:!1})},tc=Object.freeze(Object.defineProperty({__proto__:null,install:ec},Symbol.toStringTag,{value:"Module"})),nc=Fa();function ac(){return nc}const sc=Symbol("WALLET_CONNECT_EVENT"),ic=Symbol("WALLET_DISCONNECT_EVENT"),oc=Symbol("ACCOUNT_CHANGE_EVENT"),kt=5e3;function rc(){const{connection:t}=st(),{emit:e}=ac(),{notify:n}=ke(),{wallet:i}=ye();ae(i,s=>{if(!s)return;const a=()=>{const c=s.adapter.publicKey;t.onAccountChange(c,u=>{e(oc,u)}),t.onLogs(c,u=>{console.log(u)}),n({message:"Wallet update",caption:`Connected to wallet ${Ue(c.toBase58(),7)}`,timeout:kt}),e(sc,s)},o=()=>{n({message:"Wallet update",caption:"Disconnected from wallet",timeout:kt}),e(ic,s)},r=c=>{!(c!=null&&c.message)||n({type:"negative",message:"Wallet update",caption:c.message,timeout:kt})};s.adapter.once("connect",a),s.adapter.once("disconnect",o),s.adapter.removeAllListeners("error"),s.adapter.on("error",r)},{immediate:!0})}const lc=R({__name:"App",setup(t){return Ra(()=>{rc()}),Oa({title:"Cgram",meta:[{name:"description",content:""},{name:"keywords",content:""}],link:[{rel:"icon",type:"image/svg+xml",href:"/favicon.svg"}]}),(e,n)=>{const i=It("router-view");return y(),M(i)}}});async function cc(){const t=Va(lc);Object.values(Object.assign({"./plugins/app.ts":Ha,"./plugins/pinia.ts":ja,"./plugins/quasar.ts":Ga,"./plugins/router.ts":Zl,"./plugins/wallet.ts":tc})).forEach(e=>{var n;return(n=e.install)==null?void 0:n.call(e,{app:t})}),t.mount("#app")}cc().then();export{X as _};
