var Qt=Object.defineProperty;var Jt=(t,e,n)=>e in t?Qt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var q=(t,e,n)=>(Jt(t,typeof e!="symbol"?e+"":e,n),n);import{c as Ht,Q as Gt,P as Xt,D as Zt,N as Yt,a as en,i as tn,u as De,b as Re,d as nn,e as N,o as f,f as M,w as c,g as m,h as d,j as S,k as l,l as ct,m as an,r as V,n as y,p as B,q as fe,s as sn,t as on,S as ln,v as E,x as T,y as _t,z as I,A as Y,B as R,C as Ce,E as rn,F as Z,G as H,H as cn,I as se,J as U,K as kt,W as vt,L as Oe,M as qe,O as Pe,R as un,T as dn,U as pe,V as ee,X as Ee,Y as Me,Z as mn,_ as ft,$ as St,a0 as gt,a1 as hn,a2 as pn,a3 as fn,a4 as xt,a5 as Fe,a6 as gn,a7 as he,a8 as it,a9 as we,aa as $e,ab as bn,ac as $t,ad as yn,ae as _n,af as h,ag as ne,ah as Et,ai as ce,aj as ue,ak as Ie,al as Dt,am as Ae,an as vn,ao as Ue,ap as Pt,aq as ut,ar as wn,as as Cn,at as Mn,au as An,av as kn,aw as oe,ax as ie,ay as wt,az as re,aA as Sn,aB as Ke,aC as je,aD as bt,aE as ae,aF as Qe,aG as xn,aH as It,aI as $n,aJ as Je,aK as xe,aL as En,aM as Dn,aN as Pn,aO as In,aP as Kn,aQ as Ln,aR as Tn,aS as zn,aT as Nn,aU as Bn,aV as Wn,aW as Rn,aX as Vn,aY as On,aZ as qn,a_ as Fn,a$ as Un,b0 as jn,b1 as Qn,b2 as Jn,b3 as Hn,b4 as Gn,b5 as Xn,b6 as Zn,b7 as Yn,b8 as ea,b9 as ta,ba as na,bb as aa,bc as sa,bd as ia,be as oa,bf as la,bg as ra,bh as ca,bi as ua,bj as da,bk as ma,bl as ha,bm as pa,bn as fa,bo as ga,bp as ba,bq as ya}from"./vendor.ccfc6256.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function n(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerpolicy&&(a.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?a.credentials="include":o.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(o){if(o.ep)return;o.ep=!0;const a=n(o);fetch(o.href,a)}})();const _a=({app:t})=>{const e=Ht();t.use(e)},va=Object.freeze(Object.defineProperty({__proto__:null,install:_a},Symbol.toStringTag,{value:"Module"})),wa=({app:t})=>{t.use(Gt,{plugins:{Dark:Xt,Dialog:Zt,Notify:Yt,LocalStorage:en},iconSet:tn})},Ca=Object.freeze(Object.defineProperty({__proto__:null,install:wa},Symbol.toStringTag,{value:"Module"}));function Ma(){const{dark:t}=De(),e=Re("theme-mode",t.isActive);return t.set(e.value),{isActive:e,set(n){t.set(n),e.value=t.isActive},toggle(){t.toggle(),e.value=t.isActive}}}const ke=[{id:"serum-mainnet",name:"Serum RPC",cluster:"mainnet-beta",url:"https://solana-api.projectserum.com/"},{id:"rpcpool-mainnet",name:"RPCPool RPC",cluster:"mainnet-beta",url:"https://mainnet.rpcpool.com/"},{id:"mainnet",name:"Solana RPC",cluster:"mainnet-beta",url:nn("mainnet-beta")}],Kt={id:"devnet",name:"DevNet",cluster:"devnet",url:"https://devnet.rpcpool.com/"};ke.push(Kt);const Aa={id:"testnet",name:"TestNet",cluster:"testnet",url:"https://testnet.rpcpool.com/"};ke.push(Aa);var At;const ka=(At=ke.find(t=>t.id==={VITE_USER_NODE_ENV:"production",BASE_URL:"/",MODE:"staging",DEV:!1,PROD:!0}.VITE_CONNECTION_ENDPOINT))!=null?At:Kt,Sa="confirmed",xa=12e4,Ct=[`<span>Public channels</span> are non-encrypted and available to anyone, both for reading and writing.</br></br>
    <span>Public channels</span> are encrypted, and new users need to request approval to join them.</br>
    Depending on the \u2018Members can approve\u2019 setting, such requests can be approved either by channel\u2019s 
    owner/admin only, or by any authorized member of the channel.
    `,"Any authorized channel member can approve new requests to join"],$a="https://twitter.com/JPoolSolana",Ea="https://t.me/jpool_solana",Da="https://t.me/jpoolsolana",Pa="https://discord.gg/qR4BA9QXVR",Ia="https://jfactory.ch",Ka="https://jpool.one",La="https://svt.one",Ta={class:"container"},za={class:"row"},Na={class:"col-12 col-md-6"},Ba={class:"footer-links"},Wa=["href"],Ra=["href"],Va=["href"],Oa=m("div",{class:"copyright"},[m("span",null,[S("\xA9 Copyright 2022 cgram.one. All rights reserved."),m("br"),S("Powered by jFactory")])],-1),qa={class:"col-12 col-md-6 social-col"},Fa={class:"social"},Ua={class:"theme"},ja=["href"],Qa=m("span",null,[S("official"),m("br"),S("channel")],-1),Ja=[Qa],Ha=["href"],Ga=["href"],Xa=["href"],Za=N({__name:"AppFooter",setup(t){const e=Ma();return(n,i)=>(f(),M(an,null,{default:c(()=>[m("div",Ta,[m("div",za,[m("div",Na,[m("div",Ba,[m("ul",null,[m("li",null,[m("a",{target:"_blank",href:d(Ia)},"JFACTORY",8,Wa)]),m("li",null,[m("a",{target:"_blank",href:d(Ka)},"JPOOL",8,Ra)]),m("li",null,[m("a",{target:"_blank",href:d(La)},"SOLANA VALIDATOR TOOLKIT",8,Va)])])]),Oa]),m("div",qa,[m("div",Fa,[m("div",Ua,[S(" Dark theme "),l(ct,{"model-value":d(e).isActive.value,onClick:d(e).toggle},null,8,["model-value","onClick"])]),m("a",{href:d(Ea),target:"_blank",class:"social-link social-link-text"},Ja,8,ja),m("a",{href:d(Da),target:"_blank",class:"social-link telegram"},null,8,Ha),m("a",{href:d($a),target:"_blank",class:"social-link twitter"},null,8,Ga),m("a",{href:d(Pa),target:"_blank",class:"social-link discord"},null,8,Xa)])])])])]),_:1}))}});function Ya(){const t=V(es());return{userAgent:t,isMobileOs:y(()=>ts(t.value)),isWebView:y(()=>ns(t.value))}}let ot;function es(){var t,e;return ot===void 0&&(ot=(e=(t=globalThis.navigator)==null?void 0:t.userAgent)!=null?e:null),ot}function ts(t){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)}function ns(t){return/(WebView|(Phantom|Solflare)|Version\/.+(Chrome)\/(\d+)\.(\d+)\.(\d+)\.(\d+)|; wv\).+(Chrome)\/(\d+)\.(\d+)\.(\d+)\.(\d+))/i.test(t)}function He(t,e=4){return t instanceof B&&(t=t.toBase58()),`${t.slice(0,e)}...${t.slice(-e)}`}function Lt(t){return(t==null?void 0:t.name)&&t.name!==""?t.name:He(t.authority)}const Tt=t=>{if(!t)return{background:"#000"};let e=0;for(let i=0;i<t.length;i++)e=t.charCodeAt(i)+((e<<5)-e),e=e&e;let n="#";for(let i=0;i<3;i++)n+=`00${(e>>i*8&255).toString(16)}`.substr(-2);return{background:n}},as="/assets/clover.968404b0.svg",ss="/assets/ledger.40cf6861.svg",is="/assets/mathwallet.1d763e81.svg",zt=t=>(Oe("data-v-44868d49"),t=t(),qe(),t),os=zt(()=>m("div",{class:"text-h6 text-center"}," Your wallet ",-1)),ls={class:"q-gutter-md row justify-between"},rs=zt(()=>m("div",{class:"text-h6"}," Connect to a wallet ",-1)),cs={class:"text-light-gray text-caption full-width text-no-wrap",style:{"text-overflow":"ellipsis",overflow:"hidden"}},us=["src","alt"],ds=N({__name:"ConnectWallet",setup(t){const e={priority:{solflare:10,phantom:20,sollet:5,nufi:5,blocto:1},icons:{clover:as},darkIcons:{ledger:ss,mathwallet:is},deepLinks:{phantom:"https://phantom.app/ul/browse/{uri}?ref={ref}",solflare:"https://solflare.com/ul/browse/{uri}?ref={ref}"}},{userAgent:n,isWebView:i,isMobileOs:o}=Ya(),a={close:kt},s=$=>[vt.Installed,vt.Loadable].includes($.readyState);De();const r=fe(),{connected:u,connecting:p}=r;sn();const _=y(()=>o.value&&!i.value);if(i.value){const $=String(n.value).toLowerCase();$.includes("phantom")?(r.select(on),r.connect()):$.includes("solflare")&&(r.select(ln),r.connect())}const C=y(()=>{var $,O;return(O=($=r.publicKey.value)==null?void 0:$.toBase58())!=null?O:""}),x=y(()=>He(C.value)),g=y(()=>[...r.wallets.value].map($=>{var k,z;const O=$.adapter.name.toLowerCase();return $.adapter.icon=(z=(k=e.darkIcons[O])!=null?k:e.icons[O])!=null?z:$.adapter.icon,_.value&&e.deepLinks[O]&&($.deepLink=e.deepLinks[O].replace("{uri}",location.href).replace("{ref}",location.origin)),$}).sort(($,O)=>{var A,de;const k=(A=e.priority[$.adapter.name.toLowerCase()])!=null?A:1;return((de=e.priority[O.adapter.name.toLowerCase()])!=null?de:1)-k+((s(O)?1:0)-(s($)?1:0))})),w=y(()=>_.value?g.value.filter($=>!!$.deepLink):g.value),v=V(!1);async function W($){await r.select($.adapter.name),v.value=!1,await r.connect()}function F(){v.value=!1,r.disconnect()}function Q(){v.value=!0}function K(){v.value=!1}return($,O)=>(f(),E(U,null,[d(u)?(f(),M(I,_t({key:0},$.$attrs,{class:$.$style.btn,ripple:!1,color:"primary-gray","text-color":"white",square:"",unelevated:"",onClick:Q}),{default:c(()=>[S(T(d(x)),1)]),_:1},16,["class"])):(f(),M(I,_t({key:1},$.$attrs,{color:"primary-gray","text-color":"white",square:"",ripple:!1,loading:d(p),onClick:Q}),{default:c(()=>[S(" CONNECT WALLET ")]),_:1},16,["loading"])),l(se,{modelValue:v.value,"onUpdate:modelValue":O[0]||(O[0]=k=>v.value=k),"transition-duration":"150","transition-show":"fade","transition-hide":"fade"},{default:c(()=>[d(u)?(f(),M(Y,{key:0},{default:c(()=>[l(R,{class:"relative-position"},{default:c(()=>[os,l(I,{padding:"md",color:"transparent","text-color":"primary-gray",unelevated:"",class:"absolute-right",icon:a.close,size:"md",onClick:K},null,8,["icon"])]),_:1}),l(Ce),l(R,null,{default:c(()=>[S(T(d(C)),1)]),_:1}),l(Ce),l(R,null,{default:c(()=>[m("div",ls,[l(I,{class:"disconnect-btn","text-color":"white",rounded:"",onClick:F},{default:c(()=>[S(" Disconnect ")]),_:1}),l(I,{class:"disconnect-btn","text-color":"white",rounded:"",onClick:K},{default:c(()=>[S(" Ok ")]),_:1})])]),_:1})]),_:1})):(f(),M(Y,{key:1,class:"wallet-connect-card"},{default:c(()=>[l(R,null,{default:c(()=>[rs,l(I,{padding:"md",color:"transparent","text-color":"primary-gray",unelevated:"",class:"absolute-right",icon:a.close,size:"md",onClick:K},null,8,["icon"])]),_:1}),l(Ce),l(R,{style:{"max-height":"80vh"},class:"scroll"},{default:c(()=>[l(rn,{grid:"",rows:d(w),"row-key":"name","hide-pagination":"","hide-header":"","rows-per-page-options":[100]},{item:c(({row:k})=>[(f(),E("div",{key:`wallet-${k.adapter.name}`,class:"col-12 col-md-6"},[l(Z,{clickable:"",href:k.deepLink,onClick:z=>k.deepLink?!0:W(k)},{default:c(()=>[l(H,null,{default:c(()=>[m("b",null,T(k.adapter.name),1),m("div",cs,T(k.adapter.url),1)]),_:2},1024),l(H,{avatar:""},{default:c(()=>[l(cn,{square:""},{default:c(()=>[m("img",{src:k.adapter.icon,alt:k.adapter.name},null,8,us)]),_:2},1024)]),_:2},1024)]),_:2},1032,["href","onClick"])]))]),_:1},8,["rows"])]),_:1})]),_:1}))]),_:1},8,["modelValue"])],64))}});const ms="_btn_6n1iw_1",hs={btn:ms},G=(t,e)=>{const n=t.__vccOpts||t;for(const[i,o]of e)n[i]=o;return n},ps={$style:hs},fs=G(ds,[["__cssModules",ps],["__scopeId","data-v-44868d49"]]),yt=Pe({id:"connection",state:()=>({commitment:Sa,confirmTransactionInitialTimeout:xa,rpc:un("rpc","")}),getters:{endpoint(t){var e;return(e=ke.find(n=>n.id===t.rpc))!=null?e:ka},connection(t){return console.log("[connection]",this.endpoint.url),new dn(this.endpoint.url,{confirmTransactionInitialTimeout:t.confirmTransactionInitialTimeout,commitment:t.commitment})},cluster(){return this.endpoint.cluster}},actions:{setRpc(t){this.rpc=t},setCommitment(t){this.commitment=t}}}),gs=N({__name:"ClusterSelector",setup(t){const e=yt(),{connected:n,connect:i,disconnect:o,autoConnect:a}=fe(),s=[ke.filter(p=>p.cluster==="mainnet-beta"),ke.filter(p=>p.cluster!=="mainnet-beta")],r=y(()=>e.endpoint),u=p=>{n&&e.cluster!==p.cluster&&(o(),a.value&&i()),e.setRpc(p.id)};return(p,_)=>(f(),M(mn,{label:d(r).name,"model-value":!1,"auto-close":"",color:"secondary","text-color":"#000",square:"",unelevated:"",ripple:!1},{default:c(()=>[l(pe,null,{default:c(()=>[(f(),E(U,null,ee(s,(C,x)=>(f(),E(U,{key:`${x}-cluster-group`},[(f(!0),E(U,null,ee(C,g=>(f(),M(Z,{key:g.id,clickable:"",onClick:w=>u(g)},{default:c(()=>[(f(),M(H,{key:`${g.id}-item`},{default:c(()=>[l(Ee,null,{default:c(()=>[m("b",null,T(g.name),1)]),_:2},1024),S(" "+T(g.url),1)]),_:2},1024))]),_:2},1032,["onClick"]))),128)),x!==s.length-1?(f(),M(Ce,{key:0})):Me("",!0)],64))),64))]),_:1})]),_:1},8,["label"]))}});const bs={},ys={class:"container"},_s={class:"app-header__info"},vs={class:"app-header__logo"},ws={class:"logo-wrapper"},Cs=m("div",{class:"app-header__title"},[m("h1",null,[S("BLOCKCHAIN messenger "),m("span",{class:"marked"},"SOLANA")])],-1),Ms={class:"app-header__right"},As={class:"app-header__buttons"};function ks(t,e){const n=ft("router-link"),i=gs,o=fs;return f(),M(hn,{class:"app-header"},{default:c(()=>[m("div",ys,[l(St,null,{default:c(()=>[m("div",_s,[m("div",vs,[m("div",ws,[l(n,{to:"/"})])]),Cs]),l(gt),m("div",Ms,[m("div",As,[l(i,{class:"app-header__cluster-btn header-btn"}),l(o,{class:"app-header__wallet-btn header-btn"})])])]),_:1})])]),_:1})}const Ss=G(bs,[["render",ks]]),xs={};function $s(t,e){const n=Ss,i=ft("router-view"),o=Za;return f(),M(pn,{view:"lfh Lpr lff"},{default:c(()=>[l(n),l(fn,null,{default:c(()=>[l(i)]),_:1}),l(o)]),_:1})}const Es=G(xs,[["render",$s]]),Ds={default:Es,empty:()=>xt(()=>import("./empty.a7881ffa.js"),["assets/empty.a7881ffa.js","assets/vendor.ccfc6256.js"])};function Ps(t){return t.map(e=>{var n;return{path:e.path,component:Ds[((n=e.meta)==null?void 0:n.layout)||"default"],children:[{...e,path:""}]}})}const Is="/assets/search.b4fadb1c.svg",Ks="/assets/transfer.796e9da5.svg",Ls="/assets/plus.ee413328.svg",Ts={class:"how-it-works"},zs={class:"app-info"},Ns=m("div",{class:"app-info__title"}," JOIN A CHANNEL ",-1),Bs={class:"app-info__list"},Ws=["innerHTML"],Rs={class:"app-info"},Vs=m("div",{class:"app-info__title"}," CREATE YOUR OWN CHANNEL ",-1),Os={class:"app-info__list"},qs=["innerHTML"],Fs=N({__name:"HowItWorks",setup(t){const e=["For <span>public channels</span>, you can read or send messages without limitations.",`In order to join one of the existing private channels, click
        <img src="${Is}" class="icon" alt="search">
        (BROWSE CHANNELS) at the bottom of the left-side panel.`,`Find a channel you are interested in and click
        <img src="${Ks}" class="icon" alt="transfer">
        (REQUEST TO JOIN). Your status for that channel will be set to Pending
        Approval until your request has been accepted. While awaiting approval,
        all messages in the channel will appear scrambled.`,`After the private channel's owner or admin approves your membership,your
        status will change to Authorized. You will be able to read the channel
        and send messages.`],n=["You can create a channel of your own as well.",`Click <img src="${Ls}" class="icon" alt="search"> (CREATE A CHANNEL) 
  at the bottom of the left-side panel, then choose between Private and Public options.`,"A public channel is open to anyone for reading and writing, and no encryption is used.",`If you create a private channel, joining it will require your approval. You will see a red 
  notification badge above the channel list if there are approval requests pending.`];return(i,o)=>(f(),E("div",Ts,[m("div",zs,[Ns,m("ul",Bs,[(f(),E(U,null,ee(e,a=>m("li",{key:a},[m("p",{innerHTML:a},null,8,Ws)])),64))])]),m("div",Rs,[Vs,m("ul",Os,[(f(),E(U,null,ee(n,a=>m("li",{key:a},[m("p",{innerHTML:a},null,8,qs)])),64))])])]))}});const Nt=Pe("user",()=>{const t=Fe(),e=V();gn(()=>{var s;const a=(s=t.value)==null?void 0:s.publicKey;if(a){const r=Re(a.toString(),()=>it.encode(he.generate().secretKey));n(r.value)}else e.value=void 0});function n(a){e.value=he.fromSecretKey(it.decode(a))}function i(){var r;const a=(r=t.value)==null?void 0:r.publicKey;if(!a)return;const s=Re(a.toString(),"");n(s.value=it.encode(he.generate().secretKey))}function o(a){var u;const s=(u=t.value)==null?void 0:u.publicKey;if(!s)return;const r=Re(s.toString(),"");n(r.value=a)}return{keypair:e,generateKey:i,importKey:o}}),Us=t=>(Oe("data-v-e5b7ea14"),t=t(),qe(),t),js=Us(()=>m("div",{class:"text-h6 text-center"}," Device Key ",-1)),Qs={class:"q-gutter-md row justify-between"},Js=N({__name:"UserInfoDialog",emits:["regenerate"],setup(t){const e=Nt(),n=()=>{var i,o;return _n(String((o=(i=e.keypair)==null?void 0:i.publicKey)!=null?o:""))};return(i,o)=>(f(),M(se,{class:"dialog-wrapper","transition-duration":"150","transition-show":"fade","transition-hide":"fade"},{default:c(()=>[l(Y,{square:"",flat:""},{default:c(()=>[l(R,{class:"row items-center"},{default:c(()=>[js,l(gt),we(l(I,{flat:"",round:"",dense:"",icon:d(kt)},null,8,["icon"]),[[$e]])]),_:1}),l(Ce),l(R,null,{default:c(()=>{var a;return[l(I,{flat:"",round:"",dense:"",icon:d(bn),onClick:n},{default:c(()=>[l($t,{delay:0,anchor:"bottom middle",self:"top middle","transition-duration":"0"},{default:c(()=>[S(" Copy to clipboard ")]),_:1})]),_:1},8,["icon"]),m("span",null,T((a=d(e).keypair)==null?void 0:a.publicKey),1)]}),_:1}),l(Ce),l(yn,{align:"right"},{default:c(()=>[m("div",Qs,[l(I,{class:"disconnect-btn","text-color":"white",rounded:"",onClick:d(e).generateKey},{default:c(()=>[S(" Regenerate ")]),_:1},8,["onClick"])])]),_:1})]),_:1})]),_:1}))}});const Hs=G(Js,[["__scopeId","data-v-e5b7ea14"]]),Gs="0.0.8",Xs="messenger",Zs=[{name:"initChannel",accounts:[{name:"channel",isMut:!0,isSigner:!0},{name:"membership",isMut:!0,isSigner:!1},{name:"authority",isMut:!0,isSigner:!0},{name:"key",isMut:!1,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"data",type:{defined:"InitChannelData"}}]},{name:"deleteChannel",accounts:[{name:"channel",isMut:!0,isSigner:!1},{name:"authorityMembership",isMut:!0,isSigner:!1},{name:"authority",isMut:!0,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"joinChannel",accounts:[{name:"channel",isMut:!0,isSigner:!1},{name:"membership",isMut:!0,isSigner:!1},{name:"authority",isMut:!0,isSigner:!0},{name:"key",isMut:!1,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"data",type:{defined:"JoinChannelData"}}]},{name:"leaveChannel",accounts:[{name:"channel",isMut:!0,isSigner:!1},{name:"membership",isMut:!0,isSigner:!1},{name:"authority",isMut:!0,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"grantAccessMember",accounts:[{name:"channel",isMut:!1,isSigner:!1},{name:"membership",isMut:!0,isSigner:!1},{name:"authorityMembership",isMut:!1,isSigner:!1},{name:"authority",isMut:!0,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"data",type:{defined:"GrantAccessMemberData"}}]},{name:"addMember",accounts:[{name:"channel",isMut:!0,isSigner:!1},{name:"invitee",isMut:!1,isSigner:!1},{name:"inviteeMembership",isMut:!0,isSigner:!1},{name:"authorityMembership",isMut:!0,isSigner:!1},{name:"authority",isMut:!0,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"data",type:{defined:"AddMemberData"}}]},{name:"authorizeMember",accounts:[{name:"channel",isMut:!1,isSigner:!1},{name:"membership",isMut:!0,isSigner:!1},{name:"authority",isMut:!1,isSigner:!0},{name:"authorityMembership",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"data",type:{defined:"AuthorizeMemberData"}}]},{name:"deleteMember",accounts:[{name:"channel",isMut:!0,isSigner:!1},{name:"membership",isMut:!0,isSigner:!1},{name:"authorityMembership",isMut:!1,isSigner:!1},{name:"authority",isMut:!0,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"postMessage",accounts:[{name:"channel",isMut:!0,isSigner:!1},{name:"membership",isMut:!1,isSigner:!1},{name:"authority",isMut:!1,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"message",type:"string"}]}],Ys=[{name:"Channel",type:{kind:"struct",fields:[{name:"name",docs:["Name of the channel"],type:"string"},{name:"creator",docs:["Channel creator"],type:"publicKey"},{name:"createdAt",docs:["Creation date"],type:"i64"},{name:"flags",docs:["Channel flags"],type:"u8"},{name:"memberCount",docs:["Number of members"],type:"u16"},{name:"messageCount",docs:["Message counter"],type:"u32"},{name:"maxMessages",docs:["The maximum number of messages that are stored in [messages]"],type:"u16"},{name:"messages",docs:["List of messages"],type:{vec:{defined:"Message"}}}]}},{name:"ChannelMembership",type:{kind:"struct",fields:[{name:"channel",docs:["Associated [Channel] address"],type:"publicKey"},{name:"authority",docs:["Authority of membership"],type:"publicKey"},{name:"key",docs:["The device key used to encrypt the `CEK`"],type:"publicKey"},{name:"cek",docs:["The content encryption key (CEK) of the channel"],type:{defined:"CEKData"}},{name:"status",docs:["Status of membership"],type:{defined:"ChannelMembershipStatus"}},{name:"name",docs:["Name of the channel member"],type:"string"},{name:"invitedBy",docs:["Inviter address"],type:{option:"publicKey"}},{name:"createdAt",docs:["Creation date"],type:"i64"},{name:"flags",docs:["Membership flags"],type:"u8"},{name:"bump",docs:["Bump seed for deriving PDA seeds"],type:"u8"}]}}],ei=[{name:"AddMemberData",type:{kind:"struct",fields:[{name:"name",docs:["Member name"],type:"string"},{name:"flags",docs:["Membership flags, only `admin` and `owner` can set membership flags"],type:"u8"},{name:"cek",docs:["Content Encryption Key"],type:{defined:"CEKData"}},{name:"key",docs:["Device key"],type:{option:"publicKey"}}]}},{name:"AuthorizeMemberData",type:{kind:"struct",fields:[{name:"cek",type:{defined:"CEKData"}}]}},{name:"GrantAccessMemberData",type:{kind:"struct",fields:[{name:"flags",type:"u8"}]}},{name:"InitChannelData",type:{kind:"struct",fields:[{name:"name",type:"string"},{name:"maxMessages",type:"u16"},{name:"memberName",type:"string"},{name:"cek",type:{defined:"CEKData"}},{name:"public",type:"bool"},{name:"permissionless",type:"bool"}]}},{name:"JoinChannelData",type:{kind:"struct",fields:[{name:"name",type:"string"},{name:"authority",type:{option:"publicKey"}}]}},{name:"CEKData",type:{kind:"struct",fields:[{name:"header",docs:["The header information for the CEK"],type:"string"},{name:"encryptedKey",docs:["The CEK itself"],type:"string"}]}},{name:"Message",type:{kind:"struct",fields:[{name:"id",docs:["Uniq message id"],type:"u32"},{name:"sender",docs:["The message sender id"],type:"publicKey"},{name:"createdAt",docs:["The unix timestamp at which the message was received"],type:"i64"},{name:"flags",docs:["Message flags"],type:"u8"},{name:"content",docs:["The (typically encrypted) message content"],type:"string"}]}},{name:"ChannelMembershipStatus",type:{kind:"enum",variants:[{name:"Authorized",fields:[{name:"by",type:{option:"publicKey"}}]},{name:"Pending",fields:[{name:"authority",type:{option:"publicKey"}}]}]}}],ti=[{name:"NewChannelEvent",fields:[{name:"channel",type:"publicKey",index:!0},{name:"creator",type:"publicKey",index:!1},{name:"name",type:"string",index:!1},{name:"timestamp",type:"i64",index:!1}]},{name:"DeleteChannelEvent",fields:[{name:"channel",type:"publicKey",index:!0},{name:"creator",type:"publicKey",index:!1},{name:"timestamp",type:"i64",index:!1}]},{name:"NewMessageEvent",fields:[{name:"channel",type:"publicKey",index:!0},{name:"message",type:{defined:"Message"},index:!1}]},{name:"JoinChannelEvent",fields:[{name:"channel",type:"publicKey",index:!0},{name:"membership",type:"publicKey",index:!0},{name:"timestamp",type:"i64",index:!1}]},{name:"LeaveChannelEvent",fields:[{name:"channel",type:"publicKey",index:!0},{name:"authority",type:"publicKey",index:!0},{name:"timestamp",type:"i64",index:!1}]},{name:"AddMemberEvent",fields:[{name:"channel",type:"publicKey",index:!0},{name:"membership",type:"publicKey",index:!0},{name:"by",type:"publicKey",index:!1},{name:"timestamp",type:"i64",index:!1}]},{name:"AuthorizeMemberEvent",fields:[{name:"channel",type:"publicKey",index:!0},{name:"membership",type:"publicKey",index:!0},{name:"by",type:"publicKey",index:!1},{name:"timestamp",type:"i64",index:!1}]},{name:"DeleteMemberEvent",fields:[{name:"channel",type:"publicKey",index:!0},{name:"membership",type:"publicKey",index:!0},{name:"by",type:"publicKey",index:!1},{name:"timestamp",type:"i64",index:!1}]}],ni=[{code:6e3,name:"Unauthorized",msg:"Unauthorized"},{code:6001,name:"InvalidChannel",msg:"Invalid channel"},{code:6002,name:"InvalidMembership",msg:"Invalid membership"},{code:6003,name:"InvalidMessage",msg:"Invalid message"},{code:6004,name:"NameTooLong",msg:"Name too long"},{code:6005,name:"MessageTooLong",msg:"Message too long"}],ai={address:"6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm",origin:"anchor",binaryVersion:"0.25.0",libVersion:"0.25.0"},si={version:Gs,name:Xs,instructions:Zs,accounts:Ys,types:ei,events:ti,errors:ni,metadata:ai},ii=new h.FixableBeetArgsStruct([["id",h.u32],["sender",ne],["createdAt",h.i64],["flags",h.u8],["content",h.utf8String]],"Message"),dt=[49,159,99,106,220,87,219,88];class te{constructor(e,n,i,o,a,s,r,u){this.name=e,this.creator=n,this.createdAt=i,this.flags=o,this.memberCount=a,this.messageCount=s,this.maxMessages=r,this.messages=u}static fromArgs(e){return new te(e.name,e.creator,e.createdAt,e.flags,e.memberCount,e.messageCount,e.maxMessages,e.messages)}static fromAccountInfo(e,n=0){return te.deserialize(e.data,n)}static async fromAccountAddress(e,n,i){const o=await e.getAccountInfo(n,i);if(o==null)throw new Error(`Unable to find Channel account at ${n}`);return te.fromAccountInfo(o,0)[0]}static gpaBuilder(e=new B("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){return Et.fromStruct(e,Be)}static deserialize(e,n=0){return Be.deserialize(e,n)}serialize(){return Be.serialize({accountDiscriminator:dt,...this})}static byteSize(e){const n=te.fromArgs(e);return Be.toFixedFromValue({accountDiscriminator:dt,...n}).byteSize}static async getMinimumBalanceForRentExemption(e,n,i){return n.getMinimumBalanceForRentExemption(te.byteSize(e),i)}pretty(){return{name:this.name,creator:this.creator.toBase58(),createdAt:(()=>{const e=this.createdAt;if(typeof e.toNumber=="function")try{return e.toNumber()}catch{return e}return e})(),flags:this.flags,memberCount:this.memberCount,messageCount:this.messageCount,maxMessages:this.maxMessages,messages:this.messages}}}const Be=new h.FixableBeetStruct([["accountDiscriminator",h.uniformFixedSizeArray(h.u8,8)],["name",h.utf8String],["creator",ne],["createdAt",h.i64],["flags",h.u8],["memberCount",h.u16],["messageCount",h.u32],["maxMessages",h.u16],["messages",h.array(ii)]],te.fromArgs,"Channel"),Ge=new h.FixableBeetArgsStruct([["header",h.utf8String],["encryptedKey",h.utf8String]],"CEKData"),oi=h.dataEnum([["Authorized",new h.FixableBeetArgsStruct([["by",h.coption(ne)]],'ChannelMembershipStatusRecord["Authorized"]')],["Pending",new h.FixableBeetArgsStruct([["authority",h.coption(ne)]],'ChannelMembershipStatusRecord["Pending"]')]]),Ve=[238,149,255,251,116,131,86,170];class X{constructor(e,n,i,o,a,s,r,u,p,_){this.channel=e,this.authority=n,this.key=i,this.cek=o,this.status=a,this.name=s,this.invitedBy=r,this.createdAt=u,this.flags=p,this.bump=_}static fromArgs(e){return new X(e.channel,e.authority,e.key,e.cek,e.status,e.name,e.invitedBy,e.createdAt,e.flags,e.bump)}static fromAccountInfo(e,n=0){return X.deserialize(e.data,n)}static async fromAccountAddress(e,n,i){const o=await e.getAccountInfo(n,i);if(o==null)throw new Error(`Unable to find ChannelMembership account at ${n}`);return X.fromAccountInfo(o,0)[0]}static gpaBuilder(e=new B("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){return Et.fromStruct(e,We)}static deserialize(e,n=0){return We.deserialize(e,n)}serialize(){return We.serialize({accountDiscriminator:Ve,...this})}static byteSize(e){const n=X.fromArgs(e);return We.toFixedFromValue({accountDiscriminator:Ve,...n}).byteSize}static async getMinimumBalanceForRentExemption(e,n,i){return n.getMinimumBalanceForRentExemption(X.byteSize(e),i)}pretty(){return{channel:this.channel.toBase58(),authority:this.authority.toBase58(),key:this.key.toBase58(),cek:this.cek,status:this.status.__kind,name:this.name,invitedBy:this.invitedBy,createdAt:(()=>{const e=this.createdAt;if(typeof e.toNumber=="function")try{return e.toNumber()}catch{return e}return e})(),flags:this.flags,bump:this.bump}}}const We=new h.FixableBeetStruct([["accountDiscriminator",h.uniformFixedSizeArray(h.u8,8)],["channel",ne],["authority",ne],["key",ne],["cek",Ge],["status",oi],["name",h.utf8String],["invitedBy",h.coption(ne)],["createdAt",h.i64],["flags",h.u8],["bump",h.u8]],X.fromArgs,"ChannelMembership"),ge=new Map,be=new Map;class Xe extends Error{constructor(){super("Unauthorized");q(this,"code",6e3);q(this,"name","Unauthorized");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Xe)}}ge.set(6e3,()=>new Xe);be.set("Unauthorized",()=>new Xe);class Ze extends Error{constructor(){super("Invalid channel");q(this,"code",6001);q(this,"name","InvalidChannel");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Ze)}}ge.set(6001,()=>new Ze);be.set("InvalidChannel",()=>new Ze);class Ye extends Error{constructor(){super("Invalid membership");q(this,"code",6002);q(this,"name","InvalidMembership");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Ye)}}ge.set(6002,()=>new Ye);be.set("InvalidMembership",()=>new Ye);class et extends Error{constructor(){super("Invalid message");q(this,"code",6003);q(this,"name","InvalidMessage");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,et)}}ge.set(6003,()=>new et);be.set("InvalidMessage",()=>new et);class tt extends Error{constructor(){super("Name too long");q(this,"code",6004);q(this,"name","NameTooLong");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,tt)}}ge.set(6004,()=>new tt);be.set("NameTooLong",()=>new tt);class nt extends Error{constructor(){super("Message too long");q(this,"code",6005);q(this,"name","MessageTooLong");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,nt)}}ge.set(6005,()=>new nt);be.set("MessageTooLong",()=>new nt);function le(t){const e=ge.get(t);return e!=null?e():null}function ve(t){const e=be.get(t);return e!=null?e():null}const li=new h.FixableBeetArgsStruct([["name",h.utf8String],["flags",h.u8],["cek",Ge],["key",h.coption(ne)]],"AddMemberData"),ri=new h.FixableBeetArgsStruct([["instructionDiscriminator",h.uniformFixedSizeArray(h.u8,8)],["data",li]],"AddMemberInstructionArgs"),ci=[13,116,123,130,126,198,57,34];function ui(t,e,n=new B("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){var s;const[i]=ri.serialize({instructionDiscriminator:ci,...e}),o=[{pubkey:t.channel,isWritable:!0,isSigner:!1},{pubkey:t.invitee,isWritable:!1,isSigner:!1},{pubkey:t.inviteeMembership,isWritable:!0,isSigner:!1},{pubkey:t.authorityMembership,isWritable:!0,isSigner:!1},{pubkey:t.authority,isWritable:!0,isSigner:!0},{pubkey:(s=t.systemProgram)!=null?s:ce.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const r of t.anchorRemainingAccounts)o.push(r);return new ue({programId:n,keys:o,data:i})}const di=new h.FixableBeetArgsStruct([["cek",Ge]],"AuthorizeMemberData"),mi=new h.FixableBeetArgsStruct([["instructionDiscriminator",h.uniformFixedSizeArray(h.u8,8)],["data",di]],"AuthorizeMemberInstructionArgs"),hi=[194,123,189,175,86,225,93,128];function pi(t,e,n=new B("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){var s;const[i]=mi.serialize({instructionDiscriminator:hi,...e}),o=[{pubkey:t.channel,isWritable:!1,isSigner:!1},{pubkey:t.membership,isWritable:!0,isSigner:!1},{pubkey:t.authority,isWritable:!1,isSigner:!0},{pubkey:t.authorityMembership,isWritable:!0,isSigner:!1},{pubkey:(s=t.systemProgram)!=null?s:ce.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const r of t.anchorRemainingAccounts)o.push(r);return new ue({programId:n,keys:o,data:i})}const fi=new h.BeetArgsStruct([["instructionDiscriminator",h.uniformFixedSizeArray(h.u8,8)]],"DeleteChannelInstructionArgs"),gi=[145,225,187,221,157,142,114,133];function bi(t,e=new B("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){var a;const[n]=fi.serialize({instructionDiscriminator:gi}),i=[{pubkey:t.channel,isWritable:!0,isSigner:!1},{pubkey:t.authorityMembership,isWritable:!0,isSigner:!1},{pubkey:t.authority,isWritable:!0,isSigner:!0},{pubkey:(a=t.systemProgram)!=null?a:ce.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const s of t.anchorRemainingAccounts)i.push(s);return new ue({programId:e,keys:i,data:n})}const yi=new h.BeetArgsStruct([["instructionDiscriminator",h.uniformFixedSizeArray(h.u8,8)]],"DeleteMemberInstructionArgs"),_i=[95,14,98,112,252,218,205,173];function vi(t,e=new B("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){var a;const[n]=yi.serialize({instructionDiscriminator:_i}),i=[{pubkey:t.channel,isWritable:!0,isSigner:!1},{pubkey:t.membership,isWritable:!0,isSigner:!1},{pubkey:t.authorityMembership,isWritable:!1,isSigner:!1},{pubkey:t.authority,isWritable:!0,isSigner:!0},{pubkey:(a=t.systemProgram)!=null?a:ce.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const s of t.anchorRemainingAccounts)i.push(s);return new ue({programId:e,keys:i,data:n})}const wi=new h.BeetArgsStruct([["flags",h.u8]],"GrantAccessMemberData");new h.BeetArgsStruct([["instructionDiscriminator",h.uniformFixedSizeArray(h.u8,8)],["data",wi]],"GrantAccessMemberInstructionArgs");const Ci=new h.FixableBeetArgsStruct([["name",h.utf8String],["maxMessages",h.u16],["memberName",h.utf8String],["cek",Ge],["public",h.bool],["permissionless",h.bool]],"InitChannelData"),Mi=new h.FixableBeetArgsStruct([["instructionDiscriminator",h.uniformFixedSizeArray(h.u8,8)],["data",Ci]],"InitChannelInstructionArgs"),Ai=[21,200,152,39,19,178,76,47];function ki(t,e,n=new B("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){var s;const[i]=Mi.serialize({instructionDiscriminator:Ai,...e}),o=[{pubkey:t.channel,isWritable:!0,isSigner:!0},{pubkey:t.membership,isWritable:!0,isSigner:!1},{pubkey:t.authority,isWritable:!0,isSigner:!0},{pubkey:t.key,isWritable:!1,isSigner:!0},{pubkey:(s=t.systemProgram)!=null?s:ce.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const r of t.anchorRemainingAccounts)o.push(r);return new ue({programId:n,keys:o,data:i})}const Si=new h.FixableBeetArgsStruct([["name",h.utf8String],["authority",h.coption(ne)]],"JoinChannelData"),xi=new h.FixableBeetArgsStruct([["instructionDiscriminator",h.uniformFixedSizeArray(h.u8,8)],["data",Si]],"JoinChannelInstructionArgs"),$i=[124,39,115,89,217,26,38,29];function Ei(t,e,n=new B("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){var s;const[i]=xi.serialize({instructionDiscriminator:$i,...e}),o=[{pubkey:t.channel,isWritable:!0,isSigner:!1},{pubkey:t.membership,isWritable:!0,isSigner:!1},{pubkey:t.authority,isWritable:!0,isSigner:!0},{pubkey:t.key,isWritable:!1,isSigner:!0},{pubkey:(s=t.systemProgram)!=null?s:ce.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const r of t.anchorRemainingAccounts)o.push(r);return new ue({programId:n,keys:o,data:i})}const Di=new h.BeetArgsStruct([["instructionDiscriminator",h.uniformFixedSizeArray(h.u8,8)]],"LeaveChannelInstructionArgs"),Pi=[104,0,75,134,95,80,68,186];function Ii(t,e=new B("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){var a;const[n]=Di.serialize({instructionDiscriminator:Pi}),i=[{pubkey:t.channel,isWritable:!0,isSigner:!1},{pubkey:t.membership,isWritable:!0,isSigner:!1},{pubkey:t.authority,isWritable:!0,isSigner:!0},{pubkey:(a=t.systemProgram)!=null?a:ce.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const s of t.anchorRemainingAccounts)i.push(s);return new ue({programId:e,keys:i,data:n})}const Ki=new h.FixableBeetArgsStruct([["instructionDiscriminator",h.uniformFixedSizeArray(h.u8,8)],["message",h.utf8String]],"PostMessageInstructionArgs"),Li=[214,50,100,209,38,34,7,76];function Ti(t,e,n=new B("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){var s;const[i]=Ki.serialize({instructionDiscriminator:Li,...e}),o=[{pubkey:t.channel,isWritable:!0,isSigner:!1},{pubkey:t.membership,isWritable:!1,isSigner:!1},{pubkey:t.authority,isWritable:!1,isSigner:!0},{pubkey:(s=t.systemProgram)!=null?s:ce.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const r of t.anchorRemainingAccounts)o.push(r);return new ue({programId:n,keys:o,data:i})}const zi="6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm",Ni=new B(zi);function mt(t,e=new Uint8Array(4)){const n=Ie(t.toString(),"base10");return e.set(n,4-n.length),e}const lt=t=>Ae([mt(t.length),t]);function Bt(t,e,n){if(e!==256)throw new Error(`Unsupported key length: ${e}`);const i=Ae([lt(Ie(n)),lt(new Uint8Array(0)),lt(new Uint8Array(0)),mt(e)]),o=1;return vn.hash(Ae([mt(o),t,i]))}const ht=t=>Ie(t,"base64pad"),pt=t=>Dt(t,"base64pad"),Bi=t=>Ie(t),Wi=t=>Dt(t),Ri=t=>Ie(t,"base58btc"),me=Ue.NONCE_LENGTH,Se=Ue.TAG_LENGTH,Wt=t=>{const e=new Ue.XChaCha20Poly1305(t);return(n,i)=>{const o=Pt.randomBytes(me),a=e.seal(o,n,i);return{ciphertext:a.subarray(0,a.length-Se),tag:a.subarray(a.length-Se),iv:o}}},Rt=t=>{const e=new Ue.XChaCha20Poly1305(t);return(n,i,o,a)=>e.open(o,Ae([n,i]),a)},Vt="ECDH-ES+XC20PKW",Ot=256,Vi=t=>e=>{const n=ut.generateKeyPair(),i=ut.sharedKey(n.secretKey,t),o=Bt(i,Ot,Vt),a=Wt(o)(e);return{encryptedKey:a.ciphertext,tag:a.tag,iv:a.iv,epPubKey:n.publicKey}},Oi=t=>(e,n,i,o)=>{const a=ut.sharedKey(t,o),s=Bt(a,Ot,Vt);return Rt(s)(e,n,i)},qi=t=>Array.isArray(t)?he.fromSecretKey(Mn.Buffer.from(t)):typeof t=="string"?he.fromSecretKey(Ri(t)):he.fromSecretKey(t),Fi=async(t=32)=>{const e=Pt.randomBytes(t);return Promise.resolve(e)},Ui=async(t,e)=>{const n=await Vi(wn(e.toBytes()))(t);return{header:pt(Ae([n.iv,n.tag,n.epPubKey])),encryptedKey:pt(n.encryptedKey)}},ji=async(t,e)=>{const n=ht(t.header),i=n.subarray(0,me),o=n.subarray(me,me+Se),a=n.subarray(me+Se),s=ht(t.encryptedKey),r=qi(e).secretKey,u=Cn(r),p=await Oi(u)(s,o,i,a);if(p===null)throw new Error("There was a problem decrypting the CEK");return p},Qi=async(t,e)=>{const n=await Wt(e)(Bi(t));return pt(Ae([n.iv,n.ciphertext,n.tag]))},Ji=async(t,e)=>{const n=ht(t),i=n.subarray(0,me),o=n.subarray(me,-Se),a=n.subarray(-Se),s=await Rt(e)(o,a,i);if(s===null)throw new Error("There was an error decoding the message!");return Wi(s)};class Hi{constructor(e,n){q(this,"programId",Ni);q(this,"_coder");q(this,"_events");q(this,"utils",{channel:{isPublic:e=>(e.flags&1)>0,isPermissionless:e=>(e.flags&2)>0},member:{isOwner:e=>e.flags>=255,isAdmin:e=>(e.flags&7)===7,canAddMember:e=>(e.flags&1)>0,canDeleteMember:e=>(e.flags&2)>0,canAuthorizeMember:e=>(e.flags&4)>0},message:{isEncrypted:e=>(e.flags&1)>0}});this.provider=e,this.keypair=n,this._coder=new An(si),this._events=new kn(this.programId,e,this._coder)}get connection(){return this.provider.connection}addEventListener(e,n){return this._events.addEventListener(e,n)}async removeEventListener(e){return await this._events.removeEventListener(e)}setKeypair(e){this.keypair=e}async loadAllChannels(){return(await te.gpaBuilder().addFilter("accountDiscriminator",dt).run(this.provider.connection)).map(n=>({pubkey:n.pubkey,data:te.fromAccountInfo(n.account)[0]}))}async loadChannel(e,n){return te.fromAccountAddress(this.provider.connection,e,n)}async loadMyChannels(){return await this.loadMemberships()}async loadChannelMembers(e){return(await X.gpaBuilder().addFilter("accountDiscriminator",Ve).addFilter("channel",e).run(this.provider.connection)).map(i=>({pubkey:i.pubkey,data:X.fromAccountInfo(i.account)[0]}))}async loadMemberships(e){const n=X.gpaBuilder().addFilter("accountDiscriminator",Ve).addFilter("authority",this.provider.publicKey);return e&&n.addFilter("key",e),(await n.run(this.provider.connection)).map(o=>({pubkey:o.pubkey,data:X.fromAccountInfo(o.account)}))}async loadMembership(e,n){return X.fromAccountAddress(this.provider.connection,e,n)}async getMembershipPDA(e,n){return n=n!=null?n:this.keypair.publicKey,await B.findProgramAddress([e.toBuffer(),n.toBuffer()],this.programId)}async encryptCEK(e,n){return Ui(e,n!=null?n:this.keypair.publicKey)}async decryptCEK(e,n){return ji(e,n!=null?n:this.keypair.secretKey)}async encryptMessage(e,n){return Qi(e,n)}async decryptMessage(e,n){return Ji(e,n)}async initChannel(e){var p,_,C,x,g;const n=(p=e.channel)!=null?p:he.generate(),i=await Fi(),o=await this.encryptCEK(i),[a]=await this.getMembershipPDA(n.publicKey),s=this.provider.publicKey,r=new oe;r.add(ki({key:this.keypair.publicKey,channel:n.publicKey,membership:a,authority:s},{data:{name:e.name,public:(_=e.public)!=null?_:!1,permissionless:(C=e.permissionless)!=null?C:!1,memberName:(x=e.memberName)!=null?x:"",maxMessages:e.maxMessages,cek:o}}));let u;try{u=await this.provider.sendAndConfirm(r,[n,this.keypair],e.opts)}catch(w){throw(g=le(w.code))!=null?g:w}return{signature:u,channel:n,cek:i,cekEncrypted:o}}async deleteChannel({channel:e,opts:n}){var r;const i=this.provider.publicKey,[o]=await this.getMembershipPDA(e),a=new oe;a.add(bi({channel:e,authority:i,authorityMembership:o}));let s;try{s=await this.provider.sendAndConfirm(a,void 0,n)}catch(u){throw(r=le(u.code))!=null?r:ve("Unauthorized")}return{signature:s}}async joinChannel(e){var s,r;const[n]=await this.getMembershipPDA(e.channel),i=this.provider.publicKey,o=new oe;o.add(Ei({channel:e.channel,key:this.keypair.publicKey,membership:n,authority:i},{data:{name:e.name,authority:(s=e.authority)!=null?s:null}}));let a;try{a=await this.provider.sendAndConfirm(o,[this.keypair],e.opts)}catch(u){throw(r=le(u.code))!=null?r:u}return{signature:a}}async leaveChannel(e){var s;const[n]=await this.getMembershipPDA(e.channel),i=this.provider.publicKey,o=new oe;o.add(Ii({channel:e.channel,membership:n,authority:i}));let a;try{a=await this.provider.sendAndConfirm(o)}catch(r){throw(s=le(r.code))!=null?s:r}return{signature:a}}async addMember(e){var _,C,x,g;const n=(_=e.key)!=null?_:e.invitee,[i]=await this.getMembershipPDA(e.channel),[o]=await this.getMembershipPDA(e.channel,n),a=await this.loadMembership(i);if(!a.cek.encryptedKey)throw ve("Unauthorized");const s=await this.decryptCEK(a.cek),r=await this.encryptCEK(s,n),u=new oe;u.add(ui({channel:e.channel,authority:this.provider.publicKey,invitee:e.invitee,authorityMembership:i,inviteeMembership:o},{data:{name:(C=e.name)!=null?C:"",flags:(x=e.flags)!=null?x:0,cek:r,key:n}}));let p;try{p=await this.provider.sendAndConfirm(u)}catch(w){throw(g=le(w.code))!=null?g:ve("Unauthorized")}return{signature:p}}async deleteMember(e){var r;const[n]=e.membership?[e.membership]:await this.getMembershipPDA(e.channel,e.key),[i]=await this.getMembershipPDA(e.channel),o=this.provider.publicKey,a=new oe;a.add(vi({channel:e.channel,membership:n,authority:o,authorityMembership:i}));let s;try{s=await this.provider.sendAndConfirm(a)}catch(u){throw(r=le(u.code))!=null?r:u}return{signature:s}}async authorizeMember(e){var p;const[n]=await this.getMembershipPDA(e.channel),[i]=await this.getMembershipPDA(e.channel,e.key),o=await this.loadMembership(n);if(!o.cek.encryptedKey)throw ve("Unauthorized");const a=await this.decryptCEK(o.cek),s=await this.encryptCEK(a,e.key),r=new oe;r.add(pi({channel:e.channel,membership:i,authority:this.provider.publicKey,authorityMembership:n},{data:{cek:s}}));let u;try{u=await this.provider.sendAndConfirm(r)}catch(_){throw(p=le(_.code))!=null?p:ve("Unauthorized")}return{signature:u}}async postMessage(e){var r;const[n]=await this.getMembershipPDA(e.channel);let i,o=0;if(e.encrypt){const u=await this.loadMembership(n);if(!u.cek.header)throw ve("Unauthorized");const p=await this.decryptCEK(u.cek);i=await this.encryptMessage(e.message,p),o|=1}else i=e.message;const a=new oe;a.add(Ti({channel:e.channel,membership:n,authority:this.provider.publicKey},{message:String.fromCharCode(o)+i}));let s;try{s=await this.provider.sendAndConfirm(a)}catch(u){throw(r=le(u.code))!=null?r:u}return{signature:s}}}const Mt=t=>"***** *** *** *** *******",j=Pe("messenger",()=>{const t=yt(),e=Nt(),n=Fe(),i=y(()=>e.keypair),o={allChannels:[],ownChannels:[],channel:void 0,channelAddr:void 0,channelMembershipAddr:void 0,channelMembership:void 0,channelMembers:[],channelMessages:[],channelLoading:!1,loading:!1,creating:!1,sending:!1},a=ie({...o}),s=y(()=>{var b;return new Hi(new wt(t.connection,(b=n.value)!=null?b:{publicKey:B.default},wt.defaultOptions()),e.keypair)});let r=[];re(n,b=>{b?_().then():C()},{immediate:!0}),re([i,()=>a.allChannels],()=>{u().then()},{immediate:!0});async function u(){var D;const P=(await s.value.loadMemberships((D=e.keypair)==null?void 0:D.publicKey)).map(J=>({pubkey:J.data[0].channel.toBase58(),status:J.data[0].status.__kind}));a.ownChannels=P,console.log("myChannels ====== ",a.ownChannels)}async function p(){console.log("Register events...");for(const b of r)await s.value.removeEventListener(b);r.push(s.value.addEventListener("NewMessageEvent",async b=>{if(console.log("[Event] NewMessageEvent",b),`${b.channel}`!=`${a.channelAddr}`)return;let P=b.message.content;if(s.value.utils.message.isEncrypted(b.message)){const J=await W();J?P=await s.value.decryptMessage(b.message.content,J):P=Mt(b.message.content)}a.channelMessages.push({...b.message,content:P})})),r.push(s.value.addEventListener("AuthorizeMemberEvent",async b=>{console.log("[Event] AuthorizeMemberEvent",b),!(a.channelAddr&&`${b.channel}`!=`${a.channelAddr}`)&&(`${b.membership}`==`${a.channelMembershipAddr}`?v(a.channelAddr).then():Q().then())})),r.push(s.value.addEventListener("JoinChannelEvent",async b=>{console.log("[Event] JoinChannelEvent",b),`${b.channel}`==`${a.channelAddr}`&&Q().then()})),r.push(s.value.addEventListener("LeaveChannelEvent",async b=>{console.log("[Event] LeaveChannelEvent",b),`${b.channel}`==`${a.channelAddr}`&&Q().then()}))}async function _(){C(),r=[],a.loading=!0;const b=await s.value.loadAllChannels();await p(),a.allChannels=b,a.loading=!1,console.log(a)}function C(){Object.assign(a,o)}async function x(b,P){var D,J;try{a.creating=!0,await s.value.initChannel({name:b,maxMessages:(D=P.maxMessages)!=null?D:15,public:P.public,permissionless:P.permissionless,opts:{commitment:(J=P.commitment)!=null?J:"confirmed"}}),await _()}finally{a.creating=!1}}async function g(b){const P=new B(b);await s.value.deleteChannel({channel:P,opts:{commitment:"confirmed"}}),await _()}async function w(b,P){const D=new B(b);await s.value.joinChannel({channel:D,name:P,opts:{commitment:"confirmed"}}),await v(b),await A()}async function v(b){var P;a.channelLoading=!0,a.channelMessages=[],a.channelMembers=[],a.channelMembershipAddr=void 0,a.channelMembership=void 0,a.channelAddr=new B(b);try{if((P=n.value)!=null&&P.publicKey)try{const[D]=await s.value.getMembershipPDA(a.channelAddr);a.channelMembershipAddr=D,a.channelMembership=await s.value.loadMembership(D)}catch(D){console.log(D),a.channelMembershipAddr=void 0,a.channelMembership=void 0}await Q(),await F()}catch(D){console.log("Error",D)}finally{a.channelLoading=!1}}async function W(){if(!!a.channelMembership)try{return await s.value.decryptCEK(a.channelMembership.cek)}catch(b){console.log(b)}}async function F(){if(!a.channelAddr){console.log("Invalid channel");return}a.channel=await s.value.loadChannel(a.channelAddr);const P=s.value.utils.channel.isPublic(a.channel)?null:await W();a.channelMessages=await Promise.all(a.channel.messages.map(async D=>{var ze;let Le=s.value.utils.message.isEncrypted(D)?Mt(D.content):D.content,Te=He(D.sender);if((ze=n.value)!=null&&ze.publicKey){const L=a.channelMembers.find(({data:Ne})=>Ne.name!==""&&(`${Ne.authority}`==`${D.sender}`||`${Ne.key}`==`${D.sender}`));L&&L.data.name!==""&&(Te=L.data.name)}if(P)try{Le=await s.value.decryptMessage(D.content,P)}catch{console.log(`Failed to decrypt message #${D.id}`)}return{...D,senderDisplayName:Te,content:Le}}))}async function Q(){if(!a.channelAddr){console.error("Invalid channel");return}a.channelMembers=await K()}async function K(b=a.channelAddr){return await s.value.loadChannelMembers(b)}async function $(b){if(!a.channelAddr){console.log("Please select a channel");return}try{a.sending=!0;let P;a.channel&&(P=s.value.utils.channel.isPublic(a.channel)),await s.value.postMessage({channel:a.channelAddr,message:b,encrypt:!P}),await F()}finally{a.sending=!1}}async function O(b,P,D,J){if(!a.channelAddr){console.log("Invalid channel");return}await s.value.addMember({channel:a.channelAddr,invitee:new B(b),key:P?new B(P):void 0,name:D,flags:J,opts:{commitment:"confirmed"}})}async function k(b){if(!a.channelAddr){console.log("Invalid channel");return}await s.value.deleteMember({channel:a.channelAddr,key:new B(b),opts:{commitment:"finalized"}}),await de()}async function z(b){if(!a.channelAddr){console.log("Invalid channel");return}await s.value.authorizeMember({channel:a.channelAddr,key:new B(b)}),await de()}async function A(){await _()}async function de(){a.channelMembers=await K()}async function st(b){a.channelAddr=b}return{state:a,client:s.value,loadChannel:v,joinChannel:w,createChannel:x,deleteChannel:g,postMessage:$,addMember:O,deleteMember:k,authorizeMember:z,refreshList:A,loadMembers:K,selectChannel:st}}),ye=Pe("channel",()=>{const t=Fe(),{state:e,client:n}=j(),i=y(()=>e.channelLoading),o=y(()=>e.sending),a=y(()=>{var k;return!!((k=t.value)!=null&&k.publicKey)}),s=y(()=>!!e.channel&&n.utils.channel.isPublic(e.channel)),r=y(()=>!!e.channel&&n.utils.channel.isPermissionless(e.channel)),u=y(()=>{var k;return((k=e.channelMembership)==null?void 0:k.status.__kind)==="Authorized"}),p=y(()=>{var k;return((k=e.channelMembership)==null?void 0:k.status.__kind)==="Pending"}),_=y(()=>{var k,z,A;return String((k=e.channel)==null?void 0:k.creator)===String((A=(z=t.value)==null?void 0:z.publicKey)!=null?A:"-")}),C=y(()=>!!e.channelMembership&&n.utils.member.canAddMember(e.channelMembership)),x=y(()=>!!e.channelMembership&&n.utils.member.canAuthorizeMember(e.channelMembership)),g=y(()=>!!e.channelMembership&&n.utils.member.canDeleteMember(e.channelMembership)),w=y(()=>!!e.channelMembership&&n.utils.member.isAdmin(e.channelMembership)),v=y(()=>!!e.channelMembership&&n.utils.member.isOwner(e.channelMembership)),W=y(()=>a.value&&!!e.channel&&!e.loading&&!u.value),F=y(()=>a.value),Q=y(()=>v.value),K=y(()=>v.value),$=y(()=>!e.sending&&(s.value||u.value));return{ownChannels:y(()=>e.allChannels.filter(k=>{var z;return!!e.ownChannels.find(A=>A.pubkey===k.pubkey.toBase58())||k.data.flags===1||k.data.creator.toBase58()===String((z=t.value)==null?void 0:z.publicKey)})),isChannelLoading:i,isSendMessage:o,isPublicChannel:s,isWalletConnected:a,isPermissionlessChannel:r,isAuthorizedMember:u,isPendingMember:p,isChannelCreator:_,isAdmin:w,isOwner:v,canJoinChannel:W,canAddMember:C,canAuthorizeMember:x,canDeleteMember:g,canCreateChannel:F,canDeleteChannel:Q,canGrantAccess:K,canPostMessage:$}}),Gi={class:"text-weight-medium"},Xi={class:"memberlist-info__details"},Zi=m("span",null,"Authority:",-1),Yi={class:"memberlist-info__details"},eo=m("span",null,"Key:",-1),to={class:"memberlist-btns"},no=N({__name:"MemberListDialog",props:{membersDialog:{type:Boolean,default:!1},authorizeMemberState:{type:Object},deleteMemberState:{type:Object},wallet:{type:Object}},emits:["submit","deleteMember"],setup(t,{emit:e}){const{state:n}=j(),i=ye(),o=s=>s==="Pending"&&i.canAuthorizeMember;function a(s){return String(s).toLowerCase()}return(s,r)=>(f(),M(se,{class:"memberlist"},{default:c(()=>[l(Y,{square:"",flat:"",horizontal:""},{default:c(()=>[l(R,{class:"q-px-lg"},{default:c(()=>[S(" MEMBERS ")]),_:1}),l(R,{class:"memberlist-card"},{default:c(()=>[l(pe,{separator:""},{default:c(()=>[(f(!0),E(U,null,ee(d(n).channelMembers,u=>(f(),M(Z,{key:u.pubkey.toString(),"active-class":"bg-teal-1",active:`${u.pubkey}`==`${d(n).channelMembershipAddr}`,class:"memberlist-item"},{default:c(()=>[l(H,{class:"memberlist-info"},{default:c(()=>[l(Ee,{class:"row justify-between"},{default:c(()=>[m("span",Gi,T(d(Lt)(u.data)),1),l(Sn,{class:Ke([a(u.data.status.__kind),"memberlist-status q-pa-xs"])},{default:c(()=>[S(T(u.data.status.__kind),1)]),_:2},1032,["class"])]),_:2},1024),l(Ee,{caption:"",lines:"2"},{default:c(()=>[m("div",Xi,[Zi,m("span",null,T(u.data.authority),1)]),m("div",Yi,[eo,m("span",null,T(u.data.key),1)])]),_:2},1024)]),_:2},1024),m("div",to,[o(u.data.status.__kind)?(f(),M(I,{key:0,color:"positive",size:"sm",unelevated:"",class:"full-width",loading:t.authorizeMemberState.loading,disabled:t.authorizeMemberState.loading,onClick:p=>s.$emit("submit",u.data.key)},{default:c(()=>[S(" Authorize ")]),_:2},1032,["loading","disabled","onClick"])):Me("",!0),d(i).canDeleteMember?(f(),M(I,{key:1,color:"negative",size:"sm",unelevated:"",class:"full-width",loading:t.deleteMemberState.loading,disabled:t.deleteMemberState.loading,onClick:p=>s.$emit("deleteMember",u.data.key)},{default:c(()=>[S(" Delete ")]),_:2},1032,["loading","disabled","onClick"])):Me("",!0)])]),_:2},1032,["active"]))),128))]),_:1})]),_:1})]),_:1})]),_:1}))}}),ao=m("br",null,null,-1),so=N({__name:"JoinChennalModal",emits:["join"],setup(t,{emit:e}){const n=V("");return(i,o)=>(f(),M(se,null,{default:c(()=>[l(Y,{square:"",flat:""},{default:c(()=>[l(R,{class:"text-body1"},{default:c(()=>[S(" Join Channel ")]),_:1}),l(R,{class:"text-body1 text-blue-grey-8"},{default:c(()=>[l(je,{class:"join-channel-form",onSubmit:o[1]||(o[1]=bt(a=>i.$emit("join",n.value),["prevent"]))},{default:c(()=>[l(ae,{modelValue:n.value,"onUpdate:modelValue":o[0]||(o[0]=a=>n.value=a),label:"Member name *","lazy-rules":"",rules:[a=>a&&a.length>2||"Please type something"]},null,8,["modelValue","rules"]),ao,l(I,{type:"submit",class:"dialog-submit-btn","text-color":"black",ripple:!1,square:""},{default:c(()=>[S(" Join Channel ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}});const io=N({props:{text:{type:String,default:""},padding:{type:String,default:"0"}}});const oo=["innerHTML"];function lo(t,e,n,i,o,a){return f(),M($t,{class:"bg-white text-primary shadow-1 custom-tooltip",style:{"border-radius":"0"},anchor:"top middle",self:"bottom middle"},{default:c(()=>[m("div",{style:Qe({fontSize:"11px",padding:`${t.padding}`}),innerHTML:t.text},null,12,oo)]),_:1})}const at=G(io,[["render",lo]]),ro=t=>(Oe("data-v-0a789a27"),t=t(),qe(),t),co=ro(()=>m("span",{class:"text-blue-grey-8 q-pb-xs"},"Search by name or address",-1)),uo={class:"search-block"},mo={class:"channel-info"},ho={class:"channel-info"},po={class:"control-btns"},fo=N({__name:"JoinChannelDialog",props:{loading:{type:Boolean},defaultState:Object},emits:["submit","reset"],setup(t,{emit:e}){const n=t;V(n.defaultState);const{state:i,selectChannel:o,refreshList:a}=j(),s=V(!1),r=V(""),u=V([]),p=y(()=>i.allChannels.filter(v=>v.data.flags===0||v.data.flags===2)),_=y(()=>i.loading),C=v=>v.name.slice(0,2),x=()=>{if(r.value===""){u.value=[],r.value="";return}u.value=p.value.filter(v=>v.data.name.toLocaleLowerCase().includes(r.value.toLocaleLowerCase())||v.pubkey.toBase58().toLocaleLowerCase().includes(r.value.toLocaleLowerCase()))},g=y(()=>{var v;return((v=r.value)==null?void 0:v.length)>0?u.value:p.value}),w=v=>{e("submit",v)};return re(r,()=>{x()}),re(()=>n.loading,v=>{v&&(s.value=!1)}),(v,W)=>{const F=at,Q=so;return f(),M(se,{class:"join-channel-dialog",onHide:W[3]||(W[3]=K=>v.$emit("reset"))},{default:c(()=>[l(Y,{square:"",flat:""},{default:c(()=>[l(R,{class:"text-body1 text-blue-grey-8"},{default:c(()=>[S(" Join channel ")]),_:1}),l(R,{class:"q-py-none"},{default:c(()=>[co,m("div",uo,[l(ae,{modelValue:r.value,"onUpdate:modelValue":W[0]||(W[0]=K=>r.value=K),class:"input no-margin q-pa-none",placeholder:"Search ...",borderless:"",dense:"",debounce:"300"},null,8,["modelValue"])])]),_:1}),l(R,null,{default:c(()=>[d(g).length?(f(),M(pe,{key:0,bordered:"",separator:"",class:"privat-channels"},{default:c(()=>[(f(!0),E(U,null,ee(d(g),K=>we((f(),M(Z,{key:K,"active-class":"bg-blue-grey-8 text-white",class:"privat-channels-item",active:`${d(i).channelAddr}`==`${K.pubkey}`,clickable:"",onClick:$=>d(o)(K.pubkey)},{default:c(()=>[m("div",{class:"chat-avatar",style:Qe(d(Tt)(`${K.pubkey}`))},[m("span",null,T(C(K.data)),1)],4),l(H,null,{default:c(()=>[m("span",mo,T(K.data.name),1),m("span",ho,T(K.pubkey),1)]),_:2},1024)]),_:2},1032,["active","onClick"])),[[xn]])),128))]),_:1})):(f(),M(Z,{key:1,class:"privat-channels justify-center items-center text-blue-grey-5"},{default:c(()=>[S(" Channels not found ")]),_:1}))]),_:1}),m("div",po,[l(I,{class:Ke(["control-button",{"refresh-btn":d(_)}]),square:"",flat:"",disable:!d(i).channelAddr,onClick:d(a)},{default:c(()=>[l(d(It),{style:{color:"#fff"}}),l(F,{text:"Request to join"})]),_:1},8,["disable","class","onClick"]),l(I,{class:"control-button",square:"",flat:"",disable:!d(i).channelAddr,onClick:W[1]||(W[1]=K=>s.value=!0)},{default:c(()=>[l(d($n),{style:{color:"#fff"}}),l(F,{text:"Request to join"})]),_:1},8,["disable"]),l(Q,{modelValue:s.value,"onUpdate:modelValue":W[2]||(W[2]=K=>s.value=K),onJoin:w},null,8,["modelValue"])]),l(Je,{showing:t.loading},null,8,["showing"])]),_:1})]),_:1})}}});const go=G(fo,[["__scopeId","data-v-0a789a27"]]),bo=t=>(Oe("data-v-bd4b9454"),t=t(),qe(),t),yo=bo(()=>m("br",null,null,-1)),_o=N({__name:"AddMemberDialog",props:{loading:{type:Boolean,default:!1},defaultState:Object},emits:["submit","reset"],setup(t,{emit:e}){const i=V(t.defaultState),o=()=>e("submit",i.value);return(a,s)=>(f(),M(se,{class:"add-member-dialog",onHide:s[3]||(s[3]=r=>a.$emit("reset"))},{default:c(()=>[l(Y,{square:"",flat:""},{default:c(()=>[l(R,null,{default:c(()=>[l(je,{class:"add-member-form",onSubmit:bt(o,["prevent"])},{default:c(()=>[l(ae,{modelValue:i.value.name,"onUpdate:modelValue":s[0]||(s[0]=r=>i.value.name=r),label:"Member name *",hint:"Min length 3 chars","lazy-rules":"",rules:[r=>r&&r.length>2||"Please type something"]},null,8,["modelValue","rules"]),l(ae,{modelValue:i.value.wallet,"onUpdate:modelValue":s[1]||(s[1]=r=>i.value.wallet=r),label:"Member Wallet *","lazy-rules":"",rules:[r=>r&&r.length>32||"Invalid public key"]},null,8,["modelValue","rules"]),l(ae,{modelValue:i.value.key,"onUpdate:modelValue":s[2]||(s[2]=r=>i.value.key=r),label:"Member Device Key",hint:"Default: The same as member wallet","lazy-rules":"",rules:[r=>!r||r.length>32||"Invalid public key"]},null,8,["modelValue","rules"]),yo,l(I,{type:"submit",class:"dialog-submit-btn","text-color":"white",ripple:!1,rounded:""},{default:c(()=>[S(" Add Member ")]),_:1})]),_:1},8,["onSubmit"]),l(Je,{showing:t.loading},null,8,["showing"])]),_:1})]),_:1})]),_:1}))}});const vo=G(_o,[["__scopeId","data-v-bd4b9454"]]),qt="/assets/info.bfade5eb.svg",wo={class:"row q-mt-md relative-position",style:{height:"42px"}},Co={class:"toggle-info"},Mo=m("img",{src:qt,alt:"info"},null,-1),Ao={key:0,class:"row text-primary toggle-approve"},ko={class:"toggle-info"},So=m("img",{src:qt,alt:"info"},null,-1),xo=N({__name:"NewChannelDialog",props:{loading:{type:Boolean,default:!1},defaultState:Object},emits:["submit","reset"],setup(t,{emit:e}){const i=V(t.defaultState),o=()=>e("submit",i);return(a,s)=>{const r=at;return f(),M(se,{class:"new-channel-dialog",onHide:s[4]||(s[4]=u=>a.$emit("reset"))},{default:c(()=>[l(Y,{square:"",flat:""},{default:c(()=>[l(R,null,{default:c(()=>[l(je,{class:"messenger-new-channel-form",onSubmit:o},{default:c(()=>[l(ae,{modelValue:i.value.name,"onUpdate:modelValue":s[0]||(s[0]=u=>i.value.name=u),label:"Channel name *","lazy-rules":"",maxlength:"32",rules:[u=>u&&u.length>2||"Please type something"]},null,8,["modelValue","rules"]),l(ae,{modelValue:i.value.maxMessages,"onUpdate:modelValue":s[1]||(s[1]=u=>i.value.maxMessages=u),label:"Max messages","lazy-rules":"",rules:[u=>+u>0||"Invalid value"]},null,8,["modelValue","rules"]),m("div",wo,[m("div",Co,[l(r,{text:d(Ct)[0],padding:"8px"},null,8,["text"]),Mo]),m("div",{class:Ke(["col text-primary",{"toggle-border":!i.value.public}])},[S(" Private"),l(ct,{modelValue:i.value.public,"onUpdate:modelValue":s[2]||(s[2]=u=>i.value.public=u),label:"Public"},null,8,["modelValue"])],2),i.value.public?Me("",!0):(f(),E("div",Ao,[l(ct,{modelValue:i.value.permissionless,"onUpdate:modelValue":s[3]||(s[3]=u=>i.value.permissionless=u)},null,8,["modelValue"]),m("span",null,[m("div",ko,[l(r,{text:d(Ct)[1],padding:"8px"},null,8,["text"]),So]),S(" Members can approve")])]))]),l(I,{type:"submit",class:"dialog-submit-btn q-mt-md","text-color":"black",ripple:!1,square:"",flat:""},{default:c(()=>[S(" Create the Channel ")]),_:1})]),_:1}),l(Je,{showing:t.loading},null,8,["showing"])]),_:1})]),_:1})]),_:1})}}});const $o=N({__name:"ChannelForm",props:{message:{type:String,default:""},disabled:{type:Boolean,default:!1},sending:{type:Boolean,default:!1}},emits:["submit"],setup(t,{emit:e}){const i=V(t.message),o=()=>{e("submit",i),i.value=""};return(a,s)=>(f(),M(je,{class:"channel-form",onSubmit:bt(o,["prevent"])},{default:c(()=>[l(St,{class:"row message-control"},{default:c(()=>[l(ae,{ref:"inputFocus",modelValue:i.value,"onUpdate:modelValue":s[0]||(s[0]=r=>i.value=r),class:"col-grow message-input","bg-color":"white",placeholder:"Type a message",dense:"",borderless:"",autofocus:"",disable:t.disabled},null,8,["modelValue","disable"]),l(I,{class:"send-btn",square:"",flat:"",type:"submit",disable:t.disabled,loading:t.sending},{default:c(()=>[S(" Send ")]),_:1},8,["disable","loading"])]),_:1})]),_:1},8,["onSubmit"]))}});const Eo=G($o,[["__scopeId","data-v-23f62c62"]]),Do={},Po={class:"column q-ma-md"},Io={class:"column items-end q-ma-md"};function Ko(t,e){return f(),E(U,null,[m("div",Po,[l(xe,{class:"q-my-xs",width:"250px",height:"47px"}),l(xe,{class:"q-my-xs",width:"250px",height:"47px"})]),m("div",Io,[l(xe,{class:"q-my-xs",width:"250px",height:"47px"}),l(xe,{class:"q-my-xs",width:"250px",height:"47px"}),l(xe,{class:"q-my-xs",width:"250px",height:"47px"})])],64)}const Lo=G(Do,[["render",Ko]]),To={key:1,class:"row justify-center channel-wrapper"},zo={key:1,class:"messenger-empty"},No={key:2,class:"messenger-empty"},Bo=N({__name:"ChannelWrapper",props:{postMessageState:{type:Object}},emits:["sendMessage"],setup(t,{emit:e}){const n=fe(),{state:i}=j(),o=ye();function a(C){const x=n.publicKey.value;return x?String(x)!==String(C):!0}const s=y(()=>{const C=[];let x=0,g;for(const w of i.channelMessages)g&&`${w.sender}`==`${g}`?C[x-1].text.push(w.content):(g=w.sender,C.push({id:w.id,sender:w.sender,senderDisplayName:w.senderDisplayName,text:[w.content],date:w.createdAt}),x++);return C}),r=y(()=>o.canPostMessage),u=C=>e("sendMessage",C),p=V(),_=V();return re(_,C=>{C&&(p.value.scrollTop=C.scrollHeight)}),(C,x)=>{const g=Lo,w=Eo;return f(),M(Y,{class:"messenger-card",square:"",flat:""},{default:c(()=>[m("div",{ref_key:"chat",ref:p,class:"messenger-content"},[d(o).isChannelLoading?(f(),M(g,{key:0})):d(i).channel?(f(),E("div",To,[d(s).length>0?(f(),E("div",{key:0,ref_key:"mes",ref:_,class:"messenger-messages"},[(f(!0),E(U,null,ee(d(s),v=>(f(),M(En,{key:v.id,name:v.senderDisplayName,text:v.text,sent:a(v.sender)},null,8,["name","text","sent"]))),128))],512)):(f(),E("div",zo," No messages "))])):(f(),E("div",No," Please connect a wallet "))],512),l(w,{message:t.postMessageState.message,sending:d(o).isSendMessage,disabled:!d(r),onSubmit:u},null,8,["message","sending","disabled"])]),_:1})}}});const Wo=G(Bo,[["__scopeId","data-v-7bffac36"]]),Ro=15;function Vo(){const{createChannel:t}=j(),{isWalletConnected:e,ok:n,error:i}=_e(),o=ie({dialog:!1,name:"",maxMessages:Ro,public:!1,permissionless:!1,loading:!1});async function a(){if(e())try{await t(o.name,{maxMessages:o.maxMessages,public:o.public,permissionless:o.permissionless}),s(),n("Channel was created!")}catch(r){i("Something went wrong"),console.log(r)}}function s(){o.dialog=!1,o.public=!1,o.loading=!1,o.name="",o.maxMessages=15}return{state:o,submit:a,reset:s}}function Oo(){const t=j(),{info:e,ok:n,error:i}=_e(),o=ie({loading:!1});async function a(){if(!t.state.channelAddr){e("Please select a channel");return}try{o.loading=!0,await t.deleteChannel(t.state.channelAddr),n("Channel was deleted!")}catch(s){console.log("Error",s),i("Something went wrong")}finally{o.loading=!1}}return{state:o,submit:a}}function Ft(){const{authorizeMember:t}=j(),{ok:e,error:n}=_e(),i=ie({loading:!1,dialog:!1});async function o(a){try{i.loading=!0,await t(a),e("Member was authorized")}catch(s){n("Something went wrong"),console.log(s)}finally{i.loading=!1}}return{state:i,submit:o}}function qo(){const{state:t,addMember:e}=j(),{ok:n,info:i,error:o}=_e(),a=ie({dialog:!1,loading:!1});async function s(u){if(a.loading=!0,!t.channelAddr){i("Please select a channel");return}try{return await e(u.wallet,u.key,u.name),n("Member was added"),!0}catch(p){o("Something went wrong"),console.log(p)}finally{a.loading=!1,a.dialog=!1}return!1}function r(){a.loading=!1,a.dialog=!1}return{state:a,submit:s,reset:r}}function Ut(){const{deleteMember:t}=j(),{ok:e,error:n}=_e(),i=ie({loading:!1});async function o(a){try{i.loading=!0,await t(a),e("Member was deleted")}catch(s){n("Something went wrong"),console.log(s)}finally{i.loading=!1}}return{state:i,submit:o}}function Fo(){const{state:t,joinChannel:e}=j(),{ok:n,info:i,error:o}=_e(),a=ie({dialog:!1,loading:!1,name:""});async function s(){if(!t.channelAddr){i("Please select a channel");return}a.loading=!0;try{await e(t.channelAddr,a.name),r(),n("Request was sent")}catch(u){console.log("Error",u),o("Something went wrong")}finally{a.loading=!1}}function r(){a.loading=!1,a.dialog=!1,a.name=""}return{state:a,submit:s,reset:r}}function _e(){const t=fe(),{notify:e}=De(),n=s=>e({type:"positive",message:s,timeout:2e3}),i=s=>e({type:"info",message:s,timeout:2e3}),o=s=>e({type:"negative",message:s,timeout:2e3});function a(){return t.publicKey.value?!0:(i("Please connect wallet"),!1)}return{ok:n,info:i,error:o,isWalletConnected:a}}const Uo=N({__name:"ChannelControl",props:{isLoading:{type:Boolean}},emits:["createChannel","joinChannel","refreshList"],setup(t,{emit:e}){const n=ye();_e();const{notify:i}=De();y(()=>n.isPendingMember),y(()=>n.canCreateChannel);const o=a=>{if(!n.isWalletConnected){i({message:"Please connect wallet",color:"negative",position:"top"});return}e(a)};return(a,s)=>{const r=at;return f(),M(Z,null,{default:c(()=>[l(H,{class:"button-wrapper"},{default:c(()=>[l(I,{class:Ke(["control-button",{"refresh-btn":t.isLoading}]),square:"",flat:"",onClick:s[0]||(s[0]=u=>o("refreshList"))},{default:c(()=>[l(d(It),{style:{color:"#fff"}}),l(r,{text:"Refresh channels"})]),_:1},8,["class"]),l(I,{class:"control-button",square:"",flat:"",onClick:s[1]||(s[1]=u=>o("createChannel"))},{default:c(()=>[l(d(Dn),{style:{color:"#fff"}}),l(r,{text:"Create a channel"})]),_:1}),l(I,{class:"control-button",square:"",flat:"",onClick:s[2]||(s[2]=u=>o("joinChannel"))},{default:c(()=>[l(d(Pn),{style:{color:"#fff"}}),l(r,{text:"Browse channels"})]),_:1})]),_:1})]),_:1})}}});const jo=G(Uo,[["__scopeId","data-v-4a18927d"]]),Qo={class:"chat-name"},Jo={key:0,class:"message-public"},Ho=N({__name:"MessengerChannel",props:{pubkey:{type:Object,required:!0},channel:{type:Object,required:!0},isActive:Boolean},emits:["select"],setup(t){const e=t,n=y(()=>e.channel.name.slice(0,2)),i=y(()=>e.channel.flags===1);return(o,a)=>{const s=at;return f(),M(Z,{"active-class":"bg-blue-grey-8 text-white",style:{"min-height":"42px"},active:t.isActive},{default:c(()=>[l(H,{class:"chat-item cursor-pointer",onClick:a[0]||(a[0]=r=>o.$emit("select"))},{default:c(()=>[m("div",{class:"chat-badge",style:Qe(d(Tt)(`${t.pubkey}`))},[m("span",null,T(d(n)),1)],4),m("div",Qo,T(t.channel.name),1),d(i)?(f(),E("div",Jo,[l(s,{text:"Public channel"}),S(" P ")])):Me("",!0)]),_:1})]),_:1},8,["active"])}}});const Go=G(Ho,[["__scopeId","data-v-9c7d821f"]]),Xo=m("div",{class:"text-h5"}," Channels ",-1),Zo={class:"text-weight-medium"},Yo={class:"memberlist-info__details"},el=m("span",null,"Authority:",-1),tl={class:"memberlist-info__details"},nl=m("span",null,"Key:",-1),al=N({__name:"PendingUsersDialog",props:{pendingChannels:Object},setup(t){V(!1);const{state:e,refreshList:n}=j(),i=Ft(),o=Ut(),a=async(p,_)=>{e.channelAddr=_,await i.submit(p),await n()},s=async(p,_)=>{e.channelAddr=_,await o.submit(p),await n()},r=y(()=>i.state.loading),u=y(()=>o.state.loading);return(p,_)=>(f(),M(se,null,{default:c(()=>[l(Y,{class:"pending-channels",square:"",flat:"",horizontal:""},{default:c(()=>[l(R,null,{default:c(()=>[Xo]),_:1}),l(R,null,{default:c(()=>[l(pe,{bordered:""},{default:c(()=>[(f(!0),E(U,null,ee(t.pendingChannels,(C,x)=>(f(),M(In,{key:C.name,"expand-separator":"",label:C.channel.data.name,caption:"channel","default-opened":x===0,"header-class":"bg-blue-grey-1"},{default:c(()=>[l(pe,{separator:""},{default:c(()=>[(f(!0),E(U,null,ee(C.pendingMembers,g=>(f(),M(Z,{key:g,class:"row justify-between pending-item"},{default:c(()=>[l(H,{class:"memberlist-info"},{default:c(()=>[l(Ee,{class:"row justify-between"},{default:c(()=>[m("span",Zo,T(d(Lt)(g.data)),1)]),_:2},1024),l(Ee,{caption:"",lines:"2"},{default:c(()=>[m("div",Yo,[el,m("span",null,T(g.data.authority),1)]),m("div",tl,[nl,m("span",null,T(g.data.key),1)])]),_:2},1024)]),_:2},1024),l(H,{side:"",class:"memberlist-btns"},{default:c(()=>[l(I,{color:"teal",size:"xs",unelevated:"",class:"full-width",loading:d(r),disabled:d(r),onClick:w=>a(g.data.key,C.channel.pubkey)},{default:c(()=>[S(" Authorize ")]),_:2},1032,["loading","disabled","onClick"]),l(I,{color:"negative",size:"xs",unelevated:"",class:"full-width",loading:d(u),disabled:d(u),onClick:w=>s(g.data.key,C.channel.pubkey)},{default:c(()=>[S(" Delete ")]),_:2},1032,["loading","disabled","onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1032,["label","default-opened"]))),128))]),_:1})]),_:1})]),_:1})]),_:1}))}});const sl={class:"bell",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",fill:"none","xmlns:v":"https://vecta.io/nano"},il=["fill"],ol=N({__name:"iconBell",props:{color:{type:String,default:"AABEC8"}},setup(t){return(e,n)=>(f(),E("svg",sl,[m("path",{d:"M5.352 14.359h3.294c0 .821-.59 1.641-1.647 1.641s-1.647-.82-1.647-1.641zm8.434-3.467l-.911-1.515a3.68 3.68 0 0 1-.527-1.897V5.325C12.348 2.389 9.949 0 7 0S1.651 2.389 1.651 5.325v2.155a3.68 3.68 0 0 1-.527 1.897l-.911 1.515c-.278.461-.285 1.018-.018 1.487s.749.749 1.29.749h11.03a1.47 1.47 0 0 0 1.291-.749 1.46 1.46 0 0 0-.021-1.487z",fill:`#${t.color}`},null,8,il)]))}}),jt=Pe("notifications",()=>{const t=Fe(),{loadMembers:e}=j(),n=ye(),i=ie({showInfo:!1,showDialog:!1,pendingChannels:[]});re(()=>n.ownChannels,async(a,s)=>{s.length>0&&await o(s)});async function o(a){try{const s=await Promise.all(a.map(async r=>{var _;const{pubkey:u,data:p}=r;if(p.creator.toBase58()===((_=t.value)==null?void 0:_.publicKey.toBase58())){const C=await e(u);if(C.length===0)return;const x=C.filter(g=>g.data.status.__kind==="Pending");return x.length?{channel:r,pendingMembers:x}:void 0}}));i.pendingChannels=s.filter(r=>r),i.pendingChannels.length>0?(setTimeout(()=>i.showInfo=!0,2e3),setTimeout(()=>i.showInfo=!1,7e3)):i.showDialog=!1}catch(s){console.log(s)}}return{state:i}});function ll(){const{state:t}=jt();return{showDialog:y(()=>t.showDialog),showInfo:y(()=>t.showInfo),pendingChannels:y(()=>t.pendingChannels)}}const rl={class:"panel-notifications__info"},cl=N({__name:"MessengerNotification",setup(t){const{pendingChannels:e,showInfo:n,showDialog:i}=ll(),{state:o}=jt(),a=y(()=>{var p,_;return(_=(p=e.value)==null?void 0:p.length)!=null?_:0}),s=y(()=>a.value>0),r=y(()=>n.value?"width: 100%; padding-right: 14px":"width: 0; padding-right: 0;"),u=()=>{!s.value||(o.showDialog=!o.showDialog)};return(p,_)=>{const C=ol,x=al;return f(),E("div",{class:Ke(["panel-notifications",{"has-notifications":d(s)}]),onClick:u},[m("div",rl,[l(C,{class:"ring",color:d(s)?"FF5C5C":"AABEC8"},null,8,["color"]),m("span",null,T(a.value),1)]),m("div",{ref:"notificationsInfo",class:"panel-notifications__details",style:Qe(d(r))}," channels are awaiting user confirmation ",4),l(x,{modelValue:d(o).showDialog,"onUpdate:modelValue":_[0]||(_[0]=g=>d(o).showDialog=g),"pending-channels":d(e),onCloseDialog:_[1]||(_[1]=g=>p.isShow.value=!1)},null,8,["modelValue","pending-channels"])],2)}}});const ul={class:"panel-toolbar"},dl={class:"panel-search"},ml={class:"search-wrapper"},hl={class:"panel-info"},pl={class:"chat-info"},fl={class:"chat-members"},gl={class:"chat-messages"},bl={class:"chat-name"},yl=N({__name:"MessengerToolbar",emits:["search","showMembers","deleteChannel","addMember","showDeviceKey"],setup(t,{emit:e}){const n=fe(),{state:i}=j(),o=ye(),a=y(()=>!!n.publicKey.value),s=V(""),r=y(()=>i.channel),u=y(()=>{var g,w,v;return((g=r.value)==null?void 0:g.memberCount)===null||((w=r.value)==null?void 0:w.memberCount)===void 0?"":`${(v=r.value)==null?void 0:v.memberCount}\xA0members`}),p=y(()=>{var g,w,v;return((g=r.value)==null?void 0:g.messageCount)===null||((w=r.value)==null?void 0:w.messageCount)===void 0?"":`${(v=r.value)==null?void 0:v.messageCount}\xA0messages`}),_=g=>e("search",g),C=()=>e("showMembers"),x=()=>e("addMember");return re(s,g=>{_(String(g))}),(g,w)=>{var W;const v=cl;return f(),E("div",ul,[l(v),m("div",dl,[m("div",ml,[l(ae,{modelValue:s.value,"onUpdate:modelValue":w[0]||(w[0]=F=>s.value=F),class:"search-input no-margin q-pa-none",placeholder:"Search ...",clearable:"",debounce:"300",borderless:"",onClear:w[1]||(w[1]=F=>s.value="")},null,8,["modelValue"])])]),m("div",hl,[m("div",pl,[m("div",fl,T(d(u)),1),m("div",gl,T(d(p)),1)]),l(gt,{class:""}),m("div",bl,T((W=d(r))==null?void 0:W.name),1),m("div",null,[l(I,{class:"chat-menu",flat:"",square:"",disable:!d(a)},{default:c(()=>[l(d(Kn),{size:"18"}),l(Ln,{anchor:"bottom middle",self:"top middle"},{default:c(()=>[l(pe,{style:{"min-width":"150px"},bordered:""},{default:c(()=>[we((f(),M(Z,{clickable:"",onClick:w[2]||(w[2]=F=>g.$emit("showDeviceKey"))},{default:c(()=>[l(H,null,{default:c(()=>[l(I,{flat:"",square:"",class:"bg-blue-grey-7 text-white"},{default:c(()=>[S(" Device key ")]),_:1})]),_:1})]),_:1})),[[$e]]),we((f(),M(Z,{clickable:"",disable:!d(r),onClick:C},{default:c(()=>[l(H,null,{default:c(()=>[l(I,{flat:"",square:"",class:"bg-cyan-9 text-white"},{default:c(()=>[S(" Members ")]),_:1})]),_:1})]),_:1},8,["disable"])),[[$e]]),we((f(),M(Z,{clickable:"",disable:!d(o).canAddMember,onClick:x},{default:c(()=>[l(H,null,{default:c(()=>[l(I,{flat:"",square:"",class:"bg-amber-7 text-white"},{default:c(()=>[S(" Add member ")]),_:1})]),_:1})]),_:1},8,["disable"])),[[$e]]),we((f(),M(Z,{clickable:"",disable:!d(o).isChannelCreator,onClick:w[3]||(w[3]=F=>g.$emit("deleteChannel"))},{default:c(()=>[l(H,null,{default:c(()=>[l(I,{flat:"",square:"",class:"bg-negative text-white"},{default:c(()=>[S(" Delete ")]),_:1})]),_:1})]),_:1},8,["disable"])),[[$e]])]),_:1})]),_:1})]),_:1},8,["disable"])])])])}}});const _l={class:"col col-4"},vl={class:"col"},wl={class:"no-margin"},Cl=N({__name:"DebugBtn",setup(t){const{state:e}=j(),{isAuthorizedMember:n,isPendingMember:i,isChannelCreator:o}=ye(),a=V(!1),s=Tn(a);return(r,u)=>(f(),E(U,null,[l(I,{flat:"",class:"text-blue-2",onClick:u[0]||(u[0]=p=>d(s)())},{default:c(()=>[S(" Debug info ")]),_:1}),l(se,{modelValue:a.value,"onUpdate:modelValue":u[1]||(u[1]=p=>a.value=p)},{default:c(()=>[l(Y,null,{default:c(()=>[l(R,null,{default:c(()=>[(f(!0),E(U,null,ee([["Authorized",d(n)],["Pending Access",d(i)],["Channel Creator",d(o)],["Channel",d(e).channel],["Membership",d(e).channelMembership],["Members",d(e).channelMembers]],p=>(f(),E("div",{key:p[0],class:"row q-mt-md"},[m("div",_l,T(p[0]),1),m("div",vl,[m("pre",wl,T(p[1]),1)])]))),128))]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}}),Ml={class:"messenger-wrapper"},Al={class:"messenger-main"},kl={key:1,class:"messenger-channels-empty"},Sl={key:0,class:"q-my-md q-px-lg"},xl=N({__name:"Messenger",setup(t){const e=fe(),{state:n,postMessage:i,loadChannel:o,refreshList:a}=j(),s=ye(),r=Vo(),u=Fo(),p=qo(),_=Ft(),C=Ut(),x=Oo(),g=ie({message:""});y(()=>n.allChannels);const w=V([]),v=V("");async function W(z){await i(z.value),g.message=""}const F=z=>{if(z===""){w.value=[],v.value="";return}w.value=s.ownChannels.filter(A=>A.data.name.toLocaleLowerCase().includes(z.toLocaleLowerCase())||A.pubkey.toBase58().toLocaleLowerCase().includes(z.toLocaleLowerCase())),v.value=z},Q=y(()=>n.loading),K=V(!1),$=y(()=>w.value.length>0||v.value.length>0?w.value:s.ownChannels),O=z=>p.submit(z),k=z=>{u.state.name=z,u.submit()};return(z,A)=>{const de=yl,st=Go,b=jo,P=Wo,D=xo,J=vo,Le=go,Te=no,ze=Hs;return f(),E(U,null,[m("div",Ml,[l(de,{onSearch:F,onShowMembers:A[0]||(A[0]=L=>d(_).state.dialog=!0),onDeleteChannel:A[1]||(A[1]=L=>d(x).submit(d(n).channelAddr)),onAddMember:A[2]||(A[2]=L=>d(p).state.dialog=!0),onShowDeviceKey:A[3]||(A[3]=L=>K.value=!0)}),m("div",Al,[l(Y,{class:"messenger-channels",square:"",flat:""},{default:c(()=>[d($).length>0?(f(),M(pe,{key:0,separator:"",class:"channels-list"},{default:c(()=>[(f(!0),E(U,null,ee(d($),L=>(f(),M(st,{key:L.name,pubkey:L.pubkey,channel:L.data,"is-active":`${d(n).channelAddr}`==`${L.pubkey}`,onSelect:Ne=>d(o)(L.pubkey)},null,8,["pubkey","channel","is-active","onSelect"]))),128))]),_:1})):(f(),E("div",kl," No channels ")),l(b,{"is-joining":d(u).state.loading,"is-loading":d(Q),onCreateChannel:A[4]||(A[4]=L=>d(r).state.dialog=!0),onJoinChannel:A[5]||(A[5]=L=>d(u).state.dialog=!0),onRefreshList:d(a)},null,8,["is-joining","is-loading","onRefreshList"])]),_:1}),l(P,{"post-message-state":g,onSendMessage:W},null,8,["post-message-state"]),l(Je,{showing:d(n).loading,color:"primary"},null,8,["showing"])])]),l(D,{modelValue:d(r).state.dialog,"onUpdate:modelValue":A[6]||(A[6]=L=>d(r).state.dialog=L),loading:d(r).state.loading,"default-state":d(r).state,onSubmit:d(r).submit,onReset:d(r).reset},null,8,["modelValue","loading","default-state","onSubmit","onReset"]),l(J,{modelValue:d(p).state.dialog,"onUpdate:modelValue":A[7]||(A[7]=L=>d(p).state.dialog=L),loading:d(p).state.loading,"default-state":d(p).state,onSubmit:O,onReset:d(p).reset},null,8,["modelValue","loading","default-state","onReset"]),l(Le,{modelValue:d(u).state.dialog,"onUpdate:modelValue":A[8]||(A[8]=L=>d(u).state.dialog=L),loading:d(u).state.loading,"default-state":d(u).state,onSubmit:k,onReset:d(u).reset},null,8,["modelValue","loading","default-state","onReset"]),l(Te,{modelValue:d(_).state.dialog,"onUpdate:modelValue":A[9]||(A[9]=L=>d(_).state.dialog=L),wallet:d(e),"authorize-member-state":d(_).state,"delete-member-state":d(C).state,onSubmit:d(_).submit,onDeleteMember:d(C).submit},null,8,["modelValue","wallet","authorize-member-state","delete-member-state","onSubmit","onDeleteMember"]),l(ze,{modelValue:K.value,"onUpdate:modelValue":A[10]||(A[10]=L=>K.value=L)},null,8,["modelValue"]),d(n).channel?(f(),E("div",Sl,[l(Cl)])):Me("",!0)],64)}}});const $l={},El={class:"container"},Dl={class:"messenger-container"},Pl={class:"container"};function Il(t,e){const n=xl,i=Fs;return f(),M(zn,{class:"page-wrapper"},{default:c(()=>[m("div",El,[m("div",Dl,[l(n)])]),m("div",Pl,[l(i)])]),_:1})}const Kl=G($l,[["render",Il],["__scopeId","data-v-d4ef5e8f"]]),Ll=()=>xt(()=>import("./_...all_.7957b805.js"),["assets/_...all_.7957b805.js","assets/vendor.ccfc6256.js","assets/_...all_.73169310.css"]),Tl=[{name:"index",path:"/",component:Kl,props:!0},{name:"all",path:"/:all(.*)*",component:Ll,props:!0,meta:{layout:"empty"}}],zl=Ps(Tl),Nl="/",Bl=Nn({history:Bn(Nl),scrollBehavior:()=>({left:0,top:0}),strict:!0,routes:zl}),Wl=({app:t})=>{t.use(Bl)},Rl=Object.freeze(Object.defineProperty({__proto__:null,install:Wl},Symbol.toStringTag,{value:"Module"})),Vl=({app:t})=>{t.use(Wn,{wallets:[new Rn,new Vn,new On,new qn,new Fn,new Un,new jn,new Qn,new Jn,new Hn,new Gn,new Xn,new Zn,new Yn,new ea,new ta,new na,new aa,new sa,new ia,new oa,new la,new ra,new ca,new ua,new da,new ma,new ha,new pa,new fa],autoConnect:!1})},Ol=Object.freeze(Object.defineProperty({__proto__:null,install:Vl},Symbol.toStringTag,{value:"Module"})),ql=ga();function Fl(){return ql}const Ul=Symbol("WALLET_CONNECT_EVENT"),jl=Symbol("WALLET_DISCONNECT_EVENT"),Ql=Symbol("ACCOUNT_CHANGE_EVENT"),rt=5e3;function Jl(){const{connection:t}=yt(),{emit:e}=Fl(),{notify:n}=De(),{wallet:i}=fe();re(i,o=>{if(!o)return;const a=()=>{const u=o.adapter.publicKey;t.onAccountChange(u,p=>{e(Ql,p)}),t.onLogs(u,p=>{console.log(p)}),n({message:"Wallet update",caption:`Connected to wallet ${He(u.toBase58(),7)}`,timeout:rt}),e(Ul,o)},s=()=>{n({message:"Wallet update",caption:"Disconnected from wallet",timeout:rt}),e(jl,o)},r=u=>{!(u!=null&&u.message)||n({type:"negative",message:"Wallet update",caption:u.message,timeout:rt})};o.adapter.once("connect",a),o.adapter.once("disconnect",s),o.adapter.removeAllListeners("error"),o.adapter.on("error",r)},{immediate:!0})}const Hl=N({__name:"App",setup(t){return ba(()=>{Jl()}),(e,n)=>{const i=ft("router-view");return f(),M(i)}}});async function Gl(){const t=ya(Hl);Object.values(Object.assign({"./plugins/pinia.ts":va,"./plugins/quasar.ts":Ca,"./plugins/router.ts":Rl,"./plugins/wallet.ts":Ol})).forEach(e=>{var n;return(n=e.install)==null?void 0:n.call(e,{app:t})}),t.mount("#app")}Gl().then();export{G as _};
