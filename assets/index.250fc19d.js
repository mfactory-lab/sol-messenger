var kt=Object.defineProperty;var vt=(n,e,t)=>e in n?kt(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var B=(n,e,t)=>(vt(n,typeof e!="symbol"?e+"":e,t),t);import{c as Ct,Q as St,P as Mt,N as xt,a as Et,i as Pt,b as S,d as _e,u as Le,e as we,f as F,r as tt,g as Ae,o as p,h as P,j as b,k as C,w as i,l as v,t as I,m as Ge,n as W,p as o,q as V,s as pe,v as _,x as H,y as Dt,z as ne,A as L,B as It,C as ye,F as O,D as Wt,W as je,E as nt,G as at,H as Bt,I as st,J as Kt,K as Nt,L as ce,M as q,O as R,R as fe,S as rt,T as qe,U as ot,V as zt,X as Tt,Y as Rt,_ as it,Z as c,$ as T,a0 as lt,a1 as Z,a2 as Y,a3 as ue,a4 as ct,a5 as se,a6 as Lt,a7 as ke,a8 as ut,a9 as Ke,aa as Ft,ab as $t,ac as ae,ad as He,ae as G,af as Vt,ag as Ot,ah as Xe,ai as ge,aj as Je,ak as dt,al as Ze,am as Ye,an as de,ao as Ut,ap as Qt,aq as De,ar as Ie,as as le,at as Gt,au as jt,av as qt,aw as Ht,ax as Xt,ay as Jt,az as Zt,aA as Yt,aB as en,aC as tn,aD as nn,aE as an,aF as sn,aG as rn,aH as on,aI as ln,aJ as cn,aK as un,aL as dn,aM as mn,aN as hn,aO as pn,aP as yn,aQ as fn,aR as gn,aS as bn,aT as _n,aU as wn,aV as An,aW as kn,aX as vn,aY as Cn,aZ as Sn,a_ as Mn,a$ as xn,b0 as En,b1 as Pn,b2 as Dn}from"./vendor.c5367e08.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const r of a)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function t(a){const r={};return a.integrity&&(r.integrity=a.integrity),a.referrerpolicy&&(r.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?r.credentials="include":a.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(a){if(a.ep)return;a.ep=!0;const r=t(a);fetch(a.href,r)}})();const In=({app:n})=>{const e=Ct();n.use(e)},Wn=Object.freeze(Object.defineProperty({__proto__:null,install:In},Symbol.toStringTag,{value:"Module"})),Bn=({app:n})=>{n.use(St,{plugins:{Dark:Mt,Notify:xt,LocalStorage:Et},iconSet:Pt})},Kn=Object.freeze(Object.defineProperty({__proto__:null,install:Bn},Symbol.toStringTag,{value:"Module"}));function Fe(n,e=4){return n instanceof S&&(n=n.toBase58()),`${n.slice(0,e)}...${n.slice(-e)}`}const Nn="/assets/ledger.40cf6861.svg",zn="/assets/mathwallet.1d763e81.svg",mt=n=>(nt("data-v-8e6634b7"),n=n(),at(),n),Tn=mt(()=>_("div",{class:"text-h6 text-center"}," Your wallet ",-1)),Rn={class:"q-gutter-md row justify-between"},Ln=mt(()=>_("div",{class:"text-h6"}," Connect to a wallet ",-1)),Fn={class:"text-light-gray text-caption full-width text-no-wrap",style:{"text-overflow":"ellipsis",overflow:"hidden"}},$n=["src"],Vn=_e({__name:"ConnectWallet",setup(n){const e={solflare:10,phantom:20,sollet:5,nufi:5,blocto:1},t={ledger:Nn,mathwallet:zn},s={close:Wt},a=d=>[je.Installed,je.Loadable].includes(d.readyState);Le();const r=we(),{connected:l,connecting:m}=r,f=F(()=>{var d,h;return(h=(d=r.publicKey.value)==null?void 0:d.toBase58())!=null?h:""}),y=F(()=>Fe(f.value)),M=F(()=>[...r.wallets.value].map(d=>(d.darkIcon=t[d.name.toLowerCase()],d)).sort((d,h)=>{var D,$;const w=(D=e[d.name.toLowerCase()])!=null?D:1;return(($=e[h.name.toLowerCase()])!=null?$:1)-w+((a(h)?1:0)-(a(d)?1:0))})),g=tt(!1);async function A(d){await r.select(d.name),g.value=!1,await r.connect()}function E(){g.value=!1,r.disconnect()}function U(){g.value=!0}function Q(){g.value=!1}return(d,h)=>{const w=Ae("copy-to-clipboard");return p(),P(O,null,[b(l)?(p(),C(W,Ge({key:0},d.$attrs,{class:d.$style.btn,ripple:!1,color:"primary-gray","text-color":"white",rounded:"",unelevated:"",onClick:U}),{default:i(()=>[v(I(b(y)),1)]),_:1},16,["class"])):(p(),C(W,Ge({key:1},d.$attrs,{color:"primary-gray","text-color":"white",rounded:"",unelevated:"",ripple:!1,loading:b(m),onClick:U}),{default:i(()=>[v(" CONNECT WALLET ")]),_:1},16,["loading"])),o(ye,{modelValue:g.value,"onUpdate:modelValue":h[0]||(h[0]=x=>g.value=x),"transition-duration":"100","transition-show":"fade","transition-hide":"fade"},{default:i(()=>[b(l)?(p(),C(H,{key:0},{default:i(()=>[o(V,{class:"relative-position"},{default:i(()=>[Tn,o(W,{padding:"md",color:"transparent","text-color":"primary-gray",unelevated:"",class:"absolute-right",icon:s.close,size:"md",onClick:Q},null,8,["icon"])]),_:1}),o(pe),o(V,null,{default:i(()=>[o(w,{text:b(f)},null,8,["text"]),v(" "+I(b(f)),1)]),_:1}),o(pe),o(V,null,{default:i(()=>[_("div",Rn,[o(W,{outline:"",rounded:"",onClick:E},{default:i(()=>[v(" Disconnect ")]),_:1}),o(W,{outline:"",rounded:"",onClick:Q},{default:i(()=>[v(" Ok ")]),_:1})])]),_:1})]),_:1})):(p(),C(H,{key:1,class:"wallet-connect-card"},{default:i(()=>[o(V,null,{default:i(()=>[Ln,o(W,{padding:"md",color:"transparent","text-color":"primary-gray",unelevated:"",class:"absolute-right",icon:s.close,size:"md",onClick:Q},null,8,["icon"])]),_:1}),o(pe),o(V,{style:{"max-height":"80vh"},class:"scroll"},{default:i(()=>[o(Dt,{grid:"",rows:b(M),"row-key":"name","hide-pagination":"","hide-header":"","rows-per-page-options":[100]},{item:i(({row:x})=>[(p(),P("div",{key:`wallet-${x.name}`,class:"col-12 col-md-6"},[o(ne,{clickable:"",disable:!a(x),onClick:D=>A(x)},{default:i(()=>[o(L,null,{default:i(()=>[_("b",null,I(x.name),1),_("div",Fn,I(x.url),1)]),_:2},1024),o(L,{avatar:""},{default:i(()=>[o(It,{square:""},{default:i(()=>{var D;return[_("img",{src:d.$q.dark.isActive?x.icon:(D=x.darkIcon)!=null?D:x.icon,alt:""},null,8,$n)]}),_:2},1024)]),_:2},1024)]),_:2},1032,["disable","onClick"])]))]),_:1},8,["rows"])]),_:1})]),_:1}))]),_:1},8,["modelValue"])],64)}}});const On="_btn_6n1iw_1",Un={btn:On},ee=(n,e)=>{const t=n.__vccOpts||n;for(const[s,a]of e)t[s]=a;return t},Qn={$style:Un},Gn=ee(Vn,[["__cssModules",Qn],["__scopeId","data-v-8e6634b7"],["__file","/home/runner/work/sol-messenger/sol-messenger/packages/ui/src/components/ConnectWallet.vue"]]),J=[{id:"jpool-mainnet",name:"Jpool RPC",cluster:"mainnet-beta",url:"https://jpoolone.genesysgo.net/"},{id:"serum-mainnet",name:"Serum RPC",cluster:"mainnet-beta",url:"https://solana-api.projectserum.com/"},{id:"rpcpool-mainnet",name:"RPCPool RPC",cluster:"mainnet-beta",url:"https://mainnet.rpcpool.com/"},{id:"mainnet",name:"Solana RPC",cluster:"mainnet-beta",url:Bt("mainnet-beta")}],ht={id:"devnet",name:"DevNet",cluster:"devnet",url:"https://devnet.rpcpool.com/"};J.push(ht);const jn={id:"testnet",name:"TestNet",cluster:"testnet",url:"https://testnet.rpcpool.com/"};J.push(jn);J.push({id:"localnet",name:"LocalNet",cluster:"localnet",url:"http://127.0.0.1:8899"});var et;const qn=(et=J.find(n=>n.id==={BASE_URL:"/",MODE:"staging",DEV:!0,PROD:!1}.VITE_CONNECTION_ENDPOINT))!=null?et:ht,Hn="confirmed",Xn=12e4,$e=st({id:"connection",state:()=>({commitment:Hn,confirmTransactionInitialTimeout:Xn,rpc:Kt("rpc","")}),getters:{endpoint(n){var e;return(e=J.find(t=>t.id===n.rpc))!=null?e:qn},connection(n){return console.log("[connection]",this.endpoint.url),new Nt(this.endpoint.url,{confirmTransactionInitialTimeout:n.confirmTransactionInitialTimeout,commitment:n.commitment})},cluster(){return this.endpoint.cluster}},actions:{setRpc(n){this.rpc=n},setCommitment(n){this.commitment=n}}}),Jn=_e({__name:"ClusterSelector",setup(n){const e=$e(),{connected:t,connect:s,disconnect:a,autoConnect:r}=we(),l=[J.filter(y=>y.cluster==="mainnet-beta"),J.filter(y=>y.cluster!=="mainnet-beta")],m=F(()=>e.endpoint),f=y=>{t&&e.cluster!==y.cluster&&(a(),r.value&&s()),e.setRpc(y.id)};return(y,M)=>(p(),C(rt,{label:b(m).name,"model-value":!1,"auto-close":"",color:"secondary","text-color":"grey-8",rounded:"",unelevated:"",ripple:!1},{default:i(()=>[o(fe,null,{default:i(()=>[(p(),P(O,null,ce(l,(g,A)=>(p(),P(O,{key:`${A}-cluster-group`},[(p(!0),P(O,null,ce(g,E=>(p(),C(ne,{key:E.id,clickable:"",onClick:U=>f(E)},{default:i(()=>[(p(),C(L,{key:`${E.id}-item`},{default:i(()=>[o(q,null,{default:i(()=>[_("b",null,I(E.name),1)]),_:2},1024),v(" "+I(E.url),1)]),_:2},1024))]),_:2},1032,["onClick"]))),128)),A!==l.length-1?(p(),C(pe,{key:0})):R("v-if",!0)],64))),64))]),_:1})]),_:1},8,["label"]))}}),Zn=ee(Jn,[["__file","/home/runner/work/sol-messenger/sol-messenger/packages/ui/src/components/ClusterSelector.vue"]]),Yn={},ea={class:"container"},ta={class:"app-header__logo"},na=_("div",{class:"app-header__nav"},[_("a",{href:"https://jpool.one",target:"_blank"},"JPOOL"),_("a",{href:"https://dev.svt.one",target:"_blank"},"Validator toolkit")],-1),aa={class:"app-header__right"},sa={class:"app-header__buttons"};function ra(n,e){const t=Ae("router-link"),s=Zn,a=Gn;return p(),C(zt,{class:"app-header"},{default:i(()=>[_("div",ea,[o(ot,null,{default:i(()=>[_("div",ta,[o(t,{to:"/"},{default:i(()=>[v(" SOM ")]),_:1})]),o(qe),na,o(qe),_("div",aa,[_("div",sa,[o(s,{class:"app-header__cluster-btn"}),o(a,{class:"app-header__wallet-btn"})])])]),_:1})])]),_:1})}const oa=ee(Yn,[["render",ra],["__file","/home/runner/work/sol-messenger/sol-messenger/packages/ui/src/components/AppHeader.vue"]]),ia={};function la(n,e){const t=oa,s=Ae("router-view");return p(),C(Tt,{view:"lfh Lpr lff"},{default:i(()=>[o(t),o(Rt,null,{default:i(()=>[o(s)]),_:1}),R(" <app-footer /> ")]),_:1})}const ca=ee(ia,[["render",la],["__file","/home/runner/work/sol-messenger/sol-messenger/packages/ui/src/layouts/default.vue"]]),ua={default:ca,empty:()=>it(()=>import("./empty.cc5f98ff.js"),["assets/empty.cc5f98ff.js","assets/vendor.c5367e08.js"])};function da(n){return n.map(e=>{var t;return{path:e.path,component:ua[((t=e.meta)==null?void 0:t.layout)||"default"],children:[{...e,path:""}]}})}const ma=new c.FixableBeetArgsStruct([["id",c.u32],["sender",T],["createdAt",c.i64],["content",c.utf8String]],"Message"),Ne=[49,159,99,106,220,87,219,88];class z{constructor(e,t,s,a,r,l,m){this.name=e,this.creator=t,this.createdAt=s,this.memberCount=a,this.messageCount=r,this.maxMessages=l,this.messages=m}static fromArgs(e){return new z(e.name,e.creator,e.createdAt,e.memberCount,e.messageCount,e.maxMessages,e.messages)}static fromAccountInfo(e,t=0){return z.deserialize(e.data,t)}static async fromAccountAddress(e,t,s){const a=await e.getAccountInfo(t,s);if(a==null)throw new Error(`Unable to find Channel account at ${t}`);return z.fromAccountInfo(a,0)[0]}static gpaBuilder(e=new S("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){return lt.fromStruct(e,me)}static deserialize(e,t=0){return me.deserialize(e,t)}serialize(){return me.serialize({accountDiscriminator:Ne,...this})}static byteSize(e){const t=z.fromArgs(e);return me.toFixedFromValue({accountDiscriminator:Ne,...t}).byteSize}static async getMinimumBalanceForRentExemption(e,t,s){return t.getMinimumBalanceForRentExemption(z.byteSize(e),s)}pretty(){return{name:this.name,creator:this.creator.toBase58(),createdAt:(()=>{const e=this.createdAt;if(typeof e.toNumber=="function")try{return e.toNumber()}catch{return e}return e})(),memberCount:this.memberCount,messageCount:this.messageCount,maxMessages:this.maxMessages,messages:this.messages}}}const me=new c.FixableBeetStruct([["accountDiscriminator",c.uniformFixedSizeArray(c.u8,8)],["name",c.utf8String],["creator",T],["createdAt",c.i64],["memberCount",c.u16],["messageCount",c.u32],["maxMessages",c.u16],["messages",c.array(ma)]],z.fromArgs,"Channel"),ve=new c.FixableBeetArgsStruct([["header",c.utf8String],["encryptedKey",c.utf8String]],"CEKData"),ha=c.dataEnum([["Authorized",new c.FixableBeetArgsStruct([["by",c.coption(T)]],'ChannelMembershipStatusRecord["Authorized"]')],["Pending",new c.FixableBeetArgsStruct([["authority",c.coption(T)]],'ChannelMembershipStatusRecord["Pending"]')]]),be=[238,149,255,251,116,131,86,170];class K{constructor(e,t,s,a,r,l,m,f,y){this.channel=e,this.authority=t,this.key=s,this.cek=a,this.status=r,this.name=l,this.invitedBy=m,this.createdAt=f,this.bump=y}static fromArgs(e){return new K(e.channel,e.authority,e.key,e.cek,e.status,e.name,e.invitedBy,e.createdAt,e.bump)}static fromAccountInfo(e,t=0){return K.deserialize(e.data,t)}static async fromAccountAddress(e,t,s){const a=await e.getAccountInfo(t,s);if(a==null)throw new Error(`Unable to find ChannelMembership account at ${t}`);return K.fromAccountInfo(a,0)[0]}static gpaBuilder(e=new S("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){return lt.fromStruct(e,he)}static deserialize(e,t=0){return he.deserialize(e,t)}serialize(){return he.serialize({accountDiscriminator:be,...this})}static byteSize(e){const t=K.fromArgs(e);return he.toFixedFromValue({accountDiscriminator:be,...t}).byteSize}static async getMinimumBalanceForRentExemption(e,t,s){return t.getMinimumBalanceForRentExemption(K.byteSize(e),s)}pretty(){return{channel:this.channel.toBase58(),authority:this.authority.toBase58(),key:this.key.toBase58(),cek:this.cek,status:this.status.__kind,name:this.name,invitedBy:this.invitedBy,createdAt:(()=>{const e=this.createdAt;if(typeof e.toNumber=="function")try{return e.toNumber()}catch{return e}return e})(),bump:this.bump}}}const he=new c.FixableBeetStruct([["accountDiscriminator",c.uniformFixedSizeArray(c.u8,8)],["channel",T],["authority",T],["key",T],["cek",ve],["status",ha],["name",c.utf8String],["invitedBy",c.coption(T)],["createdAt",c.i64],["bump",c.u8]],K.fromArgs,"ChannelMembership"),oe=new Map,ie=new Map;class Ce extends Error{constructor(){super("Unauthorized");B(this,"code",6e3);B(this,"name","Unauthorized");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Ce)}}oe.set(6e3,()=>new Ce);ie.set("Unauthorized",()=>new Ce);class Se extends Error{constructor(){super("Name too long");B(this,"code",6001);B(this,"name","NameTooLong");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Se)}}oe.set(6001,()=>new Se);ie.set("NameTooLong",()=>new Se);class Me extends Error{constructor(){super("Message too long");B(this,"code",6002);B(this,"name","MessageTooLong");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Me)}}oe.set(6002,()=>new Me);ie.set("MessageTooLong",()=>new Me);class xe extends Error{constructor(){super("Already in use");B(this,"code",6003);B(this,"name","AlreadyInUse");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,xe)}}oe.set(6003,()=>new xe);ie.set("AlreadyInUse",()=>new xe);class Ee extends Error{constructor(){super("Uninitialized account");B(this,"code",6004);B(this,"name","UninitializedAccount");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Ee)}}oe.set(6004,()=>new Ee);ie.set("UninitializedAccount",()=>new Ee);function j(n){const e=oe.get(n);return e!=null?e():null}function te(n){const e=ie.get(n);return e!=null?e():null}const pa=new c.FixableBeetArgsStruct([["name",c.utf8String],["cek",ve],["key",c.coption(T)]],"AddMemberData"),ya=new c.FixableBeetArgsStruct([["instructionDiscriminator",c.uniformFixedSizeArray(c.u8,8)],["data",pa]],"AddMemberInstructionArgs"),fa=[13,116,123,130,126,198,57,34];function ga(n,e,t=new S("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){var l;const[s]=ya.serialize({instructionDiscriminator:fa,...e}),a=[{pubkey:n.channel,isWritable:!0,isSigner:!1},{pubkey:n.invitee,isWritable:!1,isSigner:!1},{pubkey:n.inviteeMembership,isWritable:!0,isSigner:!1},{pubkey:n.authorityMembership,isWritable:!0,isSigner:!1},{pubkey:n.authority,isWritable:!0,isSigner:!0},{pubkey:(l=n.systemProgram)!=null?l:Z.programId,isWritable:!1,isSigner:!1}];if(n.anchorRemainingAccounts!=null)for(const m of n.anchorRemainingAccounts)a.push(m);return new Y({programId:t,keys:a,data:s})}const ba=new c.FixableBeetArgsStruct([["cek",ve]],"AuthorizeMemberData"),_a=new c.FixableBeetArgsStruct([["instructionDiscriminator",c.uniformFixedSizeArray(c.u8,8)],["data",ba]],"AuthorizeMemberInstructionArgs"),wa=[194,123,189,175,86,225,93,128];function Aa(n,e,t=new S("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){var l;const[s]=_a.serialize({instructionDiscriminator:wa,...e}),a=[{pubkey:n.channel,isWritable:!1,isSigner:!1},{pubkey:n.membership,isWritable:!0,isSigner:!1},{pubkey:n.authority,isWritable:!1,isSigner:!0},{pubkey:n.authorityMembership,isWritable:!1,isSigner:!1},{pubkey:(l=n.systemProgram)!=null?l:Z.programId,isWritable:!1,isSigner:!1}];if(n.anchorRemainingAccounts!=null)for(const m of n.anchorRemainingAccounts)a.push(m);return new Y({programId:t,keys:a,data:s})}const ka=new c.BeetArgsStruct([["instructionDiscriminator",c.uniformFixedSizeArray(c.u8,8)]],"DeleteChannelInstructionArgs"),va=[145,225,187,221,157,142,114,133];function Ca(n,e=new S("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){var r;const[t]=ka.serialize({instructionDiscriminator:va}),s=[{pubkey:n.channel,isWritable:!0,isSigner:!1},{pubkey:n.authority,isWritable:!0,isSigner:!0},{pubkey:n.authorityMembership,isWritable:!0,isSigner:!1},{pubkey:(r=n.systemProgram)!=null?r:Z.programId,isWritable:!1,isSigner:!1}];if(n.anchorRemainingAccounts!=null)for(const l of n.anchorRemainingAccounts)s.push(l);return new Y({programId:e,keys:s,data:t})}const Sa=new c.BeetArgsStruct([["instructionDiscriminator",c.uniformFixedSizeArray(c.u8,8)]],"DeleteMemberInstructionArgs"),Ma=[95,14,98,112,252,218,205,173];function xa(n,e=new S("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){var r;const[t]=Sa.serialize({instructionDiscriminator:Ma}),s=[{pubkey:n.channel,isWritable:!0,isSigner:!1},{pubkey:n.membership,isWritable:!0,isSigner:!1},{pubkey:n.authority,isWritable:!0,isSigner:!0},{pubkey:n.authorityMembership,isWritable:!0,isSigner:!1},{pubkey:(r=n.systemProgram)!=null?r:Z.programId,isWritable:!1,isSigner:!1}];if(n.anchorRemainingAccounts!=null)for(const l of n.anchorRemainingAccounts)s.push(l);return new Y({programId:e,keys:s,data:t})}const Ea=new c.FixableBeetArgsStruct([["name",c.utf8String],["maxMessages",c.u16],["memberName",c.utf8String],["cek",ve]],"InitChannelData"),Pa=new c.FixableBeetArgsStruct([["instructionDiscriminator",c.uniformFixedSizeArray(c.u8,8)],["data",Ea]],"InitChannelInstructionArgs"),Da=[21,200,152,39,19,178,76,47];function Ia(n,e,t=new S("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){var l;const[s]=Pa.serialize({instructionDiscriminator:Da,...e}),a=[{pubkey:n.channel,isWritable:!0,isSigner:!0},{pubkey:n.membership,isWritable:!0,isSigner:!1},{pubkey:n.authority,isWritable:!0,isSigner:!0},{pubkey:n.key,isWritable:!1,isSigner:!0},{pubkey:(l=n.systemProgram)!=null?l:Z.programId,isWritable:!1,isSigner:!1}];if(n.anchorRemainingAccounts!=null)for(const m of n.anchorRemainingAccounts)a.push(m);return new Y({programId:t,keys:a,data:s})}const Wa=new c.FixableBeetArgsStruct([["name",c.utf8String],["authority",c.coption(T)]],"JoinChannelData"),Ba=new c.FixableBeetArgsStruct([["instructionDiscriminator",c.uniformFixedSizeArray(c.u8,8)],["data",Wa]],"JoinChannelInstructionArgs"),Ka=[124,39,115,89,217,26,38,29];function Na(n,e,t=new S("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){var l;const[s]=Ba.serialize({instructionDiscriminator:Ka,...e}),a=[{pubkey:n.channel,isWritable:!0,isSigner:!1},{pubkey:n.membership,isWritable:!0,isSigner:!1},{pubkey:n.authority,isWritable:!0,isSigner:!0},{pubkey:n.key,isWritable:!1,isSigner:!0},{pubkey:(l=n.systemProgram)!=null?l:Z.programId,isWritable:!1,isSigner:!1}];if(n.anchorRemainingAccounts!=null)for(const m of n.anchorRemainingAccounts)a.push(m);return new Y({programId:t,keys:a,data:s})}const za=new c.FixableBeetArgsStruct([["instructionDiscriminator",c.uniformFixedSizeArray(c.u8,8)],["message",c.utf8String]],"PostMessageInstructionArgs"),Ta=[214,50,100,209,38,34,7,76];function Ra(n,e,t=new S("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){var l;const[s]=za.serialize({instructionDiscriminator:Ta,...e}),a=[{pubkey:n.channel,isWritable:!0,isSigner:!1},{pubkey:n.membership,isWritable:!1,isSigner:!1},{pubkey:n.authority,isWritable:!1,isSigner:!0},{pubkey:(l=n.systemProgram)!=null?l:Z.programId,isWritable:!1,isSigner:!1}];if(n.anchorRemainingAccounts!=null)for(const m of n.anchorRemainingAccounts)a.push(m);return new Y({programId:t,keys:a,data:s})}const La="6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm",Fa=new S(La);function ze(n,e=new Uint8Array(4)){const t=ue(n.toString(),"base10");return e.set(t,4-t.length),e}const We=n=>se([ze(n.length),n]);function pt(n,e,t){if(e!==256)throw new Error(`Unsupported key length: ${e}`);const s=se([We(ue(t)),We(new Uint8Array(0)),We(new Uint8Array(0)),ze(e)]),a=1;return Lt.hash(se([ze(a),n,s]))}const Te=n=>ue(n,"base64pad"),Re=n=>ct(n,"base64pad"),$a=n=>ue(n),Va=n=>ct(n),Oa=n=>ue(n,"base58btc"),X=ke.NONCE_LENGTH,re=ke.TAG_LENGTH,yt=n=>{const e=new ke.XChaCha20Poly1305(n);return(t,s)=>{const a=ut.randomBytes(X),r=e.seal(a,t,s);return{ciphertext:r.subarray(0,r.length-re),tag:r.subarray(r.length-re),iv:a}}},ft=n=>{const e=new ke.XChaCha20Poly1305(n);return(t,s,a,r)=>e.open(a,se([t,s]),r)},gt="ECDH-ES+XC20PKW",bt=256,Ua=n=>e=>{const t=Ke.generateKeyPair(),s=Ke.sharedKey(t.secretKey,n),a=pt(s,bt,gt),r=yt(a)(e);return{encryptedKey:r.ciphertext,tag:r.tag,iv:r.iv,epPubKey:t.publicKey}},Qa=n=>(e,t,s,a)=>{const r=Ke.sharedKey(n,a),l=pt(r,bt,gt);return ft(l)(e,t,s)},Ga=n=>{if(Array.isArray(n))return ae.fromSecretKey(He.Buffer.from(n));if(typeof n=="string")return ae.fromSecretKey(Oa(n));if(n instanceof He.Buffer||n instanceof Uint8Array)return ae.fromSecretKey(n);throw new Error("Incompatible private key format")},ja=async(n=32)=>{const e=ut.randomBytes(n);return Promise.resolve(e)},qa=async(n,e)=>{const t=await Ua(Ft(e.toBytes()))(n);return{header:Re(se([t.iv,t.tag,t.epPubKey])),encryptedKey:Re(t.encryptedKey)}},Ha=async(n,e)=>{const t=Te(n.header),s=t.subarray(0,X),a=t.subarray(X,X+re),r=t.subarray(X+re),l=Te(n.encryptedKey),m=Ga(e).secretKey,f=$t(m),y=await Qa(f)(l,a,s,r);if(y===null)throw new Error("There was a problem decrypting the CEK");return y},Xa=async(n,e)=>{const t=await yt(e)($a(n));return Re(se([t.iv,t.ciphertext,t.tag]))},Ja=async(n,e)=>{const t=Te(n),s=t.subarray(0,X),a=t.subarray(X,-re),r=t.subarray(-re),l=await ft(e)(a,r,s);if(l===null)throw new Error("There was an error decoding the message!");return Va(l)};class Za{constructor(e,t){B(this,"programId",Fa);this.provider=e,this.keypair=t}get connection(){return this.provider.connection}setKeypair(e){this.keypair=e}async loadAllChannels(){return(await z.gpaBuilder().addFilter("accountDiscriminator",Ne).run(this.provider.connection)).map(t=>({pubkey:t.pubkey,data:z.fromAccountInfo(t.account)[0]}))}async loadChannel(e,t){return z.fromAccountAddress(this.provider.connection,e,t)}async loadMyChannels(){const e=await this.loadMemberships();return console.log(e),[]}async loadChannelMembers(e){return(await K.gpaBuilder().addFilter("accountDiscriminator",be).addFilter("channel",e).run(this.provider.connection)).map(s=>({pubkey:s.pubkey,data:K.fromAccountInfo(s.account)[0]}))}async loadMemberships(e){return(await K.gpaBuilder().addFilter("accountDiscriminator",be).addFilter("authority",this.provider.publicKey).addFilter("key",e).run(this.provider.connection)).map(s=>({pubkey:s.pubkey,data:K.fromAccountInfo(s.account)}))}async loadMembership(e,t){return K.fromAccountAddress(this.provider.connection,e,t)}async getMembershipPDA(e,t){return t=t!=null?t:this.keypair.publicKey,await S.findProgramAddress([e.toBuffer(),t.toBuffer()],this.programId)}async encryptCEK(e,t){return qa(e,t!=null?t:this.keypair.publicKey)}async decryptCEK(e,t){return Ha(e,t!=null?t:this.keypair.secretKey)}async encryptMessage(e,t){return Xa(e,t)}async decryptMessage(e,t){return Ja(e,t)}async initChannel(e){var f,y,M;const t=(f=e.channel)!=null?f:ae.generate(),s=await ja(),a=await this.encryptCEK(s),[r]=await this.getMembershipPDA(t.publicKey),l=new G;l.add(Ia({channel:t.publicKey,membership:r,authority:this.provider.publicKey,key:this.keypair.publicKey},{data:{name:e.name,memberName:(y=e.memberName)!=null?y:"",maxMessages:e.maxMessages,cek:a}}));let m;try{m=await this.provider.sendAndConfirm(l,[t,this.keypair])}catch(g){throw(M=j(g.code))!=null?M:g}return{signature:m,channel:t,cek:s,cekEncrypted:a}}async deleteChannel(e,t){var l;const[s]=await this.getMembershipPDA(e),a=new G;a.add(Ca({channel:e,authority:this.provider.publicKey,authorityMembership:t!=null?t:s}));let r;try{r=await this.provider.sendAndConfirm(a)}catch(m){throw(l=j(m.code))!=null?l:te("Unauthorized")}return{signature:r}}async joinChannel(e){var r;const[t]=await this.getMembershipPDA(e.channel),s=new G;s.add(Na({channel:e.channel,authority:this.provider.publicKey,key:this.keypair.publicKey,membership:t},{data:{name:e.name,authority:e.authority}}));let a;try{a=await this.provider.sendAndConfirm(s,[this.keypair])}catch(l){throw(r=j(l.code))!=null?r:l}return{signature:a}}async addMember(e){var M,g,A;const t=(M=e.key)!=null?M:e.invitee,[s]=await this.getMembershipPDA(e.channel),[a]=await this.getMembershipPDA(e.channel,t),r=await this.loadMembership(s);if(!r.cek.encryptedKey)throw te("Unauthorized");const l=await this.decryptCEK(r.cek),m=await this.encryptCEK(l,t),f=new G;f.add(ga({channel:e.channel,authority:this.provider.publicKey,invitee:e.invitee,authorityMembership:s,inviteeMembership:a},{data:{name:(g=e.name)!=null?g:"",cek:m,key:t}}));let y;try{y=await this.provider.sendAndConfirm(f)}catch(E){throw(A=j(E.code))!=null?A:te("Unauthorized")}return{signature:y}}async deleteMember(e){var l;const[t]=await this.getMembershipPDA(e.channel),[s]=await this.getMembershipPDA(e.channel,e.key),a=new G;a.add(xa({channel:e.channel,authority:this.provider.publicKey,authorityMembership:t,membership:s}));let r;try{r=await this.provider.sendAndConfirm(a)}catch(m){throw(l=j(m.code))!=null?l:m}return{signature:r}}async authorizeMember(e){var y;const[t]=await this.getMembershipPDA(e.channel),[s]=await this.getMembershipPDA(e.channel,e.key),a=await this.loadMembership(t);if(!a.cek.encryptedKey)throw te("Unauthorized");const r=await this.decryptCEK(a.cek),l=await this.encryptCEK(r,e.key),m=new G;m.add(Aa({channel:e.channel,membership:s,authority:this.provider.publicKey,authorityMembership:t},{data:{cek:l}}));let f;try{f=await this.provider.sendAndConfirm(m)}catch(M){throw(y=j(M.code))!=null?y:te("Unauthorized")}return{signature:f}}async postMessage(e){var f;const[t]=await this.getMembershipPDA(e.channel),s=await this.loadMembership(t);if(!s.cek.header)throw te("Unauthorized");const a=await this.decryptCEK(s.cek),r=await this.encryptMessage(e.message,a),l=new G;l.add(Ra({channel:e.channel,membership:t,authority:this.provider.publicKey},{message:r}));let m;try{m=await this.provider.sendAndConfirm(l)}catch(y){throw(f=j(y.code))!=null?f:y}return{signature:m}}}const Ya=st("messenger",()=>{const n=$e(),e=Vt(),t=Ot("key",()=>Xe.encode(ae.generate().secretKey)),s=ae.fromSecretKey(Xe.decode(t.value)),a=ge({allChannels:[],channel:void 0,channelAddr:void 0,channelMembership:void 0,channelMembers:[],channelMessages:[],channelLoading:!1,loading:!1,creating:!1,sending:!1}),r=F(()=>{var d;return new Za(new Je(n.connection,(d=e.value)!=null?d:{publicKey:S.default},Je.defaultOptions()),s)});l().then();async function l(){a.loading=!0;const d=await r.value.loadAllChannels();for(const h of d){console.log(`Channel: ${h.pubkey}`),console.log(h.data.pretty());const w=await r.value.loadChannelMembers(h.pubkey);console.log("|-- members:");for(const x of w)console.log(x.data.pretty())}dt(e,h=>{(h==null?void 0:h.publicKey)&&a.channelAddr&&M(a.channelAddr)}),a.allChannels=d,a.loading=!1}async function m(d,h=15){try{a.creating=!0;const{channel:w}=await r.value.initChannel({name:d,maxMessages:h});await M(w.publicKey),a.channel&&a.allChannels.push({pubkey:w.publicKey,data:a.channel})}finally{a.creating=!1}}async function f(d){const h=new S(d);await r.value.deleteChannel(h)}async function y(d,h){const w=new S(d);await r.value.joinChannel({channel:w,name:h})}async function M(d){var h;a.channelLoading=!0,a.channelAddr=new S(d);try{if((h=e.value)!=null&&h.publicKey)try{const[w]=await r.value.getMembershipPDA(a.channelAddr);a.channelMembership=await r.value.loadMembership(w)}catch(w){console.log(w)}await Promise.all([A(),g()])}catch(w){console.log("Error",w)}finally{a.channelLoading=!1}}async function g(){if(!a.channelAddr){console.log("Invalid channel");return}a.channel=await r.value.loadChannel(a.channelAddr);const d=a.channelMembership?await r.value.decryptCEK(a.channelMembership.cek):null;a.channelMessages=await Promise.all(a.channel.messages.map(async h=>{let w="***** *** *** *** *******",x=Fe(h.sender);const D=a.channelMembers.find(({data:$})=>String($.authority)===String(h.sender)||String($.key)===String(h.sender));if(D&&D.data.name!==""&&(x=D.data.name),d)try{w=await r.value.decryptMessage(h.content,d)}catch{console.log(`Failed to decrypt message #${h.id}`)}return{...h,sender:x,content:w}}))}async function A(){if(!a.channelAddr){console.error("Invalid channel");return}a.channelMembers=await r.value.loadChannelMembers(a.channelAddr)}async function E(d){if(!a.channelAddr){console.log("Please select a channel");return}try{a.sending=!0,await r.value.postMessage({channel:a.channelAddr,message:d}),await g()}finally{a.sending=!1}}async function U(d,h,w){if(!a.channelAddr){console.log("Invalid channel");return}await r.value.addMember({channel:a.channelAddr,invitee:new S(d),key:h?new S(h):void 0,name:w})}async function Q(d){if(!a.channelAddr){console.log("Invalid channel");return}await r.value.authorizeMember({channel:a.channelAddr,key:new S(d)})}return{state:a,client:r.value,keypair:s,loadChannel:M,joinChannel:y,createChannel:m,deleteChannel:f,postMessage:E,addMember:U,authorizeMember:Q}}),es=n=>(nt("data-v-d7697c19"),n=n(),at(),n),ts={class:"messenger"},ns={class:"row q-gutter-md"},as={class:"col col-3"},ss={class:"messenger-add-channel"},rs={key:1,class:"messenger-channels-empty"},os={class:"col"},is={key:0},ls={class:"row"},cs={key:0,class:"col"},us={class:"col"},ds={class:"channel-name"},ms={key:0,class:"row justify-center"},hs={key:0,class:"messenger-messages"},ps={key:1,class:"messenger-empty"},ys={key:1,class:"messenger-empty"},fs=es(()=>_("br",null,null,-1)),gs=_e({__name:"Messenger",setup(n){const{notify:e}=Le(),t=we(),{state:s,postMessage:a,addMember:r,authorizeMember:l,createChannel:m,loadChannel:f,deleteChannel:y}=Ya(),M=tt(!1),g=ge({dialog:!1,loading:!1,name:"",key:""}),A=ge({dialog:!1,name:"",maxMessages:15}),E=ge({message:""});async function U(){D()&&(await a(E.message),E.message="")}function Q(){D()&&(A.dialog=!0)}async function d(){D()&&(await m(A.name,A.maxMessages),A.dialog=!1,A.name="",e({type:"positive",message:"Channel was created!",timeout:2e3}))}async function h(){g.loading=!1,g.name="",g.key=""}async function w(N){try{await l(N),e({type:"info",message:"Member was authorized",timeout:2e3})}catch{e({type:"negative",message:"Something went wrong",timeout:2e3})}}async function x(){if(g.loading=!0,!s.channelAddr){e({type:"info",message:"Please select a channel",timeout:2e3});return}await r(s.channelAddr,g.key,g.name),g.loading=!1}function D(){return t.publicKey.value?!0:(e({type:"negative",message:"Please connect wallet",timeout:2e3}),!1)}async function $(N){}async function _t(N){await y(N),e({type:"positive",message:"Channel was deleted!",timeout:2e3})}async function wt(N){await f(N)}function At(N){if((N==null?void 0:N.__kind)==="Authorized")return"positive"}const Ve=F(()=>!!t.publicKey.value),Oe=F(()=>s.allChannels),Ue=F(()=>s.channelMessages),Qe=F(()=>t.publicKey.value&&s.channel&&!s.sending);return(N,k)=>(p(),P(O,null,[_("div",ts,[_("div",ns,[_("div",as,[_("div",ss,[o(W,{color:"primary",rounded:"",onClick:Q},{default:i(()=>[v(" Add New Channel ")]),_:1})]),o(H,{class:"messenger-channels"},{default:i(()=>[b(Oe).length>0?(p(),C(fe,{key:0,separator:""},{default:i(()=>[(p(!0),P(O,null,ce(b(Oe),u=>(p(),C(ne,{key:u.name,"active-class":"bg-blue-grey-1 text-grey-8",active:String(b(s).channelAddr)===String(u.pubkey)},{default:i(()=>[o(L,{class:"cursor-pointer",onClick:Pe=>wt(u.pubkey)},{default:i(()=>[o(q,null,{default:i(()=>[v(I(u.data.name),1)]),_:2},1024),o(q,{caption:"",lines:"2"},{default:i(()=>[_("div",null,"members: "+I(u.data.memberCount),1),_("div",null,"messages: "+I(u.data.messageCount),1)]),_:2},1024)]),_:2},1032,["onClick"]),o(L,{side:""},{default:i(()=>[b(Ve)?(p(),C(rt,{key:0,unelevated:"",rounded:""},{default:i(()=>[o(fe,null,{default:i(()=>[Ze((p(),C(ne,{clickable:"",onClick:Pe=>$(u.pubkey)},{default:i(()=>[o(L,null,{default:i(()=>[o(q,null,{default:i(()=>[v("Join channel")]),_:1})]),_:1})]),_:2},1032,["onClick"])),[[Ye]]),String(u.data.creator)===String(b(t).publicKey.value)?Ze((p(),C(ne,{key:0,clickable:"",onClick:Pe=>_t(u.pubkey)},{default:i(()=>[o(L,{class:"text-negative"},{default:i(()=>[o(q,null,{default:i(()=>[v("Delete channel")]),_:1})]),_:1})]),_:2},1032,["onClick"])),[[Ye]]):R("v-if",!0)]),_:2},1024)]),_:2},1024)):R("v-if",!0)]),_:2},1024)]),_:2},1032,["active"]))),128))]),_:1})):(p(),P("div",rs," No channels ")),o(de,{showing:b(s).loading,color:"primary"},null,8,["showing"])]),_:1})]),_("div",os,[b(s).channel?(p(),P("div",is,[_("div",ls,[b(Ve)?(p(),P("div",cs,[o(Ut,{rounded:"",unelevated:""},{default:i(()=>[o(W,{color:"secondary","text-color":"dark",loading:g.loading,onClick:k[0]||(k[0]=u=>g.dialog=!0)},{default:i(()=>[v(" add member ")]),_:1},8,["loading"]),o(W,{color:"primary",onClick:k[1]||(k[1]=u=>M.value=!0)},{default:i(()=>[v(" show members ")]),_:1})]),_:1})])):R("v-if",!0),_("div",us,[_("div",ds,I(b(s).channel.name),1)])])])):R("v-if",!0),o(H,{class:"messenger-card overflow-hidden"},{default:i(()=>[b(s).channel?(p(),P("div",ms,[b(Ue).length>0?(p(),P("div",hs,[(p(!0),P(O,null,ce(b(Ue),u=>(p(),C(Qt,{key:u.id,name:u.sender,text:[u.content],sent:u.sender===b(t).publicKey.value},null,8,["name","text","sent"]))),128))])):(p(),P("div",ps," No messages "))])):(p(),P("div",ys," Please select a channel ")),R(" Channel (new message form) "),o(De,{class:"channel-form",onSubmit:Ie(U,["prevent"])},{default:i(()=>[o(ot,{class:"bg-primary text-white row"},{default:i(()=>[o(le,{ref:"inputFocus",modelValue:E.message,"onUpdate:modelValue":k[2]||(k[2]=u=>E.message=u),class:"col-grow q-mr-sm","bg-color":"white",placeholder:"Type a message",dense:"",outlined:"",rounded:"",autofocus:"",disable:!b(Qe)},null,8,["modelValue","disable"]),o(W,{rounded:"",flat:"",type:"submit",disable:!b(Qe),loading:b(s).sending},{default:i(()=>[v(" Send ")]),_:1},8,["disable","loading"])]),_:1})]),_:1},8,["onSubmit"]),o(de,{showing:b(s).channelLoading},null,8,["showing"])]),_:1})])])]),R(" Dialogs "),o(ye,{modelValue:A.dialog,"onUpdate:modelValue":k[5]||(k[5]=u=>A.dialog=u),class:"new-channel-dialog"},{default:i(()=>[o(H,null,{default:i(()=>[o(V,null,{default:i(()=>[o(De,{class:"messenger-new-channel-form",onSubmit:Ie(d,["prevent"])},{default:i(()=>[o(le,{modelValue:A.name,"onUpdate:modelValue":k[3]||(k[3]=u=>A.name=u),label:"Channel name *","lazy-rules":"",rules:[u=>u&&u.length>2||"Please type something"]},null,8,["modelValue","rules"]),o(le,{modelValue:A.maxMessages,"onUpdate:modelValue":k[4]||(k[4]=u=>A.maxMessages=u),label:"Max messages","lazy-rules":"",rules:[u=>+u>0||"Invalid value"]},null,8,["modelValue","rules"]),o(W,{type:"submit",color:"info",ripple:!1,rounded:""},{default:i(()=>[v(" Create Channel ")]),_:1})]),_:1},8,["onSubmit"]),o(de,{showing:b(s).creating},null,8,["showing"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(ye,{modelValue:g.dialog,"onUpdate:modelValue":k[8]||(k[8]=u=>g.dialog=u),class:"add-member-dialog",onHide:h},{default:i(()=>[o(H,null,{default:i(()=>[o(V,null,{default:i(()=>[o(De,{class:"add-member-form",onSubmit:Ie(x,["prevent"])},{default:i(()=>[o(le,{modelValue:g.name,"onUpdate:modelValue":k[6]||(k[6]=u=>g.name=u),label:"Member name *","lazy-rules":"",rules:[u=>u&&u.length>2||"Please type something"]},null,8,["modelValue","rules"]),o(le,{modelValue:g.key,"onUpdate:modelValue":k[7]||(k[7]=u=>g.key=u),label:"Member Key *","lazy-rules":"",rules:[u=>u&&u.length>32||"Invalid public key"]},null,8,["modelValue","rules"]),fs,o(W,{type:"submit",color:"info",ripple:!1,rounded:""},{default:i(()=>[v(" Add Member ")]),_:1})]),_:1},8,["onSubmit"]),o(de,{showing:g.loading},null,8,["showing"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(ye,{modelValue:M.value,"onUpdate:modelValue":k[9]||(k[9]=u=>M.value=u)},{default:i(()=>[o(H,null,{default:i(()=>[o(V,null,{default:i(()=>[o(fe,{separator:""},{default:i(()=>[(p(!0),P(O,null,ce(b(s).channelMembers,u=>(p(),C(ne,{key:u.pubkey.toString()},{default:i(()=>[o(L,null,{default:i(()=>[o(q,null,{default:i(()=>[v(I(u.data.name&&u.data.name!==""?u.data.name:u.data.authority),1)]),_:2},1024),o(q,{caption:"",lines:"2"},{default:i(()=>[v(I(u.data.key),1)]),_:2},1024)]),_:2},1024),o(L,{side:"",top:""},{default:i(()=>[o(Gt,{color:At(u.data.status)},{default:i(()=>[v(I(u.data.status.__kind),1)]),_:2},1032,["color"]),u.data.status.__kind==="Pending"&&(!u.data.status.authority||String(u.data.status.authority)===String(b(t).publicKey.value))?(p(),C(W,{key:0,color:"primary",rounded:"",size:"sm",unelevated:"",class:"q-mt-sm",onClick:Pe=>w(u.data.key)},{default:i(()=>[v(" Authorize ")]),_:2},1032,["onClick"])):R("v-if",!0)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}});const bs=ee(gs,[["__scopeId","data-v-d7697c19"],["__file","/home/runner/work/sol-messenger/sol-messenger/packages/ui/src/components/Messenger.vue"]]);const _s={},ws={class:"container"},As={class:"messenger-container"};function ks(n,e){const t=bs;return p(),C(jt,null,{default:i(()=>[_("div",ws,[_("div",As,[o(t)])])]),_:1})}const vs=ee(_s,[["render",ks],["__scopeId","data-v-d1d3d0d7"],["__file","/home/runner/work/sol-messenger/sol-messenger/packages/ui/src/pages/index.vue"]]),Cs=()=>it(()=>import("./_...all_.9c6e29da.js"),["assets/_...all_.9c6e29da.js","assets/_...all_.319a51ec.css","assets/vendor.c5367e08.js"]),Ss=[{name:"index",path:"/",component:vs,props:!0},{name:"all",path:"/:all(.*)*",component:Cs,props:!0,meta:{layout:"empty"}}],Ms=da(Ss),xs="/",Es=qt({history:Ht(xs),scrollBehavior:()=>({left:0,top:0}),strict:!0,routes:Ms}),Ps=({app:n})=>{n.use(Es)},Ds=Object.freeze(Object.defineProperty({__proto__:null,install:Ps},Symbol.toStringTag,{value:"Module"})),Is=({app:n})=>{n.use(Xt,{wallets:[new Jt,new Zt,new Yt,new en,new tn,new nn,new an,new sn,new rn,new on,new ln,new cn,new un,new dn,new mn,new hn,new pn,new yn,new fn,new gn,new bn,new _n,new wn,new An,new kn,new vn,new Cn,new Sn,new Mn,new xn],autoConnect:!1})},Ws=Object.freeze(Object.defineProperty({__proto__:null,install:Is},Symbol.toStringTag,{value:"Module"})),Bs=En();function Ks(){return Bs}const Ns=Symbol("WALLET_CONNECT_EVENT"),zs=Symbol("WALLET_DISCONNECT_EVENT"),Ts=Symbol("ACCOUNT_CHANGE_EVENT"),Be=5e3;function Rs(){const{connection:n}=$e(),{emit:e}=Ks(),{notify:t}=Le(),{wallet:s}=we();dt(s,a=>{if(!a)return;const r=()=>{const f=a.publicKey;n.onAccountChange(f,y=>{console.log("ACCOUNT_CHANGE_EVENT",y),e(Ts,y)}),n.onLogs(f,y=>{console.log(y)}),t({message:"Wallet update",caption:`Connected to wallet ${Fe(f.toBase58(),7)}`,timeout:Be}),e(Ns,a)},l=()=>{t({message:"Wallet update",caption:"Disconnected from wallet",timeout:Be}),e(zs,a)},m=f=>{!(f!=null&&f.message)||t({type:"negative",message:"Wallet update",caption:f.message,timeout:Be})};a.once("connect",r),a.once("disconnect",l),a.removeAllListeners("error"),a.on("error",m)},{immediate:!0})}const Ls=_e({__name:"App",setup(n){return Pn(()=>{Rs()}),(e,t)=>{const s=Ae("router-view");return p(),C(s)}}}),Fs=ee(Ls,[["__file","/home/runner/work/sol-messenger/sol-messenger/packages/ui/src/App.vue"]]);async function $s(){const n=Dn(Fs);Object.values(Object.assign({"./plugins/pinia.ts":Wn,"./plugins/quasar.ts":Kn,"./plugins/router.ts":Ds,"./plugins/wallet.ts":Ws})).forEach(e=>{var t;return(t=e.install)==null?void 0:t.call(e,{app:n})}),n.mount("#app")}$s().then();export{ee as _};
