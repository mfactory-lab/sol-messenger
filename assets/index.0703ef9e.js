var Ut=Object.defineProperty;var Ot=(n,e,t)=>e in n?Ut(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var N=(n,e,t)=>(Ot(n,typeof e!="symbol"?e+"":e,t),t);import{c as Qt,Q as jt,P as Gt,N as qt,a as Jt,i as Ht,b as x,d as Se,u as Ue,e as ve,f as I,r as Oe,g as Ce,o as f,h as W,j as w,k as S,w as l,l as M,t as z,m as nt,n as D,p as s,q as Q,s as U,v as we,x as A,y as Xt,z as Ae,A as ne,B as Zt,C as ue,F as j,D as Yt,W as at,E as ut,G as dt,H as en,I as Qe,J as tn,K as nn,L as Te,M as me,O as de,R as $,S as an,T as mt,U as rt,V as rn,X as sn,Y as on,_ as ht,Z as pt,$ as ln,a0 as cn,a1 as ae,a2 as st,a3 as u,a4 as L,a5 as yt,a6 as X,a7 as Z,a8 as he,a9 as gt,aa as re,ab as un,ac as Me,ad as ft,ae as Re,af as dn,ag as mn,ah as ot,ai as G,aj as J,ak as it,al as bt,am as ce,an as lt,ao as hn,ap as pn,aq as ge,ar as fe,as as O,at as yn,au as gn,av as fn,aw as bn,ax as _n,ay as wn,az as An,aA as kn,aB as Sn,aC as vn,aD as Cn,aE as Mn,aF as xn,aG as En,aH as Pn,aI as Dn,aJ as In,aK as zn,aL as Kn,aM as Wn,aN as Bn,aO as Nn,aP as Tn,aQ as Rn,aR as Vn,aS as Fn,aT as Ln,aU as $n,aV as Un,aW as On,aX as Qn,aY as jn,aZ as Gn,a_ as qn,a$ as Jn,b0 as Hn,b1 as Xn}from"./vendor.94f2b619.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function t(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerpolicy&&(o.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?o.credentials="include":r.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(r){if(r.ep)return;r.ep=!0;const o=t(r);fetch(r.href,o)}})();const Zn=({app:n})=>{const e=Qt();n.use(e)},Yn=Object.freeze(Object.defineProperty({__proto__:null,install:Zn},Symbol.toStringTag,{value:"Module"})),ea=({app:n})=>{n.use(jt,{plugins:{Dark:Gt,Notify:qt,LocalStorage:Jt},iconSet:Ht})},ta=Object.freeze(Object.defineProperty({__proto__:null,install:ea},Symbol.toStringTag,{value:"Module"}));function xe(n,e=4){return n instanceof x&&(n=n.toBase58()),`${n.slice(0,e)}...${n.slice(-e)}`}const na="/sol-messenger/assets/ledger.40cf6861.svg",aa="/sol-messenger/assets/mathwallet.1d763e81.svg",_t=n=>(ut("data-v-0bdf22f0"),n=n(),dt(),n),ra=_t(()=>A("div",{class:"text-h6 text-center"}," Your wallet ",-1)),sa={class:"q-gutter-md row justify-between"},oa=_t(()=>A("div",{class:"text-h6"}," Connect to a wallet ",-1)),ia={class:"text-light-gray text-caption full-width text-no-wrap",style:{"text-overflow":"ellipsis",overflow:"hidden"}},la=["src"],ca=Se({__name:"ConnectWallet",setup(n){const e={solflare:10,phantom:20,sollet:5,nufi:5,blocto:1},t={ledger:na,mathwallet:aa},a={close:Yt},r=d=>[at.Installed,at.Loadable].includes(d.readyState);Ue();const o=ve(),{connected:c,connecting:p}=o,b=I(()=>{var d,h;return(h=(d=o.publicKey.value)==null?void 0:d.toBase58())!=null?h:""}),g=I(()=>xe(b.value)),P=I(()=>[...o.wallets.value].map(d=>(d.darkIcon=t[d.name.toLowerCase()],d)).sort((d,h)=>{var B,V;const _=(B=e[d.name.toLowerCase()])!=null?B:1;return((V=e[h.name.toLowerCase()])!=null?V:1)-_+((r(h)?1:0)-(r(d)?1:0))})),E=Oe(!1);async function R(d){await o.select(d.name),E.value=!1,await o.connect()}function K(){E.value=!1,o.disconnect()}function v(){E.value=!0}function k(){E.value=!1}return(d,h)=>{const _=Ce("copy-to-clipboard");return f(),W(j,null,[w(c)?(f(),S(D,nt({key:0},d.$attrs,{class:d.$style.btn,ripple:!1,color:"primary-gray","text-color":"white",rounded:"",unelevated:"",onClick:v}),{default:l(()=>[M(z(w(g)),1)]),_:1},16,["class"])):(f(),S(D,nt({key:1},d.$attrs,{color:"primary-gray","text-color":"white",rounded:"",unelevated:"",ripple:!1,loading:w(p),onClick:v}),{default:l(()=>[M(" CONNECT WALLET ")]),_:1},16,["loading"])),s(ue,{modelValue:E.value,"onUpdate:modelValue":h[0]||(h[0]=C=>E.value=C),"transition-duration":"100","transition-show":"fade","transition-hide":"fade"},{default:l(()=>[w(c)?(f(),S(Q,{key:0},{default:l(()=>[s(U,{class:"relative-position"},{default:l(()=>[ra,s(D,{padding:"md",color:"transparent","text-color":"primary-gray",unelevated:"",class:"absolute-right",icon:a.close,size:"md",onClick:k},null,8,["icon"])]),_:1}),s(we),s(U,null,{default:l(()=>[s(_,{text:w(b)},null,8,["text"]),M(" "+z(w(b)),1)]),_:1}),s(we),s(U,null,{default:l(()=>[A("div",sa,[s(D,{outline:"",rounded:"",onClick:K},{default:l(()=>[M(" Disconnect ")]),_:1}),s(D,{outline:"",rounded:"",onClick:k},{default:l(()=>[M(" Ok ")]),_:1})])]),_:1})]),_:1})):(f(),S(Q,{key:1,class:"wallet-connect-card"},{default:l(()=>[s(U,null,{default:l(()=>[oa,s(D,{padding:"md",color:"transparent","text-color":"primary-gray",unelevated:"",class:"absolute-right",icon:a.close,size:"md",onClick:k},null,8,["icon"])]),_:1}),s(we),s(U,{style:{"max-height":"80vh"},class:"scroll"},{default:l(()=>[s(Xt,{grid:"",rows:w(P),"row-key":"name","hide-pagination":"","hide-header":"","rows-per-page-options":[100]},{item:l(({row:C})=>[(f(),W("div",{key:`wallet-${C.name}`,class:"col-12 col-md-6"},[s(Ae,{clickable:"",disable:!r(C),onClick:B=>R(C)},{default:l(()=>[s(ne,null,{default:l(()=>[A("b",null,z(C.name),1),A("div",ia,z(C.url),1)]),_:2},1024),s(ne,{avatar:""},{default:l(()=>[s(Zt,{square:""},{default:l(()=>{var B;return[A("img",{src:d.$q.dark.isActive?C.icon:(B=C.darkIcon)!=null?B:C.icon,alt:""},null,8,la)]}),_:2},1024)]),_:2},1024)]),_:2},1032,["disable","onClick"])]))]),_:1},8,["rows"])]),_:1})]),_:1}))]),_:1},8,["modelValue"])],64)}}});const ua="_btn_6n1iw_1",da={btn:ua},pe=(n,e)=>{const t=n.__vccOpts||n;for(const[a,r]of e)t[a]=r;return t},ma={$style:da},ha=pe(ca,[["__cssModules",ma],["__scopeId","data-v-0bdf22f0"]]),se=[{id:"jpool-mainnet",name:"Jpool RPC",cluster:"mainnet-beta",url:"https://jpoolone.genesysgo.net/"},{id:"serum-mainnet",name:"Serum RPC",cluster:"mainnet-beta",url:"https://solana-api.projectserum.com/"},{id:"rpcpool-mainnet",name:"RPCPool RPC",cluster:"mainnet-beta",url:"https://mainnet.rpcpool.com/"},{id:"mainnet",name:"Solana RPC",cluster:"mainnet-beta",url:en("mainnet-beta")}],wt={id:"devnet",name:"DevNet",cluster:"devnet",url:"https://devnet.rpcpool.com/"};se.push(wt);const pa={id:"testnet",name:"TestNet",cluster:"testnet",url:"https://testnet.rpcpool.com/"};se.push(pa);var ct;const ya=(ct=se.find(n=>n.id==={VITE_BASE_PATH:"/sol-messenger/",BASE_URL:"/sol-messenger/",MODE:"staging",DEV:!1,PROD:!0}.VITE_CONNECTION_ENDPOINT))!=null?ct:wt,ga="confirmed",fa=12e4,je=Qe({id:"connection",state:()=>({commitment:ga,confirmTransactionInitialTimeout:fa,rpc:tn("rpc","")}),getters:{endpoint(n){var e;return(e=se.find(t=>t.id===n.rpc))!=null?e:ya},connection(n){return console.log("[connection]",this.endpoint.url),new nn(this.endpoint.url,{confirmTransactionInitialTimeout:n.confirmTransactionInitialTimeout,commitment:n.commitment})},cluster(){return this.endpoint.cluster}},actions:{setRpc(n){this.rpc=n},setCommitment(n){this.commitment=n}}}),ba=Se({__name:"ClusterSelector",setup(n){const e=je(),{connected:t,connect:a,disconnect:r,autoConnect:o}=ve(),c=[se.filter(g=>g.cluster==="mainnet-beta"),se.filter(g=>g.cluster!=="mainnet-beta")],p=I(()=>e.endpoint),b=g=>{t&&e.cluster!==g.cluster&&(r(),o.value&&a()),e.setRpc(g.id)};return(g,P)=>(f(),S(an,{label:w(p).name,"model-value":!1,"auto-close":"",color:"secondary","text-color":"grey-8",rounded:"",unelevated:"",ripple:!1},{default:l(()=>[s(Te,null,{default:l(()=>[(f(),W(j,null,me(c,(E,R)=>(f(),W(j,{key:`${R}-cluster-group`},[(f(!0),W(j,null,me(E,K=>(f(),S(Ae,{key:K.id,clickable:"",onClick:v=>b(K)},{default:l(()=>[(f(),S(ne,{key:`${K.id}-item`},{default:l(()=>[s(de,null,{default:l(()=>[A("b",null,z(K.name),1)]),_:2},1024),M(" "+z(K.url),1)]),_:2},1024))]),_:2},1032,["onClick"]))),128)),R!==c.length-1?(f(),S(we,{key:0})):$("",!0)],64))),64))]),_:1})]),_:1},8,["label"]))}}),_a={},wa={class:"container"},Aa={class:"app-header__logo"},ka=A("div",{class:"app-header__nav"},[A("a",{href:"https://jpool.one",target:"_blank"},"JPOOL"),A("a",{href:"https://dev.svt.one",target:"_blank"},"Validator toolkit")],-1),Sa={class:"app-header__right"},va={class:"app-header__buttons"};function Ca(n,e){const t=Ce("router-link"),a=ba,r=ha;return f(),S(rn,{class:"app-header"},{default:l(()=>[A("div",wa,[s(mt,null,{default:l(()=>[A("div",Aa,[s(t,{to:"/"},{default:l(()=>[M(" SOM ")]),_:1})]),s(rt),ka,s(rt),A("div",Sa,[A("div",va,[s(a,{class:"app-header__cluster-btn"}),s(r,{class:"app-header__wallet-btn"})])])]),_:1})])]),_:1})}const Ma=pe(_a,[["render",Ca]]),xa={};function Ea(n,e){const t=Ma,a=Ce("router-view");return f(),S(sn,{view:"lfh Lpr lff"},{default:l(()=>[s(t),s(on,null,{default:l(()=>[s(a)]),_:1})]),_:1})}const Pa=pe(xa,[["render",Ea]]),Da={default:Pa,empty:()=>ht(()=>import("./empty.9cc05f53.js"),["assets/empty.9cc05f53.js","assets/vendor.94f2b619.js"])};function Ia(n){return n.map(e=>{var t;return{path:e.path,component:Da[((t=e.meta)==null?void 0:t.layout)||"default"],children:[{...e,path:""}]}})}const At=Qe("user",()=>{const n=pt(),e=Oe();return ln(()=>{var a;const t=(a=n.value)==null?void 0:a.publicKey;if(t){const r=cn(t.toString(),()=>st.encode(ae.generate().secretKey)).value;e.value=ae.fromSecretKey(st.decode(r))}}),{keypair:e}}),za=new u.FixableBeetArgsStruct([["id",u.u32],["sender",L],["createdAt",u.i64],["content",u.utf8String]],"Message"),Ve=[49,159,99,106,220,87,219,88];class F{constructor(e,t,a,r,o,c,p){this.name=e,this.creator=t,this.createdAt=a,this.memberCount=r,this.messageCount=o,this.maxMessages=c,this.messages=p}static fromArgs(e){return new F(e.name,e.creator,e.createdAt,e.memberCount,e.messageCount,e.maxMessages,e.messages)}static fromAccountInfo(e,t=0){return F.deserialize(e.data,t)}static async fromAccountAddress(e,t,a){const r=await e.getAccountInfo(t,a);if(r==null)throw new Error(`Unable to find Channel account at ${t}`);return F.fromAccountInfo(r,0)[0]}static gpaBuilder(e=new x("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){return yt.fromStruct(e,be)}static deserialize(e,t=0){return be.deserialize(e,t)}serialize(){return be.serialize({accountDiscriminator:Ve,...this})}static byteSize(e){const t=F.fromArgs(e);return be.toFixedFromValue({accountDiscriminator:Ve,...t}).byteSize}static async getMinimumBalanceForRentExemption(e,t,a){return t.getMinimumBalanceForRentExemption(F.byteSize(e),a)}pretty(){return{name:this.name,creator:this.creator.toBase58(),createdAt:(()=>{const e=this.createdAt;if(typeof e.toNumber=="function")try{return e.toNumber()}catch{return e}return e})(),memberCount:this.memberCount,messageCount:this.messageCount,maxMessages:this.maxMessages,messages:this.messages}}}const be=new u.FixableBeetStruct([["accountDiscriminator",u.uniformFixedSizeArray(u.u8,8)],["name",u.utf8String],["creator",L],["createdAt",u.i64],["memberCount",u.u16],["messageCount",u.u32],["maxMessages",u.u16],["messages",u.array(za)]],F.fromArgs,"Channel"),Ee=new u.FixableBeetArgsStruct([["header",u.utf8String],["encryptedKey",u.utf8String]],"CEKData"),Ka=n=>n.__kind==="Pending",Wa=u.dataEnum([["Authorized",new u.FixableBeetArgsStruct([["by",u.coption(L)]],'ChannelMembershipStatusRecord["Authorized"]')],["Pending",new u.FixableBeetArgsStruct([["authority",u.coption(L)]],'ChannelMembershipStatusRecord["Pending"]')]]),ke=[238,149,255,251,116,131,86,170];class T{constructor(e,t,a,r,o,c,p,b,g){this.channel=e,this.authority=t,this.key=a,this.cek=r,this.status=o,this.name=c,this.invitedBy=p,this.createdAt=b,this.bump=g}static fromArgs(e){return new T(e.channel,e.authority,e.key,e.cek,e.status,e.name,e.invitedBy,e.createdAt,e.bump)}static fromAccountInfo(e,t=0){return T.deserialize(e.data,t)}static async fromAccountAddress(e,t,a){const r=await e.getAccountInfo(t,a);if(r==null)throw new Error(`Unable to find ChannelMembership account at ${t}`);return T.fromAccountInfo(r,0)[0]}static gpaBuilder(e=new x("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){return yt.fromStruct(e,_e)}static deserialize(e,t=0){return _e.deserialize(e,t)}serialize(){return _e.serialize({accountDiscriminator:ke,...this})}static byteSize(e){const t=T.fromArgs(e);return _e.toFixedFromValue({accountDiscriminator:ke,...t}).byteSize}static async getMinimumBalanceForRentExemption(e,t,a){return t.getMinimumBalanceForRentExemption(T.byteSize(e),a)}pretty(){return{channel:this.channel.toBase58(),authority:this.authority.toBase58(),key:this.key.toBase58(),cek:this.cek,status:this.status.__kind,name:this.name,invitedBy:this.invitedBy,createdAt:(()=>{const e=this.createdAt;if(typeof e.toNumber=="function")try{return e.toNumber()}catch{return e}return e})(),bump:this.bump}}}const _e=new u.FixableBeetStruct([["accountDiscriminator",u.uniformFixedSizeArray(u.u8,8)],["channel",L],["authority",L],["key",L],["cek",Ee],["status",Wa],["name",u.utf8String],["invitedBy",u.coption(L)],["createdAt",u.i64],["bump",u.u8]],T.fromArgs,"ChannelMembership"),ie=new Map,le=new Map;class Pe extends Error{constructor(){super("Unauthorized");N(this,"code",6e3);N(this,"name","Unauthorized");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Pe)}}ie.set(6e3,()=>new Pe);le.set("Unauthorized",()=>new Pe);class De extends Error{constructor(){super("Name too long");N(this,"code",6001);N(this,"name","NameTooLong");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,De)}}ie.set(6001,()=>new De);le.set("NameTooLong",()=>new De);class Ie extends Error{constructor(){super("Message too long");N(this,"code",6002);N(this,"name","MessageTooLong");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Ie)}}ie.set(6002,()=>new Ie);le.set("MessageTooLong",()=>new Ie);class ze extends Error{constructor(){super("Already in use");N(this,"code",6003);N(this,"name","AlreadyInUse");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,ze)}}ie.set(6003,()=>new ze);le.set("AlreadyInUse",()=>new ze);class Ke extends Error{constructor(){super("Uninitialized account");N(this,"code",6004);N(this,"name","UninitializedAccount");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Ke)}}ie.set(6004,()=>new Ke);le.set("UninitializedAccount",()=>new Ke);function q(n){const e=ie.get(n);return e!=null?e():null}function te(n){const e=le.get(n);return e!=null?e():null}const Ba=new u.FixableBeetArgsStruct([["name",u.utf8String],["cek",Ee],["key",u.coption(L)]],"AddMemberData"),Na=new u.FixableBeetArgsStruct([["instructionDiscriminator",u.uniformFixedSizeArray(u.u8,8)],["data",Ba]],"AddMemberInstructionArgs"),Ta=[13,116,123,130,126,198,57,34];function Ra(n,e,t=new x("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){var c;const[a]=Na.serialize({instructionDiscriminator:Ta,...e}),r=[{pubkey:n.channel,isWritable:!0,isSigner:!1},{pubkey:n.invitee,isWritable:!1,isSigner:!1},{pubkey:n.inviteeMembership,isWritable:!0,isSigner:!1},{pubkey:n.authorityMembership,isWritable:!0,isSigner:!1},{pubkey:n.authority,isWritable:!0,isSigner:!0},{pubkey:(c=n.systemProgram)!=null?c:X.programId,isWritable:!1,isSigner:!1}];if(n.anchorRemainingAccounts!=null)for(const p of n.anchorRemainingAccounts)r.push(p);return new Z({programId:t,keys:r,data:a})}const Va=new u.FixableBeetArgsStruct([["cek",Ee]],"AuthorizeMemberData"),Fa=new u.FixableBeetArgsStruct([["instructionDiscriminator",u.uniformFixedSizeArray(u.u8,8)],["data",Va]],"AuthorizeMemberInstructionArgs"),La=[194,123,189,175,86,225,93,128];function $a(n,e,t=new x("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){var c;const[a]=Fa.serialize({instructionDiscriminator:La,...e}),r=[{pubkey:n.channel,isWritable:!1,isSigner:!1},{pubkey:n.membership,isWritable:!0,isSigner:!1},{pubkey:n.authority,isWritable:!1,isSigner:!0},{pubkey:n.authorityMembership,isWritable:!1,isSigner:!1},{pubkey:(c=n.systemProgram)!=null?c:X.programId,isWritable:!1,isSigner:!1}];if(n.anchorRemainingAccounts!=null)for(const p of n.anchorRemainingAccounts)r.push(p);return new Z({programId:t,keys:r,data:a})}const Ua=new u.BeetArgsStruct([["instructionDiscriminator",u.uniformFixedSizeArray(u.u8,8)]],"DeleteChannelInstructionArgs"),Oa=[145,225,187,221,157,142,114,133];function Qa(n,e=new x("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){var o;const[t]=Ua.serialize({instructionDiscriminator:Oa}),a=[{pubkey:n.channel,isWritable:!0,isSigner:!1},{pubkey:n.authority,isWritable:!0,isSigner:!0},{pubkey:n.authorityMembership,isWritable:!0,isSigner:!1},{pubkey:(o=n.systemProgram)!=null?o:X.programId,isWritable:!1,isSigner:!1}];if(n.anchorRemainingAccounts!=null)for(const c of n.anchorRemainingAccounts)a.push(c);return new Z({programId:e,keys:a,data:t})}const ja=new u.BeetArgsStruct([["instructionDiscriminator",u.uniformFixedSizeArray(u.u8,8)]],"DeleteMemberInstructionArgs"),Ga=[95,14,98,112,252,218,205,173];function qa(n,e=new x("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){var o;const[t]=ja.serialize({instructionDiscriminator:Ga}),a=[{pubkey:n.channel,isWritable:!0,isSigner:!1},{pubkey:n.membership,isWritable:!0,isSigner:!1},{pubkey:n.authority,isWritable:!0,isSigner:!0},{pubkey:n.authorityMembership,isWritable:!0,isSigner:!1},{pubkey:(o=n.systemProgram)!=null?o:X.programId,isWritable:!1,isSigner:!1}];if(n.anchorRemainingAccounts!=null)for(const c of n.anchorRemainingAccounts)a.push(c);return new Z({programId:e,keys:a,data:t})}const Ja=new u.FixableBeetArgsStruct([["name",u.utf8String],["maxMessages",u.u16],["memberName",u.utf8String],["cek",Ee]],"InitChannelData"),Ha=new u.FixableBeetArgsStruct([["instructionDiscriminator",u.uniformFixedSizeArray(u.u8,8)],["data",Ja]],"InitChannelInstructionArgs"),Xa=[21,200,152,39,19,178,76,47];function Za(n,e,t=new x("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){var c;const[a]=Ha.serialize({instructionDiscriminator:Xa,...e}),r=[{pubkey:n.channel,isWritable:!0,isSigner:!0},{pubkey:n.membership,isWritable:!0,isSigner:!1},{pubkey:n.authority,isWritable:!0,isSigner:!0},{pubkey:n.key,isWritable:!1,isSigner:!0},{pubkey:(c=n.systemProgram)!=null?c:X.programId,isWritable:!1,isSigner:!1}];if(n.anchorRemainingAccounts!=null)for(const p of n.anchorRemainingAccounts)r.push(p);return new Z({programId:t,keys:r,data:a})}const Ya=new u.FixableBeetArgsStruct([["name",u.utf8String],["authority",u.coption(L)]],"JoinChannelData"),er=new u.FixableBeetArgsStruct([["instructionDiscriminator",u.uniformFixedSizeArray(u.u8,8)],["data",Ya]],"JoinChannelInstructionArgs"),tr=[124,39,115,89,217,26,38,29];function nr(n,e,t=new x("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){var c;const[a]=er.serialize({instructionDiscriminator:tr,...e}),r=[{pubkey:n.channel,isWritable:!0,isSigner:!1},{pubkey:n.membership,isWritable:!0,isSigner:!1},{pubkey:n.authority,isWritable:!0,isSigner:!0},{pubkey:n.key,isWritable:!1,isSigner:!0},{pubkey:(c=n.systemProgram)!=null?c:X.programId,isWritable:!1,isSigner:!1}];if(n.anchorRemainingAccounts!=null)for(const p of n.anchorRemainingAccounts)r.push(p);return new Z({programId:t,keys:r,data:a})}const ar=new u.FixableBeetArgsStruct([["instructionDiscriminator",u.uniformFixedSizeArray(u.u8,8)],["message",u.utf8String]],"PostMessageInstructionArgs"),rr=[214,50,100,209,38,34,7,76];function sr(n,e,t=new x("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){var c;const[a]=ar.serialize({instructionDiscriminator:rr,...e}),r=[{pubkey:n.channel,isWritable:!0,isSigner:!1},{pubkey:n.membership,isWritable:!1,isSigner:!1},{pubkey:n.authority,isWritable:!1,isSigner:!0},{pubkey:(c=n.systemProgram)!=null?c:X.programId,isWritable:!1,isSigner:!1}];if(n.anchorRemainingAccounts!=null)for(const p of n.anchorRemainingAccounts)r.push(p);return new Z({programId:t,keys:r,data:a})}const or="6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm",ir=new x(or);function Fe(n,e=new Uint8Array(4)){const t=he(n.toString(),"base10");return e.set(t,4-t.length),e}const Be=n=>re([Fe(n.length),n]);function kt(n,e,t){if(e!==256)throw new Error(`Unsupported key length: ${e}`);const a=re([Be(he(t)),Be(new Uint8Array(0)),Be(new Uint8Array(0)),Fe(e)]),r=1;return un.hash(re([Fe(r),n,a]))}const Le=n=>he(n,"base64pad"),$e=n=>gt(n,"base64pad"),lr=n=>he(n),cr=n=>gt(n),ur=n=>he(n,"base58btc"),H=Me.NONCE_LENGTH,oe=Me.TAG_LENGTH,St=n=>{const e=new Me.XChaCha20Poly1305(n);return(t,a)=>{const r=ft.randomBytes(H),o=e.seal(r,t,a);return{ciphertext:o.subarray(0,o.length-oe),tag:o.subarray(o.length-oe),iv:r}}},vt=n=>{const e=new Me.XChaCha20Poly1305(n);return(t,a,r,o)=>e.open(r,re([t,a]),o)},Ct="ECDH-ES+XC20PKW",Mt=256,dr=n=>e=>{const t=Re.generateKeyPair(),a=Re.sharedKey(t.secretKey,n),r=kt(a,Mt,Ct),o=St(r)(e);return{encryptedKey:o.ciphertext,tag:o.tag,iv:o.iv,epPubKey:t.publicKey}},mr=n=>(e,t,a,r)=>{const o=Re.sharedKey(n,r),c=kt(o,Mt,Ct);return vt(c)(e,t,a)},hr=n=>{if(Array.isArray(n))return ae.fromSecretKey(ot.Buffer.from(n));if(typeof n=="string")return ae.fromSecretKey(ur(n));if(n instanceof ot.Buffer||n instanceof Uint8Array)return ae.fromSecretKey(n);throw new Error("Incompatible private key format")},pr=async(n=32)=>{const e=ft.randomBytes(n);return Promise.resolve(e)},yr=async(n,e)=>{const t=await dr(dn(e.toBytes()))(n);return{header:$e(re([t.iv,t.tag,t.epPubKey])),encryptedKey:$e(t.encryptedKey)}},gr=async(n,e)=>{const t=Le(n.header),a=t.subarray(0,H),r=t.subarray(H,H+oe),o=t.subarray(H+oe),c=Le(n.encryptedKey),p=hr(e).secretKey,b=mn(p),g=await mr(b)(c,r,a,o);if(g===null)throw new Error("There was a problem decrypting the CEK");return g},fr=async(n,e)=>{const t=await St(e)(lr(n));return $e(re([t.iv,t.ciphertext,t.tag]))},br=async(n,e)=>{const t=Le(n),a=t.subarray(0,H),r=t.subarray(H,-oe),o=t.subarray(-oe),c=await vt(e)(r,o,a);if(c===null)throw new Error("There was an error decoding the message!");return cr(c)};class _r{constructor(e,t){N(this,"programId",ir);this.provider=e,this.keypair=t}get connection(){return this.provider.connection}setKeypair(e){this.keypair=e}async loadAllChannels(){return(await F.gpaBuilder().addFilter("accountDiscriminator",Ve).run(this.provider.connection)).map(t=>({pubkey:t.pubkey,data:F.fromAccountInfo(t.account)[0]}))}async loadChannel(e,t){return F.fromAccountAddress(this.provider.connection,e,t)}async loadMyChannels(){const e=await this.loadMemberships();return console.log(e),[]}async loadChannelMembers(e){return(await T.gpaBuilder().addFilter("accountDiscriminator",ke).addFilter("channel",e).run(this.provider.connection)).map(a=>({pubkey:a.pubkey,data:T.fromAccountInfo(a.account)[0]}))}async loadMemberships(e){return(await T.gpaBuilder().addFilter("accountDiscriminator",ke).addFilter("authority",this.provider.publicKey).addFilter("key",e).run(this.provider.connection)).map(a=>({pubkey:a.pubkey,data:T.fromAccountInfo(a.account)}))}async loadMembership(e,t){return T.fromAccountAddress(this.provider.connection,e,t)}async getMembershipPDA(e,t){return t=t!=null?t:this.keypair.publicKey,await x.findProgramAddress([e.toBuffer(),t.toBuffer()],this.programId)}async encryptCEK(e,t){return yr(e,t!=null?t:this.keypair.publicKey)}async decryptCEK(e,t){return gr(e,t!=null?t:this.keypair.secretKey)}async encryptMessage(e,t){return fr(e,t)}async decryptMessage(e,t){return br(e,t)}async initChannel(e){var b,g,P;const t=(b=e.channel)!=null?b:ae.generate(),a=await pr(),r=await this.encryptCEK(a),[o]=await this.getMembershipPDA(t.publicKey),c=new G;c.add(Za({channel:t.publicKey,membership:o,authority:this.provider.publicKey,key:this.keypair.publicKey},{data:{name:e.name,memberName:(g=e.memberName)!=null?g:"",maxMessages:e.maxMessages,cek:r}}));let p;try{p=await this.provider.sendAndConfirm(c,[t,this.keypair])}catch(E){throw(P=q(E.code))!=null?P:E}return{signature:p,channel:t,cek:a,cekEncrypted:r}}async deleteChannel(e,t){var c;const[a]=await this.getMembershipPDA(e),r=new G;r.add(Qa({channel:e,authority:this.provider.publicKey,authorityMembership:t!=null?t:a}));let o;try{o=await this.provider.sendAndConfirm(r)}catch(p){throw(c=q(p.code))!=null?c:te("Unauthorized")}return{signature:o}}async joinChannel(e){var o;const[t]=await this.getMembershipPDA(e.channel),a=new G;a.add(nr({channel:e.channel,authority:this.provider.publicKey,key:this.keypair.publicKey,membership:t},{data:{name:e.name,authority:e.authority}}));let r;try{r=await this.provider.sendAndConfirm(a,[this.keypair])}catch(c){throw(o=q(c.code))!=null?o:c}return{signature:r}}async addMember(e){var P,E,R;const t=(P=e.key)!=null?P:e.invitee,[a]=await this.getMembershipPDA(e.channel),[r]=await this.getMembershipPDA(e.channel,t),o=await this.loadMembership(a);if(!o.cek.encryptedKey)throw te("Unauthorized");const c=await this.decryptCEK(o.cek),p=await this.encryptCEK(c,t),b=new G;b.add(Ra({channel:e.channel,authority:this.provider.publicKey,invitee:e.invitee,authorityMembership:a,inviteeMembership:r},{data:{name:(E=e.name)!=null?E:"",cek:p,key:t}}));let g;try{g=await this.provider.sendAndConfirm(b)}catch(K){throw(R=q(K.code))!=null?R:te("Unauthorized")}return{signature:g}}async deleteMember(e){var c;const[t]=await this.getMembershipPDA(e.channel),[a]=await this.getMembershipPDA(e.channel,e.key),r=new G;r.add(qa({channel:e.channel,authority:this.provider.publicKey,authorityMembership:t,membership:a}));let o;try{o=await this.provider.sendAndConfirm(r)}catch(p){throw(c=q(p.code))!=null?c:p}return{signature:o}}async authorizeMember(e){var g;const[t]=await this.getMembershipPDA(e.channel),[a]=await this.getMembershipPDA(e.channel,e.key),r=await this.loadMembership(t);if(!r.cek.encryptedKey)throw te("Unauthorized");const o=await this.decryptCEK(r.cek),c=await this.encryptCEK(o,e.key),p=new G;p.add($a({channel:e.channel,membership:a,authority:this.provider.publicKey,authorityMembership:t},{data:{cek:c}}));let b;try{b=await this.provider.sendAndConfirm(p)}catch(P){throw(g=q(P.code))!=null?g:te("Unauthorized")}return{signature:b}}async postMessage(e){var b;const[t]=await this.getMembershipPDA(e.channel),a=await this.loadMembership(t);if(!a.cek.header)throw te("Unauthorized");const r=await this.decryptCEK(a.cek),o=await this.encryptMessage(e.message,r),c=new G;c.add(sr({channel:e.channel,membership:t,authority:this.provider.publicKey},{message:o}));let p;try{p=await this.provider.sendAndConfirm(c)}catch(g){throw(b=q(g.code))!=null?b:g}return{signature:p}}}const wr=Qe("messenger",()=>{const n=je(),e=At(),t=pt(),a=J({allChannels:[],channel:void 0,channelAddr:void 0,channelMembership:void 0,channelMembers:[],channelMessages:[],channelLoading:!1,loading:!1,creating:!1,sending:!1}),r=I(()=>{var d;return new _r(new it(n.connection,(d=t.value)!=null?d:{publicKey:x.default},it.defaultOptions()),e.keypair)});o().then();async function o(){a.loading=!0;const d=await r.value.loadAllChannels();for(const h of d){console.log(`Channel: ${h.pubkey}`),console.log(h.data.pretty());const _=await r.value.loadChannelMembers(h.pubkey);console.log("|-- members:");for(const C of _)console.log(`key: ${C.pubkey}`),console.log(JSON.stringify(C.data.pretty(),null,2))}bt(t,h=>{(h==null?void 0:h.publicKey)&&a.channelAddr&&g(a.channelAddr)}),a.allChannels=d,a.loading=!1}async function c(d,h=15){try{a.creating=!0;const{channel:_}=await r.value.initChannel({name:d,maxMessages:h});await g(_.publicKey),a.channel&&a.allChannels.push({pubkey:_.publicKey,data:a.channel})}finally{a.creating=!1}}async function p(d){const h=new x(d);await r.value.deleteChannel(h),await o()}async function b(d,h){const _=new x(d);await r.value.joinChannel({channel:_,name:h}),await g(d)}async function g(d){var h;a.channelLoading=!0,a.channelAddr=new x(d);try{if((h=t.value)!=null&&h.publicKey)try{const[_]=await r.value.getMembershipPDA(a.channelAddr);a.channelMembership=await r.value.loadMembership(_)}catch(_){console.log(_),a.channelMembership=void 0}await Promise.all([P(),E()])}catch(_){console.log("Error",_)}finally{a.channelLoading=!1}}async function P(){if(!a.channelAddr){console.log("Invalid channel");return}a.channel=await r.value.loadChannel(a.channelAddr);let d;if(a.channelMembership)try{d=await r.value.decryptCEK(a.channelMembership.cek)}catch(h){console.log(h)}a.channelMessages=await Promise.all(a.channel.messages.map(async h=>{let _="***** *** *** *** *******",C=xe(h.sender);const B=a.channelMembers.find(({data:V})=>String(V.authority)===String(h.sender)||String(V.key)===String(h.sender));if(B&&B.data.name!==""&&(C=B.data.name),d)try{_=await r.value.decryptMessage(h.content,d)}catch{console.log(`Failed to decrypt message #${h.id}`)}return{...h,sender:C,content:_}}))}async function E(){if(!a.channelAddr){console.error("Invalid channel");return}a.channelMembers=await r.value.loadChannelMembers(a.channelAddr)}async function R(d){if(!a.channelAddr){console.log("Please select a channel");return}try{a.sending=!0,await r.value.postMessage({channel:a.channelAddr,message:d}),await P()}finally{a.sending=!1}}async function K(d,h,_){if(!a.channelAddr){console.log("Invalid channel");return}await r.value.addMember({channel:a.channelAddr,invitee:new x(d),key:h?new x(h):void 0,name:_})}async function v(d){if(!a.channelAddr){console.log("Invalid channel");return}await r.value.deleteMember({channel:a.channelAddr,key:new x(d)})}async function k(d){if(!a.channelAddr){console.log("Invalid channel");return}await r.value.authorizeMember({channel:a.channelAddr,key:new x(d)}),await P()}return{state:a,client:r.value,loadChannel:g,joinChannel:b,createChannel:c,deleteChannel:p,postMessage:R,addMember:K,deleteMember:v,authorizeMember:k}}),xt=n=>(ut("data-v-f3a8bb6e"),n=n(),dt(),n),Ar={class:"messenger"},kr={class:"row q-gutter-md"},Sr={class:"col col-3"},vr={class:"messenger-add-channel"},Cr={key:1,class:"messenger-channels-empty"},Mr={class:"col"},xr={key:0},Er={class:"row"},Pr={class:"col"},Dr={class:"col"},Ir={class:"channel-name"},zr={key:0,class:"row justify-center"},Kr={key:0,class:"messenger-messages"},Wr={key:1,class:"messenger-empty"},Br={key:1,class:"messenger-empty"},Nr=xt(()=>A("br",null,null,-1)),Tr=xt(()=>A("br",null,null,-1)),Rr=Se({__name:"Messenger",setup(n){const{notify:e}=Ue(),t=ve(),{state:a,postMessage:r,addMember:o,deleteMember:c,authorizeMember:p,createChannel:b,loadChannel:g,deleteChannel:P,joinChannel:E}=wr(),R=At(),K=Oe(!1),v=J({dialog:!1,loading:!1,name:"",authority:""}),k=J({dialog:!1,loading:!1,name:"",authority:"",key:""}),d=J({loading:!1}),h=J({loading:!1}),_=J({dialog:!1,name:"",maxMessages:15}),C=J({message:""}),B=I(()=>!!t.publicKey.value),V=I(()=>{var m;return((m=a.channelMembership)==null?void 0:m.status.__kind)==="Authorized"}),Ge=I(()=>{var m;return((m=a.channelMembership)==null?void 0:m.status.__kind)==="Pending"}),qe=I(()=>{var m,y;return V.value&&((m=a.channel)==null?void 0:m.creator.toString())===((y=t.publicKey.value)==null?void 0:y.toString())}),Je=I(()=>a.allChannels),He=I(()=>a.channelMessages),Xe=I(()=>t.publicKey.value&&a.channel&&!a.sending),Et=I(()=>V.value),Pt=m=>I(()=>{var y;return qe.value&&String(m.key)!==String((y=R.keypair)==null?void 0:y.publicKey)}),Dt=I(()=>B.value&&!V.value),Y=m=>e({type:"positive",message:m,timeout:2e3}),ye=m=>e({type:"info",message:m,timeout:2e3}),ee=m=>e({type:"negative",message:m,timeout:2e3}),Ze=I(()=>a.channelMembers.filter(m=>Ka(m.data.status)).length);async function It(){We()&&(await r(C.message),C.message="")}function zt(){We()&&(_.dialog=!0)}async function Kt(){if(We())try{await b(_.name,_.maxMessages),Wt(),Y("Channel was created!")}catch(m){ee("Something went wrong"),console.log(m)}}function Wt(){_.dialog=!1,_.name="",_.maxMessages=15}async function Bt(){if(k.loading=!0,!a.channelAddr){ye("Please select a channel");return}try{await o(k.authority,k.key,k.name),Ye(),Y("Member was added")}catch(m){ee("Something went wrong"),console.log(m)}finally{k.loading=!1}}function Ye(){k.loading=!1,k.name="",k.authority="",k.key=""}async function Nt(m){try{h.loading=!0,await c(m),Y("Member was deleted")}catch(y){ee("Something went wrong"),console.log(y)}finally{h.loading=!1}}async function Tt(m){try{d.loading=!0,await p(m),Y("Member was authorized")}catch(y){ee("Something went wrong"),console.log(y)}finally{d.loading=!1}}async function Rt(){if(!a.channelAddr){ye("Please select a channel");return}v.loading=!0;try{await E(a.channelAddr,v.name),et(),Y("Request was sent")}catch(m){console.log("Error",m),ee("Something went wrong")}finally{v.loading=!1}}function et(){v.loading=!1,v.dialog=!1,v.name=""}async function Vt(){if(!a.channelAddr){ye("Please select a channel");return}await P(a.channelAddr);try{await P(a.channelAddr),Y("Channel was deleted!")}catch(m){console.log("Error",m),ee("Something went wrong")}finally{v.loading=!1}}async function Ft(m){await g(m)}function We(){return t.publicKey.value?!0:(ye("Please connect wallet"),!1)}function Lt(m){return(m==null?void 0:m.__kind)==="Authorized"?"positive":"grey"}function $t(m){return(m==null?void 0:m.name)&&m.name!==""?m.name:xe(m.authority)}return(m,y)=>(f(),W(j,null,[A("div",Ar,[A("div",kr,[A("div",Sr,[A("div",vr,[s(D,{color:"primary",rounded:"",onClick:zt},{default:l(()=>[M(" Add New Channel ")]),_:1})]),s(Q,{class:"messenger-channels"},{default:l(()=>[w(Je).length>0?(f(),S(Te,{key:0,separator:""},{default:l(()=>[(f(!0),W(j,null,me(w(Je),i=>(f(),S(Ae,{key:i.name,"active-class":"bg-blue-grey-1 text-grey-8",active:String(w(a).channelAddr)===String(i.pubkey)},{default:l(()=>[s(ne,{class:"cursor-pointer",onClick:tt=>Ft(i.pubkey)},{default:l(()=>[s(de,null,{default:l(()=>[M(z(i.data.name),1)]),_:2},1024),s(de,{caption:"",lines:"2"},{default:l(()=>[A("div",null,"members: "+z(i.data.memberCount),1),A("div",null,"messages: "+z(i.data.messageCount),1)]),_:2},1024)]),_:2},1032,["onClick"])]),_:2},1032,["active"]))),128))]),_:1})):(f(),W("div",Cr," No channels ")),s(ce,{showing:w(a).loading,color:"primary"},null,8,["showing"])]),_:1})]),A("div",Mr,[w(a).channel?(f(),W("div",xr,[A("div",Er,[A("div",Pr,[s(hn,{rounded:"",unelevated:""},{default:l(()=>[w(Et)?(f(),S(D,{key:0,color:"secondary","text-color":"dark",loading:k.loading,onClick:y[0]||(y[0]=i=>k.dialog=!0)},{default:l(()=>[M(" add\xA0member ")]),_:1},8,["loading"])):$("",!0),w(Dt)?(f(),S(D,{key:1,color:"secondary","text-color":"dark",loading:v.loading,disable:w(Ge),onClick:y[1]||(y[1]=i=>v.dialog=!0)},{default:l(()=>[M(z(w(Ge)?"pending\xA0request":"join\xA0channel"),1)]),_:1},8,["loading","disable"])):$("",!0),w(B)?(f(),S(D,{key:2,color:"blue-grey",onClick:y[2]||(y[2]=i=>K.value=!0)},{default:l(()=>[M(" members "),w(Ze)>0?(f(),S(lt,{key:0,color:"info",rounded:"",floating:""},{default:l(()=>[M(z(w(Ze)),1)]),_:1})):$("",!0)]),_:1})):$("",!0),w(qe)?(f(),S(D,{key:3,color:"negative",onClick:Vt},{default:l(()=>[M(" delete ")]),_:1})):$("",!0)]),_:1})]),A("div",Dr,[A("div",Ir,z(w(a).channel.name),1)])])])):$("",!0),s(Q,{class:"messenger-card overflow-hidden"},{default:l(()=>[w(a).channel?(f(),W("div",zr,[w(He).length>0?(f(),W("div",Kr,[(f(!0),W(j,null,me(w(He),i=>(f(),S(pn,{key:i.id,name:i.sender,text:[i.content],sent:i.sender===w(t).publicKey.value},null,8,["name","text","sent"]))),128))])):(f(),W("div",Wr," No messages "))])):(f(),W("div",Br," Please select a channel ")),s(ge,{class:"channel-form",onSubmit:fe(It,["prevent"])},{default:l(()=>[s(mt,{class:"bg-primary text-white row"},{default:l(()=>[s(O,{ref:"inputFocus",modelValue:C.message,"onUpdate:modelValue":y[3]||(y[3]=i=>C.message=i),class:"col-grow q-mr-sm","bg-color":"white",placeholder:"Type a message",dense:"",outlined:"",rounded:"",autofocus:"",disable:!w(Xe)},null,8,["modelValue","disable"]),s(D,{rounded:"",flat:"",type:"submit",disable:!w(Xe),loading:w(a).sending},{default:l(()=>[M(" Send ")]),_:1},8,["disable","loading"])]),_:1})]),_:1},8,["onSubmit"]),s(ce,{showing:w(a).channelLoading},null,8,["showing"])]),_:1})])])]),s(ue,{modelValue:_.dialog,"onUpdate:modelValue":y[6]||(y[6]=i=>_.dialog=i),class:"new-channel-dialog"},{default:l(()=>[s(Q,null,{default:l(()=>[s(U,null,{default:l(()=>[s(ge,{class:"messenger-new-channel-form",onSubmit:fe(Kt,["prevent"])},{default:l(()=>[s(O,{modelValue:_.name,"onUpdate:modelValue":y[4]||(y[4]=i=>_.name=i),label:"Channel name *","lazy-rules":"",rules:[i=>i&&i.length>2||"Please type something"]},null,8,["modelValue","rules"]),s(O,{modelValue:_.maxMessages,"onUpdate:modelValue":y[5]||(y[5]=i=>_.maxMessages=i),label:"Max messages","lazy-rules":"",rules:[i=>+i>0||"Invalid value"]},null,8,["modelValue","rules"]),s(D,{type:"submit",color:"info",ripple:!1,rounded:""},{default:l(()=>[M(" Create Channel ")]),_:1})]),_:1},8,["onSubmit"]),s(ce,{showing:w(a).creating},null,8,["showing"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(ue,{modelValue:k.dialog,"onUpdate:modelValue":y[10]||(y[10]=i=>k.dialog=i),class:"add-member-dialog",onHide:Ye},{default:l(()=>[s(Q,null,{default:l(()=>[s(U,null,{default:l(()=>[s(ge,{class:"add-member-form",onSubmit:fe(Bt,["prevent"])},{default:l(()=>[s(O,{modelValue:k.name,"onUpdate:modelValue":y[7]||(y[7]=i=>k.name=i),label:"Member name *","lazy-rules":"",rules:[i=>i&&i.length>2||"Please type something"]},null,8,["modelValue","rules"]),s(O,{modelValue:k.key,"onUpdate:modelValue":y[8]||(y[8]=i=>k.key=i),label:"Member Wallet *","lazy-rules":"",rules:[i=>i&&i.length>32||"Invalid public key"]},null,8,["modelValue","rules"]),s(O,{modelValue:k.key,"onUpdate:modelValue":y[9]||(y[9]=i=>k.key=i),label:"Member Device Key *","lazy-rules":"",rules:[i=>i&&i.length>32||"Invalid public key"]},null,8,["modelValue","rules"]),Nr,s(D,{type:"submit",color:"info",ripple:!1,rounded:""},{default:l(()=>[M(" Add Member ")]),_:1})]),_:1},8,["onSubmit"]),s(ce,{showing:k.loading},null,8,["showing"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(ue,{modelValue:v.dialog,"onUpdate:modelValue":y[13]||(y[13]=i=>v.dialog=i),class:"join-channel-dialog",onHide:et},{default:l(()=>[s(Q,null,{default:l(()=>[s(U,null,{default:l(()=>[s(ge,{class:"join-channel-form",onSubmit:fe(Rt,["prevent"])},{default:l(()=>[s(O,{modelValue:v.name,"onUpdate:modelValue":y[11]||(y[11]=i=>v.name=i),placeholder:"Member name *","lazy-rules":"",rules:[i=>i&&i.length>2||"Please type something"]},null,8,["modelValue","rules"]),s(O,{modelValue:v.authority,"onUpdate:modelValue":y[12]||(y[12]=i=>v.authority=i),placeholder:"Authorize By","lazy-rules":"",rules:[i=>!i||i&&i.length>32||"Invalid public key"]},null,8,["modelValue","rules"]),Tr,s(D,{type:"submit",color:"info",ripple:!1,rounded:""},{default:l(()=>[M(" Join Channel ")]),_:1})]),_:1},8,["onSubmit"]),s(ce,{showing:v.loading},null,8,["showing"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(ue,{modelValue:K.value,"onUpdate:modelValue":y[14]||(y[14]=i=>K.value=i)},{default:l(()=>[s(Q,null,{default:l(()=>[s(U,null,{default:l(()=>[s(Te,{separator:""},{default:l(()=>[(f(!0),W(j,null,me(w(a).channelMembers,i=>(f(),S(Ae,{key:i.pubkey.toString()},{default:l(()=>[s(ne,null,{default:l(()=>[s(de,null,{default:l(()=>[M(z($t(i.data)),1)]),_:2},1024),s(de,{caption:"",lines:"2"},{default:l(()=>[A("div",null,"Authority: "+z(i.data.authority),1),A("div",null,"Key: "+z(i.data.key),1)]),_:2},1024)]),_:2},1024),s(ne,{side:"",top:""},{default:l(()=>[s(lt,{color:Lt(i.data.status)},{default:l(()=>[M(z(i.data.status.__kind),1)]),_:2},1032,["color"]),i.data.status.__kind==="Pending"&&w(V)&&(!i.data.status.authority||String(i.data.status.authority)===String(w(t).publicKey.value))?(f(),S(D,{key:0,color:"primary",rounded:"",size:"sm",unelevated:"",class:"q-mt-sm",loading:d.loading,disabled:d.loading,onClick:tt=>Tt(i.data.key)},{default:l(()=>[M(" Authorize ")]),_:2},1032,["loading","disabled","onClick"])):$("",!0),Pt(i.data)?(f(),S(D,{key:1,color:"negative",rounded:"",size:"sm",unelevated:"",class:"q-mt-sm",loading:h.loading,disabled:h.loading,onClick:tt=>Nt(i.data.key)},{default:l(()=>[M(" Delete ")]),_:2},1032,["loading","disabled","onClick"])):$("",!0)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}});const Vr=pe(Rr,[["__scopeId","data-v-f3a8bb6e"]]);const Fr={},Lr={class:"container"},$r={class:"messenger-container"};function Ur(n,e){const t=Vr;return f(),S(yn,null,{default:l(()=>[A("div",Lr,[A("div",$r,[s(t)])])]),_:1})}const Or=pe(Fr,[["render",Ur],["__scopeId","data-v-8856bd2a"]]),Qr=()=>ht(()=>import("./_...all_.9b498eeb.js"),["assets/_...all_.9b498eeb.js","assets/_...all_.73169310.css","assets/vendor.94f2b619.js"]),jr=[{name:"index",path:"/",component:Or,props:!0},{name:"all",path:"/:all(.*)*",component:Qr,props:!0,meta:{layout:"empty"}}],Gr=Ia(jr),qr="/sol-messenger/",Jr=gn({history:fn(qr),scrollBehavior:()=>({left:0,top:0}),strict:!0,routes:Gr}),Hr=({app:n})=>{n.use(Jr)},Xr=Object.freeze(Object.defineProperty({__proto__:null,install:Hr},Symbol.toStringTag,{value:"Module"})),Zr=({app:n})=>{n.use(bn,{wallets:[new _n,new wn,new An,new kn,new Sn,new vn,new Cn,new Mn,new xn,new En,new Pn,new Dn,new In,new zn,new Kn,new Wn,new Bn,new Nn,new Tn,new Rn,new Vn,new Fn,new Ln,new $n,new Un,new On,new Qn,new jn,new Gn,new qn],autoConnect:!1})},Yr=Object.freeze(Object.defineProperty({__proto__:null,install:Zr},Symbol.toStringTag,{value:"Module"})),es=Jn();function ts(){return es}const ns=Symbol("WALLET_CONNECT_EVENT"),as=Symbol("WALLET_DISCONNECT_EVENT"),rs=Symbol("ACCOUNT_CHANGE_EVENT"),Ne=5e3;function ss(){const{connection:n}=je(),{emit:e}=ts(),{notify:t}=Ue(),{wallet:a}=ve();bt(a,r=>{if(!r)return;const o=()=>{const b=r.publicKey;n.onAccountChange(b,g=>{console.log("ACCOUNT_CHANGE_EVENT",g),e(rs,g)}),n.onLogs(b,g=>{console.log(g)}),t({message:"Wallet update",caption:`Connected to wallet ${xe(b.toBase58(),7)}`,timeout:Ne}),e(ns,r)},c=()=>{t({message:"Wallet update",caption:"Disconnected from wallet",timeout:Ne}),e(as,r)},p=b=>{!(b!=null&&b.message)||t({type:"negative",message:"Wallet update",caption:b.message,timeout:Ne})};r.once("connect",o),r.once("disconnect",c),r.removeAllListeners("error"),r.on("error",p)},{immediate:!0})}const os=Se({__name:"App",setup(n){return Hn(()=>{ss()}),(e,t)=>{const a=Ce("router-view");return f(),S(a)}}});async function is(){const n=Xn(os);Object.values(Object.assign({"./plugins/pinia.ts":Yn,"./plugins/quasar.ts":ta,"./plugins/router.ts":Xr,"./plugins/wallet.ts":Yr})).forEach(e=>{var t;return(t=e.install)==null?void 0:t.call(e,{app:n})}),n.mount("#app")}is().then();export{pe as _};
