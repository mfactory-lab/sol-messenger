var Xt=Object.defineProperty;var Zt=(t,e,n)=>e in t?Xt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var F=(t,e,n)=>(Zt(t,typeof e!="symbol"?e+"":e,n),n);import{c as Yt,Q as en,P as tn,D as nn,N as an,a as sn,i as on,u as fe,b as je,d as N,o as p,e as S,f as m,g as E,w as pe,v as ln,h as u,F as Q,r as Y,t as T,j as O,k as y,l as W,m as ge,n as rn,p as cn,S as un,q as A,s as d,x as Ct,y as K,z as r,A as ee,B as U,C as De,E as dn,G as X,H as G,I as mn,J as de,K as Et,W as Mt,L as Be,M as Ne,O as Ke,R as hn,T as Dt,U as Me,V as ze,X as se,Y as pn,Z as yt,_ as _t,$ as fn,a0 as gn,a1 as It,a2 as Je,a3 as bn,a4 as Ce,a5 as ct,a6 as yn,a7 as Pt,a8 as Ee,a9 as _n,aa as Kt,ab as vn,ac as wn,ad as f,ae as re,af as Lt,ag as be,ah as ye,ai as We,aj as zt,ak as Ie,al as Cn,am as Ge,an as Tt,ao as ht,ap as Mn,aq as An,ar as kn,as as Sn,at as xn,au as me,av as oe,aw as At,ax as ce,ay as $n,az as Le,aA as He,aB as vt,aC as ue,aD as Re,aE as En,aF as Dn,aG as Bt,aH as In,aI as Xe,aJ as kt,aK as Pn,aL as Kn,aM as Ln,aN as zn,aO as Tn,aP as Bn,aQ as Nn,aR as Wn,aS as Rn,aT as On,aU as qn,aV as Vn,aW as Un,aX as Fn,aY as jn,aZ as Qn,a_ as Jn,a$ as Gn,b0 as Hn,b1 as Xn,b2 as Zn,b3 as Yn,b4 as ea,b5 as ta,b6 as na,b7 as aa,b8 as sa,b9 as oa,ba as ia,bb as la,bc as ra,bd as ca,be as ua,bf as da,bg as ma,bh as ha,bi as pa,bj as fa,bk as ga,bl as ba,bm as ya,bn as _a,bo as va,bp as wa,bq as Ca,br as Ma,bs as Aa,bt as ka}from"./vendor.c082b873.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerpolicy&&(a.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?a.credentials="include":s.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(s){if(s.ep)return;s.ep=!0;const a=n(s);fetch(s.href,a)}})();const Sa=({app:t})=>{const e=Yt();t.use(e)},xa=Object.freeze(Object.defineProperty({__proto__:null,install:Sa},Symbol.toStringTag,{value:"Module"})),$a=({app:t})=>{t.use(en,{plugins:{Dark:tn,Dialog:nn,Notify:an,LocalStorage:sn},iconSet:on})},Ea=Object.freeze(Object.defineProperty({__proto__:null,install:$a},Symbol.toStringTag,{value:"Module"}));function Da(){const{dark:t}=fe(),e=je("theme-mode",t.isActive);return t.set(e.value),{isActive:e,set(n){t.set(n),e.value=t.isActive},toggle(){t.toggle(),e.value=t.isActive}}}const Te=[],Nt={id:"devnet",name:"DevNet",cluster:"devnet",url:"https://devnet.rpcpool.com/"};Te.push(Nt);var $t;const Ia=($t=Te.find(t=>t.id==={VITE_USER_NODE_ENV:"production",BASE_URL:"/",MODE:"staging",DEV:!1,PROD:!0}.VITE_CONNECTION_ENDPOINT))!=null?$t:Nt,Pa="confirmed",Ka=12e4,St=[`<span>Public channels</span> are non-encrypted and available to anyone, both for reading and writing.</br></br>
    <span>Public channels</span> are encrypted, and new users need to request approval to join them.</br>
    Depending on the \u2018Members can approve\u2019 setting, such requests can be approved either by channel\u2019s 
    owner/admin only, or by any authorized member of the channel.
    `,"Any authorized channel member can approve new requests to join"],La="https://twitter.com/JPoolSolana",za="https://t.me/jpool_solana",Ta="https://t.me/jpoolsolana",Ba="https://discord.gg/qR4BA9QXVR",Na="https://jfactory.ch",Wa="https://jpool.one",Ra="https://svt.one",Oa="https://staking.kiwi/",qa={class:"container"},Va={class:"footer-section"},Ua={class:"footer-info"},Fa={class:"theme"},ja={class:"switch"},Qa=m("span",{class:"slider round"},null,-1),Ja=m("div",{class:"copyright"},[E(" \xA9 Copyright 2022 cgram.one. All rights reserved."),m("br"),E("Powered by jFactory ")],-1),Ga={class:"footer-links"},Ha={class:"social"},Xa=["href"],Za=m("span",null,[E("official"),m("br"),E("channel")],-1),Ya=[Za],es=["href"],ts=["href"],ns=["href"],as=["href"],ss=N({__name:"AppFooter",setup(t){const e=Da(),n=[{name:"JFACTORY",link:Na},{name:"JPOOL",link:Wa},{name:"STAKING KIWI",link:Oa},{name:"SOLANA VALIDATOR TOOLKIT",link:Ra}];return(i,s)=>(p(),S("footer",null,[m("div",qa,[m("div",Va,[m("div",Ua,[m("div",Fa,[E(" Dark mode "),m("label",ja,[pe(m("input",{"onUpdate:modelValue":s[0]||(s[0]=a=>u(e).isActive.value=a),type:"checkbox",onClick:s[1]||(s[1]=(...a)=>u(e).toggle&&u(e).toggle(...a))},null,512),[[ln,u(e).isActive.value]]),Qa])]),Ja]),m("div",Ga,[m("div",Ha,[m("a",{href:u(za),target:"_blank",class:"social-link social-link-text"},Ya,8,Xa),m("a",{href:u(Ta),target:"_blank",class:"social-link telegram"},null,8,es),m("a",{href:u(La),target:"_blank",class:"social-link twitter"},null,8,ts),m("a",{href:u(Ba),target:"_blank",class:"social-link discord"},null,8,ns)]),m("nav",null,[m("ul",null,[(p(),S(Q,null,Y(n,({name:a,link:o})=>m("li",{key:a},[m("a",{target:"_blank",href:o},T(a),9,as)])),64))])])])])])]))}});function os(){const t=O(is());return{userAgent:t,isMobileOs:y(()=>ls(t.value)),isWebView:y(()=>rs(t.value))}}let ut;function is(){var t,e;return ut===void 0&&(ut=(e=(t=globalThis.navigator)==null?void 0:t.userAgent)!=null?e:null),ut}function ls(t){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)}function rs(t){return/(WebView|(Phantom|Solflare)|Version\/.+(Chrome)\/(\d+)\.(\d+)\.(\d+)\.(\d+)|; wv\).+(Chrome)\/(\d+)\.(\d+)\.(\d+)\.(\d+))/i.test(t)}function Ze(t,e=4){return t instanceof W&&(t=t.toBase58()),`${t.slice(0,e)}...${t.slice(-e)}`}function Wt(t){return(t==null?void 0:t.name)&&t.name!==""?t.name:Ze(t.authority)}const Rt=t=>{if(!t)return{background:"#000"};let e=0;for(let i=0;i<t.length;i++)e=t.charCodeAt(i)+((e<<5)-e),e=e&e;let n="#";for(let i=0;i<3;i++)n+=`00${(e>>i*8&255).toString(16)}`.substr(-2);return{background:n}},cs="/assets/clover.968404b0.svg",us="/assets/ledger.40cf6861.svg",ds="/assets/mathwallet.1d763e81.svg",Ye=t=>(Be("data-v-269ee747"),t=t(),Ne(),t),ms=Ye(()=>m("div",{class:"text-h6 text-center"}," Your wallet ",-1)),hs={class:"q-gutter-md row justify-between"},ps=Ye(()=>m("span",{name:"wallet"},"Disconnect",-1)),fs=Ye(()=>m("span",{name:"wallet"},"Ok",-1)),gs=Ye(()=>m("div",{class:"text-h6"}," Connect to a wallet ",-1)),bs={class:"text-light-gray text-caption full-width text-no-wrap",style:{"text-overflow":"ellipsis",overflow:"hidden"}},ys=["src","alt"],_s=N({__name:"ConnectWallet",setup(t){const e={priority:{solflare:10,phantom:20,sollet:5,nufi:5,blocto:1},icons:{clover:cs},darkIcons:{ledger:us,mathwallet:ds},deepLinks:{phantom:"https://phantom.app/ul/browse/{uri}?ref={ref}",solflare:"https://solflare.com/ul/browse/{uri}?ref={ref}"}},{userAgent:n,isWebView:i,isMobileOs:s}=os(),a={close:Et},o=x=>[Mt.Installed,Mt.Loadable].includes(x.readyState);fe();const l=ge(),{connected:c,connecting:h}=l;rn();const b=y(()=>s.value&&!i.value);if(i.value){const x=String(n.value).toLowerCase();x.includes("phantom")?(l.select(cn),l.connect()):x.includes("solflare")&&(l.select(un),l.connect())}const _=y(()=>{var x,C;return(C=(x=l.publicKey.value)==null?void 0:x.toBase58())!=null?C:""}),w=y(()=>Ze(_.value)),M=y(()=>[...l.wallets.value].map(x=>{var k,J;const C=x.adapter.name.toLowerCase();return x.adapter.icon=(J=(k=e.darkIcons[C])!=null?k:e.icons[C])!=null?J:x.adapter.icon,b.value&&e.deepLinks[C]&&(x.deepLink=e.deepLinks[C].replace("{uri}",location.href).replace("{ref}",location.origin)),x}).sort((x,C)=>{var ne,Se;const k=(ne=e.priority[x.adapter.name.toLowerCase()])!=null?ne:1;return((Se=e.priority[C.adapter.name.toLowerCase()])!=null?Se:1)-k+((o(C)?1:0)-(o(x)?1:0))})),$=y(()=>b.value?M.value.filter(x=>!!x.deepLink):M.value),q=O(!1);async function D(x){await l.select(x.adapter.name),q.value=!1,await l.connect()}function v(){q.value=!1,l.disconnect()}function L(){q.value=!0}function V(){q.value=!1}return(x,C)=>(p(),S(Q,null,[u(c)?(p(),A(K,Ct({key:0},x.$attrs,{ripple:!1,color:"primary-gray","text-color":"white",square:"",unelevated:"",onClick:L}),{default:d(()=>[E(T(u(w)),1)]),_:1},16)):(p(),A(K,Ct({key:1},x.$attrs,{color:"primary-gray",class:"q-pa-none btn","text-color":"white",square:"",flat:"",ripple:!1,loading:u(h),onClick:L}),{default:d(()=>[E(" CONNECT WALLET ")]),_:1},16,["loading"])),r(de,{modelValue:q.value,"onUpdate:modelValue":C[0]||(C[0]=k=>q.value=k),"transition-duration":"150","transition-show":"fade","transition-hide":"fade"},{default:d(()=>[u(c)?(p(),A(ee,{key:0},{default:d(()=>[r(U,{class:"relative-position"},{default:d(()=>[ms,r(K,{padding:"md",color:"transparent","text-color":"primary-gray",unelevated:"",class:"absolute-right",icon:a.close,size:"md",onClick:V},null,8,["icon"])]),_:1}),r(De),r(U,null,{default:d(()=>[E(T(u(_)),1)]),_:1}),r(De),r(U,null,{default:d(()=>[m("div",hs,[r(K,{class:"disconnect-btn","text-color":"black",square:"",flat:"",onClick:v},{default:d(()=>[ps]),_:1}),r(K,{class:"disconnect-btn","text-color":"black",square:"",flat:"",onClick:V},{default:d(()=>[fs]),_:1})])]),_:1})]),_:1})):(p(),A(ee,{key:1,class:"wallet-connect-card"},{default:d(()=>[r(U,null,{default:d(()=>[gs,r(K,{padding:"md",color:"transparent","text-color":"primary-gray",unelevated:"",class:"absolute-right",icon:a.close,size:"md",onClick:V},null,8,["icon"])]),_:1}),r(De),r(U,{style:{"max-height":"80vh"},class:"scroll"},{default:d(()=>[r(dn,{grid:"",rows:u($),"row-key":"name","hide-pagination":"","hide-header":"","rows-per-page-options":[100]},{item:d(({row:k})=>[(p(),S("div",{key:`wallet-${k.adapter.name}`,class:"col-12 col-md-6"},[r(X,{clickable:"",href:k.deepLink,onClick:J=>k.deepLink?!0:D(k)},{default:d(()=>[r(G,null,{default:d(()=>[m("b",null,T(k.adapter.name),1),m("div",bs,T(k.adapter.url),1)]),_:2},1024),r(G,{avatar:""},{default:d(()=>[r(mn,{square:""},{default:d(()=>[m("img",{src:k.adapter.icon,alt:k.adapter.name},null,8,ys)]),_:2},1024)]),_:2},1024)]),_:2},1032,["href","onClick"])]))]),_:1},8,["rows"])]),_:1})]),_:1}))]),_:1},8,["modelValue"])],64))}});const te=(t,e)=>{const n=t.__vccOpts||t;for(const[i,s]of e)n[i]=s;return n},vs=te(_s,[["__scopeId","data-v-269ee747"]]),et=Ke({id:"connection",state:()=>({commitment:Pa,confirmTransactionInitialTimeout:Ka,rpc:hn("rpc","")}),getters:{endpoint(t){var e;return(e=Te.find(n=>n.id===t.rpc))!=null?e:Ia},connection(t){return console.log("[connection]",this.endpoint.url),new Dt(this.endpoint.url,{confirmTransactionInitialTimeout:t.confirmTransactionInitialTimeout,commitment:t.commitment})},cluster(){return this.endpoint.cluster}},actions:{setRpc(t){this.rpc=t},setCommitment(t){this.commitment=t}}}),ws=N({__name:"ClusterSelector",setup(t){const e=et(),{connected:n,connect:i,disconnect:s,autoConnect:a}=ge(),o=[Te.filter(h=>h.cluster==="mainnet-beta"),Te.filter(h=>h.cluster!=="mainnet-beta")],l=y(()=>e.endpoint),c=h=>{n&&e.cluster!==h.cluster&&(s(),a.value&&i()),e.setRpc(h.id)};return(h,b)=>(p(),A(pn,{label:u(l).name,"model-value":!1,"auto-close":"",color:"secondary","text-color":"#000",square:"",unelevated:"",ripple:!1},{default:d(()=>[r(Me,null,{default:d(()=>[(p(),S(Q,null,Y(o,(_,w)=>(p(),S(Q,{key:`${w}-cluster-group`},[(p(!0),S(Q,null,Y(_,M=>(p(),A(X,{key:M.id,clickable:"",onClick:$=>c(M)},{default:d(()=>[(p(),A(G,{key:`${M.id}-item`},{default:d(()=>[r(ze,null,{default:d(()=>[m("b",null,T(M.name),1)]),_:2},1024),E(" "+T(M.url),1)]),_:2},1024))]),_:2},1032,["onClick"]))),128)),w!==o.length-1?(p(),A(De,{key:0})):se("",!0)],64))),64))]),_:1})]),_:1},8,["label"]))}});const Cs={},Ms={class:"app-header"},As={class:"container"},ks={class:"app-header__info"},Ss={class:"app-header__logo"},xs={class:"logo-wrapper"},$s=m("div",{class:"app-header__title"},[m("h1",null,[E("BLOCKCHAIN "),m("br"),E(" messenger "),m("span",{class:"marked"},"SOLANA")])],-1),Es={class:"app-header__right"},Ds={class:"app-header__buttons"};function Is(t,e){const n=yt("router-link"),i=ws,s=vs;return p(),S("header",Ms,[m("div",As,[m("div",ks,[m("div",Ss,[m("div",xs,[r(n,{to:"/"})])]),$s]),r(_t),m("div",Es,[m("div",Ds,[r(i,{class:"app-header__cluster-btn header-btn"}),r(s,{class:"app-header__wallet-btn header-btn"})])])])])}const Ps=te(Cs,[["render",Is]]),Ks={};function Ls(t,e){const n=Ps,i=yt("router-view"),s=ss;return p(),A(fn,{view:"lfh Lpr lff"},{default:d(()=>[r(n),r(gn,null,{default:d(()=>[r(i)]),_:1}),r(s)]),_:1})}const zs=te(Ks,[["render",Ls]]),Ts={default:zs,empty:()=>It(()=>import("./empty.810ab358.js"),["assets/empty.810ab358.js","assets/vendor.c082b873.js"])};function Bs(t){return t.map(e=>{var n;return{path:e.path,component:Ts[((n=e.meta)==null?void 0:n.layout)||"default"],children:[{...e,path:""}]}})}const Ns="/assets/search.b4fadb1c.svg",Ws="/assets/transfer.796e9da5.svg",Rs="/assets/plus.ee413328.svg",Os={class:"how-it-works"},qs={class:"app-info"},Vs=m("div",{class:"app-info__title"}," JOIN A CHANNEL ",-1),Us={class:"app-info__list"},Fs=["innerHTML"],js={class:"app-info"},Qs=m("div",{class:"app-info__title"}," CREATE YOUR OWN CHANNEL ",-1),Js={class:"app-info__list"},Gs=["innerHTML"],Hs=N({__name:"HowItWorks",setup(t){const e=["For <span>public channels</span>, you can read or send messages without limitations.",`In order to join one of the existing private channels, click
        <img src="${Ns}" class="icon" alt="search">
        (BROWSE CHANNELS) at the bottom of the left-side panel.`,`Find a channel you are interested in and click
        <img src="${Ws}" class="icon" alt="transfer">
        (REQUEST TO JOIN). Your status for that channel will be set to Pending
        Approval until your request has been accepted. While awaiting approval,
        all messages in the channel will appear scrambled.`,`After the private channel's owner or admin approves your membership,your
        status will change to Authorized. You will be able to read the channel
        and send messages.`],n=["You can create a channel of your own as well.",`Click <img src="${Rs}" class="icon" alt="search"> (CREATE A CHANNEL) 
  at the bottom of the left-side panel, then choose between Private and Public options.`,"A public channel is open to anyone for reading and writing, and no encryption is used.",`If you create a private channel, joining it will require your approval. You will see a red 
  notification badge above the channel list if there are approval requests pending.`];return(i,s)=>(p(),S("div",Os,[m("div",qs,[Vs,m("ul",Us,[(p(),S(Q,null,Y(e,a=>m("li",{key:a},[m("p",{innerHTML:a},null,8,Fs)])),64))])]),m("div",js,[Qs,m("ul",Js,[(p(),S(Q,null,Y(n,a=>m("li",{key:a},[m("p",{innerHTML:a},null,8,Gs)])),64))])])]))}});const Oe=Ke("user",()=>{const t=Je(),e=O();bn(()=>{var l;const o=(l=t.value)==null?void 0:l.publicKey;if(o){const c=je(o.toString(),()=>ct.encode(Ce.generate().secretKey));n(c.value)}else e.value=void 0});function n(o){e.value=Ce.fromSecretKey(ct.decode(o))}function i(){var c;const o=(c=t.value)==null?void 0:c.publicKey;if(!o)return;const l=je(o.toString(),"");n(l.value=ct.encode(Ce.generate().secretKey))}function s(o){var h;const l=(h=t.value)==null?void 0:h.publicKey;if(!l)return;const c=je(l.toString(),"");n(c.value=o)}async function a(){var b;const o=(b=t.value)==null?void 0:b.publicKey;return await await new Dt(yn("devnet"),"confirmed").getBalance(o)/Pt>.1}return{keypair:e,generateKey:i,importKey:s,userBalance:a}}),Xs=t=>(Be("data-v-b77c7ee6"),t=t(),Ne(),t),Zs=Xs(()=>m("div",{class:"text-h6 text-center"}," Device Key ",-1)),Ys={class:"q-gutter-md row justify-between"},eo=N({__name:"UserInfoDialog",emits:["regenerate"],setup(t){const e=Oe(),n=()=>{var i,s;return wn(String((s=(i=e.keypair)==null?void 0:i.publicKey)!=null?s:""))};return(i,s)=>(p(),A(de,{class:"dialog-wrapper","transition-duration":"150","transition-show":"fade","transition-hide":"fade"},{default:d(()=>[r(ee,{square:"",flat:""},{default:d(()=>[r(U,{class:"row items-center"},{default:d(()=>[Zs,r(_t),pe(r(K,{flat:"",round:"",dense:"",icon:u(Et)},null,8,["icon"]),[[Ee]])]),_:1}),r(De),r(U,null,{default:d(()=>{var a;return[r(K,{flat:"",round:"",dense:"",icon:u(_n),onClick:n},{default:d(()=>[r(Kt,{delay:0,anchor:"bottom middle",self:"top middle","transition-duration":"0"},{default:d(()=>[E(" Copy to clipboard ")]),_:1})]),_:1},8,["icon"]),m("span",null,T((a=u(e).keypair)==null?void 0:a.publicKey),1)]}),_:1}),r(De),r(vn,{align:"right"},{default:d(()=>[m("div",Ys,[r(K,{class:"disconnect-btn","text-color":"black",square:"",flat:"",onClick:u(e).generateKey},{default:d(()=>[E(" Regenerate ")]),_:1},8,["onClick"])])]),_:1})]),_:1})]),_:1}))}});const to=te(eo,[["__scopeId","data-v-b77c7ee6"]]),no="0.0.8",ao="messenger",so=[{name:"initChannel",accounts:[{name:"channel",isMut:!0,isSigner:!0},{name:"membership",isMut:!0,isSigner:!1},{name:"authority",isMut:!0,isSigner:!0},{name:"key",isMut:!1,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"data",type:{defined:"InitChannelData"}}]},{name:"deleteChannel",accounts:[{name:"channel",isMut:!0,isSigner:!1},{name:"authorityMembership",isMut:!0,isSigner:!1},{name:"authority",isMut:!0,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"joinChannel",accounts:[{name:"channel",isMut:!0,isSigner:!1},{name:"membership",isMut:!0,isSigner:!1},{name:"authority",isMut:!0,isSigner:!0},{name:"key",isMut:!1,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"data",type:{defined:"JoinChannelData"}}]},{name:"leaveChannel",accounts:[{name:"channel",isMut:!0,isSigner:!1},{name:"membership",isMut:!0,isSigner:!1},{name:"authority",isMut:!0,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"grantAccessMember",accounts:[{name:"channel",isMut:!1,isSigner:!1},{name:"membership",isMut:!0,isSigner:!1},{name:"authorityMembership",isMut:!1,isSigner:!1},{name:"authority",isMut:!0,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"data",type:{defined:"GrantAccessMemberData"}}]},{name:"addMember",accounts:[{name:"channel",isMut:!0,isSigner:!1},{name:"invitee",isMut:!1,isSigner:!1},{name:"inviteeMembership",isMut:!0,isSigner:!1},{name:"authorityMembership",isMut:!0,isSigner:!1},{name:"authority",isMut:!0,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"data",type:{defined:"AddMemberData"}}]},{name:"authorizeMember",accounts:[{name:"channel",isMut:!1,isSigner:!1},{name:"membership",isMut:!0,isSigner:!1},{name:"authority",isMut:!1,isSigner:!0},{name:"authorityMembership",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"data",type:{defined:"AuthorizeMemberData"}}]},{name:"deleteMember",accounts:[{name:"channel",isMut:!0,isSigner:!1},{name:"membership",isMut:!0,isSigner:!1},{name:"authorityMembership",isMut:!1,isSigner:!1},{name:"authority",isMut:!0,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"postMessage",accounts:[{name:"channel",isMut:!0,isSigner:!1},{name:"membership",isMut:!1,isSigner:!1},{name:"authority",isMut:!1,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"message",type:"string"}]}],oo=[{name:"Channel",type:{kind:"struct",fields:[{name:"name",docs:["Name of the channel"],type:"string"},{name:"creator",docs:["Channel creator"],type:"publicKey"},{name:"createdAt",docs:["Creation date"],type:"i64"},{name:"flags",docs:["Channel flags"],type:"u8"},{name:"memberCount",docs:["Number of members"],type:"u16"},{name:"messageCount",docs:["Message counter"],type:"u32"},{name:"maxMessages",docs:["The maximum number of messages that are stored in [messages]"],type:"u16"},{name:"messages",docs:["List of messages"],type:{vec:{defined:"Message"}}}]}},{name:"ChannelMembership",type:{kind:"struct",fields:[{name:"channel",docs:["Associated [Channel] address"],type:"publicKey"},{name:"authority",docs:["Authority of membership"],type:"publicKey"},{name:"key",docs:["The device key used to encrypt the `CEK`"],type:"publicKey"},{name:"cek",docs:["The content encryption key (CEK) of the channel"],type:{defined:"CEKData"}},{name:"status",docs:["Status of membership"],type:{defined:"ChannelMembershipStatus"}},{name:"name",docs:["Name of the channel member"],type:"string"},{name:"invitedBy",docs:["Inviter address"],type:{option:"publicKey"}},{name:"createdAt",docs:["Creation date"],type:"i64"},{name:"flags",docs:["Membership flags"],type:"u8"},{name:"bump",docs:["Bump seed for deriving PDA seeds"],type:"u8"}]}}],io=[{name:"AddMemberData",type:{kind:"struct",fields:[{name:"name",docs:["Member name"],type:"string"},{name:"flags",docs:["Membership flags, only `admin` and `owner` can set membership flags"],type:"u8"},{name:"cek",docs:["Content Encryption Key"],type:{defined:"CEKData"}},{name:"key",docs:["Device key"],type:{option:"publicKey"}}]}},{name:"AuthorizeMemberData",type:{kind:"struct",fields:[{name:"cek",type:{defined:"CEKData"}}]}},{name:"GrantAccessMemberData",type:{kind:"struct",fields:[{name:"flags",type:"u8"}]}},{name:"InitChannelData",type:{kind:"struct",fields:[{name:"name",type:"string"},{name:"maxMessages",type:"u16"},{name:"memberName",type:"string"},{name:"cek",type:{defined:"CEKData"}},{name:"public",type:"bool"},{name:"permissionless",type:"bool"}]}},{name:"JoinChannelData",type:{kind:"struct",fields:[{name:"name",type:"string"},{name:"authority",type:{option:"publicKey"}}]}},{name:"CEKData",type:{kind:"struct",fields:[{name:"header",docs:["The header information for the CEK"],type:"string"},{name:"encryptedKey",docs:["The CEK itself"],type:"string"}]}},{name:"Message",type:{kind:"struct",fields:[{name:"id",docs:["Uniq message id"],type:"u32"},{name:"sender",docs:["The message sender id"],type:"publicKey"},{name:"createdAt",docs:["The unix timestamp at which the message was received"],type:"i64"},{name:"flags",docs:["Message flags"],type:"u8"},{name:"content",docs:["The (typically encrypted) message content"],type:"string"}]}},{name:"ChannelMembershipStatus",type:{kind:"enum",variants:[{name:"Authorized",fields:[{name:"by",type:{option:"publicKey"}}]},{name:"Pending",fields:[{name:"authority",type:{option:"publicKey"}}]}]}}],lo=[{name:"NewChannelEvent",fields:[{name:"channel",type:"publicKey",index:!0},{name:"creator",type:"publicKey",index:!1},{name:"name",type:"string",index:!1},{name:"timestamp",type:"i64",index:!1}]},{name:"DeleteChannelEvent",fields:[{name:"channel",type:"publicKey",index:!0},{name:"creator",type:"publicKey",index:!1},{name:"timestamp",type:"i64",index:!1}]},{name:"NewMessageEvent",fields:[{name:"channel",type:"publicKey",index:!0},{name:"message",type:{defined:"Message"},index:!1}]},{name:"JoinChannelEvent",fields:[{name:"channel",type:"publicKey",index:!0},{name:"membership",type:"publicKey",index:!0},{name:"timestamp",type:"i64",index:!1}]},{name:"LeaveChannelEvent",fields:[{name:"channel",type:"publicKey",index:!0},{name:"authority",type:"publicKey",index:!0},{name:"timestamp",type:"i64",index:!1}]},{name:"AddMemberEvent",fields:[{name:"channel",type:"publicKey",index:!0},{name:"membership",type:"publicKey",index:!0},{name:"by",type:"publicKey",index:!1},{name:"timestamp",type:"i64",index:!1}]},{name:"AuthorizeMemberEvent",fields:[{name:"channel",type:"publicKey",index:!0},{name:"membership",type:"publicKey",index:!0},{name:"by",type:"publicKey",index:!1},{name:"timestamp",type:"i64",index:!1}]},{name:"DeleteMemberEvent",fields:[{name:"channel",type:"publicKey",index:!0},{name:"membership",type:"publicKey",index:!0},{name:"by",type:"publicKey",index:!1},{name:"timestamp",type:"i64",index:!1}]}],ro=[{code:6e3,name:"Unauthorized",msg:"Unauthorized"},{code:6001,name:"InvalidChannel",msg:"Invalid channel"},{code:6002,name:"InvalidMembership",msg:"Invalid membership"},{code:6003,name:"InvalidMessage",msg:"Invalid message"},{code:6004,name:"NameTooLong",msg:"Name too long"},{code:6005,name:"MessageTooLong",msg:"Message too long"}],co={address:"6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm",origin:"anchor",binaryVersion:"0.25.0",libVersion:"0.25.0"},uo={version:no,name:ao,instructions:so,accounts:oo,types:io,events:lo,errors:ro,metadata:co},mo=new f.FixableBeetArgsStruct([["id",f.u32],["sender",re],["createdAt",f.i64],["flags",f.u8],["content",f.utf8String]],"Message"),pt=[49,159,99,106,220,87,219,88];class le{constructor(e,n,i,s,a,o,l,c){this.name=e,this.creator=n,this.createdAt=i,this.flags=s,this.memberCount=a,this.messageCount=o,this.maxMessages=l,this.messages=c}static fromArgs(e){return new le(e.name,e.creator,e.createdAt,e.flags,e.memberCount,e.messageCount,e.maxMessages,e.messages)}static fromAccountInfo(e,n=0){return le.deserialize(e.data,n)}static async fromAccountAddress(e,n,i){const s=await e.getAccountInfo(n,i);if(s==null)throw new Error(`Unable to find Channel account at ${n}`);return le.fromAccountInfo(s,0)[0]}static gpaBuilder(e=new W("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){return Lt.fromStruct(e,Ue)}static deserialize(e,n=0){return Ue.deserialize(e,n)}serialize(){return Ue.serialize({accountDiscriminator:pt,...this})}static byteSize(e){const n=le.fromArgs(e);return Ue.toFixedFromValue({accountDiscriminator:pt,...n}).byteSize}static async getMinimumBalanceForRentExemption(e,n,i){return n.getMinimumBalanceForRentExemption(le.byteSize(e),i)}pretty(){return{name:this.name,creator:this.creator.toBase58(),createdAt:(()=>{const e=this.createdAt;if(typeof e.toNumber=="function")try{return e.toNumber()}catch{return e}return e})(),flags:this.flags,memberCount:this.memberCount,messageCount:this.messageCount,maxMessages:this.maxMessages,messages:this.messages}}}const Ue=new f.FixableBeetStruct([["accountDiscriminator",f.uniformFixedSizeArray(f.u8,8)],["name",f.utf8String],["creator",re],["createdAt",f.i64],["flags",f.u8],["memberCount",f.u16],["messageCount",f.u32],["maxMessages",f.u16],["messages",f.array(mo)]],le.fromArgs,"Channel"),tt=new f.FixableBeetArgsStruct([["header",f.utf8String],["encryptedKey",f.utf8String]],"CEKData"),ho=f.dataEnum([["Authorized",new f.FixableBeetArgsStruct([["by",f.coption(re)]],'ChannelMembershipStatusRecord["Authorized"]')],["Pending",new f.FixableBeetArgsStruct([["authority",f.coption(re)]],'ChannelMembershipStatusRecord["Pending"]')]]),Qe=[238,149,255,251,116,131,86,170];class Z{constructor(e,n,i,s,a,o,l,c,h,b){this.channel=e,this.authority=n,this.key=i,this.cek=s,this.status=a,this.name=o,this.invitedBy=l,this.createdAt=c,this.flags=h,this.bump=b}static fromArgs(e){return new Z(e.channel,e.authority,e.key,e.cek,e.status,e.name,e.invitedBy,e.createdAt,e.flags,e.bump)}static fromAccountInfo(e,n=0){return Z.deserialize(e.data,n)}static async fromAccountAddress(e,n,i){const s=await e.getAccountInfo(n,i);if(s==null)throw new Error(`Unable to find ChannelMembership account at ${n}`);return Z.fromAccountInfo(s,0)[0]}static gpaBuilder(e=new W("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){return Lt.fromStruct(e,Fe)}static deserialize(e,n=0){return Fe.deserialize(e,n)}serialize(){return Fe.serialize({accountDiscriminator:Qe,...this})}static byteSize(e){const n=Z.fromArgs(e);return Fe.toFixedFromValue({accountDiscriminator:Qe,...n}).byteSize}static async getMinimumBalanceForRentExemption(e,n,i){return n.getMinimumBalanceForRentExemption(Z.byteSize(e),i)}pretty(){return{channel:this.channel.toBase58(),authority:this.authority.toBase58(),key:this.key.toBase58(),cek:this.cek,status:this.status.__kind,name:this.name,invitedBy:this.invitedBy,createdAt:(()=>{const e=this.createdAt;if(typeof e.toNumber=="function")try{return e.toNumber()}catch{return e}return e})(),flags:this.flags,bump:this.bump}}}const Fe=new f.FixableBeetStruct([["accountDiscriminator",f.uniformFixedSizeArray(f.u8,8)],["channel",re],["authority",re],["key",re],["cek",tt],["status",ho],["name",f.utf8String],["invitedBy",f.coption(re)],["createdAt",f.i64],["flags",f.u8],["bump",f.u8]],Z.fromArgs,"ChannelMembership"),Ae=new Map,ke=new Map;class nt extends Error{constructor(){super("Unauthorized");F(this,"code",6e3);F(this,"name","Unauthorized");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,nt)}}Ae.set(6e3,()=>new nt);ke.set("Unauthorized",()=>new nt);class at extends Error{constructor(){super("Invalid channel");F(this,"code",6001);F(this,"name","InvalidChannel");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,at)}}Ae.set(6001,()=>new at);ke.set("InvalidChannel",()=>new at);class st extends Error{constructor(){super("Invalid membership");F(this,"code",6002);F(this,"name","InvalidMembership");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,st)}}Ae.set(6002,()=>new st);ke.set("InvalidMembership",()=>new st);class ot extends Error{constructor(){super("Invalid message");F(this,"code",6003);F(this,"name","InvalidMessage");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,ot)}}Ae.set(6003,()=>new ot);ke.set("InvalidMessage",()=>new ot);class it extends Error{constructor(){super("Name too long");F(this,"code",6004);F(this,"name","NameTooLong");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,it)}}Ae.set(6004,()=>new it);ke.set("NameTooLong",()=>new it);class lt extends Error{constructor(){super("Message too long");F(this,"code",6005);F(this,"name","MessageTooLong");typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,lt)}}Ae.set(6005,()=>new lt);ke.set("MessageTooLong",()=>new lt);function he(t){const e=Ae.get(t);return e!=null?e():null}function $e(t){const e=ke.get(t);return e!=null?e():null}const po=new f.FixableBeetArgsStruct([["name",f.utf8String],["flags",f.u8],["cek",tt],["key",f.coption(re)]],"AddMemberData"),fo=new f.FixableBeetArgsStruct([["instructionDiscriminator",f.uniformFixedSizeArray(f.u8,8)],["data",po]],"AddMemberInstructionArgs"),go=[13,116,123,130,126,198,57,34];function bo(t,e,n=new W("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){var o;const[i]=fo.serialize({instructionDiscriminator:go,...e}),s=[{pubkey:t.channel,isWritable:!0,isSigner:!1},{pubkey:t.invitee,isWritable:!1,isSigner:!1},{pubkey:t.inviteeMembership,isWritable:!0,isSigner:!1},{pubkey:t.authorityMembership,isWritable:!0,isSigner:!1},{pubkey:t.authority,isWritable:!0,isSigner:!0},{pubkey:(o=t.systemProgram)!=null?o:be.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const l of t.anchorRemainingAccounts)s.push(l);return new ye({programId:n,keys:s,data:i})}const yo=new f.FixableBeetArgsStruct([["cek",tt]],"AuthorizeMemberData"),_o=new f.FixableBeetArgsStruct([["instructionDiscriminator",f.uniformFixedSizeArray(f.u8,8)],["data",yo]],"AuthorizeMemberInstructionArgs"),vo=[194,123,189,175,86,225,93,128];function wo(t,e,n=new W("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){var o;const[i]=_o.serialize({instructionDiscriminator:vo,...e}),s=[{pubkey:t.channel,isWritable:!1,isSigner:!1},{pubkey:t.membership,isWritable:!0,isSigner:!1},{pubkey:t.authority,isWritable:!1,isSigner:!0},{pubkey:t.authorityMembership,isWritable:!0,isSigner:!1},{pubkey:(o=t.systemProgram)!=null?o:be.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const l of t.anchorRemainingAccounts)s.push(l);return new ye({programId:n,keys:s,data:i})}const Co=new f.BeetArgsStruct([["instructionDiscriminator",f.uniformFixedSizeArray(f.u8,8)]],"DeleteChannelInstructionArgs"),Mo=[145,225,187,221,157,142,114,133];function Ao(t,e=new W("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){var a;const[n]=Co.serialize({instructionDiscriminator:Mo}),i=[{pubkey:t.channel,isWritable:!0,isSigner:!1},{pubkey:t.authorityMembership,isWritable:!0,isSigner:!1},{pubkey:t.authority,isWritable:!0,isSigner:!0},{pubkey:(a=t.systemProgram)!=null?a:be.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const o of t.anchorRemainingAccounts)i.push(o);return new ye({programId:e,keys:i,data:n})}const ko=new f.BeetArgsStruct([["instructionDiscriminator",f.uniformFixedSizeArray(f.u8,8)]],"DeleteMemberInstructionArgs"),So=[95,14,98,112,252,218,205,173];function xo(t,e=new W("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){var a;const[n]=ko.serialize({instructionDiscriminator:So}),i=[{pubkey:t.channel,isWritable:!0,isSigner:!1},{pubkey:t.membership,isWritable:!0,isSigner:!1},{pubkey:t.authorityMembership,isWritable:!1,isSigner:!1},{pubkey:t.authority,isWritable:!0,isSigner:!0},{pubkey:(a=t.systemProgram)!=null?a:be.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const o of t.anchorRemainingAccounts)i.push(o);return new ye({programId:e,keys:i,data:n})}const $o=new f.BeetArgsStruct([["flags",f.u8]],"GrantAccessMemberData");new f.BeetArgsStruct([["instructionDiscriminator",f.uniformFixedSizeArray(f.u8,8)],["data",$o]],"GrantAccessMemberInstructionArgs");const Eo=new f.FixableBeetArgsStruct([["name",f.utf8String],["maxMessages",f.u16],["memberName",f.utf8String],["cek",tt],["public",f.bool],["permissionless",f.bool]],"InitChannelData"),Do=new f.FixableBeetArgsStruct([["instructionDiscriminator",f.uniformFixedSizeArray(f.u8,8)],["data",Eo]],"InitChannelInstructionArgs"),Io=[21,200,152,39,19,178,76,47];function Po(t,e,n=new W("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){var o;const[i]=Do.serialize({instructionDiscriminator:Io,...e}),s=[{pubkey:t.channel,isWritable:!0,isSigner:!0},{pubkey:t.membership,isWritable:!0,isSigner:!1},{pubkey:t.authority,isWritable:!0,isSigner:!0},{pubkey:t.key,isWritable:!1,isSigner:!0},{pubkey:(o=t.systemProgram)!=null?o:be.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const l of t.anchorRemainingAccounts)s.push(l);return new ye({programId:n,keys:s,data:i})}const Ko=new f.FixableBeetArgsStruct([["name",f.utf8String],["authority",f.coption(re)]],"JoinChannelData"),Lo=new f.FixableBeetArgsStruct([["instructionDiscriminator",f.uniformFixedSizeArray(f.u8,8)],["data",Ko]],"JoinChannelInstructionArgs"),zo=[124,39,115,89,217,26,38,29];function To(t,e,n=new W("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){var o;const[i]=Lo.serialize({instructionDiscriminator:zo,...e}),s=[{pubkey:t.channel,isWritable:!0,isSigner:!1},{pubkey:t.membership,isWritable:!0,isSigner:!1},{pubkey:t.authority,isWritable:!0,isSigner:!0},{pubkey:t.key,isWritable:!1,isSigner:!0},{pubkey:(o=t.systemProgram)!=null?o:be.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const l of t.anchorRemainingAccounts)s.push(l);return new ye({programId:n,keys:s,data:i})}const Bo=new f.BeetArgsStruct([["instructionDiscriminator",f.uniformFixedSizeArray(f.u8,8)]],"LeaveChannelInstructionArgs"),No=[104,0,75,134,95,80,68,186];function Wo(t,e=new W("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){var a;const[n]=Bo.serialize({instructionDiscriminator:No}),i=[{pubkey:t.channel,isWritable:!0,isSigner:!1},{pubkey:t.membership,isWritable:!0,isSigner:!1},{pubkey:t.authority,isWritable:!0,isSigner:!0},{pubkey:(a=t.systemProgram)!=null?a:be.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const o of t.anchorRemainingAccounts)i.push(o);return new ye({programId:e,keys:i,data:n})}const Ro=new f.FixableBeetArgsStruct([["instructionDiscriminator",f.uniformFixedSizeArray(f.u8,8)],["message",f.utf8String]],"PostMessageInstructionArgs"),Oo=[214,50,100,209,38,34,7,76];function qo(t,e,n=new W("6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm")){var o;const[i]=Ro.serialize({instructionDiscriminator:Oo,...e}),s=[{pubkey:t.channel,isWritable:!0,isSigner:!1},{pubkey:t.membership,isWritable:!1,isSigner:!1},{pubkey:t.authority,isWritable:!1,isSigner:!0},{pubkey:(o=t.systemProgram)!=null?o:be.programId,isWritable:!1,isSigner:!1}];if(t.anchorRemainingAccounts!=null)for(const l of t.anchorRemainingAccounts)s.push(l);return new ye({programId:n,keys:s,data:i})}const Vo="6RSutwAoRcQPAMwyxZdNeG76fdAxzhgxkCJXpqKCBPdm",Uo=new W(Vo);function ft(t,e=new Uint8Array(4)){const n=We(t.toString(),"base10");return e.set(n,4-n.length),e}const dt=t=>Ie([ft(t.length),t]);function Ot(t,e,n){if(e!==256)throw new Error(`Unsupported key length: ${e}`);const i=Ie([dt(We(n)),dt(new Uint8Array(0)),dt(new Uint8Array(0)),ft(e)]),s=1;return Cn.hash(Ie([ft(s),t,i]))}const gt=t=>We(t,"base64pad"),bt=t=>zt(t,"base64pad"),Fo=t=>We(t),jo=t=>zt(t),Qo=t=>We(t,"base58btc"),we=Ge.NONCE_LENGTH,Pe=Ge.TAG_LENGTH,qt=t=>{const e=new Ge.XChaCha20Poly1305(t);return(n,i)=>{const s=Tt.randomBytes(we),a=e.seal(s,n,i);return{ciphertext:a.subarray(0,a.length-Pe),tag:a.subarray(a.length-Pe),iv:s}}},Vt=t=>{const e=new Ge.XChaCha20Poly1305(t);return(n,i,s,a)=>e.open(s,Ie([n,i]),a)},Ut="ECDH-ES+XC20PKW",Ft=256,Jo=t=>e=>{const n=ht.generateKeyPair(),i=ht.sharedKey(n.secretKey,t),s=Ot(i,Ft,Ut),a=qt(s)(e);return{encryptedKey:a.ciphertext,tag:a.tag,iv:a.iv,epPubKey:n.publicKey}},Go=t=>(e,n,i,s)=>{const a=ht.sharedKey(t,s),o=Ot(a,Ft,Ut);return Vt(o)(e,n,i)},Ho=t=>Array.isArray(t)?Ce.fromSecretKey(kn.Buffer.from(t)):typeof t=="string"?Ce.fromSecretKey(Qo(t)):Ce.fromSecretKey(t),Xo=async(t=32)=>{const e=Tt.randomBytes(t);return Promise.resolve(e)},Zo=async(t,e)=>{const n=await Jo(Mn(e.toBytes()))(t);return{header:bt(Ie([n.iv,n.tag,n.epPubKey])),encryptedKey:bt(n.encryptedKey)}},Yo=async(t,e)=>{const n=gt(t.header),i=n.subarray(0,we),s=n.subarray(we,we+Pe),a=n.subarray(we+Pe),o=gt(t.encryptedKey),l=Ho(e).secretKey,c=An(l),h=await Go(c)(o,s,i,a);if(h===null)throw new Error("There was a problem decrypting the CEK");return h},ei=async(t,e)=>{const n=await qt(e)(Fo(t));return bt(Ie([n.iv,n.ciphertext,n.tag]))},ti=async(t,e)=>{const n=gt(t),i=n.subarray(0,we),s=n.subarray(we,-Pe),a=n.subarray(-Pe),o=await Vt(e)(s,a,i);if(o===null)throw new Error("There was an error decoding the message!");return jo(o)};class ni{constructor(e,n){F(this,"programId",Uo);F(this,"_coder");F(this,"_events");F(this,"utils",{channel:{isPublic:e=>(e.flags&1)>0,isPermissionless:e=>(e.flags&2)>0},member:{isOwner:e=>e.flags>=255,isAdmin:e=>(e.flags&7)===7,canAddMember:e=>(e.flags&1)>0,canDeleteMember:e=>(e.flags&2)>0,canAuthorizeMember:e=>(e.flags&4)>0},message:{isEncrypted:e=>(e.flags&1)>0}});this.provider=e,this.keypair=n,this._coder=new Sn(uo),this._events=new xn(this.programId,e,this._coder)}get connection(){return this.provider.connection}addEventListener(e,n){return this._events.addEventListener(e,n)}async removeEventListener(e){return await this._events.removeEventListener(e)}setKeypair(e){this.keypair=e}async loadAllChannels(){return(await le.gpaBuilder().addFilter("accountDiscriminator",pt).run(this.provider.connection)).map(n=>({pubkey:n.pubkey,data:le.fromAccountInfo(n.account)[0]}))}async loadChannel(e,n){return le.fromAccountAddress(this.provider.connection,e,n)}async loadMyChannels(){return await this.loadMemberships()}async loadChannelMembers(e){return(await Z.gpaBuilder().addFilter("accountDiscriminator",Qe).addFilter("channel",e).run(this.provider.connection)).map(i=>({pubkey:i.pubkey,data:Z.fromAccountInfo(i.account)[0]}))}async loadMemberships(e){const n=Z.gpaBuilder().addFilter("accountDiscriminator",Qe).addFilter("authority",this.provider.publicKey);return e&&n.addFilter("key",e),(await n.run(this.provider.connection)).map(s=>({pubkey:s.pubkey,data:Z.fromAccountInfo(s.account)}))}async loadMembership(e,n){return Z.fromAccountAddress(this.provider.connection,e,n)}async getMembershipPDA(e,n){return n=n!=null?n:this.keypair.publicKey,await W.findProgramAddress([e.toBuffer(),n.toBuffer()],this.programId)}async encryptCEK(e,n){return Zo(e,n!=null?n:this.keypair.publicKey)}async decryptCEK(e,n){return Yo(e,n!=null?n:this.keypair.secretKey)}async encryptMessage(e,n){return ei(e,n)}async decryptMessage(e,n){return ti(e,n)}async initChannel(e){var h,b,_,w,M;const n=(h=e.channel)!=null?h:Ce.generate(),i=await Xo(),s=await this.encryptCEK(i),[a]=await this.getMembershipPDA(n.publicKey),o=this.provider.publicKey,l=new me;l.add(Po({key:this.keypair.publicKey,channel:n.publicKey,membership:a,authority:o},{data:{name:e.name,public:(b=e.public)!=null?b:!1,permissionless:(_=e.permissionless)!=null?_:!1,memberName:(w=e.memberName)!=null?w:"",maxMessages:e.maxMessages,cek:s}}));let c;try{c=await this.provider.sendAndConfirm(l,[n,this.keypair],e.opts)}catch($){throw(M=he($.code))!=null?M:$}return{signature:c,channel:n,cek:i,cekEncrypted:s}}async deleteChannel({channel:e,opts:n}){var l;const i=this.provider.publicKey,[s]=await this.getMembershipPDA(e),a=new me;a.add(Ao({channel:e,authority:i,authorityMembership:s}));let o;try{o=await this.provider.sendAndConfirm(a,void 0,n)}catch(c){throw(l=he(c.code))!=null?l:$e("Unauthorized")}return{signature:o}}async joinChannel(e){var o,l;const[n]=await this.getMembershipPDA(e.channel),i=this.provider.publicKey,s=new me;s.add(To({channel:e.channel,key:this.keypair.publicKey,membership:n,authority:i},{data:{name:e.name,authority:(o=e.authority)!=null?o:null}}));let a;try{a=await this.provider.sendAndConfirm(s,[this.keypair],e.opts)}catch(c){throw(l=he(c.code))!=null?l:c}return{signature:a}}async leaveChannel(e){var o;const[n]=await this.getMembershipPDA(e.channel),i=this.provider.publicKey,s=new me;s.add(Wo({channel:e.channel,membership:n,authority:i}));let a;try{a=await this.provider.sendAndConfirm(s)}catch(l){throw(o=he(l.code))!=null?o:l}return{signature:a}}async addMember(e){var b,_,w,M;const n=(b=e.key)!=null?b:e.invitee,[i]=await this.getMembershipPDA(e.channel),[s]=await this.getMembershipPDA(e.channel,n),a=await this.loadMembership(i);if(!a.cek.encryptedKey)throw $e("Unauthorized");const o=await this.decryptCEK(a.cek),l=await this.encryptCEK(o,n),c=new me;c.add(bo({channel:e.channel,authority:this.provider.publicKey,invitee:e.invitee,authorityMembership:i,inviteeMembership:s},{data:{name:(_=e.name)!=null?_:"",flags:(w=e.flags)!=null?w:0,cek:l,key:n}}));let h;try{h=await this.provider.sendAndConfirm(c)}catch($){throw(M=he($.code))!=null?M:$e("Unauthorized")}return{signature:h}}async deleteMember(e){var l;const[n]=e.membership?[e.membership]:await this.getMembershipPDA(e.channel,e.key),[i]=await this.getMembershipPDA(e.channel),s=this.provider.publicKey,a=new me;a.add(xo({channel:e.channel,membership:n,authority:s,authorityMembership:i}));let o;try{o=await this.provider.sendAndConfirm(a)}catch(c){throw(l=he(c.code))!=null?l:c}return{signature:o}}async authorizeMember(e){var h;const[n]=await this.getMembershipPDA(e.channel),[i]=await this.getMembershipPDA(e.channel,e.key),s=await this.loadMembership(n);if(!s.cek.encryptedKey)throw $e("Unauthorized");const a=await this.decryptCEK(s.cek),o=await this.encryptCEK(a,e.key),l=new me;l.add(wo({channel:e.channel,membership:i,authority:this.provider.publicKey,authorityMembership:n},{data:{cek:o}}));let c;try{c=await this.provider.sendAndConfirm(l)}catch(b){throw(h=he(b.code))!=null?h:$e("Unauthorized")}return{signature:c}}async postMessage(e){var l;const[n]=await this.getMembershipPDA(e.channel);let i,s=0;if(e.encrypt){const c=await this.loadMembership(n);if(!c.cek.header)throw $e("Unauthorized");const h=await this.decryptCEK(c.cek);i=await this.encryptMessage(e.message,h),s|=1}else i=e.message;const a=new me;a.add(qo({channel:e.channel,membership:n,authority:this.provider.publicKey},{message:String.fromCharCode(s)+i}));let o;try{o=await this.provider.sendAndConfirm(a)}catch(c){throw(l=he(c.code))!=null?l:c}return{signature:o}}}const xt=t=>"***** *** *** *** *******",j=Ke("messenger",()=>{const t=et(),e=Oe(),n=Je(),i=y(()=>e.keypair),s={allChannels:[],ownChannels:[],channel:void 0,channelAddr:void 0,channelMembershipAddr:void 0,channelMembership:void 0,channelMembers:[],channelMessages:[],channelLoading:!1,loading:!1,creating:!1,sending:!1},a=oe({...s}),o=y(()=>{var g;return new ni(new At(t.connection,(g=n.value)!=null?g:{publicKey:W.default},At.defaultOptions()),e.keypair)});let l=[];ce(n,g=>{g?b().then():_()},{immediate:!0}),ce([i,()=>a.allChannels],()=>{c().then()},{immediate:!0});async function c(){var z;const I=(await o.value.loadMemberships((z=e.keypair)==null?void 0:z.publicKey)).map(R=>({pubkey:R.data[0].channel.toBase58(),status:R.data[0].status.__kind}));a.ownChannels=I,console.log("myChannels ====== ",a.ownChannels)}async function h(){console.log("Register events...");for(const g of l)await o.value.removeEventListener(g);l.push(o.value.addEventListener("NewMessageEvent",async g=>{if(console.log("[Event] NewMessageEvent",g),`${g.channel}`!=`${a.channelAddr}`)return;let I=g.message.content;if(o.value.utils.message.isEncrypted(g.message)){const R=await v();R?I=await o.value.decryptMessage(g.message.content,R):I=xt(g.message.content)}a.channelMessages.push({...g.message,content:I})})),l.push(o.value.addEventListener("AuthorizeMemberEvent",async g=>{console.log("[Event] AuthorizeMemberEvent",g),!(a.channelAddr&&`${g.channel}`!=`${a.channelAddr}`)&&(`${g.membership}`==`${a.channelMembershipAddr}`?D(a.channelAddr).then():V().then())})),l.push(o.value.addEventListener("JoinChannelEvent",async g=>{console.log("[Event] JoinChannelEvent",g),`${g.channel}`==`${a.channelAddr}`&&V().then()})),l.push(o.value.addEventListener("LeaveChannelEvent",async g=>{console.log("[Event] LeaveChannelEvent",g),`${g.channel}`==`${a.channelAddr}`&&V().then()}))}async function b(){_(),l=[],a.loading=!0;const g=await o.value.loadAllChannels();await h(),a.allChannels=g,a.loading=!1,console.log(a)}function _(){Object.assign(a,s)}async function w(g,I){var z,R;try{a.creating=!0;const{channel:ie}=await o.value.initChannel({name:g,maxMessages:(z=I.maxMessages)!=null?z:15,public:I.public,permissionless:I.permissionless,opts:{commitment:(R=I.commitment)!=null?R:"confirmed"}});await D(ie.publicKey),a.channel&&a.allChannels.push({pubkey:ie.publicKey,data:a.channel})}finally{a.creating=!1}}async function M(g){const I=new W(g);await o.value.deleteChannel({channel:I,opts:{commitment:"confirmed"}}),qe(g)}async function $(g){console.log("leaveChannel channel === ",g.toBase58()),await o.value.leaveChannel({channel:g,opts:{commitment:"confirmed"}}),qe(g)}async function q(g,I){const z=new W(g);try{await o.value.joinChannel({channel:z,name:I,opts:{commitment:"confirmed"}}),await D(g);const R={pubkey:g.toString(),status:"Pending"};a.ownChannels.push(R)}catch(R){console.log(R)}}async function D(g){var I,z,R,ie;a.channelLoading=!0,a.channelMessages=(I=a.channelMessages)!=null?I:[],a.channelMembers=(z=a.channelMembers)!=null?z:[],a.channelMembershipAddr=void 0,a.channelMembership=(R=a.channelMembership)!=null?R:void 0,a.channelAddr=new W(g);try{if((ie=n.value)!=null&&ie.publicKey)try{const[ae]=await o.value.getMembershipPDA(a.channelAddr);a.channelMembershipAddr=ae,a.channelMembership=await o.value.loadMembership(ae)}catch(ae){console.log(ae),a.channelMembershipAddr=void 0,a.channelMembership=void 0}await V(),await L()}catch(ae){console.log("Error",ae)}finally{a.channelLoading=!1}}async function v(){if(!!a.channelMembership)try{return await o.value.decryptCEK(a.channelMembership.cek)}catch(g){console.log(g)}}async function L(){if(!a.channelAddr){console.log("Invalid channel");return}a.channel=await o.value.loadChannel(a.channelAddr);const I=o.value.utils.channel.isPublic(a.channel)?null:await v();a.channelMessages=await Promise.all(a.channel.messages.map(async z=>{var Ve;let ie=o.value.utils.message.isEncrypted(z)?xt(z.content):z.content,ae=Ze(z.sender);if((Ve=n.value)!=null&&Ve.publicKey){const xe=a.channelMembers.find(({data:B})=>B.name!==""&&(`${B.authority}`==`${z.sender}`||`${B.key}`==`${z.sender}`));xe&&xe.data.name!==""&&(ae=xe.data.name)}if(I)try{ie=await o.value.decryptMessage(z.content,I)}catch{console.log(`Failed to decrypt message #${z.id}`)}return{...z,senderDisplayName:ae,content:ie}}))}async function V(){if(!a.channelAddr){console.error("Invalid channel");return}a.channelMembers=await x()}async function x(g=a.channelAddr){return await o.value.loadChannelMembers(g)}async function C(g){if(!a.channelAddr){console.log("Please select a channel");return}try{a.sending=!0;let I;a.channel&&(I=o.value.utils.channel.isPublic(a.channel)),await o.value.postMessage({channel:a.channelAddr,message:g,encrypt:!I}),await L()}finally{a.sending=!1}}async function k(g,I,z,R){if(!a.channelAddr){console.log("Invalid channel");return}await o.value.addMember({channel:a.channelAddr,invitee:new W(g),key:I?new W(I):void 0,name:z,flags:R,opts:{commitment:"confirmed"}})}async function J(g){if(!a.channelAddr){console.log("Invalid channel");return}await o.value.deleteMember({channel:a.channelAddr,key:new W(g),opts:{commitment:"finalized"}})}async function ne(g){if(!a.channelAddr){console.log("Invalid channel");return}await o.value.authorizeMember({channel:a.channelAddr,key:new W(g)}),await H()}async function Se(){await b()}async function H(){a.channelMembers=await x()}async function P(g){a.channelAddr=g}function qe(g){const I=a.allChannels.findIndex(z=>z.pubkey.toBase58()===g.toString());a.allChannels.splice(I,1),a.channelMessages=[],a.channel=void 0}return{state:a,client:o.value,leaveChannel:$,loadChannel:D,joinChannel:q,createChannel:w,deleteChannel:M,postMessage:C,addMember:k,deleteMember:J,authorizeMember:ne,refreshList:Se,loadMembers:x,selectChannel:P}}),_e=Ke("channel",()=>{const t=Je(),{state:e,client:n}=j(),i=y(()=>e.channelLoading),s=y(()=>e.sending),a=y(()=>{var k;return!!((k=t.value)!=null&&k.publicKey)}),o=y(()=>!!e.channel&&n.utils.channel.isPublic(e.channel)),l=y(()=>!!e.channel&&n.utils.channel.isPermissionless(e.channel)),c=y(()=>{var k;return((k=e.channelMembership)==null?void 0:k.status.__kind)==="Authorized"}),h=y(()=>{var k;return((k=e.channelMembership)==null?void 0:k.status.__kind)==="Pending"}),b=y(()=>{var k,J,ne;return String((k=e.channel)==null?void 0:k.creator)===String((ne=(J=t.value)==null?void 0:J.publicKey)!=null?ne:"-")}),_=y(()=>!!e.channelMembership&&n.utils.member.canAddMember(e.channelMembership)),w=y(()=>!!e.channelMembership&&n.utils.member.canAuthorizeMember(e.channelMembership)),M=y(()=>!!e.channelMembership&&n.utils.member.canDeleteMember(e.channelMembership)),$=y(()=>!!e.channelMembership&&n.utils.member.isAdmin(e.channelMembership)),q=y(()=>!!e.channelMembership&&n.utils.member.isOwner(e.channelMembership)),D=y(()=>a.value&&!!e.channel&&!e.loading&&!c.value),v=y(()=>a.value),L=y(()=>q.value),V=y(()=>q.value),x=y(()=>!e.sending&&(o.value||c.value));return{ownChannels:y(()=>e.allChannels.filter(k=>{var J;return!!e.ownChannels.find(ne=>ne.pubkey===k.pubkey.toBase58())||k.data.flags===1||k.data.creator.toBase58()===String((J=t.value)==null?void 0:J.publicKey)})),isChannelLoading:i,isSendMessage:s,isPublicChannel:o,isWalletConnected:a,isPermissionlessChannel:l,isAuthorizedMember:c,isPendingMember:h,isChannelCreator:b,isAdmin:$,isOwner:q,canJoinChannel:D,canAddMember:_,canAuthorizeMember:w,canDeleteMember:M,canCreateChannel:v,canDeleteChannel:L,canGrantAccess:V,canPostMessage:x}}),ai={class:"text-weight-medium wallet"},si={class:"memberlist-info__details"},oi=m("span",null,"Authority:",-1),ii={class:"memberlist-info__details"},li=m("span",null,"Key:",-1),ri={class:"memberlist-btns"},ci=N({__name:"MemberListDialog",props:{membersDialog:{type:Boolean,default:!1},authorizeMemberState:{type:Object},deleteMemberState:{type:Object},wallet:{type:Object}},emits:["submit","deleteMember"],setup(t,{emit:e}){const{state:n}=j(),i=_e(),s=l=>l==="Pending"&&i.canAuthorizeMember;function a(l){return String(l).toLowerCase()}const o=l=>{var c;return((c=n.channel)==null?void 0:c.creator.toBase58())===l};return(l,c)=>(p(),A(de,{class:"memberlist"},{default:d(()=>[r(ee,{square:"",flat:"",horizontal:""},{default:d(()=>[r(U,{class:"q-px-lg"},{default:d(()=>[E(" MEMBERS ")]),_:1}),r(U,{class:"memberlist-card"},{default:d(()=>[r(Me,{separator:""},{default:d(()=>[(p(!0),S(Q,null,Y(u(n).channelMembers,h=>(p(),A(X,{key:h.pubkey.toString(),"active-class":"owner",active:`${h.pubkey}`==`${u(n).channelMembershipAddr}`,class:"memberlist-item"},{default:d(()=>[r(G,{class:"memberlist-info"},{default:d(()=>[r(ze,{class:"row"},{default:d(()=>[m("span",ai,T(u(Wt)(h.data)),1),r($n,{class:Le([a(h.data.status.__kind),"memberlist-status q-pa-xs q-ml-lg"])},{default:d(()=>[E(T(h.data.status.__kind),1)]),_:2},1032,["class"])]),_:2},1024),r(ze,{caption:"",lines:"2"},{default:d(()=>[m("div",si,[oi,m("span",null,T(h.data.authority),1)]),m("div",ii,[li,m("span",null,T(h.data.key),1)])]),_:2},1024)]),_:2},1024),m("div",ri,[s(h.data.status.__kind)?(p(),A(K,{key:0,color:"positive",size:"sm",unelevated:"",class:"full-width",loading:t.authorizeMemberState.loading,disabled:t.authorizeMemberState.loading,onClick:b=>l.$emit("submit",h.data.key)},{default:d(()=>[E(" Authorize ")]),_:2},1032,["loading","disabled","onClick"])):se("",!0),u(i).canDeleteMember&&!o(h.data.authority.toBase58())?(p(),A(K,{key:1,color:"negative",size:"sm",unelevated:"",class:"full-width",loading:t.deleteMemberState.loading,disabled:t.deleteMemberState.loading,onClick:b=>l.$emit("deleteMember",h.data.key)},{default:d(()=>[E(" Delete ")]),_:2},1032,["loading","disabled","onClick"])):se("",!0)])]),_:2},1032,["active"]))),128))]),_:1})]),_:1})]),_:1})]),_:1}))}}),ui=m("br",null,null,-1),di=N({__name:"JoinChennalModal",emits:["join"],setup(t,{emit:e}){const n=O("");return(i,s)=>(p(),A(de,null,{default:d(()=>[r(ee,{square:"",flat:""},{default:d(()=>[r(U,{class:"text-body1"},{default:d(()=>[E(" Join Channel ")]),_:1}),r(U,{class:"text-body1 text-blue-grey-8"},{default:d(()=>[r(He,{class:"join-channel-form",onSubmit:s[1]||(s[1]=vt(a=>i.$emit("join",n.value),["prevent"]))},{default:d(()=>[r(ue,{modelValue:n.value,"onUpdate:modelValue":s[0]||(s[0]=a=>n.value=a),label:"Member name *","lazy-rules":"",rules:[a=>a&&a.length>2||"Please type something"]},null,8,["modelValue","rules"]),ui,r(K,{type:"submit",class:"dialog-submit-btn","text-color":"black",ripple:!1,square:""},{default:d(()=>[E(" Join Channel ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}});const mi=N({props:{text:{type:String,default:""},padding:{type:String,default:"0"}}});const hi=["innerHTML"];function pi(t,e,n,i,s,a){return p(),A(Kt,{class:"bg-white text-primary shadow-1 custom-tooltip",style:{"border-radius":"0"},anchor:"top middle",self:"bottom middle"},{default:d(()=>[m("div",{style:Re({fontSize:"11px",padding:`${t.padding}`}),innerHTML:t.text},null,12,hi)]),_:1})}const rt=te(mi,[["render",pi]]),fi=t=>(Be("data-v-157586e8"),t=t(),Ne(),t),gi=fi(()=>m("span",{class:"text-blue-grey-8 q-pb-xs"},"Search by name or address",-1)),bi={class:"search-block"},yi={class:"channel-info text-weight-medium"},_i={class:"channel-info"},vi={key:0,class:"already-in-chat"},wi={class:"control-btns"},Ci=N({__name:"JoinChannelDialog",props:{loading:{type:Boolean},defaultState:Object},emits:["submit","reset"],setup(t,{emit:e}){const n=t;O(n.defaultState);const{state:i,selectChannel:s,refreshList:a}=j(),o=_e(),l=O(!1),c=O(""),h=O([]),b=y(()=>i.allChannels.filter(v=>v.data.flags===0||v.data.flags===2)),_=y(()=>i.loading),w=v=>v.name.slice(0,2),M=()=>{if(c.value===""){h.value=[],c.value="";return}h.value=b.value.filter(v=>v.data.name.toLocaleLowerCase().includes(c.value.toLocaleLowerCase())||v.pubkey.toBase58().toLocaleLowerCase().includes(c.value.toLocaleLowerCase()))},$=y(()=>{var v;return((v=c.value)==null?void 0:v.length)>0?h.value:b.value}),q=v=>{e("submit",v)};ce(c,()=>{M()}),ce(()=>n.loading,v=>{v&&(l.value=!1)});const D=v=>o.ownChannels.find(L=>String(L.pubkey)===String(v.pubkey));return(v,L)=>{const V=rt,x=di;return p(),A(de,{class:"join-channel-dialog",onHide:L[3]||(L[3]=C=>v.$emit("reset"))},{default:d(()=>[r(ee,{square:"",flat:""},{default:d(()=>[r(U,{class:"text-body1 text-blue-grey-8"},{default:d(()=>[E(" Join channel ")]),_:1}),r(U,{class:"q-py-none"},{default:d(()=>[gi,m("div",bi,[r(ue,{modelValue:c.value,"onUpdate:modelValue":L[0]||(L[0]=C=>c.value=C),class:"input no-margin q-pa-none",placeholder:"Search ...",borderless:"",dense:"",debounce:"300"},null,8,["modelValue"])])]),_:1}),r(U,null,{default:d(()=>[u($).length?(p(),A(Me,{key:0,bordered:"",separator:"",class:"privat-channels"},{default:d(()=>[(p(!0),S(Q,null,Y(u($),C=>pe((p(),A(X,{key:C,"active-class":"bg-blue-grey-8 text-white",class:"privat-channels-item",active:`${u(i).channelAddr}`==`${C.pubkey}`,clickable:"",onClick:k=>u(s)(C.pubkey)},{default:d(()=>[m("div",{class:"chat-avatar",style:Re(u(Rt)(`${C.pubkey}`))},[m("span",null,T(w(C.data)),1)],4),r(G,null,{default:d(()=>[m("span",yi,T(C.data.name),1),m("span",_i,T(C.pubkey),1)]),_:2},1024),D(C)?(p(),S("div",vi,[r(V,{text:"already in channel"}),r(u(En),{size:"18"})])):se("",!0)]),_:2},1032,["active","onClick"])),[[Dn]])),128))]),_:1})):(p(),A(X,{key:1,class:"privat-channels justify-center items-center text-blue-grey-5"},{default:d(()=>[E(" Channels not found ")]),_:1}))]),_:1}),m("div",wi,[r(K,{class:Le(["control-button",{"refresh-btn":u(_)}]),square:"",flat:"",disable:!u(i).channelAddr,onClick:u(a)},{default:d(()=>[r(u(Bt),{style:{color:"#fff"}}),r(V,{text:"Refresh channels"})]),_:1},8,["disable","class","onClick"]),r(K,{class:"control-button",square:"",flat:"",disable:!u(i).channelAddr,onClick:L[1]||(L[1]=C=>l.value=!0)},{default:d(()=>[r(u(In),{style:{color:"#fff"}}),r(V,{text:"Request to join"})]),_:1},8,["disable"]),r(x,{modelValue:l.value,"onUpdate:modelValue":L[2]||(L[2]=C=>l.value=C),onJoin:q},null,8,["modelValue"])]),r(Xe,{showing:t.loading},null,8,["showing"])]),_:1})]),_:1})}}});const Mi=te(Ci,[["__scopeId","data-v-157586e8"]]),Ai=t=>(Be("data-v-e91edd23"),t=t(),Ne(),t),ki=Ai(()=>m("br",null,null,-1)),Si=N({__name:"AddMemberDialog",props:{loading:{type:Boolean,default:!1},defaultState:Object},emits:["submit","reset"],setup(t,{emit:e}){const i=O(t.defaultState),s=()=>e("submit",i.value);return(a,o)=>(p(),A(de,{class:"add-member-dialog",onHide:o[3]||(o[3]=l=>a.$emit("reset"))},{default:d(()=>[r(ee,{square:"",flat:""},{default:d(()=>[r(U,null,{default:d(()=>[r(He,{class:"add-member-form",onSubmit:vt(s,["prevent"])},{default:d(()=>[r(ue,{modelValue:i.value.name,"onUpdate:modelValue":o[0]||(o[0]=l=>i.value.name=l),label:"Member name *",hint:"Min length 3 chars","lazy-rules":"",rules:[l=>l&&l.length>2||"Please type something"]},null,8,["modelValue","rules"]),r(ue,{modelValue:i.value.wallet,"onUpdate:modelValue":o[1]||(o[1]=l=>i.value.wallet=l),label:"Member Wallet *","lazy-rules":"",rules:[l=>l&&l.length>32||"Invalid public key"]},null,8,["modelValue","rules"]),r(ue,{modelValue:i.value.key,"onUpdate:modelValue":o[2]||(o[2]=l=>i.value.key=l),label:"Member Device Key",hint:"Default: The same as member wallet","lazy-rules":"",rules:[l=>!l||l.length>32||"Invalid public key"]},null,8,["modelValue","rules"]),ki,r(K,{type:"submit",class:"dialog-submit-btn","text-color":"black",ripple:!1,square:"",flat:""},{default:d(()=>[E(" Add Member ")]),_:1})]),_:1},8,["onSubmit"]),r(Xe,{showing:t.loading},null,8,["showing"])]),_:1})]),_:1})]),_:1}))}});const xi=te(Si,[["__scopeId","data-v-e91edd23"]]),jt="/assets/info.bfade5eb.svg",$i={class:"row q-mt-md relative-position",style:{height:"42px"}},Ei={class:"toggle-info"},Di=m("img",{src:jt,alt:"info"},null,-1),Ii={key:0,class:"row text-primary toggle-approve"},Pi={class:"toggle-info"},Ki=m("img",{src:jt,alt:"info"},null,-1),Li=N({__name:"NewChannelDialog",props:{loading:{type:Boolean,default:!1},defaultState:Object},emits:["submit","reset"],setup(t,{emit:e}){const i=O(t.defaultState),s=()=>e("submit",i);return(a,o)=>{const l=rt;return p(),A(de,{class:"new-channel-dialog",onHide:o[4]||(o[4]=c=>a.$emit("reset"))},{default:d(()=>[r(ee,{square:"",flat:""},{default:d(()=>[r(U,null,{default:d(()=>[r(He,{class:"messenger-new-channel-form",onSubmit:s},{default:d(()=>[r(ue,{modelValue:i.value.name,"onUpdate:modelValue":o[0]||(o[0]=c=>i.value.name=c),label:"Channel name *","lazy-rules":"",maxlength:"32",rules:[c=>c&&c.length>2||"Please type something"]},null,8,["modelValue","rules"]),r(ue,{modelValue:i.value.maxMessages,"onUpdate:modelValue":o[1]||(o[1]=c=>i.value.maxMessages=c),label:"Max messages","lazy-rules":"",rules:[c=>+c>0||"Invalid value"]},null,8,["modelValue","rules"]),m("div",$i,[m("div",Ei,[r(l,{text:u(St)[0],padding:"8px"},null,8,["text"]),Di]),m("div",{class:Le(["col text-primary",{"toggle-border":!i.value.public}])},[E(" Private"),r(kt,{modelValue:i.value.public,"onUpdate:modelValue":o[2]||(o[2]=c=>i.value.public=c),label:"Public"},null,8,["modelValue"])],2),i.value.public?se("",!0):(p(),S("div",Ii,[r(kt,{modelValue:i.value.permissionless,"onUpdate:modelValue":o[3]||(o[3]=c=>i.value.permissionless=c)},null,8,["modelValue"]),m("span",null,[m("div",Pi,[r(l,{text:u(St)[1],padding:"8px"},null,8,["text"]),Ki]),E(" Members can approve")])]))]),r(K,{type:"submit",class:"dialog-submit-btn q-mt-md","text-color":"black",ripple:!1,square:"",flat:""},{default:d(()=>[E(" Create the Channel ")]),_:1})]),_:1}),r(Xe,{showing:t.loading},null,8,["showing"])]),_:1})]),_:1})]),_:1})}}});const zi=N({__name:"ChannelForm",props:{message:{type:String,default:""},disabled:{type:Boolean,default:!1},sending:{type:Boolean,default:!1}},emits:["submit"],setup(t,{emit:e}){const i=O(t.message),s=()=>{e("submit",i),i.value=""};return(a,o)=>(p(),A(He,{class:"channel-form",onSubmit:vt(s,["prevent"])},{default:d(()=>[r(Pn,{class:"row message-control"},{default:d(()=>[r(ue,{ref:"inputFocus",modelValue:i.value,"onUpdate:modelValue":o[0]||(o[0]=l=>i.value=l),class:"col-grow message-input",placeholder:"Type a message",dense:"",borderless:"",autofocus:"",disable:t.disabled},null,8,["modelValue","disable"]),r(K,{class:"send-btn",square:"",flat:"",type:"submit",disable:t.disabled,loading:t.sending},{default:d(()=>[E(" Send ")]),_:1},8,["disable","loading"])]),_:1})]),_:1},8,["onSubmit"]))}});const Ti=te(zi,[["__scopeId","data-v-bb5ae488"]]),Bi="/assets/solana-logo.3caace62.svg",wt=t=>(Be("data-v-a765a3c1"),t=t(),Ne(),t),Ni={class:"messenger-content"},Wi={key:0,class:"preloader"},Ri={key:1,class:"messenger-empty"},Oi={key:2,class:"messenger-empty"},qi=wt(()=>m("img",{src:Bi,alt:"logo"},null,-1)),Vi=wt(()=>m("span",{name:"connect"},"Please connect a wallet",-1)),Ui=[qi,Vi],Fi={key:3,class:"messenger-empty"},ji=wt(()=>m("span",{name:"select"},"Please select a channel",-1)),Qi=[ji],Ji=N({__name:"ChannelWrapper",props:{postMessageState:{type:Object}},emits:["sendMessage"],setup(t,{emit:e}){const n=ge(),{state:i}=j(),s=_e();function a(_){const w=n.publicKey.value;return w?String(w)!==String(_):!0}const o=y(()=>{const _=[];let w=0,M;for(const $ of i.channelMessages)M&&`${$.sender}`==`${M}`?_[w-1].text.push($.content):(M=$.sender,_.push({id:$.id,sender:$.sender,senderDisplayName:$.senderDisplayName,text:[$.content],date:$.createdAt}),w++);return _}),l=y(()=>s.canPostMessage),c=_=>e("sendMessage",_),h=O(),b=O();return ce(b,_=>{_&&(h.value.scrollTop=_.scrollHeight)}),(_,w)=>{const M=Ti;return p(),A(ee,{class:"messenger-card",square:"",flat:""},{default:d(()=>[m("div",Ni,[u(s).isChannelLoading?(p(),S("div",Wi,[r(Kn,{color:"primary",size:"2em"})])):u(i).channel?(p(),S("div",{key:1,ref_key:"chat",ref:h,class:"row justify-center channel-wrapper"},[u(o).length>0?(p(),S("div",{key:0,ref_key:"mes",ref:b,class:"messenger-messages"},[(p(!0),S(Q,null,Y(u(o),$=>(p(),A(Ln,{key:$.id,name:$.senderDisplayName,text:$.text,sent:a($.sender)},null,8,["name","text","sent"]))),128))],512)):(p(),S("div",Ri," No messages "))],512)):u(s).isWalletConnected?(p(),S("div",Fi,Qi)):(p(),S("div",Oi,Ui))]),r(M,{message:t.postMessageState.message,sending:u(s).isSendMessage,disabled:!u(l),onSubmit:c},null,8,["message","sending","disabled"])]),_:1})}}});const Gi=te(Ji,[["__scopeId","data-v-a765a3c1"]]);function Hi(){const{connection:t}=et(),e=ge(),{notify:n}=fe(),i=O(!1);return{isAirdrop:i,airdropSol:async()=>{try{const a=await t.requestAirdrop(e.publicKey.value,1*Pt);await t.confirmTransaction(a),n({type:"positive",message:"you got 1 sol",timeout:2e3,position:"top"}),i.value=!0}catch(a){console.log(a)}}}}const Xi=15;function Zi(){const{createChannel:t}=j(),{isWalletConnected:e,ok:n,error:i,noSol:s}=ve(),{userBalance:a}=Oe(),o=oe({dialog:!1,name:"",maxMessages:Xi,public:!1,permissionless:!1,loading:!1});async function l(){if(e())try{if(!await a()){s();return}await t(o.name,{maxMessages:o.maxMessages,public:o.public,permissionless:o.permissionless}),c(),n("Channel was created!")}catch(h){i("Something went wrong"),console.log(h)}}function c(){o.dialog=!1,o.public=!1,o.loading=!1,o.name="",o.maxMessages=15}return{state:o,submit:l,reset:c}}function Yi(){const t=j(),{info:e,ok:n,error:i}=ve(),s=oe({loading:!1});async function a(){if(!t.state.channelAddr){e("Please select a channel");return}try{s.loading=!0,await t.deleteChannel(t.state.channelAddr),n("Channel was deleted!")}catch(o){console.log("Error",o),i("Something went wrong")}finally{s.loading=!1}}return{state:s,submit:a}}function Qt(){const{authorizeMember:t,loadChannel:e,state:n}=j(),{ok:i,error:s}=ve(),a=oe({loading:!1,dialog:!1});async function o(l){var c;try{a.loading=!0,await t(l),await e((c=n.channelAddr)!=null?c:""),i("Member was authorized")}catch(h){s("Something went wrong"),console.log(h)}finally{a.loading=!1}}return{state:a,submit:o}}function el(){const{state:t,addMember:e,loadChannel:n}=j(),{ok:i,info:s,error:a,noSol:o}=ve(),{userBalance:l}=Oe(),c=oe({dialog:!1,loading:!1});async function h(_){var w;if(c.loading=!0,!t.channelAddr){s("Please select a channel");return}try{if(!await l()){o();return}return await e(_.wallet,_.key,_.name),await n((w=t.channelAddr)!=null?w:""),i("Member was added"),!0}catch(M){a("Something went wrong"),console.log(M)}finally{c.loading=!1,c.dialog=!1}return!1}function b(){c.loading=!1,c.dialog=!1}return{state:c,submit:h,reset:b}}function Jt(){const{deleteMember:t,loadChannel:e,state:n}=j(),{ok:i,error:s}=ve(),a=oe({loading:!1});async function o(l){var c;try{a.loading=!0,await t(l),await e((c=n.channelAddr)!=null?c:""),i("Member was deleted")}catch(h){s("Something went wrong"),console.log(h)}finally{a.loading=!1}}return{state:a,submit:o}}function tl(){const{state:t,joinChannel:e}=j(),{ok:n,info:i,error:s,noSol:a}=ve(),{userBalance:o}=Oe(),l=oe({dialog:!1,loading:!1,name:""});async function c(){if(!t.channelAddr){i("Please select a channel");return}l.loading=!0;try{if(!await o()){a();return}await e(t.channelAddr,l.name),h(),n("Request was sent")}catch(b){console.log("Error",b),s("Something went wrong")}finally{l.loading=!1}}function h(){l.loading=!1,l.dialog=!1,l.name=""}return{state:l,submit:c,reset:h}}function nl(){const t=j(),{info:e,ok:n,error:i}=ve(),s=oe({loading:!1});async function a(){if(!t.state.channelAddr){e("Please select a channel");return}try{s.loading=!0,await t.leaveChannel(t.state.channelAddr),n("Channel was abandoned!")}catch(o){console.log("Error",o),i("Something went wrong")}finally{s.loading=!1}}return{state:s,submit:a}}function ve(){const t=ge(),{airdropSol:e}=Hi(),{notify:n}=fe(),i=c=>n({type:"info",message:c,timeout:2e3}),s=c=>n({type:"negative",message:c,timeout:2e3}),a=(c,h="bottom")=>n({type:"positive",message:c,timeout:2e3,position:h}),o=()=>n({type:"warning",message:"You don't have enough SOL on your balance!",position:"top",timeout:0,actions:[{label:"GET SOL",class:"btn--no-hover",padding:"0 15px 0 10px",size:"14px",color:"black",handler:()=>e()}]});function l(){return t.publicKey.value?!0:(i("Please connect wallet"),!1)}return{ok:a,info:i,error:s,noSol:o,isWalletConnected:l}}const al=N({__name:"ChannelControl",props:{isLoading:{type:Boolean}},emits:["createChannel","joinChannel","refreshList"],setup(t,{emit:e}){const n=_e();ve();const{notify:i}=fe();y(()=>n.isPendingMember),y(()=>n.canCreateChannel);const s=a=>{if(!n.isWalletConnected){i({message:"Please connect wallet",color:"negative",position:"top"});return}e(a)};return(a,o)=>{const l=rt;return p(),A(X,null,{default:d(()=>[r(G,{class:"button-wrapper"},{default:d(()=>[r(K,{class:Le(["control-button",{"refresh-btn":t.isLoading}]),square:"",flat:"",onClick:o[0]||(o[0]=c=>s("refreshList"))},{default:d(()=>[r(u(Bt),{style:{color:"#fff"}}),r(l,{text:"Refresh channels"})]),_:1},8,["class"]),r(K,{class:"control-button",square:"",flat:"",onClick:o[1]||(o[1]=c=>s("createChannel"))},{default:d(()=>[r(u(zn),{style:{color:"#fff"}}),r(l,{text:"Create a channel"})]),_:1}),r(K,{class:"control-button",square:"",flat:"",onClick:o[2]||(o[2]=c=>s("joinChannel"))},{default:d(()=>[r(u(Tn),{style:{color:"#fff"}}),r(l,{text:"Browse channels"})]),_:1})]),_:1})]),_:1})}}});const sl=te(al,[["__scopeId","data-v-03d9bcd0"]]),ol={class:"chat-name"},il={key:0,class:"message-public"},ll={key:1,class:"pending-icon"},rl=N({__name:"MessengerChannel",props:{pubkey:{type:Object,required:!0},channel:{type:Object,required:!0},isActive:Boolean},emits:["select"],setup(t){const e=t,{state:n}=j(),i=y(()=>{var l;return(l=n.ownChannels.find(c=>c.pubkey===e.pubkey.toString()))==null?void 0:l.status}),s=y(()=>i.value==="Pending"),a=y(()=>e.channel.name.slice(0,2)),o=y(()=>e.channel.flags===1);return(l,c)=>{const h=rt;return p(),A(X,{"active-class":"bg-blue-grey-8 text-white",style:{"min-height":"42px"},active:t.isActive},{default:d(()=>[r(G,{class:"chat-item cursor-pointer",onClick:c[0]||(c[0]=b=>l.$emit("select"))},{default:d(()=>[m("div",{class:"chat-badge",style:Re(u(Rt)(`${t.pubkey}`))},[m("span",null,T(u(a)),1)],4),m("div",ol,T(t.channel.name),1),u(o)?(p(),S("div",il,[r(h,{text:"Public channel"}),E(" P ")])):se("",!0),u(s)?(p(),S("div",ll,[r(h,{text:"waiting for confirmation"}),r(Bn,{color:"primary",size:"16px"})])):se("",!0)]),_:1})]),_:1},8,["active"])}}});const cl=te(rl,[["__scopeId","data-v-d398a652"]]),ul=m("div",{class:"text-h5"}," Channels ",-1),dl={class:"text-weight-medium"},ml={class:"memberlist-info__details"},hl=m("span",null,"Authority:",-1),pl={class:"memberlist-info__details"},fl=m("span",null,"Key:",-1),gl=N({__name:"PendingUsersDialog",props:{pendingChannels:Object},setup(t){O(!1);const{state:e}=j(),n=Qt(),i=Jt(),s=async(c,h)=>{e.channelAddr=h,await n.submit(c)},a=async(c,h)=>{e.channelAddr=h,await i.submit(c)},o=y(()=>n.state.loading),l=y(()=>i.state.loading);return(c,h)=>(p(),A(de,null,{default:d(()=>[r(ee,{class:"pending-channels",square:"",flat:"",horizontal:""},{default:d(()=>[r(U,null,{default:d(()=>[ul]),_:1}),r(U,null,{default:d(()=>[r(Me,{bordered:""},{default:d(()=>[(p(!0),S(Q,null,Y(t.pendingChannels,(b,_)=>(p(),A(Nn,{key:b.name,"expand-separator":"",label:b.channel.data.name,caption:"channel","default-opened":_===0,"header-class":"owner"},{default:d(()=>[r(Me,{separator:""},{default:d(()=>[(p(!0),S(Q,null,Y(b.pendingMembers,w=>(p(),A(X,{key:w,class:"row justify-between pending-item"},{default:d(()=>[r(G,{class:"memberlist-info"},{default:d(()=>[r(ze,{class:"row justify-between"},{default:d(()=>[m("span",dl,T(u(Wt)(w.data)),1)]),_:2},1024),r(ze,{caption:"",lines:"2"},{default:d(()=>[m("div",ml,[hl,m("span",null,T(w.data.authority),1)]),m("div",pl,[fl,m("span",null,T(w.data.key),1)])]),_:2},1024)]),_:2},1024),r(G,{side:"",class:"memberlist-btns"},{default:d(()=>[r(K,{color:"teal",size:"xs",unelevated:"",class:"full-width",loading:u(o),disabled:u(o),onClick:M=>s(w.data.key,b.channel.pubkey)},{default:d(()=>[E(" Authorize ")]),_:2},1032,["loading","disabled","onClick"]),r(K,{color:"negative",size:"xs",unelevated:"",class:"full-width",loading:u(l),disabled:u(l),onClick:M=>a(w.data.key,b.channel.pubkey)},{default:d(()=>[E(" Delete ")]),_:2},1032,["loading","disabled","onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1032,["label","default-opened"]))),128))]),_:1})]),_:1})]),_:1})]),_:1}))}});const bl={class:"bell",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",fill:"none","xmlns:v":"https://vecta.io/nano"},yl=["fill"],_l=N({__name:"iconBell",props:{color:{type:String,default:"AABEC8"}},setup(t){return(e,n)=>(p(),S("svg",bl,[m("path",{d:"M5.352 14.359h3.294c0 .821-.59 1.641-1.647 1.641s-1.647-.82-1.647-1.641zm8.434-3.467l-.911-1.515a3.68 3.68 0 0 1-.527-1.897V5.325C12.348 2.389 9.949 0 7 0S1.651 2.389 1.651 5.325v2.155a3.68 3.68 0 0 1-.527 1.897l-.911 1.515c-.278.461-.285 1.018-.018 1.487s.749.749 1.29.749h11.03a1.47 1.47 0 0 0 1.291-.749 1.46 1.46 0 0 0-.021-1.487z",fill:`#${t.color}`},null,8,yl)]))}}),Gt=Ke("notifications",()=>{const t=Je(),{loadMembers:e,state:n}=j(),i=_e(),s=oe({showInfo:!1,showDialog:!1,pendingChannels:[]});ce([()=>i.ownChannels,()=>n.channelMembers],async(o,l)=>{l.length>0&&await a(l[0])});async function a(o){try{const l=await Promise.all(o.map(async c=>{var _;const{pubkey:h,data:b}=c;if(b.creator.toBase58()===((_=t.value)==null?void 0:_.publicKey.toBase58())){const w=await e(h);if(w.length===0)return;const M=w.filter($=>$.data.status.__kind==="Pending");return M.length?{channel:c,pendingMembers:M}:void 0}}));s.pendingChannels=l.filter(c=>c),s.pendingChannels.length>0?(setTimeout(()=>s.showInfo=!0,2e3),setTimeout(()=>s.showInfo=!1,7e3)):s.showDialog=!1}catch(l){console.log(l)}}return{state:s}});function vl(){const{state:t}=Gt();return{showDialog:y(()=>t.showDialog),showInfo:y(()=>t.showInfo),pendingChannels:y(()=>t.pendingChannels)}}const wl={class:"panel-notifications__info"},Cl=N({__name:"MessengerNotification",setup(t){const{pendingChannels:e,showInfo:n,showDialog:i}=vl(),{state:s}=Gt(),a=y(()=>{var h,b;return(b=(h=e.value)==null?void 0:h.length)!=null?b:0}),o=y(()=>a.value>0),l=y(()=>n.value?"width: 100%; padding-right: 14px":"width: 0; padding-right: 0;"),c=()=>{!o.value||(s.showDialog=!s.showDialog)};return(h,b)=>{const _=_l,w=gl;return p(),S("div",{class:Le(["panel-notifications",{"has-notifications":u(o)}]),onClick:c},[m("div",wl,[r(_,{class:"ring",color:u(o)?"FF5C5C":"AABEC8"},null,8,["color"]),m("span",null,T(a.value),1)]),m("div",{ref:"notificationsInfo",class:"panel-notifications__details",style:Re(u(l))}," channels are awaiting user confirmation ",4),r(w,{modelValue:u(s).showDialog,"onUpdate:modelValue":b[0]||(b[0]=M=>u(s).showDialog=M),"pending-channels":u(e),onCloseDialog:b[1]||(b[1]=M=>h.isShow.value=!1)},null,8,["modelValue","pending-channels"])],2)}}});const Ht=Ke("mobile",()=>{const{screen:t}=fe(),e=oe({searchOrInfo:"search"}),n=y(()=>t.xs);return ce(n,i=>{i&&(e.searchOrInfo="search")}),{state:e,isMobile:n}}),Ml={class:"panel-search"},Al={class:"search-wrapper"},kl={class:"panel-info"},Sl={class:"chat-info"},xl={class:"chat-members"},$l={class:"chat-messages"},El=["title"],Dl={key:0,class:"members-count bg-cyan-9"},Il=N({__name:"MessengerToolbar",emits:["search","showMembers","deleteChannel","addMember","showDeviceKey","leaveChannel"],setup(t,{emit:e}){const n=ge(),{state:i}=j(),s=_e(),a=Ht();fe();const o=y(()=>!!n.publicKey.value),l=O(""),c=y(()=>i.channel),h=y(()=>{var D,v,L;return((D=c.value)==null?void 0:D.memberCount)===null||((v=c.value)==null?void 0:v.memberCount)===void 0?"":`${(L=c.value)==null?void 0:L.memberCount}\xA0members`}),b=y(()=>{var D,v,L;return((D=c.value)==null?void 0:D.messageCount)===null||((v=c.value)==null?void 0:v.messageCount)===void 0?"":`${(L=c.value)==null?void 0:L.messageCount}\xA0messages`}),_=D=>e("search",D),w=()=>e("showMembers"),M=()=>e("addMember"),$=y(()=>{if(!(!s.isOwner||!s.isAdmin))return i.channelMembers.filter(D=>D.data.status.__kind==="Pending").length});ce(l,D=>{_(String(D))});const q=y(()=>a.isMobile&&a.state.searchOrInfo==="info");return ce(()=>i.channelAddr,D=>{D&&a.isMobile&&(a.state.searchOrInfo="info")}),(D,v)=>{var V,x;const L=Cl;return p(),S("div",{class:Le(["panel-toolbar",u(a).state.searchOrInfo])},[r(L),u(q)?(p(),A(u(Wn),{key:0,class:"back-arrow",onClick:v[0]||(v[0]=C=>u(a).state.searchOrInfo="search")})):se("",!0),m("div",Ml,[m("div",Al,[r(ue,{modelValue:l.value,"onUpdate:modelValue":v[1]||(v[1]=C=>l.value=C),class:"search-input no-margin q-pa-none",placeholder:"Search ...",clearable:"",debounce:"300",borderless:"",onClear:v[2]||(v[2]=C=>l.value="")},null,8,["modelValue"])])]),m("div",kl,[m("div",Sl,[m("div",xl,T(u(h)),1),m("div",$l,T(u(b)),1)]),r(_t,{class:""}),m("div",{class:"chat-name",title:(V=u(c))==null?void 0:V.name},T((x=u(c))==null?void 0:x.name),9,El),m("div",null,[r(K,{class:"chat-menu",flat:"",square:"",disable:!u(o)||!u(c)},{default:d(()=>[r(u(Rn),{size:"18"}),r(On,{anchor:"bottom middle",self:"top middle"},{default:d(()=>[r(Me,{style:{"min-width":"120px"},bordered:""},{default:d(()=>[pe((p(),A(X,{class:"q-my-sm q-mx-sm q-pa-none chat-menu__item",clickable:"",onClick:v[3]||(v[3]=C=>D.$emit("showDeviceKey"))},{default:d(()=>[r(G,{class:"q-pa-none"},{default:d(()=>[r(K,{flat:"",square:"",size:"sm",class:"bg-blue-grey-7 text-white q-px-xs"},{default:d(()=>[E(" Device key ")]),_:1})]),_:1})]),_:1})),[[Ee]]),pe((p(),A(X,{class:"q-my-sm q-mx-sm q-pa-none chat-menu__item relative-position",clickable:"",disable:!u(c),onClick:w},{default:d(()=>[r(G,null,{default:d(()=>[u($)>0?(p(),S("div",Dl,T(u($)),1)):se("",!0),r(K,{flat:"",square:"",size:"sm",class:"bg-cyan-9 text-white q-px-xs"},{default:d(()=>[E(" Members ")]),_:1})]),_:1})]),_:1},8,["disable"])),[[Ee]]),u(s).isOwner?pe((p(),A(X,{key:0,class:"q-my-sm q-mx-sm q-pa-none chat-menu__item",clickable:"",disable:!u(s).canAddMember,onClick:M},{default:d(()=>[r(G,null,{default:d(()=>[r(K,{flat:"",square:"",size:"sm",class:"bg-amber-7 text-white q-px-xs"},{default:d(()=>[E(" Add member ")]),_:1})]),_:1})]),_:1},8,["disable"])),[[Ee]]):se("",!0),u(s).isOwner?pe((p(),A(X,{key:1,class:"q-my-sm q-mx-sm q-pa-none chat-menu__item",clickable:"",disable:!u(s).isChannelCreator,onClick:v[4]||(v[4]=C=>D.$emit("deleteChannel"))},{default:d(()=>[r(G,null,{default:d(()=>[r(K,{flat:"",square:"",size:"sm",class:"bg-negative text-white q-px-xs"},{default:d(()=>[E(" Delete ")]),_:1})]),_:1})]),_:1},8,["disable"])),[[Ee]]):pe((p(),A(X,{key:2,class:"q-my-sm q-mx-sm q-pa-none chat-menu__item",clickable:"",onClick:v[5]||(v[5]=C=>D.$emit("leaveChannel"))},{default:d(()=>[r(G,null,{default:d(()=>[r(K,{flat:"",square:"",size:"sm",class:"bg-negative text-white q-px-xs"},{default:d(()=>[E(" Leave ")]),_:1})]),_:1})]),_:1})),[[Ee]])]),_:1})]),_:1})]),_:1},8,["disable"])])])],2)}}});const Pl={class:"col col-4"},Kl={class:"col"},Ll={class:"no-margin"},zl=N({__name:"DebugBtn",setup(t){const{state:e}=j(),{isAuthorizedMember:n,isPendingMember:i,isChannelCreator:s}=_e(),a=O(!1),o=qn(a);return(l,c)=>(p(),S(Q,null,[r(K,{flat:"",class:"text-blue-2",onClick:c[0]||(c[0]=h=>u(o)())},{default:d(()=>[E(" Debug info ")]),_:1}),r(de,{modelValue:a.value,"onUpdate:modelValue":c[1]||(c[1]=h=>a.value=h)},{default:d(()=>[r(ee,null,{default:d(()=>[r(U,null,{default:d(()=>[(p(!0),S(Q,null,Y([["Authorized",u(n)],["Pending Access",u(i)],["Channel Creator",u(s)],["Channel",u(e).channel],["Membership",u(e).channelMembership],["Members",u(e).channelMembers]],h=>(p(),S("div",{key:h[0],class:"row q-mt-md"},[m("div",Pl,T(h[0]),1),m("div",Kl,[m("pre",Ll,T(h[1]),1)])]))),128))]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}}),Tl={class:"messenger-wrapper"},Bl={class:"messenger-main"},Nl={key:1,class:"messenger-channels-empty"},Wl={key:0,class:"q-my-md q-px-lg"},Rl=N({__name:"Messenger",setup(t){const e=ge(),{state:n,postMessage:i,loadChannel:s,refreshList:a}=j(),o=_e(),l=Ht(),c=Zi(),h=tl(),b=el(),_=Qt(),w=Jt(),M=Yi(),$=nl(),q=oe({message:""});y(()=>n.allChannels);const D=O([]),v=O("");async function L(H){await i(H.value),q.message=""}const V=H=>{if(H===""){D.value=[],v.value="";return}D.value=o.ownChannels.filter(P=>P.data.name.toLocaleLowerCase().includes(H.toLocaleLowerCase())||P.pubkey.toBase58().toLocaleLowerCase().includes(H.toLocaleLowerCase())),v.value=H},x=y(()=>n.loading),C=O(!1),k=y(()=>D.value.length>0||v.value.length>0?D.value:o.ownChannels),J=H=>b.submit(H),ne=H=>{h.state.name=H,h.submit()},Se=y(()=>l.isMobile?l.state.searchOrInfo==="search"?1:2:1);return(H,P)=>{const qe=Il,g=cl,I=sl,z=Gi,R=Li,ie=xi,ae=Mi,Ve=ci,xe=to;return p(),S(Q,null,[m("div",Tl,[r(qe,{onSearch:V,onShowMembers:P[0]||(P[0]=B=>u(_).state.dialog=!0),onDeleteChannel:P[1]||(P[1]=B=>u(M).submit(u(n).channelAddr)),onLeaveChannel:P[2]||(P[2]=B=>u($).submit(u(n).channelAddr)),onAddMember:P[3]||(P[3]=B=>u(b).state.dialog=!0),onShowDeviceKey:P[4]||(P[4]=B=>C.value=!0)}),m("div",Bl,[r(ee,{class:"messenger-channels",square:"",flat:""},{default:d(()=>[u(k).length>0?(p(),A(Me,{key:0,separator:"",class:"channels-list"},{default:d(()=>[(p(!0),S(Q,null,Y(u(k),B=>(p(),A(g,{key:B.name,pubkey:B.pubkey,channel:B.data,"active-class":"select-channel","is-active":`${u(n).channelAddr}`==`${B.pubkey}`,onSelect:ur=>u(s)(B.pubkey)},null,8,["pubkey","channel","is-active","onSelect"]))),128))]),_:1})):(p(),S("div",Nl," No channels ")),r(I,{"is-joining":u(h).state.loading,"is-loading":u(x),onCreateChannel:P[5]||(P[5]=B=>u(c).state.dialog=!0),onJoinChannel:P[6]||(P[6]=B=>u(h).state.dialog=!0),onRefreshList:u(a)},null,8,["is-joining","is-loading","onRefreshList"])]),_:1}),r(z,{style:Re({"z-index":u(Se)}),"post-message-state":q,onSendMessage:L},null,8,["style","post-message-state"]),r(Xe,{showing:u(n).loading,color:"primary"},null,8,["showing"])])]),r(R,{modelValue:u(c).state.dialog,"onUpdate:modelValue":P[7]||(P[7]=B=>u(c).state.dialog=B),loading:u(c).state.loading,"default-state":u(c).state,onSubmit:u(c).submit,onReset:u(c).reset},null,8,["modelValue","loading","default-state","onSubmit","onReset"]),r(ie,{modelValue:u(b).state.dialog,"onUpdate:modelValue":P[8]||(P[8]=B=>u(b).state.dialog=B),loading:u(b).state.loading,"default-state":u(b).state,onSubmit:J,onReset:u(b).reset},null,8,["modelValue","loading","default-state","onReset"]),r(ae,{modelValue:u(h).state.dialog,"onUpdate:modelValue":P[9]||(P[9]=B=>u(h).state.dialog=B),loading:u(h).state.loading,"default-state":u(h).state,onSubmit:ne,onReset:u(h).reset},null,8,["modelValue","loading","default-state","onReset"]),r(Ve,{modelValue:u(_).state.dialog,"onUpdate:modelValue":P[10]||(P[10]=B=>u(_).state.dialog=B),wallet:u(e),"authorize-member-state":u(_).state,"delete-member-state":u(w).state,onSubmit:u(_).submit,onDeleteMember:u(w).submit},null,8,["modelValue","wallet","authorize-member-state","delete-member-state","onSubmit","onDeleteMember"]),r(xe,{modelValue:C.value,"onUpdate:modelValue":P[11]||(P[11]=B=>C.value=B)},null,8,["modelValue"]),u(n).channel?(p(),S("div",Wl,[r(zl)])):se("",!0)],64)}}});const Ol={},ql={class:"container"},Vl={class:"messenger-container"},Ul={class:"container"};function Fl(t,e){const n=Rl,i=Hs;return p(),A(Vn,{class:"page-wrapper"},{default:d(()=>[m("div",ql,[m("div",Vl,[r(n)])]),m("div",Ul,[r(i)])]),_:1})}const jl=te(Ol,[["render",Fl],["__scopeId","data-v-d4ef5e8f"]]),Ql=()=>It(()=>import("./_...all_.93375d5f.js"),["assets/_...all_.93375d5f.js","assets/vendor.c082b873.js","assets/_...all_.73169310.css"]),Jl=[{name:"index",path:"/",component:jl,props:!0},{name:"all",path:"/:all(.*)*",component:Ql,props:!0,meta:{layout:"empty"}}],Gl=Bs(Jl),Hl="/",Xl=Un({history:Fn(Hl),scrollBehavior:()=>({left:0,top:0}),strict:!0,routes:Gl}),Zl=({app:t})=>{t.use(Xl)},Yl=Object.freeze(Object.defineProperty({__proto__:null,install:Zl},Symbol.toStringTag,{value:"Module"})),er=({app:t})=>{t.use(jn,{wallets:[new Qn,new Jn,new Gn,new Hn,new Xn,new Zn,new Yn,new ea,new ta,new na,new aa,new sa,new oa,new ia,new la,new ra,new ca,new ua,new da,new ma,new ha,new pa,new fa,new ga,new ba,new ya,new _a,new va,new wa,new Ca],autoConnect:!1})},tr=Object.freeze(Object.defineProperty({__proto__:null,install:er},Symbol.toStringTag,{value:"Module"})),nr=Ma();function ar(){return nr}const sr=Symbol("WALLET_CONNECT_EVENT"),or=Symbol("WALLET_DISCONNECT_EVENT"),ir=Symbol("ACCOUNT_CHANGE_EVENT"),mt=5e3;function lr(){const{connection:t}=et(),{emit:e}=ar(),{notify:n}=fe(),{wallet:i}=ge();ce(i,s=>{if(!s)return;const a=()=>{const c=s.adapter.publicKey;t.onAccountChange(c,h=>{e(ir,h)}),t.onLogs(c,h=>{console.log(h)}),n({message:"Wallet update",caption:`Connected to wallet ${Ze(c.toBase58(),7)}`,timeout:mt}),e(sr,s)},o=()=>{n({message:"Wallet update",caption:"Disconnected from wallet",timeout:mt}),e(or,s)},l=c=>{!(c!=null&&c.message)||n({type:"negative",message:"Wallet update",caption:c.message,timeout:mt})};s.adapter.once("connect",a),s.adapter.once("disconnect",o),s.adapter.removeAllListeners("error"),s.adapter.on("error",l)},{immediate:!0})}const rr=N({__name:"App",setup(t){return Aa(()=>{lr()}),(e,n)=>{const i=yt("router-view");return p(),A(i)}}});async function cr(){const t=ka(rr);Object.values(Object.assign({"./plugins/pinia.ts":xa,"./plugins/quasar.ts":Ea,"./plugins/router.ts":Yl,"./plugins/wallet.ts":tr})).forEach(e=>{var n;return(n=e.install)==null?void 0:n.call(e,{app:t})}),t.mount("#app")}cr().then();export{te as _};
